[
    {
        "id": "7a2a228bff5f9b1b",
        "type": "tab",
        "label": "Tarea 4",
        "disabled": true,
        "info": ""
    },
    {
        "id": "28aa48179e689485",
        "type": "tab",
        "label": "Flow 3",
        "disabled": true,
        "info": ""
    },
    {
        "id": "240e9138468e39f6",
        "type": "tab",
        "label": "Tarea 2",
        "disabled": true,
        "info": ""
    },
    {
        "id": "79e1efd2b7cf0d02",
        "type": "tab",
        "label": "Tarea 1 + extra",
        "disabled": true,
        "info": ""
    },
    {
        "id": "24ab647bb9010131",
        "type": "tab",
        "label": "ui test",
        "disabled": true,
        "info": ""
    },
    {
        "id": "13df9ad25c9618e4",
        "type": "tab",
        "label": "Tarea ESP826",
        "disabled": true,
        "info": "# Tarea de grupo ESP826\n\n## Grupo 3\n- Izan Amador Bustos\n- Irene Guijarro Molina\n- Jorge Luis Benavides Macías\n- Ricardo Panero Lamothe\n\n## Descripción de la práctica\n\nHay que programar usando el IDE Arduino la placa de desarrollo ESP8266 NodeMCU Dev Kit para que realice las siguientes funciones.\n\n1. Conexión \n2. Envío periódico de datos\n3. Escritura en LED\n4. Lectura del LED\n\nHay dos opciones para usar como servidor MQTT, el de vuestra máquina virtual. Hay que usar como IP del servidor la del PC que estáis usando. También podéis usar el servidor iot.ac.uma.es usando como usuario y clave: infind / zancudo . Siempre que se use este servidor los topics tienen que empezar obligatoriamente por infind/\n\nEn los topics hay que usar el nombre del grupo, por ejemplo GRUPO5 si se trata del prototipo del grupo 5. Si dentro del mismo grupo hay varios prototipos en marcha añadir otro nivel intermedio al topic con el nombre propio del programador si se quiere evitar interferencias.\n\nImplementar flujos Node-RED para que sean funcionales con este nuevo prototipo. Se deben recibir los datos de sensores y estado para visualizarlos en el Dashboard y permitir configurar el nivel de brillo del LED.\n\nEntregar en grupo el programa Arduino y flujo NodeRED desarrollados.\nLibrerías de interés\n\nPara configurar la conexión MQTT, LWT, publicar y suscribirse a topics, ... usamos la librería PubSubClient. Consultar referencia en: https://pubsubclient.knolleary.net/ \n\nPara manejar las cadenas formateadas con JSON se recomienda utilizar la librería ArduinoJson (https://arduinojson.org/) instalable desde el gestor de librerías de la herramienta. O imprimir las cadenas con el formato adecuado usando funciones de C como sprintf().\n\n\n## 1. Conexión \n\nConectar usando el punto de acceso WiFi con SSID: infind  y password: 1518wifi si estamos en el laboratorio y vuestra WiFi si estáis en casa.\n\n\n\n## 2. Envío periódico de datos\n\nEl dispositivo debe leer un sensor de humedad y tempertaura DHT11, también la entrada analógica para controlar el nivel de la batería/alimentación (ver https://arduino-esp8266.readthedocs.io/en/latest/reference.html#analog-input) y enviar periodicamente (cada 30 segundos) los valores mediante MQTT.  \n\nEn este envío periódico se incluirá también información de la conexión WiFi (SSid), IP asignada y potencia de señal (RSSI). \n\nHabrá que realizar el conexionado del sensor DHT11 como vimos en tareas anteriores. Para la lectura del nivel de voltaje (Vcc) hay que usar las indicaciones del enlace en el párrafo anterior, la función para leer ESP.getVcc() devolverá los milivoltios observados en la entrada de alimentación (https://arduino-esp8266.readthedocs.io/en/latest/libraries.html#esp-specific-apis).\n\nPara el campo \"Uptime\", enviaremos el número de milisegundos desde que inició la placa.\n\nLa información sobre la conexión WiFi del dispositivo se podrá consultar mediante la clases disponibles en la librería WiFi (https://www.arduino.cc/en/Reference/WiFi). Algunas particularidades para ESP8266 estarán mejor descritas en la librería ESP8266WiFi (https://arduino-esp8266.readthedocs.io/en/latest/esp8266wifi/station-class.html)  y en el API de la librería  ( https://links2004.github.io/Arduino/df/d1c/class_e_s_p8266_wi_fi_scan_class.html).\n\n\n\n\n## 3. Escritura en LED\n\nTambién mediante el mismo protocolo debe recibir ordenes para actuar sobre la salida GPIO2 (conectada a un LED azul sobre la placa), informando de los cambios realizados.\n\nEl control del LED (GPIO2) esta vez lo haremos usando PWM (https://arduino-esp8266.readthedocs.io/en/latest/reference.html#analog-output) de forma que se configurará su funcionamiento con un número entero entre 0 y 100, que representará el nivel de brillo del LED en tanto por ciento. \n\nLos valores 0 y 100 deben funcionar como hasta ahora apagando y encendiendo totalmente el LED y los valores intermedios deben encenderlo con la atenuación indicada usando PWM.\n\nPosiblemente el rango de actuación de analogWrite() sea de [0-1023] o [0-255], dependerá de la versión que estemos usando del soporte para ESP8266 en Arduino.\n\n## 4. Lectura del LED\n\n\n\n## 1 Envío periódico de datos\n\nEl dispositivo debe leer un sensor de humedad y tempertaura DHT11, también la entrada analógica para controlar el nivel de la batería/alimentación ( ver https://arduino-esp8266.readthedocs.io/en/latest/reference.html#analog-input) y enviar periodicamente (cada 30 segundos) los valores mediante MQTT.  \n\nEn este envío periódico se incluirá también información de la conexión WiFi (SSid), IP asignada y potencia de señal (RSSI). También mediante el mismo protocolo debe recibir ordenes para actuar sobre la salida GPIO2 (conectada a un LED azul sobre la placa), informando de los cambios realizados."
    },
    {
        "id": "a43193f9452562d4",
        "type": "tab",
        "label": "FOTA",
        "disabled": true,
        "info": ""
    },
    {
        "id": "45a4e39f.03efac",
        "type": "tab",
        "label": "Tarea 9",
        "disabled": true,
        "info": ""
    },
    {
        "id": "ccd8ad10.a1f6a",
        "type": "tab",
        "label": "Tarea 10",
        "disabled": true,
        "info": ""
    },
    {
        "id": "122f65d809b34d8e",
        "type": "tab",
        "label": "Upload intomongo",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "b056b4cf9a298e0d",
        "type": "tab",
        "label": "La caja - Game",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "e124bbec17d40651",
        "type": "tab",
        "label": "Agregaciones",
        "disabled": true,
        "info": ""
    },
    {
        "id": "03c76acfc9a07adb",
        "type": "tab",
        "label": "Examen",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "b23dfd10f01a4521",
        "type": "tab",
        "label": "Pruebas -  Jorge",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "f607af27c5f161a8",
        "type": "tab",
        "label": "Tarea 4",
        "disabled": true,
        "info": ""
    },
    {
        "id": "75eea1382d17332e",
        "type": "tab",
        "label": "Flow 3",
        "disabled": true,
        "info": ""
    },
    {
        "id": "7a16d1d00dfc8197",
        "type": "tab",
        "label": "Tarea 2",
        "disabled": true,
        "info": ""
    },
    {
        "id": "0e6efdbc0f657beb",
        "type": "tab",
        "label": "Tarea 1 + extra",
        "disabled": true,
        "info": ""
    },
    {
        "id": "2ecbb3a5fe8520af",
        "type": "tab",
        "label": "ui test",
        "disabled": true,
        "info": ""
    },
    {
        "id": "4b80774a81fc72e3",
        "type": "tab",
        "label": "Tarea ESP826",
        "disabled": true,
        "info": "# Tarea de grupo ESP826\n\n## Grupo 3\n- Izan Amador Bustos\n- Irene Guijarro Molina\n- Jorge Luis Benavides Macías\n- Ricardo Panero Lamothe\n\n## Descripción de la práctica\n\nHay que programar usando el IDE Arduino la placa de desarrollo ESP8266 NodeMCU Dev Kit para que realice las siguientes funciones.\n\n1. Conexión \n2. Envío periódico de datos\n3. Escritura en LED\n4. Lectura del LED\n\nHay dos opciones para usar como servidor MQTT, el de vuestra máquina virtual. Hay que usar como IP del servidor la del PC que estáis usando. También podéis usar el servidor iot.ac.uma.es usando como usuario y clave: infind / zancudo . Siempre que se use este servidor los topics tienen que empezar obligatoriamente por infind/\n\nEn los topics hay que usar el nombre del grupo, por ejemplo GRUPO5 si se trata del prototipo del grupo 5. Si dentro del mismo grupo hay varios prototipos en marcha añadir otro nivel intermedio al topic con el nombre propio del programador si se quiere evitar interferencias.\n\nImplementar flujos Node-RED para que sean funcionales con este nuevo prototipo. Se deben recibir los datos de sensores y estado para visualizarlos en el Dashboard y permitir configurar el nivel de brillo del LED.\n\nEntregar en grupo el programa Arduino y flujo NodeRED desarrollados.\nLibrerías de interés\n\nPara configurar la conexión MQTT, LWT, publicar y suscribirse a topics, ... usamos la librería PubSubClient. Consultar referencia en: https://pubsubclient.knolleary.net/ \n\nPara manejar las cadenas formateadas con JSON se recomienda utilizar la librería ArduinoJson (https://arduinojson.org/) instalable desde el gestor de librerías de la herramienta. O imprimir las cadenas con el formato adecuado usando funciones de C como sprintf().\n\n\n## 1. Conexión \n\nConectar usando el punto de acceso WiFi con SSID: infind  y password: 1518wifi si estamos en el laboratorio y vuestra WiFi si estáis en casa.\n\n\n\n## 2. Envío periódico de datos\n\nEl dispositivo debe leer un sensor de humedad y tempertaura DHT11, también la entrada analógica para controlar el nivel de la batería/alimentación (ver https://arduino-esp8266.readthedocs.io/en/latest/reference.html#analog-input) y enviar periodicamente (cada 30 segundos) los valores mediante MQTT.  \n\nEn este envío periódico se incluirá también información de la conexión WiFi (SSid), IP asignada y potencia de señal (RSSI). \n\nHabrá que realizar el conexionado del sensor DHT11 como vimos en tareas anteriores. Para la lectura del nivel de voltaje (Vcc) hay que usar las indicaciones del enlace en el párrafo anterior, la función para leer ESP.getVcc() devolverá los milivoltios observados en la entrada de alimentación (https://arduino-esp8266.readthedocs.io/en/latest/libraries.html#esp-specific-apis).\n\nPara el campo \"Uptime\", enviaremos el número de milisegundos desde que inició la placa.\n\nLa información sobre la conexión WiFi del dispositivo se podrá consultar mediante la clases disponibles en la librería WiFi (https://www.arduino.cc/en/Reference/WiFi). Algunas particularidades para ESP8266 estarán mejor descritas en la librería ESP8266WiFi (https://arduino-esp8266.readthedocs.io/en/latest/esp8266wifi/station-class.html)  y en el API de la librería  ( https://links2004.github.io/Arduino/df/d1c/class_e_s_p8266_wi_fi_scan_class.html).\n\n\n\n\n## 3. Escritura en LED\n\nTambién mediante el mismo protocolo debe recibir ordenes para actuar sobre la salida GPIO2 (conectada a un LED azul sobre la placa), informando de los cambios realizados.\n\nEl control del LED (GPIO2) esta vez lo haremos usando PWM (https://arduino-esp8266.readthedocs.io/en/latest/reference.html#analog-output) de forma que se configurará su funcionamiento con un número entero entre 0 y 100, que representará el nivel de brillo del LED en tanto por ciento. \n\nLos valores 0 y 100 deben funcionar como hasta ahora apagando y encendiendo totalmente el LED y los valores intermedios deben encenderlo con la atenuación indicada usando PWM.\n\nPosiblemente el rango de actuación de analogWrite() sea de [0-1023] o [0-255], dependerá de la versión que estemos usando del soporte para ESP8266 en Arduino.\n\n## 4. Lectura del LED\n\n\n\n## 1 Envío periódico de datos\n\nEl dispositivo debe leer un sensor de humedad y tempertaura DHT11, también la entrada analógica para controlar el nivel de la batería/alimentación ( ver https://arduino-esp8266.readthedocs.io/en/latest/reference.html#analog-input) y enviar periodicamente (cada 30 segundos) los valores mediante MQTT.  \n\nEn este envío periódico se incluirá también información de la conexión WiFi (SSid), IP asignada y potencia de señal (RSSI). También mediante el mismo protocolo debe recibir ordenes para actuar sobre la salida GPIO2 (conectada a un LED azul sobre la placa), informando de los cambios realizados."
    },
    {
        "id": "717fc4f91fb7094e",
        "type": "tab",
        "label": "FOTA",
        "disabled": true,
        "info": ""
    },
    {
        "id": "ecad3a12aab4b8b2",
        "type": "tab",
        "label": "Tarea 9",
        "disabled": true,
        "info": ""
    },
    {
        "id": "135a65bc89a095d4",
        "type": "tab",
        "label": "Tarea 10",
        "disabled": true,
        "info": ""
    },
    {
        "id": "6c70fe453347e1a4",
        "type": "tab",
        "label": "Upload intomongo",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "b1264f7f33a6cecd",
        "type": "tab",
        "label": "La caja - Game",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "d894e2caf9be4a6e",
        "type": "tab",
        "label": "Agregaciones",
        "disabled": true,
        "info": ""
    },
    {
        "id": "e5bf25aa0df07243",
        "type": "tab",
        "label": "Examen",
        "disabled": true,
        "info": "",
        "env": []
    },
    {
        "id": "bf067899c58fd436",
        "type": "tab",
        "label": "Pruebas -  Jorge",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "d13323c9cef06b5d",
        "type": "tab",
        "label": "Test",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "1736e63b25650818",
        "type": "subflow",
        "name": "Json-Parametros",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 240,
                "y": 180,
                "wires": [
                    {
                        "id": "4e09efcff6e84b0c"
                    },
                    {
                        "id": "95164f1d4c36c5d5"
                    },
                    {
                        "id": "6c4c38ff165dbd18"
                    },
                    {
                        "id": "b03cec66fb391724"
                    },
                    {
                        "id": "b0c38e47413631d4"
                    },
                    {
                        "id": "fa36c4f9fd494fa8"
                    },
                    {
                        "id": "8579e5a838f746f2"
                    },
                    {
                        "id": "c80f38ea1c9620b4"
                    },
                    {
                        "id": "3ab993c9aaeb02a9"
                    },
                    {
                        "id": "ed54312aaa364df5"
                    },
                    {
                        "id": "cbca515058def3f9"
                    },
                    {
                        "id": "965433bea2abdd7f"
                    },
                    {
                        "id": "02ad691c4d094030"
                    },
                    {
                        "id": "37ec8e592794dd5a"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 700,
                "y": 60,
                "wires": [
                    {
                        "id": "4e09efcff6e84b0c",
                        "port": 0
                    }
                ]
            },
            {
                "x": 700,
                "y": 100,
                "wires": [
                    {
                        "id": "95164f1d4c36c5d5",
                        "port": 0
                    }
                ]
            },
            {
                "x": 700,
                "y": 140,
                "wires": [
                    {
                        "id": "6c4c38ff165dbd18",
                        "port": 0
                    }
                ]
            },
            {
                "x": 700,
                "y": 180,
                "wires": [
                    {
                        "id": "b03cec66fb391724",
                        "port": 0
                    }
                ]
            },
            {
                "x": 700,
                "y": 220,
                "wires": [
                    {
                        "id": "b0c38e47413631d4",
                        "port": 0
                    }
                ]
            },
            {
                "x": 700,
                "y": 260,
                "wires": [
                    {
                        "id": "fa36c4f9fd494fa8",
                        "port": 0
                    }
                ]
            },
            {
                "x": 700,
                "y": 300,
                "wires": [
                    {
                        "id": "8579e5a838f746f2",
                        "port": 0
                    }
                ]
            },
            {
                "x": 700,
                "y": 340,
                "wires": [
                    {
                        "id": "c80f38ea1c9620b4",
                        "port": 0
                    }
                ]
            },
            {
                "x": 700,
                "y": 380,
                "wires": [
                    {
                        "id": "3ab993c9aaeb02a9",
                        "port": 0
                    }
                ]
            },
            {
                "x": 700,
                "y": 420,
                "wires": [
                    {
                        "id": "ed54312aaa364df5",
                        "port": 0
                    }
                ]
            },
            {
                "x": 730,
                "y": 520,
                "wires": [
                    {
                        "id": "cbca515058def3f9",
                        "port": 0
                    }
                ]
            },
            {
                "x": 720,
                "y": 560,
                "wires": [
                    {
                        "id": "965433bea2abdd7f",
                        "port": 0
                    }
                ]
            },
            {
                "x": 720,
                "y": 600,
                "wires": [
                    {
                        "id": "02ad691c4d094030",
                        "port": 0
                    }
                ]
            },
            {
                "x": 710,
                "y": 680,
                "wires": [
                    {
                        "id": "37ec8e592794dd5a",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [
            {
                "name": "entrada",
                "type": "str",
                "value": "salida"
            }
        ],
        "meta": {},
        "color": "#3FADB5",
        "inputLabels": [
            "json"
        ],
        "outputLabels": [
            "SSID",
            "RSSI",
            "localIP",
            "macAddress",
            "uptime_ms",
            "interval_s",
            "ChipID",
            "Des",
            "Rojo",
            "Verde",
            "Temperatura",
            "Humedad",
            "Presion",
            "Illuminacion"
        ],
        "icon": "node-red/parser-json.svg"
    },
    {
        "id": "7cbc96056c55979a",
        "type": "subflow",
        "name": "Cara002",
        "info": "Este bloque funsiona asin",
        "category": "",
        "in": [
            {
                "x": 40,
                "y": 60,
                "wires": [
                    {
                        "id": "d8fc63694048f63f"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 2140,
                "y": 200,
                "wires": [
                    {
                        "id": "f467c017da051f39",
                        "port": 0
                    }
                ]
            },
            {
                "x": 2130,
                "y": 400,
                "wires": [
                    {
                        "id": "99f8ad3df90e445c",
                        "port": 0
                    }
                ]
            },
            {
                "x": 2140,
                "y": 440,
                "wires": [
                    {
                        "id": "e2e49d26f6fd4e46",
                        "port": 0
                    }
                ]
            },
            {
                "x": 2140,
                "y": 560,
                "wires": [
                    {
                        "id": "2eb58ec64814c2b3",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "meta": {
            "version": "0.0.1",
            "author": "Rhyloo",
            "license": "MIT"
        },
        "color": "#DDAA99",
        "outputLabels": [
            "msgToBot",
            "State",
            "gametime",
            "gameinfo"
        ]
    },
    {
        "id": "72ea5fcb0b022fe1",
        "type": "subflow",
        "name": "Cara003",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 120,
                "y": 80,
                "wires": [
                    {
                        "id": "ac7dfeb5cf992750"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1440,
                "y": 80,
                "wires": [
                    {
                        "id": "d5422d86349077ea",
                        "port": 0
                    },
                    {
                        "id": "ac7dfeb5cf992750",
                        "port": 0
                    }
                ]
            },
            {
                "x": 1450,
                "y": 740,
                "wires": [
                    {
                        "id": "d4b49bc94f317197",
                        "port": 0
                    }
                ]
            },
            {
                "x": 1450,
                "y": 700,
                "wires": [
                    {
                        "id": "eebe47aca36fb577",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "meta": {},
        "color": "#DDAA99",
        "outputLabels": [
            "msgToBot",
            "State",
            "Clock"
        ]
    },
    {
        "id": "90d9a362f6d9804b",
        "type": "subflow",
        "name": "Cara005",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 40,
                "y": 180,
                "wires": [
                    {
                        "id": "f016bc1d142a0eb9"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1800,
                "y": 240,
                "wires": [
                    {
                        "id": "3b61f394285ac503",
                        "port": 0
                    }
                ]
            },
            {
                "x": 1810,
                "y": 360,
                "wires": [
                    {
                        "id": "c78a643484dd5c49",
                        "port": 0
                    }
                ]
            },
            {
                "x": 1810,
                "y": 400,
                "wires": [
                    {
                        "id": "a29f543e4a245926",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "meta": {},
        "color": "#DDAA99",
        "outputLabels": [
            "msgToBot",
            "state",
            "clock"
        ]
    },
    {
        "id": "7e2a7678166f609f",
        "type": "subflow",
        "name": "INTRO",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 80,
                "wires": [
                    {
                        "id": "f3dc491e67b9826c"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 1420,
                "y": 300,
                "wires": [
                    {
                        "id": "53fe3b5f5eab4862",
                        "port": 0
                    }
                ]
            },
            {
                "x": 1410,
                "y": 620,
                "wires": [
                    {
                        "id": "2aacb55b03d625ef",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "meta": {},
        "color": "#DDAA99",
        "outputLabels": [
            "msgToBot",
            "game_start"
        ]
    },
    {
        "id": "178fa897d7510777",
        "type": "subflow",
        "name": "Cara004",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 100,
                "wires": [
                    {
                        "id": "3d9cbd050ccf436b"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 2260,
                "y": 240,
                "wires": [
                    {
                        "id": "0a67632feb36fdf6",
                        "port": 0
                    }
                ]
            },
            {
                "x": 1770,
                "y": 480,
                "wires": [
                    {
                        "id": "0aedc8df5c1d0937",
                        "port": 0
                    }
                ]
            },
            {
                "x": 1770,
                "y": 520,
                "wires": [
                    {
                        "id": "bb1fc23bb83a7812",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "meta": {},
        "color": "#DDAA99",
        "outputLabels": [
            "msgToBot",
            "State",
            "Clock"
        ]
    },
    {
        "id": "0b10c282ffcb0e7b",
        "type": "group",
        "z": "79e1efd2b7cf0d02",
        "name": "Dev tools",
        "style": {
            "label": true,
            "fill": "#e3f3d3"
        },
        "nodes": [
            "90e7335f291ea8dd",
            "e6031d3ff7a2c7b4"
        ],
        "x": 948,
        "y": 353
    },
    {
        "id": "a6101559ef212be0",
        "type": "group",
        "z": "79e1efd2b7cf0d02",
        "name": "UI control",
        "style": {
            "label": true,
            "fill": "#e3f3d3"
        },
        "nodes": [
            "c74e5f6560244f59",
            "e37aeb7da330393e"
        ],
        "x": 948,
        "y": 33
    },
    {
        "id": "b4fed83d261cb969",
        "type": "group",
        "z": "79e1efd2b7cf0d02",
        "name": "Leds",
        "style": {
            "label": true,
            "fill": "#e3f3d3"
        },
        "nodes": [
            "a6047788ab02d9a9",
            "5b4db520284435b2",
            "3964eb999b71da93",
            "1a79e1f1d7d855e8",
            "be8c6fca32a6f82c",
            "b002d636c993db56",
            "5508fdeecdc940bb",
            "069a53d25b9aa378"
        ],
        "x": 54,
        "y": 19
    },
    {
        "id": "c988676a32d00f8b",
        "type": "group",
        "z": "79e1efd2b7cf0d02",
        "name": "Humedad",
        "style": {
            "label": true,
            "fill": "#e3f3d3"
        },
        "nodes": [
            "6cd380be060dd2e6",
            "1aec4f35e986a00b",
            "e6055b97ee0fecfe"
        ],
        "x": 54,
        "y": 499
    },
    {
        "id": "d4b6d2cdca33cc65",
        "type": "group",
        "z": "79e1efd2b7cf0d02",
        "name": "Presión",
        "style": {
            "label": true,
            "fill": "#e3f3d3"
        },
        "nodes": [
            "67d101b1b5a89ffb",
            "1d5b713945b2fdec",
            "5c18989c01bf38c8",
            "d6b149cd6e27b2a2"
        ],
        "x": 54,
        "y": 339
    },
    {
        "id": "352236264866bec3",
        "type": "group",
        "z": "79e1efd2b7cf0d02",
        "name": "Temperatura",
        "style": {
            "fill": "#e3f3d3",
            "fill-opacity": "0.77",
            "label": true
        },
        "nodes": [
            "d32919527242649d",
            "14f6a7e0e4dc4c60",
            "d786eed394f22b5a",
            "f976c7673e81d293",
            "b6ce87f818aaecac",
            "f968752fa6c28624",
            "d89e4bd5d49896c3",
            "8fbe2a5338dc462a",
            "554ee62bb7f8dead",
            "9c366eefdfe04fbf",
            "51acf678a736f6a1",
            "56c8d43912b75a02",
            "20120fed3f616cf7",
            "94e421e9f0b7b91b",
            "503e802577b4e178",
            "ebb4b5aeaea3b4bb",
            "747f15d270d31b62",
            "b1be2beb5dab6d27",
            "9f1b88539a1d3436"
        ],
        "x": 54,
        "y": 599
    },
    {
        "id": "c6c2603753194b13",
        "type": "group",
        "z": "240e9138468e39f6",
        "name": "JSON",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "3a99781e6031d629",
            "cba4a38d7900d885",
            "99d0ec64faab4b94",
            "99fb9b16b1629eea",
            "6457892a3e672cbe",
            "910905f51ec3c273",
            "d42036ba593c80c1",
            "1c6e5895e3998ee3"
        ],
        "x": 14,
        "y": 19
    },
    {
        "id": "d67c96eb46005d02",
        "type": "group",
        "z": "240e9138468e39f6",
        "name": "UI control",
        "style": {
            "label": true,
            "fill": "#e3f3d3"
        },
        "nodes": [
            "8c42595fd702f856",
            "6793a44395d337f2"
        ],
        "x": 1908,
        "y": 13
    },
    {
        "id": "41653db2dbc8eff5",
        "type": "group",
        "z": "240e9138468e39f6",
        "name": "LEDS",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "debd5c63615fff3e",
            "bed29fa72c8f9e99",
            "1eb41ef80e3d5aa2",
            "8f17387ff474ec87",
            "c9b93ff37480c0f9",
            "18c7c585c8eb32ef",
            "a040bbf0062ac342",
            "cd061775fa6b345c",
            "8fd217ed9224341c",
            "4dbd59f9d9b762d1",
            "f144670f5c1d4397",
            "22e6850228ea80f7",
            "42cfb30568599827",
            "507ee572dc146a37"
        ],
        "x": 1094,
        "y": 19
    },
    {
        "id": "ef3d086a30a1b87a",
        "type": "group",
        "z": "240e9138468e39f6",
        "name": "Presión",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "c2b551405535b0b2",
            "5983285fa86d9906",
            "93ce455ec89f564f",
            "708dcf7d93f0e426",
            "3914849762882418"
        ],
        "x": 1094,
        "y": 339
    },
    {
        "id": "e1419462044728a3",
        "type": "group",
        "z": "240e9138468e39f6",
        "name": "Humedad",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "fa83b2151127c727",
            "9864a25f16236d0f",
            "e8d076d673b0062f",
            "f27af90432a9d1ce"
        ],
        "x": 1094,
        "y": 499
    },
    {
        "id": "e539cc8d8670fa6a",
        "type": "group",
        "z": "240e9138468e39f6",
        "name": "Temperatura",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "1d40c067aa6b81e9",
            "08842309694c8bab",
            "945f9d8631965dc1",
            "5ac83df035afb6f3",
            "4e182b0fa83cb332",
            "a1508307e5a54ab7",
            "ed18196da15b9d12",
            "ef4f90370b870fcc",
            "6969c4c38cf1af0e",
            "7d4dceb80377abe4",
            "4768707a9098fb23",
            "da3c633c34fad8eb",
            "1ed2280940d5db75",
            "061af7fac1fe5554",
            "0befb2601c5453c7",
            "7235b33bb85139c3",
            "5b1970f2b93f41df",
            "f6cba8292f57fa68",
            "a319282dc20b1712",
            "137df09f21d87c2f"
        ],
        "x": 1094,
        "y": 599
    },
    {
        "id": "8344f882bc6f7e0a",
        "type": "group",
        "z": "240e9138468e39f6",
        "name": "Conexiones",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "767ec8fc4ab1f4c1",
            "a56dd440b8eb4d6b",
            "0d71042f96fd60e5",
            "d81eb3faf849abe0",
            "2a0a6c8ba2f2d020",
            "2a31ee24cca2ccc1",
            "8ede5d4f32a0687f",
            "f70e16858d537dd9",
            "8c1a1a4cb1f00504",
            "9128ab6fdf7afcdb",
            "26e6dec50cd22e0e",
            "86861dbaf0395be9",
            "19182511d5a9c13a",
            "0bd685e285d408cc",
            "3809a9e51818d6af",
            "bc9372d0930381e5",
            "b0d289625ed1b4bc",
            "c4a8b15e93c31f15",
            "0a9e4ee6f718cadc",
            "f847774e7a2cf413",
            "b50489b6bd82b0f7",
            "5032016908db4ee9",
            "a40836b65d6efe39",
            "b5c7f119232a415d",
            "93556662e19cbdb7",
            "b92239618d897343",
            "ba4e16a101fa8be0"
        ],
        "x": 14,
        "y": 399
    },
    {
        "id": "ec0e2ac7900fa3f9",
        "type": "group",
        "z": "240e9138468e39f6",
        "name": "Input",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "fe142cdba710abf1",
            "f758201befab6fdb",
            "4877d8019e62a313"
        ],
        "x": 14,
        "y": 279
    },
    {
        "id": "7f061c58298ef81e",
        "type": "group",
        "z": "79e1efd2b7cf0d02",
        "name": "Extra 1",
        "style": {
            "fill": "#ffffbf",
            "label": true
        },
        "nodes": [
            "5bb9bc8965e13cb7",
            "0956face0e6f3598",
            "bd7ff32f4a4240c0",
            "be8cec68cf632eef"
        ],
        "x": 54,
        "y": 1059
    },
    {
        "id": "2a56d2a7be9c7b76",
        "type": "group",
        "z": "79e1efd2b7cf0d02",
        "name": "Extra 2",
        "style": {
            "fill": "#ffffbf",
            "label": true
        },
        "nodes": [
            "c38d796ff32f7042",
            "0b158c5b6bfceb48",
            "42d0e8a2a2d23c0e",
            "64febcac4f03edfe",
            "268cd8dcd1bc1833"
        ],
        "x": 54,
        "y": 1159
    },
    {
        "id": "ea102138d043bafa",
        "type": "group",
        "z": "240e9138468e39f6",
        "name": "Extra 2",
        "style": {
            "fill": "#ffffbf",
            "label": true
        },
        "nodes": [
            "0095a0e0e54af22c",
            "815d1be594737e12",
            "040b51d90c4176d1",
            "3c29a4510d854a3c",
            "7133b14cba1fa09f"
        ],
        "x": 14,
        "y": 1019
    },
    {
        "id": "297629dbd540b327",
        "type": "group",
        "z": "240e9138468e39f6",
        "name": "Extra 1",
        "style": {
            "fill": "#ffffbf",
            "label": true
        },
        "nodes": [
            "5050aab76f29694f",
            "cc7b38fd3c9c7256",
            "5bab50b9af0e76e6",
            "08e84a4803e5357c",
            "558414ec8a70ece0"
        ],
        "x": 14,
        "y": 919
    },
    {
        "id": "452dfd544fc2fce6",
        "type": "group",
        "z": "7a2a228bff5f9b1b",
        "name": "Ejercicio 3 - Testing",
        "style": {
            "stroke": "#a4a4a4",
            "label": true,
            "color": "#000000",
            "fill": "#e3f3d3"
        },
        "nodes": [
            "fab9f543e0403ab1",
            "8326e82b99489bb5",
            "a34d3f97dab4e0b5",
            "c876d0cdc773ea9e",
            "5753c128a2592add",
            "6ba3d2865f3abca3",
            "9e35842b2b180fca",
            "78fe538a23f071e7",
            "b316f3404ef1283f",
            "fd3917170b43836c"
        ],
        "x": 54,
        "y": 39
    },
    {
        "id": "ab4328f3ce21153a",
        "type": "group",
        "z": "7a2a228bff5f9b1b",
        "name": "",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "34554487634f6a45",
            "db1bd864885aa917",
            "38bcaac5dd6d8ec9",
            "f7bbbf759c1035c6"
        ],
        "x": 1048,
        "y": 53
    },
    {
        "id": "270307f35f30c014",
        "type": "group",
        "z": "28aa48179e689485",
        "name": "Ejercicio 1",
        "style": {
            "stroke": "#a4a4a4",
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "7a9e114d8c8121d4",
            "d2b5378f006dcf82",
            "fb7010822d6bb986",
            "20f183d859f029d5",
            "69f48efb3ed2e9a2",
            "b8690d1e7db83076",
            "4ce5c24181a90fad",
            "1bacd1ab2f89ae19",
            "0367f9847eafdfc5",
            "500b07cc64c12311"
        ],
        "x": 34,
        "y": 39
    },
    {
        "id": "034ae3c7d299bca8",
        "type": "group",
        "z": "28aa48179e689485",
        "name": "LEDS",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "193b2ad82d31cde9",
            "2537281fa85022da",
            "5a4733eb5ef27176",
            "576b46f9bf7b3dc9",
            "03d7f8316e1a7dc6",
            "5712e76a228cfe7a",
            "0939b7cf254f9201",
            "756bf8bfeb8c8ad7",
            "aeb8f26f50a869d4",
            "c63a62bea32075c0",
            "8cc0b21df1f6d4ab",
            "24946e4f8282e5f7",
            "48cee4fc7ec5b74f",
            "182f17adb09b093c"
        ],
        "x": 1234,
        "y": 39
    },
    {
        "id": "269f5e74b8681382",
        "type": "group",
        "z": "28aa48179e689485",
        "name": "Humedad",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "558bd8ac2c467f45",
            "22f99c7c67673279",
            "c66117b1fdd806d5",
            "c5e0f9ac5116754d"
        ],
        "x": 1234,
        "y": 519
    },
    {
        "id": "7e2b19e2a3ad35a1",
        "type": "group",
        "z": "28aa48179e689485",
        "name": "Temperatura",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "5f5b2b757ccdda37",
            "ad01a0fa20fbc900",
            "88114b10592f2e86",
            "3f11effdfade3c0c",
            "51934c2c7309041d",
            "39bae5fbe759d48c"
        ],
        "x": 1244,
        "y": 619
    },
    {
        "id": "e308511d7b132ac8",
        "type": "group",
        "z": "28aa48179e689485",
        "name": "Conexiones",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "3d232f5c78646eeb",
            "c708a584301c36f4",
            "13aefb2b905034c9",
            "112be335581efa50",
            "6563cadf1c8c1760",
            "80fd1401dc086ae4",
            "a07ee75e7d5f20f0",
            "b0fb94e808835f10",
            "633cb12bf37eb606",
            "5cbd8e343cf35e46",
            "ccde711847fac60b",
            "8f9b1df76a93695a",
            "215156ba0deebab0",
            "5608320c39684fc9",
            "f0e451d92dfe2699",
            "83e64e0e3037e7b4",
            "591fd6a7f4ff20fe",
            "27c65d3061597a5b",
            "e6ab46d16363d6d6",
            "f8c3f925ec0fdb14",
            "b7ae2bc76235434b",
            "b363bc167b4d635d",
            "b4bb0517cd553e43",
            "4af9e17c13f8e617",
            "c146bf7d408652f7",
            "94865c6d6da736c9",
            "fe3a7ce2e30a7e42"
        ],
        "x": 1224,
        "y": 759
    },
    {
        "id": "531ca8b2fcf5e560",
        "type": "group",
        "z": "28aa48179e689485",
        "name": "Presión",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "d28a91f32dac6fe3",
            "5b9b37b255a61e4a",
            "0b56f1b4e827a08b",
            "e7e97ddcfa05ad37",
            "0fcdb51ee77c6f78"
        ],
        "x": 1234,
        "y": 359
    },
    {
        "id": "c867ac9e3fdd1cbf",
        "type": "group",
        "z": "28aa48179e689485",
        "name": "Ejercicio 4",
        "style": {
            "stroke": "#a4a4a4",
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "9b25c5b420c7f72b",
            "e4718518fcf97c09",
            "fc0178895a1aee94",
            "1d35200c560c9797",
            "4ee2c7c576ce35a4",
            "f7a3c063082b6b48",
            "e64b3085.9a525"
        ],
        "x": 34,
        "y": 599
    },
    {
        "id": "3794648bb169b272",
        "type": "group",
        "z": "28aa48179e689485",
        "name": "Ejercicio 5",
        "style": {
            "stroke": "#a4a4a4",
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "6f2385b31ff14630",
            "37e97867580b33fe",
            "c8914d0a9113990b",
            "e91db7f6e967d630",
            "63fa2691c2ed03b2",
            "1618cce562a50646"
        ],
        "x": 34,
        "y": 779
    },
    {
        "id": "61af492eb62b5b4d",
        "type": "group",
        "z": "28aa48179e689485",
        "name": "Ejercicio 3",
        "style": {
            "stroke": "#a4a4a4",
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "17422dfaf138a6cf",
            "829d2c2fd7369339",
            "4f6a219dd5ca56ba",
            "02cdbb45bab265bf",
            "19370125730d77e6",
            "53f223c7e2ad0ea1",
            "03c3979010c41f33",
            "e0b1c6c5c2a41a05",
            "7da74ad0c2ce8991",
            "161d832346e40b1d"
        ],
        "x": 34,
        "y": 399
    },
    {
        "id": "94dc048a9c84b452",
        "type": "group",
        "z": "28aa48179e689485",
        "name": "Ejercicio 2",
        "style": {
            "stroke": "#a4a4a4",
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "99846e687134cd5a",
            "52847e1fef43b5bd",
            "ab56ca8423144561",
            "e07bdbea1aa218e5",
            "9d954e9055d207a2"
        ],
        "x": 34,
        "y": 299
    },
    {
        "id": "f4f56cd0159288c3",
        "type": "group",
        "z": "28aa48179e689485",
        "name": "Ejercicio en clase",
        "style": {
            "stroke": "#000000",
            "fill": "#bfdbef",
            "label": true
        },
        "nodes": [
            "172ddd8b54e52f43",
            "d02f577c31b6e6b5",
            "528f18345fc130c7",
            "f7da87dfd1caafa7",
            "fd7da9f49098fa93",
            "0197b0cdd2bf835e",
            "51044b70f943ab88",
            "b227d0a39833605f",
            "1ed97e83a3aa7230",
            "f74ae1123d309d8a",
            "c4c5fe67cd7f756f"
        ],
        "x": 34,
        "y": 1119
    },
    {
        "id": "a30b6d8ea68c3596",
        "type": "group",
        "z": "28aa48179e689485",
        "name": "Ejercicio en clase",
        "style": {
            "stroke": "#000000",
            "label": true,
            "fill": "#bfdbef"
        },
        "nodes": [
            "9300db5867473dfb",
            "49012e8e0c0c4162",
            "8a9296b558c17ba2",
            "114f6ff116a2d363"
        ],
        "x": 30.99993896484375,
        "y": 939
    },
    {
        "id": "2f2d6fcd70cbfe4a",
        "type": "group",
        "z": "13df9ad25c9618e4",
        "name": "Estado y LWT",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "dfaadf3ab199e00c",
            "1eaec8b318944fc3",
            "56640648f318fb19",
            "631359044b52c8b1",
            "b5d1dddf4e575f4e",
            "d5b5d13671439e9a",
            "06e1a8509d49c5a1",
            "89c9e5866eeb4402",
            "02738aad3e6d70d4"
        ],
        "x": 14,
        "y": 19,
        "info": "# Estado y LWT\n\n- Topic: infind/GRUPOX/conexion\n- Acción: Publicar\n- Descripción: Estado de conexión del dispositivo (mensaje retenido). Usar últimas voluntades (LWT) para enviar la notificación desconexión\n- Ejemplos: {\"online\":true}  {\"online\":false}"
    },
    {
        "id": "31d7abf2d95de80e",
        "type": "group",
        "z": "13df9ad25c9618e4",
        "name": "Sensores",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "a30adc92797161ad",
            "e4e313be7cf72272",
            "204e8951dbb09c53",
            "fd4c253fa4036aa9",
            "7873a2401884d320",
            "ecccce0a5594afdb",
            "39d6fac3b45b36ea",
            "2a35eff3801fbdb8",
            "cdeea9f974f54573",
            "495dd803d5128cd4",
            "bee0e551b2c2a3bf",
            "30fc991dc7523ddb",
            "34d884309e9afa81"
        ],
        "x": 14,
        "y": 239,
        "info": "# Sensores\n\n- Topic: infind/GRUPOX/datos\n- Acción: Publicar\n- Descripción: Actualización periódica (30s) de información de sensores y más\n- Ejemplo:\n\n\n{\n\n\"Uptime\":12300,\n\n\"Vcc\":2.97,\n\n\"DHT11\":{\"temp\":26.0,\"hum\":37.0},\n\n\"LED\":100,\n\n\"Wifi\":{\"SSId\":\"infind\",\"IP\":\"192.168.0.100\",\"RSSI\":56}\n\n}\n"
    },
    {
        "id": "5cba6c5db0d46559",
        "type": "group",
        "z": "13df9ad25c9618e4",
        "name": "Estado Led",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "9beb600c63b60280",
            "93107118806b4b86",
            "29d5550a23b4d981",
            "5ae2c99e08b2c418",
            "6f2c3dd3b98b38db"
        ],
        "x": 14,
        "y": 859,
        "info": "# Sensores\n\n- Topic: infind/GRUPOX/datos\n- Acción: Publicar\n- Descripción: Actualización periódica (30s) de información de sensores y más\n- Ejemplo:\n\n\n{\n\n\"Uptime\":12300,\n\n\"Vcc\":2.97,\n\n\"DHT11\":{\"temp\":26.0,\"hum\":37.0},\n\n\"LED\":100,\n\n\"Wifi\":{\"SSId\":\"infind\",\"IP\":\"192.168.0.100\",\"RSSI\":56}\n\n}\n"
    },
    {
        "id": "c59e69ccdd22540f",
        "type": "group",
        "z": "13df9ad25c9618e4",
        "name": "Cambio LED",
        "style": {
            "fill": "#ffbfbf",
            "label": true
        },
        "nodes": [
            "0fc0b1c73d0162a9",
            "02e9f915f64990b0",
            "e741bb926c073ddc",
            "1031733d058764be",
            "612853001cbb9f90"
        ],
        "x": 14,
        "y": 619,
        "info": "# Intensidad\n\n- Topic: infind/GRUPOX/led/cmd\n- Acción: Suscribir\n- Descripción: El dispositivo recibe la configuración de intensidad del LED [0-100]\n- Ejemplo: { \"level\":75 }"
    },
    {
        "id": "0cdda659d54342bd",
        "type": "group",
        "z": "45a4e39f.03efac",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "696c19e5.d26f78",
            "6baf2f65.ab099",
            "2cf239ee.fe0836",
            "338058ea.875b28",
            "e84f5da3.829a3",
            "80d43bb8.0e3d88",
            "85028a8d.668138",
            "fb2ad7fd.fd9d38",
            "c91834d1.9bf4b8",
            "a8feb814.7498e8",
            "ba35e1b7.ec857",
            "50818085.451f5"
        ],
        "x": 54,
        "y": 19
    },
    {
        "id": "0888e7373481d35e",
        "type": "group",
        "z": "122f65d809b34d8e",
        "name": "Clean the collection",
        "style": {
            "label": true
        },
        "nodes": [
            "574e891f993fcb91",
            "c8ba76d152d7366a"
        ],
        "x": 794,
        "y": 659,
        "w": 592,
        "h": 82
    },
    {
        "id": "0f1cf58e08b73cc2",
        "type": "group",
        "z": "122f65d809b34d8e",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "21f9347e8aef3828",
            "e8c6e9ffed7b9a38",
            "a2b9b895f1a88888",
            "8d9f6656f8f37055",
            "20ec2a5a24d52017",
            "5baf45c3e6032233"
        ],
        "x": 1324,
        "y": 179,
        "w": 342,
        "h": 242
    },
    {
        "id": "9c2f3a58f83b946f",
        "type": "group",
        "z": "03c76acfc9a07adb",
        "name": "Comprobar",
        "style": {
            "label": true
        },
        "nodes": [
            "d9ce5f1f9c1579e9",
            "47d6ae483f6a2bd1"
        ],
        "x": 14,
        "y": 399
    },
    {
        "id": "4cd2d92b6f1e42de",
        "type": "group",
        "z": "b056b4cf9a298e0d",
        "name": "Común",
        "style": {
            "stroke": "#3f93cf",
            "fill": "#e3f3d3",
            "fill-opacity": "0.57",
            "label": true
        },
        "nodes": [
            "20a682fad8758c49",
            "d8313757e30311dd",
            "cfe27898c4972426",
            "7b3e58db5fa243a0",
            "da39ff3f3bd01714",
            "56de6b18ecd69a81",
            "5b392c70bdeeab37",
            "18eebd5c17ad471e",
            "0d44cb0ff1d349ea",
            "ef258efaabcdd988",
            "a30bf994eae7cd3e",
            "1990a18743a761a9",
            "5d4807349eb7d70c",
            "5985ed6bdc4ed23d",
            "8e79c92367f424a4",
            "adf692ef0a9e9fb2",
            "7651d8dfb22cc43e"
        ],
        "x": 1024,
        "y": 39,
        "w": 942,
        "h": 602
    },
    {
        "id": "407e3e089de46a03",
        "type": "group",
        "z": "b056b4cf9a298e0d",
        "name": "Cara002",
        "style": {
            "stroke": "#6f2fa0",
            "fill": "#dbcbe7",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "22a622e6e3a77723",
            "c8318c5c0b6342cd",
            "ad9e883957d3685b",
            "b8246bec0ff6bd43",
            "1f58fb8b96bce92e",
            "7dc2883e2ed41873"
        ],
        "x": 14,
        "y": 439,
        "w": 782,
        "h": 162
    },
    {
        "id": "74c5e0e865fd749f",
        "type": "group",
        "z": "b056b4cf9a298e0d",
        "name": "La Caja",
        "style": {
            "label": true
        },
        "nodes": [
            "f3dc491e67b9826c",
            "d064a8a08363d9a0",
            "a483d173586b9e5e",
            "a5686142f35c81ec",
            "eafe96754ad3092d",
            "fedcb4bb1ace3832",
            "b4e7a71c03156b8f",
            "08f030f5381a1c7d",
            "8cf6b99ba10ac475",
            "078431c881436679",
            "22daf5dc41a5c8e3",
            "32e1c65c1907a6cf",
            "f3f6865a4acc64a8"
        ],
        "x": 14,
        "y": 39,
        "w": 632,
        "h": 342
    },
    {
        "id": "f0bc3c69188895b3",
        "type": "group",
        "z": "b056b4cf9a298e0d",
        "name": "Cara003",
        "style": {
            "stroke": "#6f2fa0",
            "fill": "#dbcbe7",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "7e40046c60ee2860",
            "fdb7e2982875f8ba",
            "323b84f05b7a90a2",
            "e851ebc98b56550e",
            "0b1f4c3a444e4988",
            "90effe8f20f81252",
            "e789e8e1711a246d"
        ],
        "x": 14,
        "y": 619,
        "w": 782,
        "h": 162
    },
    {
        "id": "ef9e0b05387b0f7f",
        "type": "group",
        "z": "b056b4cf9a298e0d",
        "name": "Cara005",
        "style": {
            "stroke": "#6f2fa0",
            "fill": "#dbcbe7",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "ca6fc1c375a4484a",
            "81702d1a90090e50",
            "5dbd7316c3660276",
            "6fdb94005210418f",
            "d5f490ad8e2a8675",
            "376f1e1e0b41f292",
            "592ea0f1449e87e8"
        ],
        "x": 14,
        "y": 799,
        "w": 782,
        "h": 162
    },
    {
        "id": "e6031d3ff7a2c7b4",
        "type": "group",
        "z": "79e1efd2b7cf0d02",
        "g": "0b10c282ffcb0e7b",
        "name": "Control led red",
        "style": {
            "label": true
        },
        "nodes": [
            "7eb497ab812a25be",
            "0318856b60cbd6e1",
            "2e8f03dc1c942c24"
        ],
        "x": 974,
        "y": 379
    },
    {
        "id": "90e7335f291ea8dd",
        "type": "group",
        "z": "79e1efd2b7cf0d02",
        "g": "0b10c282ffcb0e7b",
        "name": "Control led green",
        "style": {
            "label": true
        },
        "nodes": [
            "c3149fa7f57a0629",
            "9bb4c76ed0081af5",
            "6e26c3bd36cae061"
        ],
        "x": 974,
        "y": 539
    },
    {
        "id": "c74e5f6560244f59",
        "type": "group",
        "z": "79e1efd2b7cf0d02",
        "g": "a6101559ef212be0",
        "style": {
            "stroke": "#a8a095",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#afa89d"
        },
        "nodes": [
            "6ecf19a0e1375f1e"
        ],
        "x": 1174,
        "y": 59
    },
    {
        "id": "e37aeb7da330393e",
        "type": "group",
        "z": "79e1efd2b7cf0d02",
        "g": "a6101559ef212be0",
        "style": {
            "stroke": "#a8a095",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#afa89d"
        },
        "nodes": [
            "e7a52f948e70f729",
            "f0e063bdf3c27c89",
            "4fe663ed27d540de"
        ],
        "x": 974,
        "y": 179
    },
    {
        "id": "8c42595fd702f856",
        "type": "group",
        "z": "240e9138468e39f6",
        "g": "d67c96eb46005d02",
        "style": {
            "stroke": "#a8a095",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#afa89d"
        },
        "nodes": [
            "9ded6ebbbd3adb27",
            "66cfe09992108ec7",
            "e4b1a3e75cbffc3c"
        ],
        "x": 1934,
        "y": 39
    },
    {
        "id": "6793a44395d337f2",
        "type": "group",
        "z": "240e9138468e39f6",
        "g": "d67c96eb46005d02",
        "style": {
            "stroke": "#a8a095",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#afa89d"
        },
        "nodes": [
            "27309bfed6048359",
            "95da5e1fe2cdf27a",
            "d84be5d03107784f"
        ],
        "x": 1934,
        "y": 179
    },
    {
        "id": "34554487634f6a45",
        "type": "group",
        "z": "7a2a228bff5f9b1b",
        "g": "ab4328f3ce21153a",
        "name": "Ejercicio 4 ",
        "style": {
            "stroke": "#a4a4a4",
            "label": true,
            "color": "#000000",
            "fill": "#e3f3d3"
        },
        "nodes": [
            "aa30d7aefdb74982",
            "fee945a41a9eecb2",
            "16521c764bb85856"
        ],
        "x": 1074,
        "y": 79
    },
    {
        "id": "db1bd864885aa917",
        "type": "group",
        "z": "7a2a228bff5f9b1b",
        "g": "ab4328f3ce21153a",
        "name": "",
        "style": {
            "stroke": "#a4a4a4",
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "5d05ec264c0d4f29",
            "0ad1a470a6d2e0e6",
            "ea496d37ceabf649",
            "d1b6cec415033237"
        ],
        "x": 1074,
        "y": 219
    },
    {
        "id": "38bcaac5dd6d8ec9",
        "type": "group",
        "z": "7a2a228bff5f9b1b",
        "g": "ab4328f3ce21153a",
        "name": "",
        "style": {
            "stroke": "#a4a4a4",
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "dce7eac07dc32b17",
            "a42e30e862124474",
            "ab6c8a8815fd51b8",
            "d0368dc15927f780",
            "b238e7e06b0e188b",
            "742362ab6ac163d5",
            "54c11767c002873f",
            "191304c6c3d76777",
            "efae4a070823fb92",
            "ba4a596c15e39c03",
            "91eefba7a4f0d452",
            "851d52f94e9f7558"
        ],
        "x": 1074,
        "y": 419
    },
    {
        "id": "f7bbbf759c1035c6",
        "type": "group",
        "z": "7a2a228bff5f9b1b",
        "g": "ab4328f3ce21153a",
        "name": "",
        "style": {
            "stroke": "#a4a4a4",
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "798d321a5f3e32b9",
            "cb6a1b1593dc14b4",
            "ad58e3efea64f3b2",
            "081e229272675cc3"
        ],
        "x": 1074,
        "y": 319
    },
    {
        "id": "fa1b4c310d42be5b",
        "type": "group",
        "z": "0e6efdbc0f657beb",
        "name": "Dev tools",
        "style": {
            "label": true,
            "fill": "#e3f3d3"
        },
        "nodes": [
            "677e44441bd53f9b",
            "dc3604968aa40363"
        ],
        "x": 948,
        "y": 353
    },
    {
        "id": "9a2ec2d6f29abdf8",
        "type": "group",
        "z": "0e6efdbc0f657beb",
        "name": "UI control",
        "style": {
            "label": true,
            "fill": "#e3f3d3"
        },
        "nodes": [
            "1c282d6c2598c6e5",
            "15fc3268ac0fe9a3"
        ],
        "x": 948,
        "y": 33
    },
    {
        "id": "ab8c3f4c897cc372",
        "type": "group",
        "z": "0e6efdbc0f657beb",
        "name": "Leds",
        "style": {
            "label": true,
            "fill": "#e3f3d3"
        },
        "nodes": [
            "20f3ca81ba60bc3c",
            "6705535eb46a3532",
            "d7dfae2c4d71b915",
            "0fd81b8b3685de7e",
            "46b609c7d63313ca",
            "79a6d5f051253208",
            "03099a7a3c6bb3cd",
            "d460ae5fa28aa23e"
        ],
        "x": 54,
        "y": 19
    },
    {
        "id": "14d796290fd84b33",
        "type": "group",
        "z": "0e6efdbc0f657beb",
        "name": "Humedad",
        "style": {
            "label": true,
            "fill": "#e3f3d3"
        },
        "nodes": [
            "9b98909d93690fd6",
            "37bc48b9b1c67b23",
            "087515cd867744a8"
        ],
        "x": 54,
        "y": 499
    },
    {
        "id": "5bb4c6d4afb4abcd",
        "type": "group",
        "z": "0e6efdbc0f657beb",
        "name": "Presión",
        "style": {
            "label": true,
            "fill": "#e3f3d3"
        },
        "nodes": [
            "1d77737950ce731b",
            "dbdcf136fa815719",
            "685f4482369c0041",
            "3a6a6e542f5e87ab"
        ],
        "x": 54,
        "y": 339
    },
    {
        "id": "24141e590783e1a1",
        "type": "group",
        "z": "0e6efdbc0f657beb",
        "name": "Temperatura",
        "style": {
            "fill": "#e3f3d3",
            "fill-opacity": "0.77",
            "label": true
        },
        "nodes": [
            "40c35a047f906adf",
            "fc2e8b0be097732b",
            "e6f58469b48a6b11",
            "b54103c554e4ba82",
            "8cb8331ca1a9e3c4",
            "4b2175a517582ac0",
            "1f5639249330428c",
            "4e94c5701316cc0b",
            "11de0c479e604499",
            "502d712e31183eee",
            "3be2b77b1a6a3263",
            "55d5fb152d4c3a9d",
            "6e5cdaa62deb69af",
            "630441c3e8fee512",
            "18af0bb67619846a",
            "34794e61787205bb",
            "cdd3989e53dba123",
            "9c91fbe878ae4064",
            "7dfdd9cbce128ca4"
        ],
        "x": 54,
        "y": 599
    },
    {
        "id": "c7c0429a558afdbb",
        "type": "group",
        "z": "7a16d1d00dfc8197",
        "name": "JSON",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "59748828a812a89b",
            "802965d63aa780f9",
            "d3c0f3815c2be508",
            "dfc1fbfc52694eb9",
            "95333310b95e92fa",
            "81f681fdf7787ad4",
            "2a8f15b29bcad07a",
            "d0a952bb3fdf3e13"
        ],
        "x": 14,
        "y": 19
    },
    {
        "id": "1c8cb162f374a7c6",
        "type": "group",
        "z": "7a16d1d00dfc8197",
        "name": "UI control",
        "style": {
            "label": true,
            "fill": "#e3f3d3"
        },
        "nodes": [
            "3d2c5d33e37d6dbc",
            "468e6c6d4d6b1f4f"
        ],
        "x": 1908,
        "y": 13
    },
    {
        "id": "b8c01bdb213bdf2a",
        "type": "group",
        "z": "7a16d1d00dfc8197",
        "name": "LEDS",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "4cb8f01d2df3d74f",
            "a75ae4d1e0601868",
            "da6150a919471ea8",
            "e2055f0387091010",
            "68c887ccacdcc65f",
            "5cdcf77d76247d41",
            "4f7466319b72ba9f",
            "90081377270e04ad",
            "98d40d99ba4151d8",
            "9af423a7bb2d837b",
            "27817793bcf88e31",
            "f25ae044dbb399de",
            "3918e1aced349285",
            "101e32c11977c276"
        ],
        "x": 1094,
        "y": 19
    },
    {
        "id": "3257a317712f0b5d",
        "type": "group",
        "z": "7a16d1d00dfc8197",
        "name": "Presión",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "ac467beb4fa9e5cd",
            "0bf89d5da91f6860",
            "0c22465deb2518f3",
            "c74bc10f4d3ffd14",
            "1d774783e282a20a"
        ],
        "x": 1094,
        "y": 339
    },
    {
        "id": "bd1d576d98dfa972",
        "type": "group",
        "z": "7a16d1d00dfc8197",
        "name": "Humedad",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "df8576ebbb006b55",
            "0dade4400d16e36b",
            "8a82934c652213bc",
            "64a56b2722da04c3"
        ],
        "x": 1094,
        "y": 499
    },
    {
        "id": "dbca49f1bd3c48a5",
        "type": "group",
        "z": "7a16d1d00dfc8197",
        "name": "Temperatura",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "e0764da71cdb6c9d",
            "586df285533f6f31",
            "df88c371cc0be2e4",
            "4d5bb2109cea33e8",
            "adc396252b607fcf",
            "81bd016eeeb4be54",
            "1938fe3092c18ea1",
            "42fac8ce51fd0a3a",
            "5704ab749fabf2e9",
            "d882a0a8d0875314",
            "f6032ef4a6cd9a63",
            "c66a0a61f42d9796",
            "79ece79b8d5b4b0c",
            "7cb53c8f3869c255",
            "4b1991113899510a",
            "b7ae8fed5888903a",
            "a067e5a35fbb5be2",
            "928dcbeb51fc5086",
            "cb380d0e41af31f9",
            "974389dfd6e7f220"
        ],
        "x": 1094,
        "y": 599
    },
    {
        "id": "56f47bfd6c62f39d",
        "type": "group",
        "z": "7a16d1d00dfc8197",
        "name": "Conexiones",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "75e116c16eee6f2f",
            "e4c0e07228390da8",
            "ebe2bb9ad1bb9cdb",
            "f030180e4bfe3703",
            "5caacceb8ded1f96",
            "9c1fcf13d5ed9ff8",
            "5775f9d37e91db3b",
            "25eb006b1666ca7f",
            "7ae171d59544969a",
            "39e932748ff43175",
            "d54d2b8c330c2a35",
            "7675caa924841d24",
            "db2eadd8ec509eb4",
            "97281a27e3228f6d",
            "e6d1ad2858e87d28",
            "4cee9caf880dbf75",
            "cecdf7cfdcccd41b",
            "289daa805cbc742e",
            "9eddd2aa8bce368b",
            "4941fbcb1f9c03cf",
            "a2429eed43b732b0",
            "b40246d5cdcbf5ab",
            "9466fa22036a1157",
            "7498e7d5edf5c8b1",
            "cb2954d6c2be0874",
            "8805564321fdfd81",
            "b0309b7f2c71a620"
        ],
        "x": 14,
        "y": 399
    },
    {
        "id": "041b608dd6eb6675",
        "type": "group",
        "z": "7a16d1d00dfc8197",
        "name": "Input",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "f65447cd6de160aa",
            "799272e0826da5f6",
            "79275135c0703271"
        ],
        "x": 14,
        "y": 279
    },
    {
        "id": "f6c614057030cceb",
        "type": "group",
        "z": "0e6efdbc0f657beb",
        "name": "Extra 1",
        "style": {
            "fill": "#ffffbf",
            "label": true
        },
        "nodes": [
            "d3a0b0daa96aa520",
            "461a74fd74ac18f8",
            "2461bf672adf44a2",
            "251c49f1fdd9a9c7"
        ],
        "x": 54,
        "y": 1059
    },
    {
        "id": "3a996c253c33e17a",
        "type": "group",
        "z": "0e6efdbc0f657beb",
        "name": "Extra 2",
        "style": {
            "fill": "#ffffbf",
            "label": true
        },
        "nodes": [
            "6235fc2712622b67",
            "665a8bf053e26e54",
            "ebecfe8159b47b27",
            "03548c5ced1efcc1",
            "b8a3c7a5e5bd1c9b"
        ],
        "x": 54,
        "y": 1159
    },
    {
        "id": "f852a0b06ec1fb53",
        "type": "group",
        "z": "7a16d1d00dfc8197",
        "name": "Extra 2",
        "style": {
            "fill": "#ffffbf",
            "label": true
        },
        "nodes": [
            "a49bbd13db558966",
            "88ec140e74fb1777",
            "954c0d76d404f264",
            "9fbdab756e4eec55",
            "19ecfa97bba1fbeb"
        ],
        "x": 14,
        "y": 1019
    },
    {
        "id": "f442450b16d4f47c",
        "type": "group",
        "z": "7a16d1d00dfc8197",
        "name": "Extra 1",
        "style": {
            "fill": "#ffffbf",
            "label": true
        },
        "nodes": [
            "0a4f9588acac850f",
            "6d4e0b39baf6f600",
            "52335c1dfa0dc709",
            "4ebf5669ba48e5b0",
            "5d14b82297f7ba81"
        ],
        "x": 14,
        "y": 919
    },
    {
        "id": "3802ea70904128df",
        "type": "group",
        "z": "f607af27c5f161a8",
        "name": "Ejercicio 3 - Testing",
        "style": {
            "stroke": "#a4a4a4",
            "label": true,
            "color": "#000000",
            "fill": "#e3f3d3"
        },
        "nodes": [
            "52394374208c00e9",
            "656c134d0f9f327f",
            "4be3a05697cd5570",
            "0fd587eb0eafb375",
            "b716332f62494002",
            "be4f60e6d63e9492",
            "dcaf5c2a91acb687",
            "dc1bc819707c9cf3",
            "16532ba976a11c74",
            "abbcfa50c29b1d0e"
        ],
        "x": 54,
        "y": 39
    },
    {
        "id": "0d4867dd076d65a0",
        "type": "group",
        "z": "f607af27c5f161a8",
        "name": "",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "a048d8410ae79405",
            "09a81a457253b8d4",
            "f70edc445b47629c",
            "77511cc01629b614"
        ],
        "x": 1048,
        "y": 53
    },
    {
        "id": "649ef4596360f731",
        "type": "group",
        "z": "75eea1382d17332e",
        "name": "Ejercicio 1",
        "style": {
            "stroke": "#a4a4a4",
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "7f779793dea8a999",
            "a59bb6fcd156702e",
            "badb7991e0aad159",
            "7a4d07f793ab64bb",
            "591c77a9793c708d",
            "6977ecf391846a70",
            "2069b7e6f1cd6d4a",
            "08902129e849bece",
            "f63c76414327d523",
            "296f70f22f6ab008"
        ],
        "x": 34,
        "y": 39
    },
    {
        "id": "0e2ac29ec655628c",
        "type": "group",
        "z": "75eea1382d17332e",
        "name": "LEDS",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "35488a2546801986",
            "c789f80eaee226f6",
            "28e6ed79667c4c8f",
            "91210b14b56a06a8",
            "c8821c52cb6aa60d",
            "0c1290d36881709a",
            "da7b924c6c0c0103",
            "0fc37db329e8b96f",
            "36c01bb5bb9b678e",
            "eda6447af7c8bffe",
            "d5ec909fc2a947e1",
            "d4c8025a303bf89d",
            "5a28e07148ec276d",
            "b1d676d63b987cfa"
        ],
        "x": 1234,
        "y": 39
    },
    {
        "id": "b0912d74dc61c016",
        "type": "group",
        "z": "75eea1382d17332e",
        "name": "Humedad",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "cd903d736c615d53",
            "71406a0bea54bf24",
            "efcacea8ecaf383f",
            "9ebb6be22a8b749e"
        ],
        "x": 1234,
        "y": 519
    },
    {
        "id": "11e204a348f1b70b",
        "type": "group",
        "z": "75eea1382d17332e",
        "name": "Temperatura",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "f89d21a2a60f29a1",
            "c842633427d582d2",
            "f8b068809ebdb8b6",
            "72dc3c90ef2b4e37",
            "ab5b598a7284062b",
            "47b5bd66bc2ddc3f"
        ],
        "x": 1244,
        "y": 619
    },
    {
        "id": "0db9cf2dc5229a25",
        "type": "group",
        "z": "75eea1382d17332e",
        "name": "Conexiones",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "ae0a7684d57a1068",
            "56f6517c336fdc8a",
            "8155232e168b87d5",
            "42e4cbc6aa1ca7c8",
            "4541c44ae5248be3",
            "a104d7e8a817aee0",
            "270d6d4a8f0fa0e7",
            "32ea389529d5ffcb",
            "a14de9fcda319b0d",
            "94b3e846c8f45a0b",
            "360b50a2f9d7985c",
            "d47785b8c4041f8b",
            "7483a81f26b192b8",
            "78e3cdb157e1129f",
            "977cb46e7b213e58",
            "e05bacd595fd7b9b",
            "71373ff3bff73c36",
            "623a369218616077",
            "9cd0af2162c11169",
            "2d9aa2659ce8abc2",
            "f58e23e1fe46bea9",
            "318364f7ce2c10db",
            "0d328427efb18475",
            "62ccfc102a121707",
            "57ef0f8e9c967f80",
            "1845dc66ab84b372",
            "ba5d751411b241a0"
        ],
        "x": 1224,
        "y": 759
    },
    {
        "id": "ecfef77c05bf3b51",
        "type": "group",
        "z": "75eea1382d17332e",
        "name": "Presión",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "afe8663976092c61",
            "c1bf3fb784624a5e",
            "d808403632946b1e",
            "256909c3dc5dc377",
            "6650bb9b207e419d"
        ],
        "x": 1234,
        "y": 359
    },
    {
        "id": "2cb4b78c22252d47",
        "type": "group",
        "z": "75eea1382d17332e",
        "name": "Ejercicio 4",
        "style": {
            "stroke": "#a4a4a4",
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "a808d4145868dfcb",
            "a7d4d5b8cd46d80f",
            "9d01d3f2713c5ee4",
            "f7791d5d91ac1f32",
            "a90bb90d02d2f1e7",
            "b725253c3965a384",
            "6e717116f9d3c7cd"
        ],
        "x": 34,
        "y": 599
    },
    {
        "id": "4f5cec43fc4200ad",
        "type": "group",
        "z": "75eea1382d17332e",
        "name": "Ejercicio 5",
        "style": {
            "stroke": "#a4a4a4",
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "b56732462606b9af",
            "6be94e771d69de4a",
            "fdd6d82ca6c347e1",
            "9a39cdd28bddc058",
            "653b079df9522d00",
            "6f4d50e205eb162b"
        ],
        "x": 34,
        "y": 779
    },
    {
        "id": "afde8b33977a814c",
        "type": "group",
        "z": "75eea1382d17332e",
        "name": "Ejercicio 3",
        "style": {
            "stroke": "#a4a4a4",
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "b87f92065b60fba0",
            "649cdc3e1838217a",
            "74e1a0933c20455b",
            "cc84ac7703124f01",
            "7dcaf3d3f771ef36",
            "d5de2f5917a146a0",
            "86d07dfd046950cc",
            "7f3ed60624f4d963",
            "4f83812c8667c336",
            "edd20832146cd32f"
        ],
        "x": 34,
        "y": 399
    },
    {
        "id": "309aebc5883aca03",
        "type": "group",
        "z": "75eea1382d17332e",
        "name": "Ejercicio 2",
        "style": {
            "stroke": "#a4a4a4",
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "f42515b31c65e764",
            "b3feb7a105d0ccab",
            "282380279cde19b8",
            "e6c2f71338d5c14c",
            "7ac6fd944f48629d"
        ],
        "x": 34,
        "y": 299
    },
    {
        "id": "647824b5fc68c9b4",
        "type": "group",
        "z": "75eea1382d17332e",
        "name": "Ejercicio en clase",
        "style": {
            "stroke": "#000000",
            "fill": "#bfdbef",
            "label": true
        },
        "nodes": [
            "dcf1e87d2ec6acb9",
            "72f818b5b9b50f36",
            "0b978e33f3b44517",
            "27362b5fe3d6b6a5",
            "a2529eef44698b6f",
            "57a686d4d340dcce",
            "1c82d5fe266a00a9",
            "724254f70da10925",
            "5df3852ac3ab31cc",
            "0aafc89b687c69aa",
            "378b2a78242c7b03"
        ],
        "x": 34,
        "y": 1119
    },
    {
        "id": "74039604ee5e8650",
        "type": "group",
        "z": "75eea1382d17332e",
        "name": "Ejercicio en clase",
        "style": {
            "stroke": "#000000",
            "label": true,
            "fill": "#bfdbef"
        },
        "nodes": [
            "d059edbed9ddbeb5",
            "25d009209369ec68",
            "e633e2181efcddf6",
            "ab7651e781273dc2"
        ],
        "x": 30.99993896484375,
        "y": 939
    },
    {
        "id": "29cb6290e5ff6565",
        "type": "group",
        "z": "4b80774a81fc72e3",
        "name": "Estado y LWT",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "7389ae81dc8f9346",
            "d32126701a054460",
            "d88cbb9404e397dd",
            "2960423e04904fe7",
            "e925b3185130b633",
            "a807903924b703c6",
            "eb23964865b88d26",
            "c0ed8dcd2056a1c4",
            "a71fc5e3fa9a82bb"
        ],
        "x": 14,
        "y": 19,
        "info": "# Estado y LWT\n\n- Topic: infind/GRUPOX/conexion\n- Acción: Publicar\n- Descripción: Estado de conexión del dispositivo (mensaje retenido). Usar últimas voluntades (LWT) para enviar la notificación desconexión\n- Ejemplos: {\"online\":true}  {\"online\":false}"
    },
    {
        "id": "f2a63becb357bbaa",
        "type": "group",
        "z": "4b80774a81fc72e3",
        "name": "Sensores",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "0be60a69fcb5b045",
            "a183000632389a04",
            "be3461b1d304e8d1",
            "d138837287c476f0",
            "c9b852c4e8a57466",
            "9e50e9b5ae8aa381",
            "1755599114fe5073",
            "59a85b8799576545",
            "c255e9170d248ceb",
            "e8a7079d81e1f4fe",
            "3419bcdf2481535d",
            "269d176f4ded5565",
            "11e3b1353c3dbc5e"
        ],
        "x": 14,
        "y": 239,
        "info": "# Sensores\n\n- Topic: infind/GRUPOX/datos\n- Acción: Publicar\n- Descripción: Actualización periódica (30s) de información de sensores y más\n- Ejemplo:\n\n\n{\n\n\"Uptime\":12300,\n\n\"Vcc\":2.97,\n\n\"DHT11\":{\"temp\":26.0,\"hum\":37.0},\n\n\"LED\":100,\n\n\"Wifi\":{\"SSId\":\"infind\",\"IP\":\"192.168.0.100\",\"RSSI\":56}\n\n}\n"
    },
    {
        "id": "cedc168255cba3fe",
        "type": "group",
        "z": "4b80774a81fc72e3",
        "name": "Estado Led",
        "style": {
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "4086e459ed8e2d4e",
            "5e694971870c0ec9",
            "b2c7ad6d67afd80d",
            "b55ac03529c46e9a",
            "c32ecdfa41ec6c11"
        ],
        "x": 14,
        "y": 859,
        "info": "# Sensores\n\n- Topic: infind/GRUPOX/datos\n- Acción: Publicar\n- Descripción: Actualización periódica (30s) de información de sensores y más\n- Ejemplo:\n\n\n{\n\n\"Uptime\":12300,\n\n\"Vcc\":2.97,\n\n\"DHT11\":{\"temp\":26.0,\"hum\":37.0},\n\n\"LED\":100,\n\n\"Wifi\":{\"SSId\":\"infind\",\"IP\":\"192.168.0.100\",\"RSSI\":56}\n\n}\n"
    },
    {
        "id": "c670b4d7d9719781",
        "type": "group",
        "z": "4b80774a81fc72e3",
        "name": "Cambio LED",
        "style": {
            "fill": "#ffbfbf",
            "label": true
        },
        "nodes": [
            "5421b6e2864b3aa9",
            "e055538e13adb994",
            "44547e793ea61712",
            "5f89bdb78be3f862",
            "8e2b746befc8dfdb"
        ],
        "x": 14,
        "y": 619,
        "info": "# Intensidad\n\n- Topic: infind/GRUPOX/led/cmd\n- Acción: Suscribir\n- Descripción: El dispositivo recibe la configuración de intensidad del LED [0-100]\n- Ejemplo: { \"level\":75 }"
    },
    {
        "id": "55042353c69140c9",
        "type": "group",
        "z": "ecad3a12aab4b8b2",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "6f86f7f3464dfd85",
            "773fa43766f0b25b",
            "761d860b7905862e",
            "c6c3e6c67274295f",
            "3d09827389478a3a",
            "c3031f97cebcc386",
            "904c91e5c15bf934",
            "afabcaa71761c6fd",
            "ee43d04648a67e78",
            "32c7d5c336ac22e8",
            "6a4aa1571e208fa6",
            "59518888f1b728e2"
        ],
        "x": 54,
        "y": 19
    },
    {
        "id": "58752f0a6e4c85a0",
        "type": "group",
        "z": "6c70fe453347e1a4",
        "name": "Clean the collection",
        "style": {
            "label": true
        },
        "nodes": [
            "91ce1175ed60c27f",
            "a939ae425921532b"
        ],
        "x": 794,
        "y": 659
    },
    {
        "id": "90cdd081dffb79e1",
        "type": "group",
        "z": "6c70fe453347e1a4",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "206e65e8fb41aa3f",
            "c9ac8a171ec326a1",
            "cc775bf8b4c3564d",
            "a4c9e592bf9b2023",
            "3654503d536f1979",
            "c6af20667ac98ae0"
        ],
        "x": 1324,
        "y": 179
    },
    {
        "id": "b247db83b1efe9cb",
        "type": "group",
        "z": "e5bf25aa0df07243",
        "name": "Comprobar",
        "style": {
            "label": true
        },
        "nodes": [
            "de38e936a07a26d1",
            "6cf20a8e5e9451f2"
        ],
        "x": 14,
        "y": 399
    },
    {
        "id": "3cbc76d168ffea0b",
        "type": "group",
        "z": "b1264f7f33a6cecd",
        "name": "Común",
        "style": {
            "stroke": "#3f93cf",
            "fill": "#e3f3d3",
            "fill-opacity": "0.57",
            "label": true
        },
        "nodes": [
            "8c47ef56210aa70a",
            "60e86eddac32f9da",
            "6d12a581e7591ba7",
            "1ed86f99e4e7d4dc",
            "79b389605d6304db",
            "35b148a34bb29e41",
            "9de6f6d62250a26e",
            "e41230128d1a231b",
            "06fc84f46a789dc6",
            "60e1bcfa7d0988f8",
            "dd3fc4e68e99cc7f",
            "4f169ba3320645ff",
            "5882ed5137ba31d7",
            "07b6818be845ed13",
            "63f0786d37170552",
            "8d0f4c9c38dfba89",
            "62573d0f1753256b",
            "7b296dd275441bdc"
        ],
        "x": 1024,
        "y": 39
    },
    {
        "id": "c41f0b47cbbfbc65",
        "type": "group",
        "z": "b1264f7f33a6cecd",
        "name": "Cara002",
        "style": {
            "stroke": "#6f2fa0",
            "fill": "#dbcbe7",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "7292a048e2c396a6",
            "0a75a83f2d9a5f7c",
            "8ca3bdc94c59e1e0",
            "bb9e039b4e617ca2",
            "989e21d1ec7543f1",
            "7c83d266f3d716e4",
            "0b2b91ae657441de"
        ],
        "x": 14,
        "y": 399
    },
    {
        "id": "c58cdcaa25741f38",
        "type": "group",
        "z": "b1264f7f33a6cecd",
        "name": "Cara003",
        "style": {
            "stroke": "#6f2fa0",
            "fill": "#dbcbe7",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "60eddba48375afe2",
            "3a29e59fba2a5164",
            "98c631e8246cc765",
            "157499ce0bfc42b7",
            "c442e1e4d8c60952",
            "06976b1a983dd765",
            "2e681e5c5cdf07be"
        ],
        "x": 14,
        "y": 619
    },
    {
        "id": "e58badeac6a79a19",
        "type": "group",
        "z": "b1264f7f33a6cecd",
        "name": "Cara005",
        "style": {
            "stroke": "#6f2fa0",
            "fill": "#dbcbe7",
            "label": true,
            "color": "#000000"
        },
        "nodes": [
            "8b2ac556555a12c8",
            "ae1892d2b2a412d2",
            "e8a92e7b28f7b9f0",
            "f2eb9e8f54ec2846",
            "18e527ef879eb9f5",
            "f2dce74e263d3d9c",
            "e8e5d289cdf980f6"
        ],
        "x": 14,
        "y": 979
    },
    {
        "id": "998f9c86d7c6ed11",
        "type": "group",
        "z": "b1264f7f33a6cecd",
        "name": "Cara004",
        "style": {
            "label": true,
            "stroke": "#6f2fa0",
            "fill": "#dbcbe7"
        },
        "nodes": [
            "8104bd8c54f5c23b",
            "8577a7f24cae5079",
            "a9f3f752ca8131d6",
            "2eae17aa5a73d683",
            "b81cc36611338a99",
            "e1313cf636f86331",
            "00d7dcb2c10d87f1"
        ],
        "x": 14,
        "y": 799
    },
    {
        "id": "649bfa4f764191c5",
        "type": "group",
        "z": "b1264f7f33a6cecd",
        "name": "Función para recuperar textos en rango",
        "style": {
            "stroke": "#3f93cf",
            "fill": "#3f93cf",
            "label": true
        },
        "nodes": [
            "29ab9449cc0efcfd",
            "a8033b20a9e59d7b",
            "99cb5ceb8f132a55",
            "4987ca13a0b90d2b"
        ],
        "x": 1074,
        "y": 699
    },
    {
        "id": "dc3604968aa40363",
        "type": "group",
        "z": "0e6efdbc0f657beb",
        "g": "fa1b4c310d42be5b",
        "name": "Control led red",
        "style": {
            "label": true
        },
        "nodes": [
            "bf0fa0651dbcb639",
            "12b09a43e03cd7c3",
            "1a25f85e90ce5a07"
        ],
        "x": 974,
        "y": 379
    },
    {
        "id": "677e44441bd53f9b",
        "type": "group",
        "z": "0e6efdbc0f657beb",
        "g": "fa1b4c310d42be5b",
        "name": "Control led green",
        "style": {
            "label": true
        },
        "nodes": [
            "cd1d542ade044b6e",
            "775e2e8d4707df80",
            "27246a49e3b44cf7"
        ],
        "x": 974,
        "y": 539
    },
    {
        "id": "1c282d6c2598c6e5",
        "type": "group",
        "z": "0e6efdbc0f657beb",
        "g": "9a2ec2d6f29abdf8",
        "style": {
            "stroke": "#a8a095",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#afa89d"
        },
        "nodes": [
            "da450c45cefeb990"
        ],
        "x": 1174,
        "y": 59
    },
    {
        "id": "15fc3268ac0fe9a3",
        "type": "group",
        "z": "0e6efdbc0f657beb",
        "g": "9a2ec2d6f29abdf8",
        "style": {
            "stroke": "#a8a095",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#afa89d"
        },
        "nodes": [
            "e38ef2355ba0469d",
            "8d34f5ed47f740e4",
            "9a177d0af14eb248"
        ],
        "x": 974,
        "y": 179
    },
    {
        "id": "3d2c5d33e37d6dbc",
        "type": "group",
        "z": "7a16d1d00dfc8197",
        "g": "1c8cb162f374a7c6",
        "style": {
            "stroke": "#a8a095",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#afa89d"
        },
        "nodes": [
            "a3e895b119eb3e8a",
            "cdeccc9446a56f4d",
            "d4e8dcae1e01bbde"
        ],
        "x": 1934,
        "y": 39
    },
    {
        "id": "468e6c6d4d6b1f4f",
        "type": "group",
        "z": "7a16d1d00dfc8197",
        "g": "1c8cb162f374a7c6",
        "style": {
            "stroke": "#a8a095",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#afa89d"
        },
        "nodes": [
            "a575f5aa8818b254",
            "5a74bade7286704b",
            "2de928be198426c0"
        ],
        "x": 1934,
        "y": 179
    },
    {
        "id": "a048d8410ae79405",
        "type": "group",
        "z": "f607af27c5f161a8",
        "g": "0d4867dd076d65a0",
        "name": "Ejercicio 4 ",
        "style": {
            "stroke": "#a4a4a4",
            "label": true,
            "color": "#000000",
            "fill": "#e3f3d3"
        },
        "nodes": [
            "bf3cf708f17e653c",
            "115662fced1d8e26",
            "b91994e2fa49fa0e"
        ],
        "x": 1074,
        "y": 79
    },
    {
        "id": "09a81a457253b8d4",
        "type": "group",
        "z": "f607af27c5f161a8",
        "g": "0d4867dd076d65a0",
        "name": "",
        "style": {
            "stroke": "#a4a4a4",
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "7517801765a0bc1e",
            "26a3407919839168",
            "1e5340d074ece8ae",
            "be94424c81d39ed9"
        ],
        "x": 1074,
        "y": 219
    },
    {
        "id": "f70edc445b47629c",
        "type": "group",
        "z": "f607af27c5f161a8",
        "g": "0d4867dd076d65a0",
        "name": "",
        "style": {
            "stroke": "#a4a4a4",
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "ca3e93bac4356c89",
            "6e05f0706402d735",
            "ba2dc2f18933cb5f",
            "9e64c4cf25735c0d",
            "08ceaac9c4335523",
            "2a290ddb8ccdd81a",
            "b84786aa7f2eaa95",
            "e677eb22f7e51387",
            "e9d37dc65615b879",
            "c45991bc1d5f2828",
            "ddcbce2f08623d57",
            "a62dca5ec68c60eb"
        ],
        "x": 1074,
        "y": 419
    },
    {
        "id": "77511cc01629b614",
        "type": "group",
        "z": "f607af27c5f161a8",
        "g": "0d4867dd076d65a0",
        "name": "",
        "style": {
            "stroke": "#a4a4a4",
            "fill": "#e3f3d3",
            "label": true
        },
        "nodes": [
            "e2abbcccb1b32b84",
            "c838b32e0076c737",
            "81ab1216e764cf5c",
            "0e47d32a6d09d79e"
        ],
        "x": 1074,
        "y": 319
    },
    {
        "id": "dfefd42be31cab40",
        "type": "mqtt-broker",
        "name": "",
        "broker": "localhost",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": ""
    },
    {
        "id": "64cdcf7a3b4cd223",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "950c05f1ac2d3f82",
        "type": "ui_base",
        "theme": {
            "name": "theme-dark",
            "lightTheme": {
                "default": "#0094CE",
                "baseColor": "#0094CE",
                "baseFont": "Arial Black,Arial Black,Gadget,sans-serif",
                "edited": true,
                "reset": false
            },
            "darkTheme": {
                "default": "#097479",
                "baseColor": "#097479",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "customTheme": {
                "name": "Untitled Theme 1",
                "default": "#4B7930",
                "baseColor": "#4B7930",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "reset": false
            },
            "themeState": {
                "base-color": {
                    "default": "#097479",
                    "value": "#097479",
                    "edited": true
                },
                "page-titlebar-backgroundColor": {
                    "value": "#097479",
                    "edited": false
                },
                "page-backgroundColor": {
                    "value": "#111111",
                    "edited": false
                },
                "page-sidebar-backgroundColor": {
                    "value": "#333333",
                    "edited": false
                },
                "group-textColor": {
                    "value": "#0eb8c0",
                    "edited": false
                },
                "group-borderColor": {
                    "value": "#555555",
                    "edited": false
                },
                "group-backgroundColor": {
                    "value": "#333333",
                    "edited": false
                },
                "widget-textColor": {
                    "value": "#eeeeee",
                    "edited": false
                },
                "widget-backgroundColor": {
                    "value": "#097479",
                    "edited": false
                },
                "widget-borderColor": {
                    "value": "#333333",
                    "edited": false
                },
                "base-font": {
                    "value": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
                }
            },
            "angularTheme": {
                "primary": "indigo",
                "accents": "blue",
                "warn": "red",
                "background": "grey",
                "palette": "light"
            }
        },
        "site": {
            "name": "La Caja Game",
            "hideToolbar": "false",
            "allowSwipe": "false",
            "lockMenu": "false",
            "allowTempTheme": "true",
            "dateFormat": "DD/MM/YYYY",
            "sizes": {
                "sx": 48,
                "sy": 48,
                "gx": 6,
                "gy": 6,
                "cx": 6,
                "cy": 6,
                "px": 0,
                "py": 0
            }
        }
    },
    {
        "id": "afc96c5537aa9bd2",
        "type": "ui_tab",
        "name": "Tarea 1 + extra",
        "icon": "dashboard",
        "order": 3,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "5b43d9b58de38c94",
        "type": "ui_group",
        "name": "Time",
        "tab": "89e7d4e0c36d9489",
        "order": 2,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": "<style>     #nr-dashboard-cardtitle{text-align: center !important;} </style>"
    },
    {
        "id": "fadc24b19848c47b",
        "type": "ui_group",
        "name": "Control LED Verde",
        "tab": "afc96c5537aa9bd2",
        "order": 2,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "13bc2dd9a45cc0e9",
        "type": "ui_group",
        "name": "Temperatura",
        "tab": "afc96c5537aa9bd2",
        "order": 3,
        "disp": false,
        "width": "12",
        "collapse": false,
        "className": ""
    },
    {
        "id": "cb79f73074024dbb",
        "type": "ui_group",
        "name": "Humedad",
        "tab": "afc96c5537aa9bd2",
        "order": 4,
        "disp": false,
        "width": "8",
        "collapse": false,
        "className": ""
    },
    {
        "id": "d27cc3eaafc9bcc8",
        "type": "ui_group",
        "name": "Presión",
        "tab": "afc96c5537aa9bd2",
        "order": 5,
        "disp": false,
        "width": "12",
        "collapse": false,
        "className": ""
    },
    {
        "id": "96d7b634fbe25751",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": ""
    },
    {
        "id": "9ff8455e4877d275",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": ""
    },
    {
        "id": "1482f7c9cab5d4a1",
        "type": "ui_group",
        "name": "Dato ADC",
        "tab": "afc96c5537aa9bd2",
        "order": 6,
        "disp": false,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "c8b2b5778aed34b0",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "251fc0d11da602c6",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "59aa107107b6074e",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": ""
    },
    {
        "id": "a15e8808fd506feb",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": ""
    },
    {
        "id": "ec6230cd34b267ef",
        "type": "ui_tab",
        "name": "Tarea 2",
        "icon": "dashboard",
        "order": 4,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "6d8ffaa69a25c68f",
        "type": "ui_group",
        "name": "Control LED Rojo",
        "tab": "ec6230cd34b267ef",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": "<style>     #nr-dashboard-cardtitle{text-align: center !important;} </style>"
    },
    {
        "id": "e8ccf6ad47502312",
        "type": "ui_group",
        "name": "Control LED Verde",
        "tab": "ec6230cd34b267ef",
        "order": 2,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "60916e8014cfd3f7",
        "type": "ui_group",
        "name": "Temperatura",
        "tab": "ec6230cd34b267ef",
        "order": 3,
        "disp": false,
        "width": "12",
        "collapse": false,
        "className": ""
    },
    {
        "id": "8599d9afed430a9d",
        "type": "ui_group",
        "name": "Humedad",
        "tab": "ec6230cd34b267ef",
        "order": 4,
        "disp": false,
        "width": "8",
        "collapse": false,
        "className": ""
    },
    {
        "id": "386ddfb962d0c80d",
        "type": "ui_group",
        "name": "Presión",
        "tab": "ec6230cd34b267ef",
        "order": 5,
        "disp": false,
        "width": "12",
        "collapse": false,
        "className": ""
    },
    {
        "id": "bb45de54a7fe18b8",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": ""
    },
    {
        "id": "c9c513303f389c7d",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": ""
    },
    {
        "id": "3d72c6d43da61785",
        "type": "ui_group",
        "name": "Conexión",
        "tab": "ec6230cd34b267ef",
        "order": 6,
        "disp": true,
        "width": "8",
        "collapse": false,
        "className": ""
    },
    {
        "id": "bf64e5c6fbbba3c3",
        "type": "ui_group",
        "name": "Dato ADC",
        "tab": "ec6230cd34b267ef",
        "order": 7,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "498b706769fb5160",
        "type": "ui_tab",
        "name": "Tarea 4",
        "icon": "dashboard",
        "order": 6,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "d20b3cd14e645d48",
        "type": "ui_group",
        "name": "Humedad",
        "tab": "498b706769fb5160",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "8a548b476cc419b4",
        "type": "ui_group",
        "name": "Temperatura",
        "tab": "498b706769fb5160",
        "order": 2,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "e968a1c70a34a463",
        "type": "ui_group",
        "name": "Sensación térmica",
        "tab": "498b706769fb5160",
        "order": 3,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "ff340c796cfbcd07",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": ""
    },
    {
        "id": "ce30e442c74a8757",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": ""
    },
    {
        "id": "b838b28975e115b3",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": ""
    },
    {
        "id": "25d3b348baa44989",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": ""
    },
    {
        "id": "3faf59b5c0904ba0",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": ""
    },
    {
        "id": "69f9be3977f6a86b",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": ""
    },
    {
        "id": "a5a79e0203c5b083",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": ""
    },
    {
        "id": "387bddd0cc6d1f12",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": ""
    },
    {
        "id": "70257f4534da7029",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": ""
    },
    {
        "id": "284e0b37b67b2822",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": ""
    },
    {
        "id": "e8038adf457b4465",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": ""
    },
    {
        "id": "6ac432b491b7d6fc",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "ca0dd972168dc6a0",
        "type": "mongodb",
        "hostname": "iot.ac.uma.es",
        "topology": "direct",
        "connectOptions": "",
        "port": "27017",
        "db": "pruebas",
        "name": ""
    },
    {
        "id": "05cea6759e795a87",
        "type": "mongodb",
        "hostname": "127.0.0.1",
        "topology": "direct",
        "connectOptions": "",
        "port": "27017",
        "db": "local",
        "name": ""
    },
    {
        "id": "cd777711829327e5",
        "type": "ui_tab",
        "name": "Tarea 3",
        "icon": "dashboard",
        "order": 5,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "cbfbdc48914b032d",
        "type": "ui_group",
        "name": "Conexiones",
        "tab": "cd777711829327e5",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "2888ca9d00385ef8",
        "type": "ui_group",
        "name": "LED Rojo",
        "tab": "cd777711829327e5",
        "order": 2,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "98ee1182cc353ad6",
        "type": "ui_group",
        "name": "Presión",
        "tab": "cd777711829327e5",
        "order": 4,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "c271ce14649409b0",
        "type": "ui_group",
        "name": "Humedad",
        "tab": "cd777711829327e5",
        "order": 6,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "4f2fd049c27a14a1",
        "type": "ui_group",
        "name": "Temperatura",
        "tab": "cd777711829327e5",
        "order": 5,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "f8b2658284e752dc",
        "type": "ui_group",
        "name": "LED Verde",
        "tab": "cd777711829327e5",
        "order": 3,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "f4f4dc208bbef1ee",
        "type": "ui_group",
        "name": "Consultas Slider",
        "tab": "cd777711829327e5",
        "order": 7,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "9eaa5333ae7be1f9",
        "type": "ui_group",
        "name": "Consultas numeric",
        "tab": "cd777711829327e5",
        "order": 8,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "24a2032a9df17ba3",
        "type": "ui_group",
        "name": "Consultas Range",
        "tab": "cd777711829327e5",
        "order": 9,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "8b67b1bd51c43347",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "b8b5fb6b4bfeb434",
        "type": "ui_group",
        "name": "Estado y LWT",
        "tab": "4a06ba0a96f6d1fb",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "27e360b8dee7f0ae",
        "type": "ui_group",
        "name": "G3 Datos",
        "tab": "4a06ba0a96f6d1fb",
        "order": 5,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "4a06ba0a96f6d1fb",
        "type": "ui_tab",
        "name": "Home",
        "icon": "dashboard",
        "order": 7,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "b8514a208e81c49e",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": ""
    },
    {
        "id": "3dc9ec03600ab1b0",
        "type": "ui_group",
        "name": "datos",
        "tab": "547a5b5e59839162",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "95bf002b73b4a351",
        "type": "ui_group",
        "name": "Default",
        "tab": "f3101f3b8af327c7",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "547a5b5e59839162",
        "type": "ui_tab",
        "name": "elquequerais",
        "icon": "dashboard",
        "order": 8,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "f3101f3b8af327c7",
        "type": "ui_tab",
        "name": "LEDs",
        "icon": "dashboard",
        "order": 9,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "ec5e3bd27f5064bc",
        "type": "ui_group",
        "name": "Datos dispositivo",
        "tab": "da9051b8aca9da78",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "69f47afb1a3237b5",
        "type": "ui_group",
        "name": "Gráficas",
        "tab": "da9051b8aca9da78",
        "order": 2,
        "disp": true,
        "width": "10",
        "collapse": false,
        "className": ""
    },
    {
        "id": "142ed0bb263fc1a7",
        "type": "ui_group",
        "name": "Estado LEDs",
        "tab": "da9051b8aca9da78",
        "order": 3,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "da9051b8aca9da78",
        "type": "ui_tab",
        "name": "Dashboard Principal",
        "icon": "dashboard",
        "order": 10,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "9ffa43d52f7365a9",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": ""
    },
    {
        "id": "f8e3360024a8fede",
        "type": "ui_group",
        "name": "Datos dispositivo",
        "tab": "906601726774ec61",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "9de2c791b931a51a",
        "type": "ui_group",
        "name": "Histórico",
        "tab": "906601726774ec61",
        "order": 2,
        "disp": true,
        "width": "10",
        "collapse": false,
        "className": ""
    },
    {
        "id": "b0172c0d62a7dc67",
        "type": "ui_group",
        "name": "LEDs",
        "tab": "906601726774ec61",
        "order": 3,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "906601726774ec61",
        "type": "ui_tab",
        "name": "Grupo1",
        "icon": "dashboard",
        "order": 11,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "fd4ef32ed97b3267",
        "type": "ui_tab",
        "name": "Información Completa",
        "icon": "dashboard",
        "order": 12,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "f05d79154bee32af",
        "type": "ui_group",
        "name": "Conexiones",
        "tab": "fd4ef32ed97b3267",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "d65024e343511220",
        "type": "ui_group",
        "name": "Gráficas",
        "tab": "fd4ef32ed97b3267",
        "order": 2,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "995da68e7598652e",
        "type": "ui_group",
        "name": "Datos del Dispositivo",
        "tab": "fd4ef32ed97b3267",
        "order": 3,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "b266f63deeb3007d",
        "type": "ui_group",
        "name": "LEDs",
        "tab": "fd4ef32ed97b3267",
        "order": 4,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "4a17300d61e0065b",
        "type": "ui_group",
        "name": "Control LEDs",
        "tab": "da9051b8aca9da78",
        "order": 4,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "76fc120df06c3d4a",
        "type": "ui_group",
        "name": "Conexiones",
        "tab": "da9051b8aca9da78",
        "order": 5,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "74b28a5e7c866247",
        "type": "ui_group",
        "name": "ESP82",
        "tab": "423b6a130b684fb2",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "11e77274e18f5e66",
        "type": "ui_group",
        "name": "Control LEDs JSON",
        "tab": "da9051b8aca9da78",
        "order": 6,
        "disp": true,
        "width": "4",
        "collapse": false,
        "className": ""
    },
    {
        "id": "6d4110de9bf1bcf5",
        "type": "ui_group",
        "name": "Estado LEDs (sin bugs JSON)",
        "tab": "da9051b8aca9da78",
        "order": 7,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "4f161821e0636e81",
        "type": "ui_group",
        "name": "Datos Dispositivo 2.0",
        "tab": "da9051b8aca9da78",
        "order": 8,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "f229aa351b50819b",
        "type": "mongodb",
        "hostname": "127.0.0.1",
        "topology": "direct",
        "connectOptions": "",
        "port": "27017",
        "db": "pruebas",
        "name": ""
    },
    {
        "id": "2222263843bdba85",
        "type": "ui_tab",
        "name": "MongoDB",
        "icon": "dashboard",
        "order": 13,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "5f8d4c27dcbd6798",
        "type": "ui_group",
        "name": "Default",
        "tab": "2222263843bdba85",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "71800cda9a1eabf9",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": ""
    },
    {
        "id": "6046a47177835823",
        "type": "mongodb",
        "hostname": "127.0.0.1",
        "connectOptions": "",
        "port": "27017",
        "db": "test",
        "name": ""
    },
    {
        "id": "71d4105137694090",
        "type": "ui_group",
        "name": "Consulta",
        "tab": "4db8e8aa79d93f4e",
        "order": 1,
        "disp": true,
        "width": "10",
        "collapse": false,
        "className": ""
    },
    {
        "id": "4db8e8aa79d93f4e",
        "type": "ui_tab",
        "name": "Ejemplo Mongo",
        "icon": "dashboard",
        "order": 14,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "423b6a130b684fb2",
        "type": "ui_tab",
        "name": "ESP82",
        "icon": "dashboard",
        "order": 15,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "89e7d4e0c36d9489",
        "type": "ui_tab",
        "name": "LaCaja - Debug",
        "icon": "dashboard",
        "order": 2,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "1d5a7f2c4047edc7",
        "type": "ui_group",
        "name": "Controles Consulta",
        "tab": "4db8e8aa79d93f4e",
        "order": 2,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "638e08dab45a6aee",
        "type": "ui_group",
        "name": "Datos Sensor",
        "tab": "423b6a130b684fb2",
        "order": 3,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "98c3801e20c06bc5",
        "type": "ui_group",
        "name": "Consulta Tiempo",
        "tab": "4db8e8aa79d93f4e",
        "order": 4,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "81d3b2a6dd28b58e",
        "type": "ui_group",
        "name": "Gráfica",
        "tab": "4db8e8aa79d93f4e",
        "order": 5,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "ef2c90a21fdbd37b",
        "type": "ui_group",
        "name": "Mensaje",
        "tab": "423b6a130b684fb2",
        "order": 3,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "f605fa69.8f5008",
        "type": "mongodb",
        "hostname": "iot.ac.uma.es",
        "connectOptions": "",
        "port": "27017",
        "db": "examen",
        "name": ""
    },
    {
        "id": "c7a3425e606353b2",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "1f33bd2091f1c0f0",
        "type": "telegram bot",
        "botname": "botagendabot",
        "usernames": "",
        "chatids": "",
        "baseapiurl": "",
        "updatemode": "polling",
        "pollinterval": "300",
        "usesocks": false,
        "sockshost": "",
        "socksport": "6667",
        "socksusername": "anonymous",
        "sockspassword": "",
        "bothost": "",
        "botpath": "",
        "localbotport": "8443",
        "publicbotport": "8443",
        "privatekey": "",
        "certificate": "",
        "useselfsignedcertificate": false,
        "sslterminated": false,
        "verboselogging": false
    },
    {
        "id": "3752afa1.deaf9",
        "type": "mongodb",
        "hostname": "iot.ac.uma.es",
        "connectOptions": "",
        "port": "27017",
        "db": "pruebas",
        "name": ""
    },
    {
        "id": "a34ffe7a.04009",
        "type": "ui_group",
        "name": "Grupo descarga",
        "tab": "e63432e4.6c1e",
        "order": 1,
        "disp": true,
        "width": "8",
        "collapse": false
    },
    {
        "id": "2b251178.95ad2e",
        "type": "mqtt-broker",
        "name": "iot infind",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "e63432e4.6c1e",
        "type": "ui_tab",
        "name": "Ejemplo descarga",
        "icon": "dashboard",
        "order": 16,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "970b2d92940cc035",
        "type": "ui_group",
        "name": "Grupo aggregación",
        "tab": "078c073b376af0aa",
        "order": 1,
        "disp": true,
        "width": "10",
        "collapse": false
    },
    {
        "id": "078c073b376af0aa",
        "type": "ui_tab",
        "name": "Agregación",
        "icon": "dashboard",
        "order": 17,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "14bda206c3f7ab91",
        "type": "ui_tab",
        "name": "Examen",
        "icon": "dashboard",
        "order": 18,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "ef4e3347ed457b9c",
        "type": "ui_group",
        "name": "Input",
        "tab": "14bda206c3f7ab91",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "2f39551d1464f827",
        "type": "ui_group",
        "name": "Game Status",
        "tab": "89e7d4e0c36d9489",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "2156a9e02110da25",
        "type": "ui_tab",
        "name": "LaCaja - User",
        "icon": "dashboard",
        "order": 1,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "f870df7d6c3cc2e9",
        "type": "ui_group",
        "name": "Game Status",
        "tab": "2156a9e02110da25",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "bd903d6.d9fc7c",
        "type": "ui_group",
        "name": "Report",
        "tab": "1e3fe400.0baf5c",
        "order": 2,
        "disp": true,
        "width": "18"
    },
    {
        "id": "1e17cd0b.862863",
        "type": "ui_group",
        "name": "Selection",
        "tab": "1e3fe400.0baf5c",
        "order": 1,
        "disp": true,
        "width": "5"
    },
    {
        "id": "1e3fe400.0baf5c",
        "type": "ui_tab",
        "name": "Reports",
        "icon": "dashboard",
        "order": 9
    },
    {
        "id": "5359497a2a301f2a",
        "type": "ui_group",
        "name": "JuegoSimon",
        "tab": "2ec127612123211b",
        "order": 1,
        "disp": true,
        "width": "10",
        "collapse": false,
        "className": ""
    },
    {
        "id": "2ec127612123211b",
        "type": "ui_tab",
        "name": "LaCaja",
        "icon": "dashboard",
        "disabled": false,
        "hidden": false
    },
    {
        "id": "f2d93db89ab63446",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "userProps": "",
        "sessionExpiry": ""
    },
    {
        "id": "3999f8259e1b43de",
        "type": "mqtt-broker",
        "name": "",
        "broker": "iot.ac.uma.es",
        "port": "1883",
        "clientid": "",
        "usetls": false,
        "protocolVersion": "4",
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "birthMsg": {},
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "closeMsg": {},
        "willTopic": "",
        "willQos": "0",
        "willPayload": "",
        "willMsg": {},
        "sessionExpiry": ""
    },
    {
        "id": "d95354d46509e771",
        "type": "telegram bot",
        "botname": "ChiquiBot",
        "usernames": "",
        "chatids": "",
        "baseapiurl": "",
        "updatemode": "polling",
        "pollinterval": "300",
        "usesocks": false,
        "sockshost": "",
        "socksprotocol": "socks5",
        "socksport": "6667",
        "socksusername": "anonymous",
        "sockspassword": "",
        "bothost": "",
        "botpath": "",
        "localbotport": "8443",
        "publicbotport": "8443",
        "privatekey": "",
        "certificate": "",
        "useselfsignedcertificate": false,
        "sslterminated": false,
        "verboselogging": false
    },
    {
        "id": "96e271eba0b52a94",
        "type": "mongodb",
        "hostname": "iot.ac.uma.es",
        "topology": "direct",
        "connectOptions": "",
        "port": "27017",
        "db": "II3",
        "name": ""
    },
    {
        "id": "9fd09ec59450a624",
        "type": "telegram bot",
        "botname": "Tarea_9_Irene",
        "usernames": "",
        "chatids": "",
        "baseapiurl": "",
        "updatemode": "polling",
        "pollinterval": "300",
        "usesocks": false,
        "sockshost": "",
        "socksprotocol": "socks5",
        "socksport": "6667",
        "socksusername": "anonymous",
        "sockspassword": "",
        "bothost": "",
        "botpath": "",
        "localbotport": "8443",
        "publicbotport": "8443",
        "privatekey": "",
        "certificate": "",
        "useselfsignedcertificate": false,
        "sslterminated": false,
        "verboselogging": false
    },
    {
        "id": "da9d18fd4873c01a",
        "type": "telegram bot",
        "botname": "Simonbot",
        "usernames": "",
        "chatids": "",
        "baseapiurl": "",
        "updatemode": "polling",
        "pollinterval": "300",
        "usesocks": false,
        "sockshost": "",
        "socksprotocol": "socks5",
        "socksport": "6667",
        "socksusername": "anonymous",
        "sockspassword": "",
        "bothost": "",
        "botpath": "",
        "localbotport": "8443",
        "publicbotport": "8443",
        "privatekey": "",
        "certificate": "",
        "useselfsignedcertificate": false,
        "sslterminated": false,
        "verboselogging": false
    },
    {
        "id": "219ce9d84d63af72",
        "type": "ui_group",
        "name": "Game Status",
        "tab": "9198a8f9e2a34ed3",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "9198a8f9e2a34ed3",
        "type": "ui_tab",
        "name": "LaCaja - User",
        "icon": "dashboard",
        "order": 1,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "37ec8e592794dd5a",
        "type": "change",
        "z": "1736e63b25650818",
        "name": "Iluminacion",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.ADC.Iluminacion",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 510,
        "y": 680,
        "wires": [
            []
        ]
    },
    {
        "id": "cbca515058def3f9",
        "type": "change",
        "z": "1736e63b25650818",
        "name": "Temperatura",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.BME280.Temperatura",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 510,
        "y": 520,
        "wires": [
            []
        ]
    },
    {
        "id": "965433bea2abdd7f",
        "type": "change",
        "z": "1736e63b25650818",
        "name": "Humedad",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.BME280.Humedad",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 500,
        "y": 560,
        "wires": [
            []
        ]
    },
    {
        "id": "02ad691c4d094030",
        "type": "change",
        "z": "1736e63b25650818",
        "name": "Presion",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.BME280.Presion",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 500,
        "y": 600,
        "wires": [
            []
        ]
    },
    {
        "id": "3ab993c9aaeb02a9",
        "type": "change",
        "z": "1736e63b25650818",
        "name": "Rojo",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.LEDs.Rojo",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 490,
        "y": 420,
        "wires": [
            []
        ]
    },
    {
        "id": "ed54312aaa364df5",
        "type": "change",
        "z": "1736e63b25650818",
        "name": "Verde",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.LEDs.Verde",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 490,
        "y": 460,
        "wires": [
            []
        ]
    },
    {
        "id": "8579e5a838f746f2",
        "type": "change",
        "z": "1736e63b25650818",
        "name": "ChipID",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.nodeID.ChipID",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 490,
        "y": 320,
        "wires": [
            []
        ]
    },
    {
        "id": "c80f38ea1c9620b4",
        "type": "change",
        "z": "1736e63b25650818",
        "name": "Des",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.Des",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 490,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "4e09efcff6e84b0c",
        "type": "change",
        "z": "1736e63b25650818",
        "name": "SSID",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.SSID",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 490,
        "y": 40,
        "wires": [
            []
        ]
    },
    {
        "id": "95164f1d4c36c5d5",
        "type": "change",
        "z": "1736e63b25650818",
        "name": "RSSI",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.RSSI",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 490,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "6c4c38ff165dbd18",
        "type": "change",
        "z": "1736e63b25650818",
        "name": "localIP",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.localIP",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 490,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "b03cec66fb391724",
        "type": "change",
        "z": "1736e63b25650818",
        "name": "macAddress",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.macAddress",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 510,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "b0c38e47413631d4",
        "type": "change",
        "z": "1736e63b25650818",
        "name": "uptime_ms",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.uptime_ms",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 510,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "fa36c4f9fd494fa8",
        "type": "change",
        "z": "1736e63b25650818",
        "name": "interval_s",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.interval_s",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 500,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "d8fc63694048f63f",
        "type": "function",
        "z": "7cbc96056c55979a",
        "name": "Foto: Inicial del juego",
        "func": "msg.payload = global.get(\"user\");\nmsg.payload.content = \"/home/rhyloo/nol/pics/prueba1_preview.png\";\nmsg.payload.type = 'photo';\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 720,
        "y": 60,
        "wires": [
            [
                "95e3ae4c7cf01afe",
                "30a9a1de061806a0"
            ]
        ]
    },
    {
        "id": "60f7d5fedf815de3",
        "type": "mongodb in",
        "z": "7cbc96056c55979a",
        "mongodb": "96e271eba0b52a94",
        "name": "",
        "collection": "recursos_de_las_pruebas",
        "operation": "aggregate",
        "x": 830,
        "y": 300,
        "wires": [
            [
                "50d67abb826b5bad",
                "47a99b0fd9516842"
            ]
        ]
    },
    {
        "id": "ee71b9a0dd9d7153",
        "type": "function",
        "z": "7cbc96056c55979a",
        "name": "Recupera un acertijo aleatorio de la base de datos",
        "func": "msg.payload = [{ $match: { \"filename\": \"acertijos_cara002.json\" } },\n                { $unwind: \"$payload\" },\n                { \"$sample\": { \"size\": 1 } },\n                { $replaceRoot: { newRoot: \"$payload\" } }];\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 410,
        "y": 300,
        "wires": [
            [
                "60f7d5fedf815de3"
            ]
        ]
    },
    {
        "id": "662f7e25afd3725e",
        "type": "change",
        "z": "7cbc96056c55979a",
        "name": "Get puzzle",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload[0].content",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1270,
        "y": 300,
        "wires": [
            [
                "20ef49c17eb61b27"
            ]
        ]
    },
    {
        "id": "f3b847c371af68b1",
        "type": "complete",
        "z": "7cbc96056c55979a",
        "name": "",
        "scope": [
            "951ddf27018e089f"
        ],
        "uncaught": false,
        "x": 90,
        "y": 300,
        "wires": [
            [
                "ee71b9a0dd9d7153"
            ]
        ]
    },
    {
        "id": "47a99b0fd9516842",
        "type": "change",
        "z": "7cbc96056c55979a",
        "name": "Get ans",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload[0].ans",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1120,
        "y": 340,
        "wires": [
            [
                "b17841f01894f976"
            ]
        ]
    },
    {
        "id": "e658caa098e07164",
        "type": "delay",
        "z": "7cbc96056c55979a",
        "name": "",
        "pauseType": "delay",
        "timeout": "3",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 300,
        "y": 180,
        "wires": [
            [
                "951ddf27018e089f"
            ]
        ]
    },
    {
        "id": "45a21b9fac9c3de7",
        "type": "mqtt in",
        "z": "7cbc96056c55979a",
        "name": "",
        "topic": "II3/ESP002/pub/cara002",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "2b251178.95ad2e",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 110,
        "y": 440,
        "wires": [
            [
                "99f8ad3df90e445c",
                "e2e49d26f6fd4e46",
                "33612072a9903295",
                "5c2cf1620e7bb78b",
                "2eb58ec64814c2b3"
            ]
        ]
    },
    {
        "id": "01f722175d46f796",
        "type": "ui_text",
        "z": "7cbc96056c55979a",
        "group": "f870df7d6c3cc2e9",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Número introducido",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1490,
        "y": 40,
        "wires": []
    },
    {
        "id": "50d67abb826b5bad",
        "type": "delay",
        "z": "7cbc96056c55979a",
        "name": "",
        "pauseType": "delay",
        "timeout": "3",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1120,
        "y": 300,
        "wires": [
            [
                "662f7e25afd3725e"
            ]
        ]
    },
    {
        "id": "95e3ae4c7cf01afe",
        "type": "link out",
        "z": "7cbc96056c55979a",
        "name": "link out 14",
        "mode": "link",
        "links": [
            "f467c017da051f39"
        ],
        "x": 1725,
        "y": 60,
        "wires": []
    },
    {
        "id": "f467c017da051f39",
        "type": "link in",
        "z": "7cbc96056c55979a",
        "name": "link in 25",
        "links": [
            "95e3ae4c7cf01afe",
            "d29bf012134f8ffe",
            "d70f73aa1eeae7b7",
            "d638963d2d5d1a35",
            "2731515564e2a084",
            "a683ded7ea3cc190",
            "3ad526a566996839"
        ],
        "x": 2025,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "d29bf012134f8ffe",
        "type": "link out",
        "z": "7cbc96056c55979a",
        "name": "link out 15",
        "mode": "link",
        "links": [
            "f467c017da051f39"
        ],
        "x": 1725,
        "y": 180,
        "wires": []
    },
    {
        "id": "d70f73aa1eeae7b7",
        "type": "link out",
        "z": "7cbc96056c55979a",
        "name": "link out 16",
        "mode": "link",
        "links": [
            "f467c017da051f39"
        ],
        "x": 1725,
        "y": 300,
        "wires": []
    },
    {
        "id": "b17841f01894f976",
        "type": "mqtt out",
        "z": "7cbc96056c55979a",
        "name": "",
        "topic": "II3/ESP002/cmd/cara002",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "2b251178.95ad2e",
        "x": 1350,
        "y": 340,
        "wires": []
    },
    {
        "id": "99f8ad3df90e445c",
        "type": "change",
        "z": "7cbc96056c55979a",
        "name": "State",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.state",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 490,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "2eb58ec64814c2b3",
        "type": "change",
        "z": "7cbc96056c55979a",
        "name": "gameinfo",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.gameinfo",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 500,
        "y": 560,
        "wires": [
            []
        ]
    },
    {
        "id": "7a3228361c8fbb4b",
        "type": "delay",
        "z": "7cbc96056c55979a",
        "name": "",
        "pauseType": "delay",
        "timeout": "3",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 300,
        "y": 240,
        "wires": [
            [
                "47fda2aa80a73f98"
            ]
        ]
    },
    {
        "id": "d638963d2d5d1a35",
        "type": "link out",
        "z": "7cbc96056c55979a",
        "name": "link out 42",
        "mode": "link",
        "links": [
            "f467c017da051f39"
        ],
        "x": 1725,
        "y": 240,
        "wires": []
    },
    {
        "id": "47fda2aa80a73f98",
        "type": "function",
        "z": "7cbc96056c55979a",
        "name": "+Instrucciones",
        "func": "msg.payload = global.get(\"user\");\nmsg.payload.content= \"El acertijo es el siguiente: \";\nmsg.payload.type = \"message\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 700,
        "y": 240,
        "wires": [
            [
                "d638963d2d5d1a35"
            ]
        ]
    },
    {
        "id": "951ddf27018e089f",
        "type": "function",
        "z": "7cbc96056c55979a",
        "name": "Instrucciones",
        "func": "msg.payload = global.get(\"user\");\nmsg.payload.content = \"Recordad que podéis utilizar el botón de \\\"Pista\\\" para obtener una pista adicional. ¡Buena suerte a todos!\";\nmsg.payload.type = \"message\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 690,
        "y": 180,
        "wires": [
            [
                "d29bf012134f8ffe",
                "7a3228361c8fbb4b"
            ]
        ]
    },
    {
        "id": "1a20248644484714",
        "type": "function",
        "z": "7cbc96056c55979a",
        "name": "Mensaje: Inicia el juego",
        "func": "msg.payload = global.get(\"user\");\nmsg.payload.type = \"message\";\nmsg.payload.content = \"¡Bienvenidos a la primera prueba de \\\"La Caja\\\"! Para resolver esta prueba, tendréis que utilizar el numpad disponible en la caja para introducir un número de dos dígitos.\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 730,
        "y": 120,
        "wires": [
            [
                "2731515564e2a084",
                "e658caa098e07164"
            ]
        ]
    },
    {
        "id": "2731515564e2a084",
        "type": "link out",
        "z": "7cbc96056c55979a",
        "name": "link out 43",
        "mode": "link",
        "links": [
            "f467c017da051f39"
        ],
        "x": 1725,
        "y": 120,
        "wires": []
    },
    {
        "id": "30a9a1de061806a0",
        "type": "delay",
        "z": "7cbc96056c55979a",
        "name": "",
        "pauseType": "delay",
        "timeout": "3",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 300,
        "y": 120,
        "wires": [
            [
                "1a20248644484714"
            ]
        ]
    },
    {
        "id": "19e8c8726cf10ee7",
        "type": "function",
        "z": "7cbc96056c55979a",
        "name": "terminado?",
        "func": "if (msg.payload == 2){\n    return msg;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 650,
        "y": 860,
        "wires": [
            [
                "fd123d5df6b8a4f3"
            ]
        ]
    },
    {
        "id": "fd123d5df6b8a4f3",
        "type": "function",
        "z": "7cbc96056c55979a",
        "name": "Mensaje: Inicia el juego",
        "func": "msg.payload = global.get(\"user\");\nmsg.payload.type = \"message\";\nmsg.payload.content = \"¡Felicidades por haber pasado la primera prueba de \\\"La Caja\\\"! Estamos impresionados por vuestra habilidad para resolver el acertijo.\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 770,
        "y": 920,
        "wires": [
            [
                "a683ded7ea3cc190",
                "2ef4b606db53ca11"
            ]
        ]
    },
    {
        "id": "a683ded7ea3cc190",
        "type": "link out",
        "z": "7cbc96056c55979a",
        "name": "link out 44",
        "mode": "link",
        "links": [
            "f467c017da051f39"
        ],
        "x": 1585,
        "y": 920,
        "wires": []
    },
    {
        "id": "651287b90e979c55",
        "type": "function",
        "z": "7cbc96056c55979a",
        "name": "Mensaje: Inicia el juego",
        "func": "msg.payload = global.get(\"user\");\nmsg.payload.type = \"message\";\nmsg.payload.content = \"Estamos seguros de que seguiréis demostrando vuestras habilidades a lo largo del juego. ¡Seguid adelante y no dejéis que nada os detenga! ¡Buena suerte en la siguiente prueba!\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 930,
        "y": 980,
        "wires": [
            [
                "3ad526a566996839"
            ]
        ]
    },
    {
        "id": "2ef4b606db53ca11",
        "type": "delay",
        "z": "7cbc96056c55979a",
        "name": "",
        "pauseType": "delay",
        "timeout": "3",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 720,
        "y": 980,
        "wires": [
            [
                "651287b90e979c55"
            ]
        ]
    },
    {
        "id": "3ad526a566996839",
        "type": "link out",
        "z": "7cbc96056c55979a",
        "name": "link out 45",
        "mode": "link",
        "links": [
            "f467c017da051f39"
        ],
        "x": 1585,
        "y": 980,
        "wires": []
    },
    {
        "id": "f7990599de758aac",
        "type": "function",
        "z": "7cbc96056c55979a",
        "name": "Send an inline message",
        "func": "var texto = msg.payload;\nmsg.payload = global.get(\"user\");\nmsg.payload.content = texto;\nmsg.payload.type = \"message\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1230,
        "y": 40,
        "wires": [
            []
        ]
    },
    {
        "id": "20ef49c17eb61b27",
        "type": "function",
        "z": "7cbc96056c55979a",
        "name": "Send an inline message",
        "func": "var texto = msg.payload;\nmsg.payload = global.get(\"user\");\nmsg.payload.content = \"*\";\nmsg.payload.content += texto;\nmsg.payload.content += \"*\";\nmsg.payload.type = \"message\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1530,
        "y": 300,
        "wires": [
            [
                "d70f73aa1eeae7b7"
            ]
        ]
    },
    {
        "id": "33612072a9903295",
        "type": "change",
        "z": "7cbc96056c55979a",
        "name": "trytime",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.trytime",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 490,
        "y": 480,
        "wires": [
            []
        ]
    },
    {
        "id": "5c2cf1620e7bb78b",
        "type": "change",
        "z": "7cbc96056c55979a",
        "name": "numtries",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.numtries",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 500,
        "y": 520,
        "wires": [
            []
        ]
    },
    {
        "id": "e2e49d26f6fd4e46",
        "type": "change",
        "z": "7cbc96056c55979a",
        "name": "gametime",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.gametime",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 500,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "0acde4c796f02db3",
        "type": "complete",
        "z": "72ea5fcb0b022fe1",
        "name": "",
        "scope": [
            "ac7dfeb5cf992750"
        ],
        "uncaught": false,
        "x": 170,
        "y": 180,
        "wires": [
            [
                "3f20526c93fc2976"
            ]
        ]
    },
    {
        "id": "3f20526c93fc2976",
        "type": "delay",
        "z": "72ea5fcb0b022fe1",
        "name": "",
        "pauseType": "delay",
        "timeout": "3",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 360,
        "y": 180,
        "wires": [
            [
                "bc5e1aff13f86696"
            ]
        ]
    },
    {
        "id": "9f114dbce8fa9b53",
        "type": "telegram command",
        "z": "72ea5fcb0b022fe1",
        "name": "",
        "command": "/ayuda2",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "d95354d46509e771",
        "strict": false,
        "hasresponse": false,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 1,
        "x": 150,
        "y": 120,
        "wires": [
            [
                "1699125b4b0f183c"
            ]
        ]
    },
    {
        "id": "bc5e1aff13f86696",
        "type": "function",
        "z": "72ea5fcb0b022fe1",
        "name": "Start Game",
        "func": "msg.payload= {\"state\":1, \"reducir_secuencia\":0};\nmsg.topic = \"II3/ESP14440037/datos_juego2\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 530,
        "y": 180,
        "wires": [
            [
                "0fa8f0d66dddee5f"
            ]
        ]
    },
    {
        "id": "d5422d86349077ea",
        "type": "function",
        "z": "72ea5fcb0b022fe1",
        "name": "mensaje respuesta",
        "func": "msg.payload= \"No abuses del comando que acabas de utilizar, tus puntaciones quedarán registradas. \\n\";\nmsg.payload+=\"Se ha reducido en '1' el número de secuencias que debes acertar para ganar el juego. Quizás con esta ayudita puedas conseguir superar la prueba, sino recuerda que puedes usar el comando: \\n/ayuda2\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1210,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "ac7dfeb5cf992750",
        "type": "function",
        "z": "72ea5fcb0b022fe1",
        "name": "mensaje bienvenida",
        "func": "msg.payload=\"Hey amigo/a, ya estás en el segundo nivel del juego 'La Caja'. Enhorabuena, pero no sonrías tan pronto porque debes de superar esta prueba. Para resolver este nivel, juega al Simon y gana. Si necesitas algo, puedes pulsar el comando: \\n/ayuda2\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 500,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "1699125b4b0f183c",
        "type": "function",
        "z": "72ea5fcb0b022fe1",
        "name": "info telegram user",
        "func": "msg.payload= {\"empieza_juego2\":1, \"reducir_secuencia\":1};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 910,
        "y": 120,
        "wires": [
            [
                "d5422d86349077ea",
                "0fa8f0d66dddee5f"
            ]
        ]
    },
    {
        "id": "c396cce8f8361451",
        "type": "function",
        "z": "72ea5fcb0b022fe1",
        "name": "",
        "func": "msg.payload= {\"state\":1, \"reducir_secuencia\":0};\n//msg.topic = \"II3/ESP14440037/datos_juego2\";\nmsg.topic =\"II3/ESP14440037/datos_juego2\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 580,
        "y": 780,
        "wires": [
            [
                "944f25fe086ec57d",
                "d4b49bc94f317197",
                "4c63f309e596ec62"
            ]
        ]
    },
    {
        "id": "0a0c47359b1a98d2",
        "type": "mqtt in",
        "z": "72ea5fcb0b022fe1",
        "name": "",
        "topic": "II3/ESP14440037/resultados_juego2",
        "qos": "0",
        "datatype": "auto",
        "broker": "2b251178.95ad2e",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 240,
        "y": 340,
        "wires": [
            [
                "b2e8bf8ff160cecf",
                "3179cf7e6fc7a5f9"
            ]
        ]
    },
    {
        "id": "b2e8bf8ff160cecf",
        "type": "debug",
        "z": "72ea5fcb0b022fe1",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 530,
        "y": 280,
        "wires": []
    },
    {
        "id": "944f25fe086ec57d",
        "type": "debug",
        "z": "72ea5fcb0b022fe1",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 750,
        "y": 820,
        "wires": []
    },
    {
        "id": "d4b49bc94f317197",
        "type": "change",
        "z": "72ea5fcb0b022fe1",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.state",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 780,
        "y": 740,
        "wires": [
            []
        ]
    },
    {
        "id": "389aec60cf888f6b",
        "type": "ui_text",
        "z": "72ea5fcb0b022fe1",
        "group": "f870df7d6c3cc2e9",
        "order": 7,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Tiempo partida total: ",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1400,
        "y": 280,
        "wires": []
    },
    {
        "id": "96af37f5e6e600d7",
        "type": "ui_text",
        "z": "72ea5fcb0b022fe1",
        "group": "f870df7d6c3cc2e9",
        "order": 8,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Tiempo partida actual:  ",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1400,
        "y": 340,
        "wires": []
    },
    {
        "id": "5daa642f63fb92a4",
        "type": "change",
        "z": "72ea5fcb0b022fe1",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.aciertos_por_partida",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 780,
        "y": 400,
        "wires": [
            [
                "16db2d8abaf06bd6"
            ]
        ]
    },
    {
        "id": "16db2d8abaf06bd6",
        "type": "ui_text",
        "z": "72ea5fcb0b022fe1",
        "group": "f870df7d6c3cc2e9",
        "order": 9,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Aciertos por partida:  ",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1400,
        "y": 400,
        "wires": []
    },
    {
        "id": "3179cf7e6fc7a5f9",
        "type": "json",
        "z": "72ea5fcb0b022fe1",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 530,
        "y": 340,
        "wires": [
            [
                "5daa642f63fb92a4",
                "468e9211a838685c",
                "36f4edce8a725ba5",
                "533be197ee698298",
                "d7b279830c877d20"
            ]
        ]
    },
    {
        "id": "468e9211a838685c",
        "type": "function",
        "z": "72ea5fcb0b022fe1",
        "name": "",
        "func": "var tiempo = msg.payload.tiempo_partida_total;\n\nvar minutos = Math.trunc(tiempo/(1000*60));\n    tiempo = tiempo - minutos*60*1000;\nvar segundos = Math.trunc(tiempo/(1000));\n\nmsg.payload = minutos +\":\"+segundos;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 760,
        "y": 280,
        "wires": [
            [
                "389aec60cf888f6b"
            ]
        ]
    },
    {
        "id": "36f4edce8a725ba5",
        "type": "function",
        "z": "72ea5fcb0b022fe1",
        "name": "",
        "func": "var tiempo = msg.payload.tiempo_partida_actual;\n\nvar minutos = Math.trunc(tiempo/(1000*60));\n    tiempo = tiempo - minutos*60*1000;\nvar segundos = Math.trunc(tiempo/(1000));\n\nmsg.payload = minutos +\":\"+segundos;\nreturn msg;\n\n\n\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 760,
        "y": 340,
        "wires": [
            [
                "96af37f5e6e600d7"
            ]
        ]
    },
    {
        "id": "2434dcb911ad72ca",
        "type": "ui_button",
        "z": "72ea5fcb0b022fe1",
        "name": "Start",
        "group": "f870df7d6c3cc2e9",
        "order": 8,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Start",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 150,
        "y": 780,
        "wires": [
            [
                "c396cce8f8361451"
            ]
        ]
    },
    {
        "id": "f3dccf0c40acb14b",
        "type": "mqtt in",
        "z": "72ea5fcb0b022fe1",
        "name": "",
        "topic": "II3/ESP14440037/estado_juego2",
        "qos": "0",
        "datatype": "auto",
        "broker": "2b251178.95ad2e",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 230,
        "y": 740,
        "wires": [
            [
                "d97fe414beeacd6a"
            ]
        ]
    },
    {
        "id": "d97fe414beeacd6a",
        "type": "json",
        "z": "72ea5fcb0b022fe1",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 450,
        "y": 740,
        "wires": [
            [
                "d4b49bc94f317197",
                "be12d3481b65aef4",
                "eebe47aca36fb577"
            ]
        ]
    },
    {
        "id": "fa4ff7af71006060",
        "type": "mongodb out",
        "z": "72ea5fcb0b022fe1",
        "mongodb": "96e271eba0b52a94",
        "name": "",
        "collection": "records_cara003",
        "payonly": true,
        "upsert": false,
        "multi": false,
        "operation": "store",
        "x": 1380,
        "y": 460,
        "wires": []
    },
    {
        "id": "533be197ee698298",
        "type": "function",
        "z": "72ea5fcb0b022fe1",
        "name": "+ fecha",
        "func": "msg.payload.date = new Date();\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 760,
        "y": 460,
        "wires": [
            [
                "fa4ff7af71006060"
            ]
        ]
    },
    {
        "id": "48ccd2eb16d7d281",
        "type": "mongodb in",
        "z": "72ea5fcb0b022fe1",
        "mongodb": "96e271eba0b52a94",
        "name": "",
        "collection": "records_cara003",
        "operation": "find",
        "x": 640,
        "y": 580,
        "wires": [
            [
                "a02e951529342c38",
                "0c66d54ac2cb33ee"
            ]
        ]
    },
    {
        "id": "a02e951529342c38",
        "type": "function",
        "z": "72ea5fcb0b022fe1",
        "name": "genera datos gráfica",
        "func": "var arraytiempo=[];\nvar arrayaciertos=[];\n\n// los arrays usados en la represenstación gráfica deben contener objetos JSON con dos campos: {x , y}\n// en x debemos poner la hora en formato \"timestamp\". Si tenemos un objeto fecha se puede convertir usando el método getTime()\n// en y debemos poner el valor de la variable\n// mas info en: https://github.com/node-red/node-red-dashboard/blob/master/Charts.md\n\nif(Array.isArray(msg.payload) && msg.payload.length>0)\n{\n    for (var i = 0; i < msg.payload.length; i++) { // añade datos a los arrays\n        //arraytiempo.push({x : msg.payload[i].date.getTime() , y : msg.payload[i].tiempo_partida_actual});\n        arraytiempo.push({x : Math.trunc(msg.payload[i].tiempo_partida_total/1000) , y : msg.payload[i].aciertos_por_partida});\n        //arrayaciertos.push({x : msg.payload[i].date.getTime() , y : msg.payload[i].aciertos_por_partida});\n    }\n}\n    \nmsg.payload = [{\n        //\"series\":[\"Tiempo_partida_actual\",\"Aciertos_por_partida\"],\n        //\"data\":[arraytiempo, arrayaciertos],\n        \"series\":[\"Aciertos_por_partida\"],\n        \"data\":[arraytiempo],\n        \"labels\":[\"\"]\n        }];\n\nreturn msg;  ",
        "outputs": "1",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1040,
        "y": 580,
        "wires": [
            [
                "88af94195d1aef44",
                "8255e48346b2b242"
            ]
        ]
    },
    {
        "id": "88af94195d1aef44",
        "type": "ui_chart",
        "z": "72ea5fcb0b022fe1",
        "name": "",
        "group": "f870df7d6c3cc2e9",
        "order": 6,
        "width": 0,
        "height": 0,
        "label": "Registro resultados",
        "chartType": "line",
        "legend": "true",
        "xformat": "auto",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "0",
        "ymax": "20",
        "removeOlder": "10",
        "removeOlderPoints": "",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1410,
        "y": 580,
        "wires": [
            []
        ]
    },
    {
        "id": "56e2082898110e66",
        "type": "function",
        "z": "72ea5fcb0b022fe1",
        "name": "",
        "func": "msg.sort = {\"date\" : -1}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 380,
        "y": 580,
        "wires": [
            [
                "48ccd2eb16d7d281"
            ]
        ]
    },
    {
        "id": "ad7db8353ffabfd1",
        "type": "ui_button",
        "z": "72ea5fcb0b022fe1",
        "name": "",
        "group": "f870df7d6c3cc2e9",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Ver resultados",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "{ }",
        "payloadType": "json",
        "topic": "topic",
        "topicType": "str",
        "x": 180,
        "y": 580,
        "wires": [
            [
                "56e2082898110e66"
            ]
        ]
    },
    {
        "id": "0c66d54ac2cb33ee",
        "type": "debug",
        "z": "72ea5fcb0b022fe1",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 850,
        "y": 620,
        "wires": []
    },
    {
        "id": "8255e48346b2b242",
        "type": "debug",
        "z": "72ea5fcb0b022fe1",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1230,
        "y": 620,
        "wires": []
    },
    {
        "id": "d7b279830c877d20",
        "type": "debug",
        "z": "72ea5fcb0b022fe1",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 750,
        "y": 220,
        "wires": []
    },
    {
        "id": "4c63f309e596ec62",
        "type": "mqtt out",
        "z": "72ea5fcb0b022fe1",
        "name": "",
        "topic": "II3/ESP14440037/datos_juego2",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "2b251178.95ad2e",
        "x": 1370,
        "y": 780,
        "wires": []
    },
    {
        "id": "0fa8f0d66dddee5f",
        "type": "mqtt out",
        "z": "72ea5fcb0b022fe1",
        "name": "",
        "topic": "II3/ESP14440037/datos_juego2",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "2b251178.95ad2e",
        "x": 1170,
        "y": 180,
        "wires": []
    },
    {
        "id": "be12d3481b65aef4",
        "type": "debug",
        "z": "72ea5fcb0b022fe1",
        "name": "debug 32",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 580,
        "y": 680,
        "wires": []
    },
    {
        "id": "eebe47aca36fb577",
        "type": "change",
        "z": "72ea5fcb0b022fe1",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.clock",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 780,
        "y": 700,
        "wires": [
            []
        ]
    },
    {
        "id": "f016bc1d142a0eb9",
        "type": "function",
        "z": "90d9a362f6d9804b",
        "name": "Mensaje: Inicia el juego",
        "func": "msg.payload = \"El juego 5 ha comenzado!\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 430,
        "y": 180,
        "wires": [
            [
                "faf8321602dd30ff"
            ]
        ]
    },
    {
        "id": "254398daec3d12f8",
        "type": "change",
        "z": "90d9a362f6d9804b",
        "name": "Get puzzle",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload[0].content",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1450,
        "y": 300,
        "wires": [
            [
                "c5e7218cb59fa9d3"
            ]
        ]
    },
    {
        "id": "a850f82e9954bb89",
        "type": "complete",
        "z": "90d9a362f6d9804b",
        "name": "",
        "scope": [
            "3ec53b27288a9a62"
        ],
        "uncaught": false,
        "x": 90,
        "y": 320,
        "wires": [
            [
                "c3838804c8c01f86"
            ]
        ]
    },
    {
        "id": "3ec53b27288a9a62",
        "type": "function",
        "z": "90d9a362f6d9804b",
        "name": "Instrucciones",
        "func": "msg.payload = \"\\nInstrucciones del juego...\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 730,
        "y": 240,
        "wires": [
            [
                "d6f32d6ac4060582"
            ]
        ]
    },
    {
        "id": "aa44cd521da0e858",
        "type": "complete",
        "z": "90d9a362f6d9804b",
        "name": "",
        "scope": [
            "f016bc1d142a0eb9"
        ],
        "uncaught": false,
        "x": 90,
        "y": 240,
        "wires": [
            [
                "6b12b87a295902d0"
            ]
        ]
    },
    {
        "id": "26ed1fe739c0b74d",
        "type": "change",
        "z": "90d9a362f6d9804b",
        "name": "Get ans",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload[0].ans",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1260,
        "y": 340,
        "wires": [
            [
                "a6738fb75a8ff60d"
            ]
        ]
    },
    {
        "id": "6b12b87a295902d0",
        "type": "delay",
        "z": "90d9a362f6d9804b",
        "name": "",
        "pauseType": "delay",
        "timeout": "3",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 380,
        "y": 240,
        "wires": [
            [
                "3ec53b27288a9a62"
            ]
        ]
    },
    {
        "id": "65e18ee7ce830848",
        "type": "mqtt in",
        "z": "90d9a362f6d9804b",
        "name": "",
        "topic": "II3/ESP005/pub/cara005",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "2b251178.95ad2e",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 130,
        "y": 400,
        "wires": [
            [
                "c78a643484dd5c49",
                "a29f543e4a245926",
                "b002e99671ded181"
            ]
        ]
    },
    {
        "id": "c51e4f5a395e6c02",
        "type": "delay",
        "z": "90d9a362f6d9804b",
        "name": "",
        "pauseType": "delay",
        "timeout": "3",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1260,
        "y": 300,
        "wires": [
            [
                "254398daec3d12f8"
            ]
        ]
    },
    {
        "id": "faf8321602dd30ff",
        "type": "link out",
        "z": "90d9a362f6d9804b",
        "name": "link out 22",
        "mode": "link",
        "links": [
            "3b61f394285ac503"
        ],
        "x": 1585,
        "y": 180,
        "wires": []
    },
    {
        "id": "3b61f394285ac503",
        "type": "link in",
        "z": "90d9a362f6d9804b",
        "name": "link in 31",
        "links": [
            "faf8321602dd30ff",
            "d6f32d6ac4060582",
            "c5e7218cb59fa9d3"
        ],
        "x": 1675,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "d6f32d6ac4060582",
        "type": "link out",
        "z": "90d9a362f6d9804b",
        "name": "link out 23",
        "mode": "link",
        "links": [
            "3b61f394285ac503"
        ],
        "x": 1585,
        "y": 240,
        "wires": []
    },
    {
        "id": "c5e7218cb59fa9d3",
        "type": "link out",
        "z": "90d9a362f6d9804b",
        "name": "link out 24",
        "mode": "link",
        "links": [
            "3b61f394285ac503"
        ],
        "x": 1585,
        "y": 300,
        "wires": []
    },
    {
        "id": "a6738fb75a8ff60d",
        "type": "mqtt out",
        "z": "90d9a362f6d9804b",
        "name": "",
        "topic": "II3/ESP005/cmd/cara005",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "2b251178.95ad2e",
        "x": 1490,
        "y": 340,
        "wires": []
    },
    {
        "id": "c78a643484dd5c49",
        "type": "change",
        "z": "90d9a362f6d9804b",
        "name": "State",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.state",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 370,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "a29f543e4a245926",
        "type": "change",
        "z": "90d9a362f6d9804b",
        "name": "Clock",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.clock",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 370,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "b002e99671ded181",
        "type": "debug",
        "z": "90d9a362f6d9804b",
        "name": "debug 29",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 380,
        "y": 440,
        "wires": []
    },
    {
        "id": "d626c2214f59ffb5",
        "type": "mongodb in",
        "z": "90d9a362f6d9804b",
        "mongodb": "96e271eba0b52a94",
        "name": "",
        "collection": "recursos_de_las_pruebas",
        "operation": "aggregate",
        "x": 930,
        "y": 320,
        "wires": [
            [
                "c51e4f5a395e6c02",
                "26ed1fe739c0b74d"
            ]
        ]
    },
    {
        "id": "c3838804c8c01f86",
        "type": "function",
        "z": "90d9a362f6d9804b",
        "name": "Recupera una secuencia aleatoria de la base de datos",
        "func": "msg.payload = [{ $match: { \"filename\": \"secuencias_cara005.json\" }},\n                { $unwind: \"$payload\" },\n                { \"$sample\": { \"size\": 1 } },\n                { $replaceRoot: { newRoot: \"$payload\" } }];\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 520,
        "y": 320,
        "wires": [
            [
                "d626c2214f59ffb5"
            ]
        ]
    },
    {
        "id": "f3dc491e67b9826c",
        "type": "function",
        "z": "7e2a7678166f609f",
        "name": "msg 1",
        "func": "msg.payload = global.get(\"user\");\nif(msg.payload.content.substring(0,1)!=\"/\")\n{\n    msg.payload.content = \"¡Bienvenidos a \\\"La Caja\\\"! Soy Chiquito de la Calzada, el bot encargado de guiaros en este juego creado por Google.\";\n return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 370,
        "y": 80,
        "wires": [
            [
                "9943bdf78bf74fd9",
                "34d88de82163e7b8",
                "6e79899d3c75578d"
            ]
        ]
    },
    {
        "id": "39bea2a6fd0e8709",
        "type": "function",
        "z": "7e2a7678166f609f",
        "name": "msg 2",
        "func": "msg.payload = global.get(\"user\");\nif(msg.payload.content.substring(0,1)!=\"/\")\n{\n    msg.payload.content = \"Estamos buscando ingenieros talentosos para nuestro nuevo centro en Málaga. Hemos creado este juego para poner a prueba vuestras habilidades.\";\n return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 370,
        "y": 160,
        "wires": [
            [
                "5d0cc38a34c5db1c",
                "636e8ac26caacaca",
                "7e2486afa05a2895"
            ]
        ]
    },
    {
        "id": "def0734b13b7a1c1",
        "type": "function",
        "z": "7e2a7678166f609f",
        "name": "msg 3",
        "func": "msg.payload = global.get(\"user\");\nif(msg.payload.content.substring(0,1)!=\"/\")\n{\n    msg.payload.content = \"En este juego, os enfrentaréis a pruebas de lógica y pensamiento lateral utilizando los sensores y actuadores disponibles en la caja.\";\n return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 370,
        "y": 240,
        "wires": [
            [
                "344c56729b021957",
                "f1ed81c15fe8f86c",
                "dece2e4abcf4790c"
            ]
        ]
    },
    {
        "id": "344c56729b021957",
        "type": "delay",
        "z": "7e2a7678166f609f",
        "name": "",
        "pauseType": "random",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "5",
        "randomLast": "15",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 200,
        "y": 320,
        "wires": [
            [
                "030631861963728b"
            ]
        ]
    },
    {
        "id": "030631861963728b",
        "type": "function",
        "z": "7e2a7678166f609f",
        "name": "msg 4",
        "func": "msg.payload = global.get(\"user\");\nif(msg.payload.content.substring(0,1)!=\"/\")\n{\n    msg.payload.content = \"Si necesitáis ayuda, no dudéis en poneros en contacto conmigo a través de Telegram.\";\n return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 320,
        "wires": [
            [
                "e6ff3aa647233dec",
                "8b518044c9524902",
                "76c6bedb812967f7"
            ]
        ]
    },
    {
        "id": "a85c4273e4db8289",
        "type": "function",
        "z": "7e2a7678166f609f",
        "name": "msg 5",
        "func": "msg.payload = global.get(\"user\");\nif(msg.payload.content.substring(0,1)!=\"/\")\n{\n    msg.payload.content = \"¡Espero que disfrutéis del juego y que demostréis vuestras habilidades como ingenieros!\";\n return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 400,
        "wires": [
            [
                "915c07d21e2c4676",
                "667ef464ef444ba1",
                "097a151d94afedf3"
            ]
        ]
    },
    {
        "id": "b876d33393c76d7e",
        "type": "function",
        "z": "7e2a7678166f609f",
        "name": "msg 6",
        "func": "msg.payload = global.get(\"user\");\nif(msg.payload.content.substring(0,1)!=\"/\")\n{\n    msg.payload.content = \"¡Buena suerte a todos! Hasta luego Lucas.\";\n return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 350,
        "y": 480,
        "wires": [
            [
                "d6f79670b4ba8fe4",
                "2a3a3cd156e72cee"
            ]
        ]
    },
    {
        "id": "9943bdf78bf74fd9",
        "type": "delay",
        "z": "7e2a7678166f609f",
        "name": "",
        "pauseType": "random",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "5",
        "randomLast": "15",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 220,
        "y": 160,
        "wires": [
            [
                "39bea2a6fd0e8709"
            ]
        ]
    },
    {
        "id": "5d0cc38a34c5db1c",
        "type": "delay",
        "z": "7e2a7678166f609f",
        "name": "",
        "pauseType": "random",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "5",
        "randomLast": "15",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 200,
        "y": 240,
        "wires": [
            [
                "def0734b13b7a1c1"
            ]
        ]
    },
    {
        "id": "e6ff3aa647233dec",
        "type": "delay",
        "z": "7e2a7678166f609f",
        "name": "",
        "pauseType": "random",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "5",
        "randomLast": "15",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 200,
        "y": 400,
        "wires": [
            [
                "a85c4273e4db8289"
            ]
        ]
    },
    {
        "id": "915c07d21e2c4676",
        "type": "delay",
        "z": "7e2a7678166f609f",
        "name": "",
        "pauseType": "random",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "5",
        "randomLast": "15",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 200,
        "y": 480,
        "wires": [
            [
                "b876d33393c76d7e"
            ]
        ]
    },
    {
        "id": "4d8947e22371d07e",
        "type": "complete",
        "z": "7e2a7678166f609f",
        "name": "",
        "scope": [
            "76809f1a9b916a55"
        ],
        "uncaught": false,
        "x": 210,
        "y": 620,
        "wires": [
            [
                "2aacb55b03d625ef"
            ]
        ]
    },
    {
        "id": "2aacb55b03d625ef",
        "type": "delay",
        "z": "7e2a7678166f609f",
        "name": "",
        "pauseType": "random",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "4",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 400,
        "y": 620,
        "wires": [
            []
        ]
    },
    {
        "id": "2fe3574d1dffe3f1",
        "type": "function",
        "z": "7e2a7678166f609f",
        "name": "voide - msg 1",
        "func": "msg.payload.content = \"/home/rhyloo/nol/pics/mensaje1.wav\";\nmsg.payload.type = 'voice';\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 740,
        "y": 120,
        "wires": [
            [
                "3bd6a0917156869d"
            ]
        ]
    },
    {
        "id": "34d88de82163e7b8",
        "type": "delay",
        "z": "7e2a7678166f609f",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 560,
        "y": 120,
        "wires": [
            [
                "2fe3574d1dffe3f1"
            ]
        ]
    },
    {
        "id": "53fe3b5f5eab4862",
        "type": "link in",
        "z": "7e2a7678166f609f",
        "name": "link in 34",
        "links": [
            "6e79899d3c75578d",
            "3bd6a0917156869d",
            "494eb9bbef3fb728",
            "1e1008a25a016d28",
            "7af0be34fac5f0a3",
            "3005571e909bbfaf",
            "7279a0e62f34a89a",
            "7e2486afa05a2895",
            "dece2e4abcf4790c",
            "76c6bedb812967f7",
            "097a151d94afedf3",
            "2a3a3cd156e72cee"
        ],
        "x": 1265,
        "y": 300,
        "wires": [
            []
        ]
    },
    {
        "id": "6e79899d3c75578d",
        "type": "link out",
        "z": "7e2a7678166f609f",
        "name": "link out 30",
        "mode": "link",
        "links": [
            "53fe3b5f5eab4862"
        ],
        "x": 875,
        "y": 80,
        "wires": []
    },
    {
        "id": "3bd6a0917156869d",
        "type": "link out",
        "z": "7e2a7678166f609f",
        "name": "link out 31",
        "mode": "link",
        "links": [
            "53fe3b5f5eab4862"
        ],
        "x": 875,
        "y": 120,
        "wires": []
    },
    {
        "id": "46fb8e42bdd58c16",
        "type": "function",
        "z": "7e2a7678166f609f",
        "name": "voide - msg 2",
        "func": "msg.payload.content = \"/home/rhyloo/nol/pics/mensaje2.wav\";\nmsg.payload.type = 'voice';\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 740,
        "y": 200,
        "wires": [
            [
                "494eb9bbef3fb728"
            ]
        ]
    },
    {
        "id": "636e8ac26caacaca",
        "type": "delay",
        "z": "7e2a7678166f609f",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 560,
        "y": 200,
        "wires": [
            [
                "46fb8e42bdd58c16"
            ]
        ]
    },
    {
        "id": "494eb9bbef3fb728",
        "type": "link out",
        "z": "7e2a7678166f609f",
        "name": "link out 32",
        "mode": "link",
        "links": [
            "53fe3b5f5eab4862"
        ],
        "x": 875,
        "y": 200,
        "wires": []
    },
    {
        "id": "43caa776853b7933",
        "type": "function",
        "z": "7e2a7678166f609f",
        "name": "voide - msg 3",
        "func": "msg.payload.content = \"/home/rhyloo/nol/pics/mensaje3.wav\";\nmsg.payload.type = 'voice';\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 740,
        "y": 280,
        "wires": [
            [
                "1e1008a25a016d28"
            ]
        ]
    },
    {
        "id": "f1ed81c15fe8f86c",
        "type": "delay",
        "z": "7e2a7678166f609f",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 560,
        "y": 280,
        "wires": [
            [
                "43caa776853b7933"
            ]
        ]
    },
    {
        "id": "1e1008a25a016d28",
        "type": "link out",
        "z": "7e2a7678166f609f",
        "name": "link out 33",
        "mode": "link",
        "links": [
            "53fe3b5f5eab4862"
        ],
        "x": 875,
        "y": 280,
        "wires": []
    },
    {
        "id": "6ef0f673041aa04c",
        "type": "function",
        "z": "7e2a7678166f609f",
        "name": "voide - msg 4",
        "func": "msg.payload.content = \"/home/rhyloo/nol/pics/mensaje4.wav\";\nmsg.payload.type = 'voice';\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 740,
        "y": 360,
        "wires": [
            [
                "7af0be34fac5f0a3"
            ]
        ]
    },
    {
        "id": "8b518044c9524902",
        "type": "delay",
        "z": "7e2a7678166f609f",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 560,
        "y": 360,
        "wires": [
            [
                "6ef0f673041aa04c"
            ]
        ]
    },
    {
        "id": "7af0be34fac5f0a3",
        "type": "link out",
        "z": "7e2a7678166f609f",
        "name": "link out 34",
        "mode": "link",
        "links": [
            "53fe3b5f5eab4862"
        ],
        "x": 875,
        "y": 360,
        "wires": []
    },
    {
        "id": "3a49108706019dcd",
        "type": "function",
        "z": "7e2a7678166f609f",
        "name": "voide - msg 5",
        "func": "msg.payload.content = \"/home/rhyloo/nol/pics/mensaje5.wav\";\nmsg.payload.type = 'voice';\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 740,
        "y": 440,
        "wires": [
            [
                "3005571e909bbfaf"
            ]
        ]
    },
    {
        "id": "667ef464ef444ba1",
        "type": "delay",
        "z": "7e2a7678166f609f",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 560,
        "y": 440,
        "wires": [
            [
                "3a49108706019dcd"
            ]
        ]
    },
    {
        "id": "3005571e909bbfaf",
        "type": "link out",
        "z": "7e2a7678166f609f",
        "name": "link out 35",
        "mode": "link",
        "links": [
            "53fe3b5f5eab4862"
        ],
        "x": 875,
        "y": 440,
        "wires": []
    },
    {
        "id": "76809f1a9b916a55",
        "type": "function",
        "z": "7e2a7678166f609f",
        "name": "voide - msg 6",
        "func": "msg.payload.content = \"/home/rhyloo/nol/pics/mensaje6.wav\";\nmsg.payload.type = 'voice';\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 740,
        "y": 520,
        "wires": [
            [
                "7279a0e62f34a89a"
            ]
        ]
    },
    {
        "id": "d6f79670b4ba8fe4",
        "type": "delay",
        "z": "7e2a7678166f609f",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 560,
        "y": 520,
        "wires": [
            [
                "76809f1a9b916a55"
            ]
        ]
    },
    {
        "id": "7279a0e62f34a89a",
        "type": "link out",
        "z": "7e2a7678166f609f",
        "name": "link out 36",
        "mode": "link",
        "links": [
            "53fe3b5f5eab4862"
        ],
        "x": 875,
        "y": 520,
        "wires": []
    },
    {
        "id": "7e2486afa05a2895",
        "type": "link out",
        "z": "7e2a7678166f609f",
        "name": "link out 37",
        "mode": "link",
        "links": [
            "53fe3b5f5eab4862"
        ],
        "x": 875,
        "y": 160,
        "wires": []
    },
    {
        "id": "dece2e4abcf4790c",
        "type": "link out",
        "z": "7e2a7678166f609f",
        "name": "link out 38",
        "mode": "link",
        "links": [
            "53fe3b5f5eab4862"
        ],
        "x": 875,
        "y": 240,
        "wires": []
    },
    {
        "id": "76c6bedb812967f7",
        "type": "link out",
        "z": "7e2a7678166f609f",
        "name": "link out 39",
        "mode": "link",
        "links": [
            "53fe3b5f5eab4862"
        ],
        "x": 875,
        "y": 320,
        "wires": []
    },
    {
        "id": "097a151d94afedf3",
        "type": "link out",
        "z": "7e2a7678166f609f",
        "name": "link out 40",
        "mode": "link",
        "links": [
            "53fe3b5f5eab4862"
        ],
        "x": 875,
        "y": 400,
        "wires": []
    },
    {
        "id": "2a3a3cd156e72cee",
        "type": "link out",
        "z": "7e2a7678166f609f",
        "name": "link out 41",
        "mode": "link",
        "links": [
            "53fe3b5f5eab4862"
        ],
        "x": 875,
        "y": 480,
        "wires": []
    },
    {
        "id": "1e6ca6d375750aed",
        "type": "function",
        "z": "178fa897d7510777",
        "name": "Foto: Inicial del juego",
        "func": "msg.payload = global.get(\"user\");\nmsg.payload.content = \"/home/rhyloo/nol/pics/prueba1_preview.png\";\nmsg.payload.type = 'photo';\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 800,
        "y": 100,
        "wires": [
            [
                "daf32c42d50a5d7c",
                "f8b2d0572cf25250"
            ]
        ]
    },
    {
        "id": "2c5538c2a46cb659",
        "type": "mongodb in",
        "z": "178fa897d7510777",
        "mongodb": "96e271eba0b52a94",
        "name": "",
        "collection": "recursos_de_las_pruebas",
        "operation": "aggregate",
        "x": 890,
        "y": 360,
        "wires": [
            [
                "1c2d747a50f3c8bb"
            ]
        ]
    },
    {
        "id": "3d9cbd050ccf436b",
        "type": "function",
        "z": "178fa897d7510777",
        "name": "Recupera un acertijo aleatorio de la base de datos",
        "func": "msg.payload = [{ $match: { \"filename\": \"secuencias_cara004.json\" } },\n                { $unwind: \"$payload\" },\n                { \"$sample\": { \"size\": 1 } },\n                { $replaceRoot: { newRoot: \"$payload\" } }];\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 490,
        "y": 360,
        "wires": [
            [
                "2c5538c2a46cb659"
            ]
        ]
    },
    {
        "id": "e336a9f3ac958bdf",
        "type": "complete",
        "z": "178fa897d7510777",
        "name": "",
        "scope": [
            "c6c33e071b5ea97d"
        ],
        "uncaught": false,
        "x": 170,
        "y": 360,
        "wires": [
            [
                "3d9cbd050ccf436b"
            ]
        ]
    },
    {
        "id": "0f4bf996baac19e8",
        "type": "delay",
        "z": "178fa897d7510777",
        "name": "",
        "pauseType": "delay",
        "timeout": "3",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 380,
        "y": 220,
        "wires": [
            [
                "c6c33e071b5ea97d"
            ]
        ]
    },
    {
        "id": "053c5d8897190a89",
        "type": "mqtt in",
        "z": "178fa897d7510777",
        "name": "",
        "topic": "II3/ESP004/pub/cara004",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "2b251178.95ad2e",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 210,
        "y": 480,
        "wires": [
            [
                "b81126ae51b39355",
                "0aedc8df5c1d0937",
                "bb1fc23bb83a7812"
            ]
        ]
    },
    {
        "id": "21ae83aa8505a7b1",
        "type": "ui_text",
        "z": "178fa897d7510777",
        "group": "f870df7d6c3cc2e9",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Número introducido",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1730,
        "y": 440,
        "wires": []
    },
    {
        "id": "daf32c42d50a5d7c",
        "type": "link out",
        "z": "178fa897d7510777",
        "name": "link out 46",
        "mode": "link",
        "links": [
            "0a67632feb36fdf6"
        ],
        "x": 1805,
        "y": 100,
        "wires": []
    },
    {
        "id": "0a67632feb36fdf6",
        "type": "link in",
        "z": "178fa897d7510777",
        "name": "link in 35",
        "links": [
            "daf32c42d50a5d7c",
            "47cb9e7f26445191",
            "48ebca8d40b2da94",
            "6478e2ba3b14184c",
            "10da3a12949656e6",
            "f653e9d1a8043d06"
        ],
        "x": 2105,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "48ebca8d40b2da94",
        "type": "link out",
        "z": "178fa897d7510777",
        "name": "link out 47",
        "mode": "link",
        "links": [
            "0a67632feb36fdf6"
        ],
        "x": 1805,
        "y": 220,
        "wires": []
    },
    {
        "id": "4af6499201c53fd0",
        "type": "mqtt out",
        "z": "178fa897d7510777",
        "name": "",
        "topic": "II3/ESP004/cmd/cara004",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "2b251178.95ad2e",
        "x": 1710,
        "y": 360,
        "wires": []
    },
    {
        "id": "0aedc8df5c1d0937",
        "type": "change",
        "z": "178fa897d7510777",
        "name": "State",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.state",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 430,
        "y": 480,
        "wires": [
            [
                "2512bf06fd39160b"
            ]
        ]
    },
    {
        "id": "b81126ae51b39355",
        "type": "change",
        "z": "178fa897d7510777",
        "name": "Número",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.numero",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 440,
        "y": 440,
        "wires": [
            [
                "21ae83aa8505a7b1"
            ]
        ]
    },
    {
        "id": "bb1fc23bb83a7812",
        "type": "change",
        "z": "178fa897d7510777",
        "name": "Clock",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.clock",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 430,
        "y": 520,
        "wires": [
            []
        ]
    },
    {
        "id": "58f3565941639bda",
        "type": "delay",
        "z": "178fa897d7510777",
        "name": "",
        "pauseType": "delay",
        "timeout": "3",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 380,
        "y": 280,
        "wires": [
            [
                "378b8bfcc6014df3"
            ]
        ]
    },
    {
        "id": "6478e2ba3b14184c",
        "type": "link out",
        "z": "178fa897d7510777",
        "name": "link out 49",
        "mode": "link",
        "links": [
            "0a67632feb36fdf6"
        ],
        "x": 1805,
        "y": 280,
        "wires": []
    },
    {
        "id": "378b8bfcc6014df3",
        "type": "function",
        "z": "178fa897d7510777",
        "name": "+Instrucciones",
        "func": "msg.payload = global.get(\"user\");\nmsg.payload.content= \"El acertijo es el siguiente: \";\nmsg.payload.type = \"message\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 780,
        "y": 280,
        "wires": [
            [
                "6478e2ba3b14184c"
            ]
        ]
    },
    {
        "id": "c6c33e071b5ea97d",
        "type": "function",
        "z": "178fa897d7510777",
        "name": "Instrucciones",
        "func": "msg.payload = global.get(\"user\");\nmsg.payload.content = \"Recordad que podéis utilizar el botón de \\\"Pista\\\" para obtener una pista adicional. ¡Buena suerte a todos!\";\nmsg.payload.type = \"message\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 770,
        "y": 220,
        "wires": [
            [
                "48ebca8d40b2da94",
                "58f3565941639bda"
            ]
        ]
    },
    {
        "id": "16345e0ca4093a39",
        "type": "function",
        "z": "178fa897d7510777",
        "name": "Mensaje: Inicia el juego",
        "func": "msg.payload = global.get(\"user\");\nmsg.payload.type = \"message\";\nmsg.payload.content = \"¡Bienvenidos a la primera prueba de \\\"La Caja\\\"! Para resolver esta prueba, tendréis que utilizar el numpad disponible en la caja para introducir un número de dos dígitos.\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 810,
        "y": 160,
        "wires": [
            [
                "47cb9e7f26445191",
                "0f4bf996baac19e8"
            ]
        ]
    },
    {
        "id": "47cb9e7f26445191",
        "type": "link out",
        "z": "178fa897d7510777",
        "name": "link out 50",
        "mode": "link",
        "links": [
            "0a67632feb36fdf6"
        ],
        "x": 1805,
        "y": 160,
        "wires": []
    },
    {
        "id": "f8b2d0572cf25250",
        "type": "delay",
        "z": "178fa897d7510777",
        "name": "",
        "pauseType": "delay",
        "timeout": "3",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 380,
        "y": 160,
        "wires": [
            [
                "16345e0ca4093a39"
            ]
        ]
    },
    {
        "id": "2512bf06fd39160b",
        "type": "function",
        "z": "178fa897d7510777",
        "name": "terminado?",
        "func": "if (msg.payload == 2){\n    return msg;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 770,
        "y": 640,
        "wires": [
            [
                "284c066dd6754ae0"
            ]
        ]
    },
    {
        "id": "284c066dd6754ae0",
        "type": "function",
        "z": "178fa897d7510777",
        "name": "Mensaje: Inicia el juego",
        "func": "msg.payload = global.get(\"user\");\nmsg.payload.type = \"message\";\nmsg.payload.content = \"¡Felicidades por haber pasado la primera prueba de \\\"La Caja\\\"! Estamos impresionados por vuestra habilidad para resolver el acertijo.\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 990,
        "y": 640,
        "wires": [
            [
                "10da3a12949656e6",
                "360ddd442ecb1a62"
            ]
        ]
    },
    {
        "id": "10da3a12949656e6",
        "type": "link out",
        "z": "178fa897d7510777",
        "name": "link out 51",
        "mode": "link",
        "links": [
            "0a67632feb36fdf6"
        ],
        "x": 1805,
        "y": 640,
        "wires": []
    },
    {
        "id": "bde6d9327d460e23",
        "type": "function",
        "z": "178fa897d7510777",
        "name": "Mensaje: Inicia el juego",
        "func": "msg.payload = global.get(\"user\");\nmsg.payload.type = \"message\";\nmsg.payload.content = \"Estamos seguros de que seguiréis demostrando vuestras habilidades a lo largo del juego. ¡Seguid adelante y no dejéis que nada os detenga! ¡Buena suerte en la siguiente prueba!\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1150,
        "y": 700,
        "wires": [
            [
                "f653e9d1a8043d06"
            ]
        ]
    },
    {
        "id": "360ddd442ecb1a62",
        "type": "delay",
        "z": "178fa897d7510777",
        "name": "",
        "pauseType": "delay",
        "timeout": "3",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 940,
        "y": 700,
        "wires": [
            [
                "bde6d9327d460e23"
            ]
        ]
    },
    {
        "id": "f653e9d1a8043d06",
        "type": "link out",
        "z": "178fa897d7510777",
        "name": "link out 52",
        "mode": "link",
        "links": [
            "0a67632feb36fdf6"
        ],
        "x": 1805,
        "y": 700,
        "wires": []
    },
    {
        "id": "1c2d747a50f3c8bb",
        "type": "function",
        "z": "178fa897d7510777",
        "name": "function 24",
        "func": "var content = msg.payload[0].content;\nvar ans = msg.payload[0].ans;\nmsg.payload = { \"content\":  content, \"ans\": ans};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1290,
        "y": 360,
        "wires": [
            [
                "4af6499201c53fd0"
            ]
        ]
    },
    {
        "id": "fab9f543e0403ab1",
        "type": "debug",
        "z": "7a2a228bff5f9b1b",
        "g": "452dfd544fc2fce6",
        "name": "debug 1",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 440,
        "y": 80,
        "wires": []
    },
    {
        "id": "8326e82b99489bb5",
        "type": "mqtt in",
        "z": "7a2a228bff5f9b1b",
        "g": "452dfd544fc2fce6",
        "name": "",
        "topic": "infind/ESP_00000001/pub",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "64cdcf7a3b4cd223",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 190,
        "y": 80,
        "wires": [
            [
                "fab9f543e0403ab1"
            ]
        ]
    },
    {
        "id": "a34d3f97dab4e0b5",
        "type": "mqtt out",
        "z": "7a2a228bff5f9b1b",
        "g": "452dfd544fc2fce6",
        "name": "",
        "topic": "infind/ESP_00000001/sub",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "64cdcf7a3b4cd223",
        "x": 410,
        "y": 240,
        "wires": []
    },
    {
        "id": "c876d0cdc773ea9e",
        "type": "inject",
        "z": "7a2a228bff5f9b1b",
        "g": "452dfd544fc2fce6",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "num",
        "x": 170,
        "y": 240,
        "wires": [
            [
                "a34d3f97dab4e0b5"
            ]
        ]
    },
    {
        "id": "5753c128a2592add",
        "type": "inject",
        "z": "7a2a228bff5f9b1b",
        "g": "452dfd544fc2fce6",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "0",
        "payloadType": "num",
        "x": 170,
        "y": 200,
        "wires": [
            [
                "a34d3f97dab4e0b5"
            ]
        ]
    },
    {
        "id": "6ba3d2865f3abca3",
        "type": "inject",
        "z": "7a2a228bff5f9b1b",
        "g": "452dfd544fc2fce6",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "lala",
        "payload": "0",
        "payloadType": "num",
        "x": 170,
        "y": 280,
        "wires": [
            [
                "a34d3f97dab4e0b5"
            ]
        ]
    },
    {
        "id": "9e35842b2b180fca",
        "type": "inject",
        "z": "7a2a228bff5f9b1b",
        "g": "452dfd544fc2fce6",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "lala",
        "payload": "1",
        "payloadType": "num",
        "x": 170,
        "y": 320,
        "wires": [
            [
                "a34d3f97dab4e0b5"
            ]
        ]
    },
    {
        "id": "78fe538a23f071e7",
        "type": "inject",
        "z": "7a2a228bff5f9b1b",
        "g": "452dfd544fc2fce6",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 160,
        "wires": [
            [
                "a34d3f97dab4e0b5",
                "fab9f543e0403ab1"
            ]
        ]
    },
    {
        "id": "b316f3404ef1283f",
        "type": "comment",
        "z": "7a2a228bff5f9b1b",
        "g": "452dfd544fc2fce6",
        "name": "He probado este archivo en casa y en clase, el ID_PLACA ha cambiado, por lo tanto depende de la red, en el código .ino lo he fijado.",
        "info": "",
        "x": 540,
        "y": 360,
        "wires": []
    },
    {
        "id": "fd3917170b43836c",
        "type": "comment",
        "z": "7a2a228bff5f9b1b",
        "g": "452dfd544fc2fce6",
        "name": "Para facilitar la correción.",
        "info": "",
        "x": 210,
        "y": 400,
        "wires": []
    },
    {
        "id": "aa30d7aefdb74982",
        "type": "mqtt in",
        "z": "7a2a228bff5f9b1b",
        "g": "34554487634f6a45",
        "name": "",
        "topic": "infind/ESP_00000001/pub/Jorge/temperatura",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "64cdcf7a3b4cd223",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 1270,
        "y": 120,
        "wires": [
            [
                "fee945a41a9eecb2",
                "16521c764bb85856"
            ]
        ]
    },
    {
        "id": "5d05ec264c0d4f29",
        "type": "change",
        "z": "7a2a228bff5f9b1b",
        "g": "db1bd864885aa917",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "humedad",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1490,
        "y": 260,
        "wires": [
            [
                "0ad1a470a6d2e0e6"
            ]
        ]
    },
    {
        "id": "0ad1a470a6d2e0e6",
        "type": "ui_gauge",
        "z": "7a2a228bff5f9b1b",
        "g": "db1bd864885aa917",
        "name": "",
        "group": "d20b3cd14e645d48",
        "order": 1,
        "width": 0,
        "height": 0,
        "gtype": "wave",
        "title": "Humedad",
        "label": "%",
        "format": "{{value}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 1760,
        "y": 260,
        "wires": []
    },
    {
        "id": "ea496d37ceabf649",
        "type": "change",
        "z": "7a2a228bff5f9b1b",
        "g": "db1bd864885aa917",
        "name": "Humedad",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.humedad",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1240,
        "y": 260,
        "wires": [
            [
                "5d05ec264c0d4f29"
            ]
        ]
    },
    {
        "id": "dce7eac07dc32b17",
        "type": "function",
        "z": "7a2a228bff5f9b1b",
        "g": "38bcaac5dd6d8ec9",
        "name": "",
        "func": "msg.topic = \"temperatura\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1520,
        "y": 460,
        "wires": [
            [
                "191304c6c3d76777"
            ]
        ]
    },
    {
        "id": "a42e30e862124474",
        "type": "ui_text",
        "z": "7a2a228bff5f9b1b",
        "g": "38bcaac5dd6d8ec9",
        "group": "8a548b476cc419b4",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Hora de recepción",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1710,
        "y": 500,
        "wires": []
    },
    {
        "id": "ab6c8a8815fd51b8",
        "type": "function",
        "z": "7a2a228bff5f9b1b",
        "g": "38bcaac5dd6d8ec9",
        "name": "",
        "func": "var fecha = new Date();\n\nmsg.payload = fecha.toLocaleString('es-ES', { timeZone: 'Europe/Madrid', hour12: false });\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1520,
        "y": 500,
        "wires": [
            [
                "a42e30e862124474"
            ]
        ]
    },
    {
        "id": "d0368dc15927f780",
        "type": "smooth",
        "z": "7a2a228bff5f9b1b",
        "g": "38bcaac5dd6d8ec9",
        "name": "",
        "property": "payload",
        "action": "mean",
        "count": "6",
        "round": "2",
        "mult": "single",
        "reduce": false,
        "x": 1320,
        "y": 620,
        "wires": [
            [
                "efae4a070823fb92"
            ]
        ]
    },
    {
        "id": "b238e7e06b0e188b",
        "type": "ui_chart",
        "z": "7a2a228bff5f9b1b",
        "g": "38bcaac5dd6d8ec9",
        "name": "",
        "group": "8a548b476cc419b4",
        "order": 3,
        "width": 0,
        "height": 0,
        "label": "Temperatura (ºC)",
        "chartType": "line",
        "legend": "true",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1730,
        "y": 540,
        "wires": [
            []
        ]
    },
    {
        "id": "742362ab6ac163d5",
        "type": "inject",
        "z": "7a2a228bff5f9b1b",
        "g": "38bcaac5dd6d8ec9",
        "name": "Reset chart",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "[ ]",
        "payloadType": "json",
        "x": 1510,
        "y": 540,
        "wires": [
            [
                "b238e7e06b0e188b"
            ]
        ]
    },
    {
        "id": "54c11767c002873f",
        "type": "change",
        "z": "7a2a228bff5f9b1b",
        "g": "38bcaac5dd6d8ec9",
        "name": "Actual",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "temperatura_actual",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1310,
        "y": 580,
        "wires": [
            [
                "d0368dc15927f780",
                "ba4a596c15e39c03"
            ]
        ]
    },
    {
        "id": "191304c6c3d76777",
        "type": "ui_gauge",
        "z": "7a2a228bff5f9b1b",
        "g": "38bcaac5dd6d8ec9",
        "name": "",
        "group": "8a548b476cc419b4",
        "order": 2,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Temperatura",
        "label": "ºC",
        "format": "{{value | number:1}}",
        "min": "-5",
        "max": "50",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 1750,
        "y": 460,
        "wires": []
    },
    {
        "id": "efae4a070823fb92",
        "type": "change",
        "z": "7a2a228bff5f9b1b",
        "g": "38bcaac5dd6d8ec9",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "temperatura_media",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1330,
        "y": 660,
        "wires": [
            [
                "ba4a596c15e39c03"
            ]
        ]
    },
    {
        "id": "ba4a596c15e39c03",
        "type": "function",
        "z": "7a2a228bff5f9b1b",
        "g": "38bcaac5dd6d8ec9",
        "name": "Diferencia actual y media",
        "func": "var msg1 = {};\nvar msg2 = {};\nvar msg3 = {};\ncontext.data = context.data || {};\nswitch (msg.topic){\n    case \"temperatura_media\":\n        context.data.temperatura_media = msg.payload;\n        msg = null;\n        break;\n    case \"temperatura_actual\":\n        context.data.temperatura_actual = msg.payload;\n        msg = null;\n        break;\n    default:\n        msg = null;\n        break;\n}\n\nif (context.data.temperatura_actual != null && context.data.temperatura_media != null){\n    msg1.payload = Math.abs(context.data.temperatura_actual-context.data.temperatura_media);\n    msg1.topic = \"Diferencia\";\n    msg2.payload = context.data.temperatura_actual;\n    msg2.topic = \"Actual\";\n    msg3.payload = context.data.temperatura_media;\n    msg3.topic = \"Media\";\n    context.data = null;\n    return [msg1, msg2, msg3];\n}else {return msg;}",
        "outputs": 3,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1550,
        "y": 620,
        "wires": [
            [
                "b238e7e06b0e188b"
            ],
            [
                "b238e7e06b0e188b"
            ],
            [
                "b238e7e06b0e188b"
            ]
        ]
    },
    {
        "id": "91eefba7a4f0d452",
        "type": "change",
        "z": "7a2a228bff5f9b1b",
        "g": "38bcaac5dd6d8ec9",
        "name": "Temperatura",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.temperatura",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1250,
        "y": 460,
        "wires": [
            [
                "dce7eac07dc32b17",
                "ab6c8a8815fd51b8",
                "54c11767c002873f"
            ]
        ]
    },
    {
        "id": "fee945a41a9eecb2",
        "type": "link out",
        "z": "7a2a228bff5f9b1b",
        "g": "34554487634f6a45",
        "name": "Salida_json_tarea_4",
        "mode": "link",
        "links": [
            "851d52f94e9f7558",
            "d1b6cec415033237",
            "cb6a1b1593dc14b4"
        ],
        "x": 1805,
        "y": 120,
        "wires": []
    },
    {
        "id": "d1b6cec415033237",
        "type": "link in",
        "z": "7a2a228bff5f9b1b",
        "g": "db1bd864885aa917",
        "name": "link in 1",
        "links": [
            "fee945a41a9eecb2"
        ],
        "x": 1115,
        "y": 260,
        "wires": [
            [
                "ea496d37ceabf649"
            ]
        ]
    },
    {
        "id": "851d52f94e9f7558",
        "type": "link in",
        "z": "7a2a228bff5f9b1b",
        "g": "38bcaac5dd6d8ec9",
        "name": "link in 2",
        "links": [
            "fee945a41a9eecb2"
        ],
        "x": 1115,
        "y": 460,
        "wires": [
            [
                "91eefba7a4f0d452"
            ]
        ]
    },
    {
        "id": "798d321a5f3e32b9",
        "type": "change",
        "z": "7a2a228bff5f9b1b",
        "g": "f7bbbf759c1035c6",
        "name": "Humedad",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.sensacion_termica",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1240,
        "y": 360,
        "wires": [
            [
                "ad58e3efea64f3b2"
            ]
        ]
    },
    {
        "id": "cb6a1b1593dc14b4",
        "type": "link in",
        "z": "7a2a228bff5f9b1b",
        "g": "f7bbbf759c1035c6",
        "name": "link in 3",
        "links": [
            "fee945a41a9eecb2"
        ],
        "x": 1115,
        "y": 360,
        "wires": [
            [
                "798d321a5f3e32b9"
            ]
        ]
    },
    {
        "id": "ad58e3efea64f3b2",
        "type": "change",
        "z": "7a2a228bff5f9b1b",
        "g": "f7bbbf759c1035c6",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "sensacion_termica",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1490,
        "y": 360,
        "wires": [
            [
                "081e229272675cc3"
            ]
        ]
    },
    {
        "id": "081e229272675cc3",
        "type": "ui_gauge",
        "z": "7a2a228bff5f9b1b",
        "g": "f7bbbf759c1035c6",
        "name": "",
        "group": "e968a1c70a34a463",
        "order": 4,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Sensación térmica",
        "label": "ºC",
        "format": "{{value | number:1}}",
        "min": "-5",
        "max": "50",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 1730,
        "y": 360,
        "wires": []
    },
    {
        "id": "16521c764bb85856",
        "type": "debug",
        "z": "7a2a228bff5f9b1b",
        "g": "34554487634f6a45",
        "name": "debug 2",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1740,
        "y": 160,
        "wires": []
    },
    {
        "id": "7a9e114d8c8121d4",
        "type": "mqtt in",
        "z": "28aa48179e689485",
        "g": "270307f35f30c014",
        "name": "",
        "topic": "iot/datos/json",
        "qos": "2",
        "datatype": "auto",
        "broker": "6ac432b491b7d6fc",
        "nl": false,
        "rap": false,
        "inputs": 0,
        "x": 130,
        "y": 80,
        "wires": [
            [
                "d2b5378f006dcf82"
            ]
        ]
    },
    {
        "id": "d2b5378f006dcf82",
        "type": "json",
        "z": "28aa48179e689485",
        "g": "270307f35f30c014",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 290,
        "y": 80,
        "wires": [
            [
                "69f48efb3ed2e9a2"
            ]
        ]
    },
    {
        "id": "fb7010822d6bb986",
        "type": "debug",
        "z": "28aa48179e689485",
        "g": "270307f35f30c014",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 690,
        "y": 180,
        "wires": []
    },
    {
        "id": "20f183d859f029d5",
        "type": "mongodb out",
        "z": "28aa48179e689485",
        "g": "270307f35f30c014",
        "mongodb": "ca0dd972168dc6a0",
        "name": "",
        "collection": "datos",
        "payonly": true,
        "upsert": false,
        "multi": false,
        "operation": "store",
        "x": 750,
        "y": 100,
        "wires": []
    },
    {
        "id": "9300db5867473dfb",
        "type": "mongodb in",
        "z": "28aa48179e689485",
        "g": "a30b6d8ea68c3596",
        "mongodb": "05cea6759e795a87",
        "name": "",
        "collection": "datos",
        "operation": "find",
        "x": 540,
        "y": 1040,
        "wires": [
            [
                "8a9296b558c17ba2"
            ]
        ]
    },
    {
        "id": "49012e8e0c0c4162",
        "type": "inject",
        "z": "28aa48179e689485",
        "g": "a30b6d8ea68c3596",
        "name": "",
        "props": [
            {
                "p": "payload",
                "v": "{ }",
                "vt": "json"
            },
            {
                "p": "topic",
                "v": "",
                "vt": "string"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{ }",
        "payloadType": "json",
        "x": 126.99993896484375,
        "y": 1040.3665533065796,
        "wires": [
            [
                "9300db5867473dfb"
            ]
        ]
    },
    {
        "id": "8a9296b558c17ba2",
        "type": "debug",
        "z": "28aa48179e689485",
        "g": "a30b6d8ea68c3596",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1050,
        "y": 1040,
        "wires": []
    },
    {
        "id": "69f48efb3ed2e9a2",
        "type": "function",
        "z": "28aa48179e689485",
        "g": "270307f35f30c014",
        "name": "+ fecha",
        "func": "msg.payload.date = new Date();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 480,
        "y": 140,
        "wires": [
            [
                "20f183d859f029d5",
                "b8690d1e7db83076",
                "fb7010822d6bb986"
            ]
        ]
    },
    {
        "id": "172ddd8b54e52f43",
        "type": "inject",
        "z": "28aa48179e689485",
        "g": "f4f56cd0159288c3",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"date\":\"2022-10-17T17:56:58.583Z\"}",
        "payloadType": "json",
        "x": 130,
        "y": 1220,
        "wires": [
            [
                "d02f577c31b6e6b5"
            ]
        ]
    },
    {
        "id": "d02f577c31b6e6b5",
        "type": "mongodb out",
        "z": "28aa48179e689485",
        "g": "f4f56cd0159288c3",
        "mongodb": "ca0dd972168dc6a0",
        "name": "",
        "collection": "datos_json",
        "payonly": true,
        "upsert": false,
        "multi": false,
        "operation": "delete",
        "x": 440,
        "y": 1220,
        "wires": []
    },
    {
        "id": "528f18345fc130c7",
        "type": "comment",
        "z": "28aa48179e689485",
        "g": "f4f56cd0159288c3",
        "name": "borrar una coleccion",
        "info": "inyectar un JSON vacío: {}\nseleccionar \"remove\" en la configuración del nodo mongoDB ",
        "x": 150,
        "y": 1160,
        "wires": []
    },
    {
        "id": "114f6ff116a2d363",
        "type": "comment",
        "z": "28aa48179e689485",
        "g": "a30b6d8ea68c3596",
        "name": "consultar una coleccion",
        "info": "",
        "x": 160,
        "y": 980,
        "wires": []
    },
    {
        "id": "17422dfaf138a6cf",
        "type": "template",
        "z": "28aa48179e689485",
        "g": "61af492eb62b5b4d",
        "name": "lista en formato html",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": " <h1>Registros: </h1>\n <ul>\n{{#payload}}\n  <li>{{date}} : {{BME280.Temperatura }}ºC, {{BME280.Humedad}}% </li>\n{{/payload}}\n </ul>",
        "output": "str",
        "x": 900,
        "y": 440,
        "wires": [
            [
                "829d2c2fd7369339"
            ]
        ]
    },
    {
        "id": "829d2c2fd7369339",
        "type": "ui_template",
        "z": "28aa48179e689485",
        "g": "61af492eb62b5b4d",
        "group": "f4f4dc208bbef1ee",
        "name": "",
        "order": 3,
        "width": "6",
        "height": "4",
        "format": "<div ng-bind-html=\"msg.payload\"></div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": false,
        "templateScope": "local",
        "className": "",
        "x": 1080,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "4f6a219dd5ca56ba",
        "type": "function",
        "z": "28aa48179e689485",
        "g": "61af492eb62b5b4d",
        "name": "",
        "func": "var limite = flow.get(\"parametro\");;\nmsg.payload = {};\nmsg.limit = limite;\nmsg.sort = {\"date\" : -1};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 280,
        "y": 460,
        "wires": [
            [
                "19370125730d77e6"
            ]
        ]
    },
    {
        "id": "02cdbb45bab265bf",
        "type": "ui_chart",
        "z": "28aa48179e689485",
        "g": "61af492eb62b5b4d",
        "name": "",
        "group": "f4f4dc208bbef1ee",
        "order": 1,
        "width": 0,
        "height": 0,
        "label": "chart",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1090,
        "y": 480,
        "wires": [
            []
        ]
    },
    {
        "id": "f7da87dfd1caafa7",
        "type": "mongodb in",
        "z": "28aa48179e689485",
        "g": "f4f56cd0159288c3",
        "mongodb": "ca0dd972168dc6a0",
        "name": "",
        "collection": "datos_json",
        "operation": "find",
        "x": 780,
        "y": 1280,
        "wires": [
            [
                "0197b0cdd2bf835e"
            ]
        ]
    },
    {
        "id": "fd7da9f49098fa93",
        "type": "inject",
        "z": "28aa48179e689485",
        "g": "f4f56cd0159288c3",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"ADC.Iluminacion\":10}",
        "payloadType": "json",
        "x": 180,
        "y": 1280,
        "wires": [
            [
                "f7da87dfd1caafa7",
                "d02f577c31b6e6b5"
            ]
        ]
    },
    {
        "id": "0197b0cdd2bf835e",
        "type": "debug",
        "z": "28aa48179e689485",
        "g": "f4f56cd0159288c3",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1050,
        "y": 1280,
        "wires": []
    },
    {
        "id": "51044b70f943ab88",
        "type": "function",
        "z": "28aa48179e689485",
        "g": "f4f56cd0159288c3",
        "name": "",
        "func": "msg.payload={\"date\": new Date(\"2022-10-17T17:57:28.587Z\")}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 520,
        "y": 1340,
        "wires": [
            [
                "f7da87dfd1caafa7"
            ]
        ]
    },
    {
        "id": "b227d0a39833605f",
        "type": "inject",
        "z": "28aa48179e689485",
        "g": "f4f56cd0159288c3",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 140,
        "y": 1340,
        "wires": [
            [
                "51044b70f943ab88"
            ]
        ]
    },
    {
        "id": "1ed97e83a3aa7230",
        "type": "inject",
        "z": "28aa48179e689485",
        "g": "f4f56cd0159288c3",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"conexion.SSID\": \"MASTER\"}",
        "payloadType": "json",
        "x": 330,
        "y": 1160,
        "wires": [
            [
                "f7da87dfd1caafa7",
                "d02f577c31b6e6b5"
            ]
        ]
    },
    {
        "id": "f74ae1123d309d8a",
        "type": "mongodb out",
        "z": "28aa48179e689485",
        "g": "f4f56cd0159288c3",
        "mongodb": "05cea6759e795a87",
        "name": "",
        "collection": "datos",
        "payonly": true,
        "upsert": false,
        "multi": false,
        "operation": "delete",
        "x": 340,
        "y": 1400,
        "wires": []
    },
    {
        "id": "c4c5fe67cd7f756f",
        "type": "inject",
        "z": "28aa48179e689485",
        "g": "f4f56cd0159288c3",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{}",
        "payloadType": "json",
        "x": 130,
        "y": 1400,
        "wires": [
            [
                "f74ae1123d309d8a"
            ]
        ]
    },
    {
        "id": "b8690d1e7db83076",
        "type": "mongodb out",
        "z": "28aa48179e689485",
        "g": "270307f35f30c014",
        "mongodb": "05cea6759e795a87",
        "name": "",
        "collection": "datos",
        "payonly": true,
        "upsert": false,
        "multi": false,
        "operation": "store",
        "x": 720,
        "y": 140,
        "wires": []
    },
    {
        "id": "4ce5c24181a90fad",
        "type": "mongodb in",
        "z": "28aa48179e689485",
        "g": "270307f35f30c014",
        "mongodb": "05cea6759e795a87",
        "name": "",
        "collection": "datos",
        "operation": "find",
        "x": 700,
        "y": 240,
        "wires": [
            [
                "1bacd1ab2f89ae19"
            ]
        ]
    },
    {
        "id": "1bacd1ab2f89ae19",
        "type": "debug",
        "z": "28aa48179e689485",
        "g": "270307f35f30c014",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1050,
        "y": 240,
        "wires": []
    },
    {
        "id": "0367f9847eafdfc5",
        "type": "function",
        "z": "28aa48179e689485",
        "g": "270307f35f30c014",
        "name": "Get values sorted and limited",
        "func": "msg.payload = {};\nmsg.topic = \"\";\nmsg.sort = {\"date\":-1};\nmsg.limit = 10;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 420,
        "y": 240,
        "wires": [
            [
                "4ce5c24181a90fad"
            ]
        ]
    },
    {
        "id": "500b07cc64c12311",
        "type": "complete",
        "z": "28aa48179e689485",
        "g": "270307f35f30c014",
        "name": "",
        "scope": [
            "69f48efb3ed2e9a2"
        ],
        "uncaught": false,
        "x": 130,
        "y": 240,
        "wires": [
            [
                "0367f9847eafdfc5"
            ]
        ]
    },
    {
        "id": "99846e687134cd5a",
        "type": "function",
        "z": "28aa48179e689485",
        "g": "94dc048a9c84b452",
        "name": "Get values sorted and limited",
        "func": "msg.payload = {};\nmsg.topic = \"\";\nmsg.sort = {\"date\":-1};\nmsg.limit = 1;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 420,
        "y": 340,
        "wires": [
            [
                "ab56ca8423144561"
            ]
        ]
    },
    {
        "id": "52847e1fef43b5bd",
        "type": "complete",
        "z": "28aa48179e689485",
        "g": "94dc048a9c84b452",
        "name": "",
        "scope": [
            "69f48efb3ed2e9a2"
        ],
        "uncaught": false,
        "x": 130,
        "y": 340,
        "wires": [
            [
                "99846e687134cd5a"
            ]
        ]
    },
    {
        "id": "ab56ca8423144561",
        "type": "mongodb in",
        "z": "28aa48179e689485",
        "g": "94dc048a9c84b452",
        "mongodb": "05cea6759e795a87",
        "name": "",
        "collection": "datos",
        "operation": "find",
        "x": 700,
        "y": 340,
        "wires": [
            [
                "9d954e9055d207a2"
            ]
        ]
    },
    {
        "id": "193b2ad82d31cde9",
        "type": "function",
        "z": "28aa48179e689485",
        "g": "034ae3c7d299bca8",
        "name": "",
        "func": "var fecha = new Date();\n\nmsg.payload = fecha.toLocaleString('es-ES', { timeZone: 'Europe/Madrid', hour12: false });\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1620,
        "y": 160,
        "wires": [
            [
                "576b46f9bf7b3dc9"
            ]
        ]
    },
    {
        "id": "2537281fa85022da",
        "type": "ui_led",
        "z": "28aa48179e689485",
        "g": "034ae3c7d299bca8",
        "order": 3,
        "group": "2888ca9d00385ef8",
        "width": "4",
        "height": "1",
        "label": "LED",
        "labelPlacement": "left",
        "labelAlignment": "center",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "1",
                "valueType": "num"
            },
            {
                "color": "#9a9996",
                "value": "0",
                "valueType": "num"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 1930,
        "y": 120,
        "wires": []
    },
    {
        "id": "5a4733eb5ef27176",
        "type": "ui_led",
        "z": "28aa48179e689485",
        "g": "034ae3c7d299bca8",
        "order": 3,
        "group": "f8b2658284e752dc",
        "width": "4",
        "height": "1",
        "label": "LED ",
        "labelPlacement": "left",
        "labelAlignment": "center",
        "colorForValue": [
            {
                "color": "#33d17a",
                "value": "1",
                "valueType": "num"
            },
            {
                "color": "#9a9996",
                "value": "0",
                "valueType": "num"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 1930,
        "y": 260,
        "wires": []
    },
    {
        "id": "576b46f9bf7b3dc9",
        "type": "ui_text",
        "z": "28aa48179e689485",
        "g": "034ae3c7d299bca8",
        "group": "2888ca9d00385ef8",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Última actualización",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1880,
        "y": 160,
        "wires": []
    },
    {
        "id": "03d7f8316e1a7dc6",
        "type": "ui_text",
        "z": "28aa48179e689485",
        "g": "034ae3c7d299bca8",
        "group": "f8b2658284e752dc",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Última actualización",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "<style>     #nr-dashboard-cardtitle{text-align: center !important;} </style>",
        "x": 1880,
        "y": 300,
        "wires": []
    },
    {
        "id": "5712e76a228cfe7a",
        "type": "function",
        "z": "28aa48179e689485",
        "g": "034ae3c7d299bca8",
        "name": "",
        "func": "var fecha = new Date();\n\nmsg.payload = fecha.toLocaleString('es-ES', { timeZone: 'Europe/Madrid', hour12: false });\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1620,
        "y": 300,
        "wires": [
            [
                "03d7f8316e1a7dc6"
            ]
        ]
    },
    {
        "id": "0939b7cf254f9201",
        "type": "ui_text",
        "z": "28aa48179e689485",
        "g": "034ae3c7d299bca8",
        "group": "f8b2658284e752dc",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Estado:",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1920,
        "y": 220,
        "wires": []
    },
    {
        "id": "756bf8bfeb8c8ad7",
        "type": "function",
        "z": "28aa48179e689485",
        "g": "034ae3c7d299bca8",
        "name": "",
        "func": "switch (msg.payload) {\n    case 0:\n        msg.payload = \"Apagado\";\n        break;\n    default:\n        msg.payload = \"Encendido\";\n        break;\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1620,
        "y": 220,
        "wires": [
            [
                "0939b7cf254f9201"
            ]
        ]
    },
    {
        "id": "aeb8f26f50a869d4",
        "type": "function",
        "z": "28aa48179e689485",
        "g": "034ae3c7d299bca8",
        "name": "",
        "func": "switch (msg.payload) {\n    case 0:\n        msg.payload = \"Apagado\";\n        break;\n    default:\n        msg.payload = \"Encendido\";\n        break;\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1620,
        "y": 80,
        "wires": [
            [
                "c63a62bea32075c0"
            ]
        ]
    },
    {
        "id": "c63a62bea32075c0",
        "type": "ui_text",
        "z": "28aa48179e689485",
        "g": "034ae3c7d299bca8",
        "group": "2888ca9d00385ef8",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Estado:",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1920,
        "y": 80,
        "wires": []
    },
    {
        "id": "8cc0b21df1f6d4ab",
        "type": "change",
        "z": "28aa48179e689485",
        "g": "034ae3c7d299bca8",
        "name": "Estado LED Rojo",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.LEDs.Rojo",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1430,
        "y": 120,
        "wires": [
            [
                "aeb8f26f50a869d4",
                "2537281fa85022da",
                "193b2ad82d31cde9"
            ]
        ]
    },
    {
        "id": "24946e4f8282e5f7",
        "type": "change",
        "z": "28aa48179e689485",
        "g": "034ae3c7d299bca8",
        "name": "Estado LED verde",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.LEDs.Verde",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1430,
        "y": 260,
        "wires": [
            [
                "756bf8bfeb8c8ad7",
                "5a4733eb5ef27176",
                "5712e76a228cfe7a"
            ]
        ]
    },
    {
        "id": "558bd8ac2c467f45",
        "type": "change",
        "z": "28aa48179e689485",
        "g": "269f5e74b8681382",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "humedad",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1650,
        "y": 560,
        "wires": [
            [
                "22f99c7c67673279"
            ]
        ]
    },
    {
        "id": "22f99c7c67673279",
        "type": "ui_gauge",
        "z": "28aa48179e689485",
        "g": "269f5e74b8681382",
        "name": "",
        "group": "c271ce14649409b0",
        "order": 1,
        "width": 0,
        "height": 0,
        "gtype": "wave",
        "title": "Humedad",
        "label": "%",
        "format": "{{value}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 1920,
        "y": 560,
        "wires": []
    },
    {
        "id": "c66117b1fdd806d5",
        "type": "change",
        "z": "28aa48179e689485",
        "g": "269f5e74b8681382",
        "name": "Humedad",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.BME280.Humedad",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1400,
        "y": 560,
        "wires": [
            [
                "558bd8ac2c467f45"
            ]
        ]
    },
    {
        "id": "5f5b2b757ccdda37",
        "type": "function",
        "z": "28aa48179e689485",
        "g": "7e2b19e2a3ad35a1",
        "name": "",
        "func": "msg.topic = \"temperatura\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1680,
        "y": 660,
        "wires": [
            [
                "3f11effdfade3c0c"
            ]
        ]
    },
    {
        "id": "ad01a0fa20fbc900",
        "type": "ui_text",
        "z": "28aa48179e689485",
        "g": "7e2b19e2a3ad35a1",
        "group": "4f2fd049c27a14a1",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Última actualización",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1880,
        "y": 700,
        "wires": []
    },
    {
        "id": "88114b10592f2e86",
        "type": "function",
        "z": "28aa48179e689485",
        "g": "7e2b19e2a3ad35a1",
        "name": "",
        "func": "var fecha = new Date();\n\nmsg.payload = fecha.toLocaleString('es-ES', { timeZone: 'Europe/Madrid', hour12: false });\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1680,
        "y": 700,
        "wires": [
            [
                "ad01a0fa20fbc900"
            ]
        ]
    },
    {
        "id": "3f11effdfade3c0c",
        "type": "ui_gauge",
        "z": "28aa48179e689485",
        "g": "7e2b19e2a3ad35a1",
        "name": "",
        "group": "4f2fd049c27a14a1",
        "order": 4,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Temperatura",
        "label": "ºC",
        "format": "{{value}}",
        "min": "-5",
        "max": "50",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 1910,
        "y": 660,
        "wires": []
    },
    {
        "id": "51934c2c7309041d",
        "type": "change",
        "z": "28aa48179e689485",
        "g": "7e2b19e2a3ad35a1",
        "name": "Temperatura",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.BME280.Temperatura",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1410,
        "y": 660,
        "wires": [
            [
                "5f5b2b757ccdda37",
                "88114b10592f2e86"
            ]
        ]
    },
    {
        "id": "3d232f5c78646eeb",
        "type": "smooth",
        "z": "28aa48179e689485",
        "g": "e308511d7b132ac8",
        "name": "",
        "property": "payload",
        "action": "max",
        "count": "100",
        "round": "",
        "mult": "single",
        "reduce": false,
        "x": 1580,
        "y": 860,
        "wires": [
            [
                "80fd1401dc086ae4"
            ]
        ]
    },
    {
        "id": "c708a584301c36f4",
        "type": "ui_text",
        "z": "28aa48179e689485",
        "g": "e308511d7b132ac8",
        "group": "cbfbdc48914b032d",
        "order": 7,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Tiempo de funcionamiento",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1990,
        "y": 1160,
        "wires": []
    },
    {
        "id": "13aefb2b905034c9",
        "type": "change",
        "z": "28aa48179e689485",
        "g": "e308511d7b132ac8",
        "name": "uptime_ms",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.uptime_ms",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "uptime_ms",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1410,
        "y": 1160,
        "wires": [
            [
                "a07ee75e7d5f20f0"
            ]
        ]
    },
    {
        "id": "112be335581efa50",
        "type": "smooth",
        "z": "28aa48179e689485",
        "g": "e308511d7b132ac8",
        "name": "",
        "property": "payload",
        "action": "min",
        "count": "100",
        "round": "",
        "mult": "single",
        "reduce": false,
        "x": 1580,
        "y": 920,
        "wires": [
            [
                "6563cadf1c8c1760"
            ]
        ]
    },
    {
        "id": "6563cadf1c8c1760",
        "type": "ui_text",
        "z": "28aa48179e689485",
        "g": "e308511d7b132ac8",
        "group": "cbfbdc48914b032d",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": " RSSI mínimo",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 2040,
        "y": 920,
        "wires": []
    },
    {
        "id": "80fd1401dc086ae4",
        "type": "ui_text",
        "z": "28aa48179e689485",
        "g": "e308511d7b132ac8",
        "group": "cbfbdc48914b032d",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": " RSSI máximo",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 2040,
        "y": 860,
        "wires": []
    },
    {
        "id": "a07ee75e7d5f20f0",
        "type": "function",
        "z": "28aa48179e689485",
        "g": "e308511d7b132ac8",
        "name": "",
        "func": "var ms = msg.payload;\nconst days = Math.floor(ms / (24 * 60 * 60 * 1000));\nconst daysms = ms % (24 * 60 * 60 * 1000);\nconst hours = Math.floor(daysms / (60 * 60 * 1000));\nconst hoursms = ms % (60 * 60 * 1000);\nconst minutes = Math.floor(hoursms / (60 * 1000));\nconst minutesms = ms % (60 * 1000);\nmsg.payload = {};\nmsg.payload = days + \" días \" + hours + \"h \" + minutes + \"m \";\nreturn msg",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1660,
        "y": 1160,
        "wires": [
            [
                "c708a584301c36f4"
            ]
        ]
    },
    {
        "id": "b0fb94e808835f10",
        "type": "ui_text",
        "z": "28aa48179e689485",
        "g": "e308511d7b132ac8",
        "group": "cbfbdc48914b032d",
        "order": 8,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "interval_s",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 2040,
        "y": 1220,
        "wires": []
    },
    {
        "id": "633cb12bf37eb606",
        "type": "change",
        "z": "28aa48179e689485",
        "g": "e308511d7b132ac8",
        "name": "RSSI",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.RSSI",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "RSSI",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1390,
        "y": 980,
        "wires": [
            [
                "ccde711847fac60b"
            ]
        ]
    },
    {
        "id": "5cbd8e343cf35e46",
        "type": "ui_text",
        "z": "28aa48179e689485",
        "g": "e308511d7b132ac8",
        "group": "cbfbdc48914b032d",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "SSID",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 2070,
        "y": 800,
        "wires": []
    },
    {
        "id": "ccde711847fac60b",
        "type": "ui_text",
        "z": "28aa48179e689485",
        "g": "e308511d7b132ac8",
        "group": "cbfbdc48914b032d",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "RSSI",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 2070,
        "y": 980,
        "wires": []
    },
    {
        "id": "8f9b1df76a93695a",
        "type": "change",
        "z": "28aa48179e689485",
        "g": "e308511d7b132ac8",
        "name": "localIP",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.localIP",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "localIP",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1400,
        "y": 1040,
        "wires": [
            [
                "215156ba0deebab0"
            ]
        ]
    },
    {
        "id": "215156ba0deebab0",
        "type": "ui_text",
        "z": "28aa48179e689485",
        "g": "e308511d7b132ac8",
        "group": "cbfbdc48914b032d",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "localIP",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 2060,
        "y": 1040,
        "wires": []
    },
    {
        "id": "5608320c39684fc9",
        "type": "ui_text",
        "z": "28aa48179e689485",
        "g": "e308511d7b132ac8",
        "group": "cbfbdc48914b032d",
        "order": 6,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "macAddress",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 2050,
        "y": 1100,
        "wires": []
    },
    {
        "id": "f0e451d92dfe2699",
        "type": "change",
        "z": "28aa48179e689485",
        "g": "e308511d7b132ac8",
        "name": "SSID",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.SSID",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "SSID",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1390,
        "y": 800,
        "wires": [
            [
                "5cbd8e343cf35e46"
            ]
        ]
    },
    {
        "id": "83e64e0e3037e7b4",
        "type": "change",
        "z": "28aa48179e689485",
        "g": "e308511d7b132ac8",
        "name": "macAddress",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.macAddress",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "macAddress",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1410,
        "y": 1100,
        "wires": [
            [
                "5608320c39684fc9"
            ]
        ]
    },
    {
        "id": "591fd6a7f4ff20fe",
        "type": "change",
        "z": "28aa48179e689485",
        "g": "e308511d7b132ac8",
        "name": "interval_s",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.interval_s",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "interval_s",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1410,
        "y": 1220,
        "wires": [
            [
                "b0fb94e808835f10"
            ]
        ]
    },
    {
        "id": "27c65d3061597a5b",
        "type": "change",
        "z": "28aa48179e689485",
        "g": "e308511d7b132ac8",
        "name": "RSSI",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.RSSI",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "RSSI",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1390,
        "y": 920,
        "wires": [
            [
                "112be335581efa50"
            ]
        ]
    },
    {
        "id": "e6ab46d16363d6d6",
        "type": "change",
        "z": "28aa48179e689485",
        "g": "e308511d7b132ac8",
        "name": "RSSI",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.RSSI",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "RSSI",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1390,
        "y": 860,
        "wires": [
            [
                "3d232f5c78646eeb"
            ]
        ]
    },
    {
        "id": "e07bdbea1aa218e5",
        "type": "link out",
        "z": "28aa48179e689485",
        "g": "94dc048a9c84b452",
        "name": "link out 1",
        "mode": "link",
        "links": [
            "f8c3f925ec0fdb14",
            "b7ae2bc76235434b",
            "b363bc167b4d635d",
            "4af9e17c13f8e617",
            "b4bb0517cd553e43",
            "c146bf7d408652f7",
            "94865c6d6da736c9",
            "fe3a7ce2e30a7e42",
            "48cee4fc7ec5b74f",
            "182f17adb09b093c",
            "0fcdb51ee77c6f78",
            "c5e0f9ac5116754d",
            "39bae5fbe759d48c"
        ],
        "x": 1125,
        "y": 340,
        "wires": []
    },
    {
        "id": "f8c3f925ec0fdb14",
        "type": "link in",
        "z": "28aa48179e689485",
        "g": "e308511d7b132ac8",
        "name": "link in 4",
        "links": [
            "e07bdbea1aa218e5"
        ],
        "x": 1265,
        "y": 800,
        "wires": [
            [
                "f0e451d92dfe2699"
            ]
        ]
    },
    {
        "id": "b7ae2bc76235434b",
        "type": "link in",
        "z": "28aa48179e689485",
        "g": "e308511d7b132ac8",
        "name": "link in 5",
        "links": [
            "e07bdbea1aa218e5"
        ],
        "x": 1265,
        "y": 860,
        "wires": [
            [
                "e6ab46d16363d6d6"
            ]
        ]
    },
    {
        "id": "b4bb0517cd553e43",
        "type": "link in",
        "z": "28aa48179e689485",
        "g": "e308511d7b132ac8",
        "name": "link in 7",
        "links": [
            "e07bdbea1aa218e5"
        ],
        "x": 1265,
        "y": 980,
        "wires": [
            [
                "633cb12bf37eb606"
            ]
        ]
    },
    {
        "id": "b363bc167b4d635d",
        "type": "link in",
        "z": "28aa48179e689485",
        "g": "e308511d7b132ac8",
        "name": "link in 6",
        "links": [
            "e07bdbea1aa218e5"
        ],
        "x": 1265,
        "y": 920,
        "wires": [
            [
                "27c65d3061597a5b"
            ]
        ]
    },
    {
        "id": "4af9e17c13f8e617",
        "type": "link in",
        "z": "28aa48179e689485",
        "g": "e308511d7b132ac8",
        "name": "link in 8",
        "links": [
            "e07bdbea1aa218e5"
        ],
        "x": 1265,
        "y": 1040,
        "wires": [
            [
                "8f9b1df76a93695a"
            ]
        ]
    },
    {
        "id": "c146bf7d408652f7",
        "type": "link in",
        "z": "28aa48179e689485",
        "g": "e308511d7b132ac8",
        "name": "link in 9",
        "links": [
            "e07bdbea1aa218e5"
        ],
        "x": 1265,
        "y": 1100,
        "wires": [
            [
                "83e64e0e3037e7b4"
            ]
        ]
    },
    {
        "id": "94865c6d6da736c9",
        "type": "link in",
        "z": "28aa48179e689485",
        "g": "e308511d7b132ac8",
        "name": "link in 10",
        "links": [
            "e07bdbea1aa218e5"
        ],
        "x": 1265,
        "y": 1160,
        "wires": [
            [
                "13aefb2b905034c9"
            ]
        ]
    },
    {
        "id": "fe3a7ce2e30a7e42",
        "type": "link in",
        "z": "28aa48179e689485",
        "g": "e308511d7b132ac8",
        "name": "link in 11",
        "links": [
            "e07bdbea1aa218e5"
        ],
        "x": 1265,
        "y": 1220,
        "wires": [
            [
                "591fd6a7f4ff20fe"
            ]
        ]
    },
    {
        "id": "9d954e9055d207a2",
        "type": "function",
        "z": "28aa48179e689485",
        "g": "94dc048a9c84b452",
        "name": "Array to JSON",
        "func": "msg.payload = msg.payload[0];\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 980,
        "y": 340,
        "wires": [
            [
                "e07bdbea1aa218e5"
            ]
        ]
    },
    {
        "id": "d28a91f32dac6fe3",
        "type": "ui_chart",
        "z": "28aa48179e689485",
        "g": "531ca8b2fcf5e560",
        "name": "",
        "group": "98ee1182cc353ad6",
        "order": 2,
        "width": "0",
        "height": "0",
        "label": "Presión (mbar)",
        "chartType": "line",
        "legend": "true",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1900,
        "y": 420,
        "wires": [
            []
        ]
    },
    {
        "id": "5b9b37b255a61e4a",
        "type": "change",
        "z": "28aa48179e689485",
        "g": "531ca8b2fcf5e560",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Presión",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1630,
        "y": 400,
        "wires": [
            [
                "d28a91f32dac6fe3"
            ]
        ]
    },
    {
        "id": "0b56f1b4e827a08b",
        "type": "inject",
        "z": "28aa48179e689485",
        "g": "531ca8b2fcf5e560",
        "name": "Reset chart",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "[ ]",
        "payloadType": "json",
        "x": 1630,
        "y": 460,
        "wires": [
            [
                "d28a91f32dac6fe3"
            ]
        ]
    },
    {
        "id": "e7e97ddcfa05ad37",
        "type": "change",
        "z": "28aa48179e689485",
        "g": "531ca8b2fcf5e560",
        "name": "Presión",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.BME280.Presion",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1400,
        "y": 400,
        "wires": [
            [
                "5b9b37b255a61e4a"
            ]
        ]
    },
    {
        "id": "48cee4fc7ec5b74f",
        "type": "link in",
        "z": "28aa48179e689485",
        "g": "034ae3c7d299bca8",
        "name": "link in 12",
        "links": [
            "e07bdbea1aa218e5"
        ],
        "x": 1275,
        "y": 120,
        "wires": [
            [
                "8cc0b21df1f6d4ab"
            ]
        ]
    },
    {
        "id": "182f17adb09b093c",
        "type": "link in",
        "z": "28aa48179e689485",
        "g": "034ae3c7d299bca8",
        "name": "link in 13",
        "links": [
            "e07bdbea1aa218e5"
        ],
        "x": 1275,
        "y": 260,
        "wires": [
            [
                "24946e4f8282e5f7"
            ]
        ]
    },
    {
        "id": "0fcdb51ee77c6f78",
        "type": "link in",
        "z": "28aa48179e689485",
        "g": "531ca8b2fcf5e560",
        "name": "link in 14",
        "links": [
            "e07bdbea1aa218e5"
        ],
        "x": 1275,
        "y": 400,
        "wires": [
            [
                "e7e97ddcfa05ad37"
            ]
        ]
    },
    {
        "id": "c5e0f9ac5116754d",
        "type": "link in",
        "z": "28aa48179e689485",
        "g": "269f5e74b8681382",
        "name": "link in 15",
        "links": [
            "e07bdbea1aa218e5"
        ],
        "x": 1275,
        "y": 560,
        "wires": [
            [
                "c66117b1fdd806d5"
            ]
        ]
    },
    {
        "id": "39bae5fbe759d48c",
        "type": "link in",
        "z": "28aa48179e689485",
        "g": "7e2b19e2a3ad35a1",
        "name": "link in 16",
        "links": [
            "e07bdbea1aa218e5"
        ],
        "x": 1285,
        "y": 660,
        "wires": [
            [
                "51934c2c7309041d"
            ]
        ]
    },
    {
        "id": "19370125730d77e6",
        "type": "mongodb in",
        "z": "28aa48179e689485",
        "g": "61af492eb62b5b4d",
        "mongodb": "05cea6759e795a87",
        "name": "",
        "collection": "datos",
        "operation": "find",
        "x": 500,
        "y": 460,
        "wires": [
            [
                "53f223c7e2ad0ea1",
                "161d832346e40b1d"
            ]
        ]
    },
    {
        "id": "53f223c7e2ad0ea1",
        "type": "function",
        "z": "28aa48179e689485",
        "g": "61af492eb62b5b4d",
        "name": "genera datos gráfica",
        "func": "var arraytemp=[];\nvar arrayhum=[];\n\n// los arrays usados en la represenstación gráfica deben contener objetos JSON con dos campos: {x , y}\n// en x debemos poner la hora en formato \"timestamp\". Si tenemos un objeto fecha se puede convertir usando el método getTime()\n// en y debemos poner el valor de la variable\n// mas info en: https://github.com/node-red/node-red-dashboard/blob/master/Charts.md\n\nif (Array.isArray(msg.payload) && msg.payload.length > 0 && msg.payload.length <= flow.get(\"parametro\"))\n{\n    for (var i = 0; i < msg.payload.length; i++) { // añade datos a los arrays\n        arraytemp.push({x : msg.payload[i].date.getTime() , y : msg.payload[i].BME280.Temperatura});\n        arrayhum.push({x : msg.payload[i].date.getTime() , y : msg.payload[i].BME280.Humedad});\n    }\n    msg.payload = [{\n        \"series\": [\"Temperatura\", \"Humedad\"],\n        \"data\": [arraytemp, arrayhum],\n        \"labels\": [\"\"]\n    }];\n} else {\n    msg.payload = [];\n}\n\nreturn msg;  ",
        "outputs": "1",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 760,
        "y": 480,
        "wires": [
            [
                "02cdbb45bab265bf"
            ]
        ]
    },
    {
        "id": "03c3979010c41f33",
        "type": "change",
        "z": "28aa48179e689485",
        "g": "61af492eb62b5b4d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "parametro",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 310,
        "y": 540,
        "wires": [
            []
        ]
    },
    {
        "id": "e0b1c6c5c2a41a05",
        "type": "ui_slider",
        "z": "28aa48179e689485",
        "g": "61af492eb62b5b4d",
        "name": "",
        "label": "slider",
        "tooltip": "",
        "group": "f4f4dc208bbef1ee",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": true,
        "outs": "end",
        "topic": "topic",
        "topicType": "msg",
        "min": 0,
        "max": "100",
        "step": 1,
        "className": "",
        "x": 110,
        "y": 540,
        "wires": [
            [
                "03c3979010c41f33"
            ]
        ]
    },
    {
        "id": "7da74ad0c2ce8991",
        "type": "complete",
        "z": "28aa48179e689485",
        "g": "61af492eb62b5b4d",
        "name": "",
        "scope": [
            "03c3979010c41f33"
        ],
        "uncaught": false,
        "x": 130,
        "y": 460,
        "wires": [
            [
                "4f6a219dd5ca56ba"
            ]
        ]
    },
    {
        "id": "161d832346e40b1d",
        "type": "function",
        "z": "28aa48179e689485",
        "g": "61af492eb62b5b4d",
        "name": "function 2",
        "func": "if(flow.get(\"parametro\") == 0){\n    msg.payload = [];\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 720,
        "y": 440,
        "wires": [
            [
                "17422dfaf138a6cf"
            ]
        ]
    },
    {
        "id": "9b25c5b420c7f72b",
        "type": "function",
        "z": "28aa48179e689485",
        "g": "c867ac9e3fdd1cbf",
        "name": "function 3",
        "func": "var limite = global.get(\"user_input\");\nmsg.payload = { \"BME280.Temperatura\": { \"$gte\": limite } }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 640,
        "wires": [
            [
                "fc0178895a1aee94"
            ]
        ]
    },
    {
        "id": "e4718518fcf97c09",
        "type": "ui_button",
        "z": "28aa48179e689485",
        "g": "c867ac9e3fdd1cbf",
        "name": "",
        "group": "9eaa5333ae7be1f9",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Actualizar gráfica",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 150,
        "y": 640,
        "wires": [
            [
                "9b25c5b420c7f72b"
            ]
        ]
    },
    {
        "id": "fc0178895a1aee94",
        "type": "mongodb in",
        "z": "28aa48179e689485",
        "g": "c867ac9e3fdd1cbf",
        "mongodb": "05cea6759e795a87",
        "name": "",
        "collection": "datos",
        "operation": "find",
        "x": 600,
        "y": 640,
        "wires": [
            [
                "e64b3085.9a525"
            ]
        ]
    },
    {
        "id": "1d35200c560c9797",
        "type": "ui_chart",
        "z": "28aa48179e689485",
        "g": "c867ac9e3fdd1cbf",
        "name": "",
        "group": "9eaa5333ae7be1f9",
        "order": 6,
        "width": 0,
        "height": 0,
        "label": "chart",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1090,
        "y": 640,
        "wires": [
            []
        ]
    },
    {
        "id": "4ee2c7c576ce35a4",
        "type": "ui_numeric",
        "z": "28aa48179e689485",
        "g": "c867ac9e3fdd1cbf",
        "name": "",
        "label": "user_input",
        "tooltip": "",
        "group": "9eaa5333ae7be1f9",
        "order": 4,
        "width": 0,
        "height": 0,
        "wrap": false,
        "passthru": true,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{value}}",
        "min": 0,
        "max": "50",
        "step": 1,
        "className": "",
        "x": 130,
        "y": 720,
        "wires": [
            [
                "f7a3c063082b6b48"
            ]
        ]
    },
    {
        "id": "f7a3c063082b6b48",
        "type": "change",
        "z": "28aa48179e689485",
        "g": "c867ac9e3fdd1cbf",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "user_input",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 360,
        "y": 720,
        "wires": [
            []
        ]
    },
    {
        "id": "e64b3085.9a525",
        "type": "function",
        "z": "28aa48179e689485",
        "g": "c867ac9e3fdd1cbf",
        "name": "genera datos gráfica",
        "func": "var arraytemp=[];\nvar arrayhum=[];\n\n// los arrays usados en la represenstación gráfica deben contener objetos JSON con dos campos: {x , y}\n// en x debemos poner la hora en formato \"timestamp\". Si tenemos un objeto fecha se puede convertir usando el método getTime()\n// en y debemos poner el valor de la variable\n// mas info en: https://github.com/node-red/node-red-dashboard/blob/master/Charts.md\n\nif(Array.isArray(msg.payload) && msg.payload.length>0)\n{\n    for (var i = 0; i < msg.payload.length; i++) { // añade datos a los arrays\n        arraytemp.push({x : msg.payload[i].date.getTime() , y : msg.payload[i].BME280.Temperatura});\n        arrayhum.push({x : msg.payload[i].date.getTime() , y : msg.payload[i].BME280.Humedad});\n    }\n}\n    \nmsg.payload = [{\n        \"series\":[\"Temperatura\",\"Humedad\"],\n        \"data\":[arraytemp, arrayhum],\n        \"labels\":[\"\"]\n        }];\n\nreturn msg;  ",
        "outputs": "1",
        "noerr": 0,
        "x": 880,
        "y": 640,
        "wires": [
            [
                "1d35200c560c9797"
            ]
        ]
    },
    {
        "id": "6f2385b31ff14630",
        "type": "function",
        "z": "28aa48179e689485",
        "g": "3794648bb169b272",
        "name": "function 4",
        "func": "var ms_per_minute = 60000;\n//obtiene el timestamp actual\nvar now_ms = new Date().getTime();\n// crear el objeto fecha con la hora de hace 5 minutos\nvar fiveminsago = new Date(now_ms-5*ms_per_minute);\nvar fiveteenminsago = new Date(now_ms - 15 * ms_per_minute);\n\n//Seleccionar con fecha posterior o igual a hacer 5 minutos\nmsg.payload = {$and: [{ \"date\": {\"$gte\": fiveteenminsago}}, {\"date\": { \"$lte\": fiveminsago }}]};\nmsg.sort= {\"date\":1};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 820,
        "wires": [
            [
                "1618cce562a50646"
            ]
        ]
    },
    {
        "id": "37e97867580b33fe",
        "type": "template",
        "z": "28aa48179e689485",
        "g": "3794648bb169b272",
        "name": "lista en formato html",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": " <h1>Registros: </h1>\n <ul>\n{{#payload}}\n  <li>{{date}} : {{BME280.Temperatura }}ºC, {{BME280.Humedad}}% </li>\n{{/payload}}\n </ul>",
        "output": "str",
        "x": 880,
        "y": 820,
        "wires": [
            [
                "c8914d0a9113990b"
            ]
        ]
    },
    {
        "id": "c8914d0a9113990b",
        "type": "ui_template",
        "z": "28aa48179e689485",
        "g": "3794648bb169b272",
        "group": "24a2032a9df17ba3",
        "name": "",
        "order": 3,
        "width": "6",
        "height": "4",
        "format": "<div ng-bind-html=\"msg.payload\"></div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": false,
        "templateScope": "local",
        "className": "",
        "x": 1080,
        "y": 820,
        "wires": [
            []
        ]
    },
    {
        "id": "e91db7f6e967d630",
        "type": "complete",
        "z": "28aa48179e689485",
        "g": "3794648bb169b272",
        "name": "",
        "scope": [
            "69f48efb3ed2e9a2"
        ],
        "uncaught": false,
        "x": 130,
        "y": 820,
        "wires": [
            [
                "6f2385b31ff14630"
            ]
        ]
    },
    {
        "id": "63fa2691c2ed03b2",
        "type": "debug",
        "z": "28aa48179e689485",
        "g": "3794648bb169b272",
        "name": "debug 3",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 900,
        "y": 880,
        "wires": []
    },
    {
        "id": "1618cce562a50646",
        "type": "mongodb in",
        "z": "28aa48179e689485",
        "g": "3794648bb169b272",
        "mongodb": "05cea6759e795a87",
        "name": "",
        "collection": "datos",
        "operation": "find",
        "x": 600,
        "y": 820,
        "wires": [
            [
                "37e97867580b33fe",
                "63fa2691c2ed03b2"
            ]
        ]
    },
    {
        "id": "3a99781e6031d629",
        "type": "mqtt in",
        "z": "240e9138468e39f6",
        "g": "c6c2603753194b13",
        "name": "",
        "topic": "iot/datos/json",
        "qos": "2",
        "datatype": "auto",
        "broker": "c8b2b5778aed34b0",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 110,
        "y": 160,
        "wires": [
            [
                "99d0ec64faab4b94"
            ]
        ]
    },
    {
        "id": "cba4a38d7900d885",
        "type": "debug",
        "z": "240e9138468e39f6",
        "g": "c6c2603753194b13",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 470,
        "y": 120,
        "wires": []
    },
    {
        "id": "99d0ec64faab4b94",
        "type": "json",
        "z": "240e9138468e39f6",
        "g": "c6c2603753194b13",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 290,
        "y": 160,
        "wires": [
            [
                "cba4a38d7900d885",
                "99fb9b16b1629eea",
                "910905f51ec3c273"
            ]
        ]
    },
    {
        "id": "99fb9b16b1629eea",
        "type": "change",
        "z": "240e9138468e39f6",
        "g": "c6c2603753194b13",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.BME280.Temperatura",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 480,
        "y": 160,
        "wires": [
            [
                "6457892a3e672cbe"
            ]
        ]
    },
    {
        "id": "6457892a3e672cbe",
        "type": "debug",
        "z": "240e9138468e39f6",
        "g": "c6c2603753194b13",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 670,
        "y": 160,
        "wires": []
    },
    {
        "id": "910905f51ec3c273",
        "type": "change",
        "z": "240e9138468e39f6",
        "g": "c6c2603753194b13",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.uptime_ms",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 480,
        "y": 200,
        "wires": [
            [
                "d42036ba593c80c1"
            ]
        ]
    },
    {
        "id": "d42036ba593c80c1",
        "type": "debug",
        "z": "240e9138468e39f6",
        "g": "c6c2603753194b13",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 670,
        "y": 200,
        "wires": []
    },
    {
        "id": "1c6e5895e3998ee3",
        "type": "comment",
        "z": "240e9138468e39f6",
        "g": "c6c2603753194b13",
        "name": "Como trabajar con JSON - Ejemplo de la clase",
        "info": "",
        "x": 730,
        "y": 60,
        "wires": []
    },
    {
        "id": "debd5c63615fff3e",
        "type": "function",
        "z": "240e9138468e39f6",
        "g": "41653db2dbc8eff5",
        "name": "",
        "func": "var fecha = new Date();\n\nmsg.payload = fecha.toLocaleString('es-ES', { timeZone: 'Europe/Madrid', hour12: false });\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1500,
        "y": 140,
        "wires": [
            [
                "8f17387ff474ec87"
            ]
        ]
    },
    {
        "id": "c2b551405535b0b2",
        "type": "ui_chart",
        "z": "240e9138468e39f6",
        "g": "ef3d086a30a1b87a",
        "name": "",
        "group": "386ddfb962d0c80d",
        "order": 2,
        "width": "0",
        "height": "0",
        "label": "Presión (mbar)",
        "chartType": "line",
        "legend": "true",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1780,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "5983285fa86d9906",
        "type": "change",
        "z": "240e9138468e39f6",
        "g": "ef3d086a30a1b87a",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Presión",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1510,
        "y": 380,
        "wires": [
            [
                "c2b551405535b0b2"
            ]
        ]
    },
    {
        "id": "93ce455ec89f564f",
        "type": "inject",
        "z": "240e9138468e39f6",
        "g": "ef3d086a30a1b87a",
        "name": "Reset chart",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "[ ]",
        "payloadType": "json",
        "x": 1510,
        "y": 440,
        "wires": [
            [
                "c2b551405535b0b2"
            ]
        ]
    },
    {
        "id": "bed29fa72c8f9e99",
        "type": "ui_led",
        "z": "240e9138468e39f6",
        "g": "41653db2dbc8eff5",
        "order": 3,
        "group": "6d8ffaa69a25c68f",
        "width": "4",
        "height": "1",
        "label": "LED",
        "labelPlacement": "left",
        "labelAlignment": "center",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "1",
                "valueType": "num"
            },
            {
                "color": "#9a9996",
                "value": "0",
                "valueType": "num"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 1810,
        "y": 100,
        "wires": []
    },
    {
        "id": "1eb41ef80e3d5aa2",
        "type": "ui_led",
        "z": "240e9138468e39f6",
        "g": "41653db2dbc8eff5",
        "order": 3,
        "group": "e8ccf6ad47502312",
        "width": "4",
        "height": "1",
        "label": "LED ",
        "labelPlacement": "left",
        "labelAlignment": "center",
        "colorForValue": [
            {
                "color": "#33d17a",
                "value": "1",
                "valueType": "num"
            },
            {
                "color": "#9a9996",
                "value": "0",
                "valueType": "num"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 1810,
        "y": 240,
        "wires": []
    },
    {
        "id": "8f17387ff474ec87",
        "type": "ui_text",
        "z": "240e9138468e39f6",
        "g": "41653db2dbc8eff5",
        "group": "6d8ffaa69a25c68f",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Última actualización",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1760,
        "y": 140,
        "wires": []
    },
    {
        "id": "c9b93ff37480c0f9",
        "type": "ui_text",
        "z": "240e9138468e39f6",
        "g": "41653db2dbc8eff5",
        "group": "e8ccf6ad47502312",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Última actualización",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "<style>     #nr-dashboard-cardtitle{text-align: center !important;} </style>",
        "x": 1760,
        "y": 280,
        "wires": []
    },
    {
        "id": "18c7c585c8eb32ef",
        "type": "function",
        "z": "240e9138468e39f6",
        "g": "41653db2dbc8eff5",
        "name": "",
        "func": "var fecha = new Date();\n\nmsg.payload = fecha.toLocaleString('es-ES', { timeZone: 'Europe/Madrid', hour12: false });\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1500,
        "y": 280,
        "wires": [
            [
                "c9b93ff37480c0f9"
            ]
        ]
    },
    {
        "id": "a040bbf0062ac342",
        "type": "ui_text",
        "z": "240e9138468e39f6",
        "g": "41653db2dbc8eff5",
        "group": "e8ccf6ad47502312",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Estado:",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1800,
        "y": 200,
        "wires": []
    },
    {
        "id": "cd061775fa6b345c",
        "type": "function",
        "z": "240e9138468e39f6",
        "g": "41653db2dbc8eff5",
        "name": "",
        "func": "switch (msg.payload) {\n    case 0:\n        msg.payload = \"Apagado\";\n        break;\n    default:\n        msg.payload = \"Encendido\";\n        break;\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1500,
        "y": 200,
        "wires": [
            [
                "a040bbf0062ac342"
            ]
        ]
    },
    {
        "id": "8fd217ed9224341c",
        "type": "function",
        "z": "240e9138468e39f6",
        "g": "41653db2dbc8eff5",
        "name": "",
        "func": "switch (msg.payload) {\n    case 0:\n        msg.payload = \"Apagado\";\n        break;\n    default:\n        msg.payload = \"Encendido\";\n        break;\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1500,
        "y": 60,
        "wires": [
            [
                "4dbd59f9d9b762d1"
            ]
        ]
    },
    {
        "id": "4dbd59f9d9b762d1",
        "type": "ui_text",
        "z": "240e9138468e39f6",
        "g": "41653db2dbc8eff5",
        "group": "6d8ffaa69a25c68f",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Estado:",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1800,
        "y": 60,
        "wires": []
    },
    {
        "id": "fa83b2151127c727",
        "type": "change",
        "z": "240e9138468e39f6",
        "g": "e1419462044728a3",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "humedad",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1530,
        "y": 540,
        "wires": [
            [
                "9864a25f16236d0f"
            ]
        ]
    },
    {
        "id": "9864a25f16236d0f",
        "type": "ui_gauge",
        "z": "240e9138468e39f6",
        "g": "e1419462044728a3",
        "name": "",
        "group": "8599d9afed430a9d",
        "order": 1,
        "width": 0,
        "height": 0,
        "gtype": "wave",
        "title": "Humedad",
        "label": "%",
        "format": "{{value}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 1800,
        "y": 540,
        "wires": []
    },
    {
        "id": "9ded6ebbbd3adb27",
        "type": "ui_button",
        "z": "240e9138468e39f6",
        "g": "8c42595fd702f856",
        "name": "",
        "group": "6d8ffaa69a25c68f",
        "order": 1,
        "width": "1",
        "height": "1",
        "passthru": false,
        "label": "On",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "{\"led\" : \"rojo\", \"orden\" : 1}",
        "payloadType": "json",
        "topic": "topic",
        "topicType": "msg",
        "x": 2010,
        "y": 80,
        "wires": [
            [
                "e4b1a3e75cbffc3c"
            ]
        ]
    },
    {
        "id": "66cfe09992108ec7",
        "type": "ui_button",
        "z": "240e9138468e39f6",
        "g": "8c42595fd702f856",
        "name": "",
        "group": "6d8ffaa69a25c68f",
        "order": 2,
        "width": "1",
        "height": "1",
        "passthru": false,
        "label": "Off",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "{\"led\" : \"rojo\", \"orden\" : 0}",
        "payloadType": "json",
        "topic": "topic",
        "topicType": "msg",
        "x": 2010,
        "y": 120,
        "wires": [
            [
                "e4b1a3e75cbffc3c"
            ]
        ]
    },
    {
        "id": "27309bfed6048359",
        "type": "ui_button",
        "z": "240e9138468e39f6",
        "g": "6793a44395d337f2",
        "name": "",
        "group": "e8ccf6ad47502312",
        "order": 1,
        "width": "1",
        "height": "1",
        "passthru": false,
        "label": "On",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "{\"led\" : \"verde\", \"orden\" : 1}",
        "payloadType": "json",
        "topic": "topic",
        "topicType": "msg",
        "x": 2010,
        "y": 220,
        "wires": [
            [
                "d84be5d03107784f"
            ]
        ]
    },
    {
        "id": "95da5e1fe2cdf27a",
        "type": "ui_button",
        "z": "240e9138468e39f6",
        "g": "6793a44395d337f2",
        "name": "",
        "group": "e8ccf6ad47502312",
        "order": 2,
        "width": "1",
        "height": "1",
        "passthru": false,
        "label": "Off",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "{\"led\" : \"verde\", \"orden\" : 0}",
        "payloadType": "json",
        "topic": "topic",
        "topicType": "msg",
        "x": 2010,
        "y": 260,
        "wires": [
            [
                "d84be5d03107784f"
            ]
        ]
    },
    {
        "id": "1d40c067aa6b81e9",
        "type": "function",
        "z": "240e9138468e39f6",
        "g": "e539cc8d8670fa6a",
        "name": "",
        "func": "msg.topic = \"temperatura\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1560,
        "y": 640,
        "wires": [
            [
                "ef4f90370b870fcc"
            ]
        ]
    },
    {
        "id": "08842309694c8bab",
        "type": "ui_text",
        "z": "240e9138468e39f6",
        "g": "e539cc8d8670fa6a",
        "group": "60916e8014cfd3f7",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Última actualización",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1760,
        "y": 680,
        "wires": []
    },
    {
        "id": "945f9d8631965dc1",
        "type": "function",
        "z": "240e9138468e39f6",
        "g": "e539cc8d8670fa6a",
        "name": "",
        "func": "var fecha = new Date();\n\nmsg.payload = fecha.toLocaleString('es-ES', { timeZone: 'Europe/Madrid', hour12: false });\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1560,
        "y": 680,
        "wires": [
            [
                "08842309694c8bab"
            ]
        ]
    },
    {
        "id": "5ac83df035afb6f3",
        "type": "smooth",
        "z": "240e9138468e39f6",
        "g": "e539cc8d8670fa6a",
        "name": "",
        "property": "payload",
        "action": "mean",
        "count": "6",
        "round": "2",
        "mult": "single",
        "reduce": false,
        "x": 1360,
        "y": 800,
        "wires": [
            [
                "6969c4c38cf1af0e"
            ]
        ]
    },
    {
        "id": "4e182b0fa83cb332",
        "type": "ui_chart",
        "z": "240e9138468e39f6",
        "g": "e539cc8d8670fa6a",
        "name": "",
        "group": "60916e8014cfd3f7",
        "order": 3,
        "width": 0,
        "height": 0,
        "label": "Temperatura (ºC)",
        "chartType": "line",
        "legend": "true",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1770,
        "y": 720,
        "wires": [
            []
        ]
    },
    {
        "id": "a1508307e5a54ab7",
        "type": "inject",
        "z": "240e9138468e39f6",
        "g": "e539cc8d8670fa6a",
        "name": "Reset chart",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "[ ]",
        "payloadType": "json",
        "x": 1550,
        "y": 720,
        "wires": [
            [
                "4e182b0fa83cb332"
            ]
        ]
    },
    {
        "id": "ed18196da15b9d12",
        "type": "change",
        "z": "240e9138468e39f6",
        "g": "e539cc8d8670fa6a",
        "name": "Actual",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "temperatura_actual",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1350,
        "y": 760,
        "wires": [
            [
                "5ac83df035afb6f3",
                "7d4dceb80377abe4"
            ]
        ]
    },
    {
        "id": "ef4f90370b870fcc",
        "type": "ui_gauge",
        "z": "240e9138468e39f6",
        "g": "e539cc8d8670fa6a",
        "name": "",
        "group": "60916e8014cfd3f7",
        "order": 2,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Temperatura",
        "label": "ºC",
        "format": "{{value}}",
        "min": "-5",
        "max": "50",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 1790,
        "y": 640,
        "wires": []
    },
    {
        "id": "6969c4c38cf1af0e",
        "type": "change",
        "z": "240e9138468e39f6",
        "g": "e539cc8d8670fa6a",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "temperatura_media",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1370,
        "y": 840,
        "wires": [
            [
                "7d4dceb80377abe4"
            ]
        ]
    },
    {
        "id": "7d4dceb80377abe4",
        "type": "function",
        "z": "240e9138468e39f6",
        "g": "e539cc8d8670fa6a",
        "name": "Diferencia actual y media",
        "func": "var msg1 = {};\nvar msg2 = {};\nvar msg3 = {};\ncontext.data = context.data || {};\nswitch (msg.topic){\n    case \"temperatura_media\":\n        context.data.temperatura_media = msg.payload;\n        msg = null;\n        break;\n    case \"temperatura_actual\":\n        context.data.temperatura_actual = msg.payload;\n        msg = null;\n        break;\n    default:\n        msg = null;\n        break;\n}\n\nif (context.data.temperatura_actual != null && context.data.temperatura_media != null){\n    msg1.payload = Math.abs(context.data.temperatura_actual-context.data.temperatura_media);\n    msg1.topic = \"Diferencia\";\n    msg2.payload = context.data.temperatura_actual;\n    msg2.topic = \"Actual\";\n    msg3.payload = context.data.temperatura_media;\n    msg3.topic = \"Media\";\n    context.data = null;\n    return [msg1, msg2, msg3];\n}else {return msg;}",
        "outputs": 3,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1590,
        "y": 800,
        "wires": [
            [
                "4e182b0fa83cb332"
            ],
            [
                "4e182b0fa83cb332"
            ],
            [
                "4e182b0fa83cb332"
            ]
        ]
    },
    {
        "id": "4768707a9098fb23",
        "type": "switch",
        "z": "240e9138468e39f6",
        "g": "e539cc8d8670fa6a",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "gte",
                "v": "25",
                "vt": "num"
            },
            {
                "t": "lt",
                "v": "25",
                "vt": "num"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 1350,
        "y": 940,
        "wires": [
            [
                "da3c633c34fad8eb",
                "0befb2601c5453c7"
            ],
            [
                "1ed2280940d5db75",
                "061af7fac1fe5554"
            ]
        ]
    },
    {
        "id": "da3c633c34fad8eb",
        "type": "change",
        "z": "240e9138468e39f6",
        "g": "e539cc8d8670fa6a",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "off",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"led\" : \"rojo\", \"orden\" : 0}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1560,
        "y": 920,
        "wires": [
            [
                "137df09f21d87c2f"
            ]
        ]
    },
    {
        "id": "1ed2280940d5db75",
        "type": "change",
        "z": "240e9138468e39f6",
        "g": "e539cc8d8670fa6a",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "on",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"led\" : \"verde\", \"orden\" : 1}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1560,
        "y": 960,
        "wires": [
            [
                "137df09f21d87c2f"
            ]
        ]
    },
    {
        "id": "061af7fac1fe5554",
        "type": "change",
        "z": "240e9138468e39f6",
        "g": "e539cc8d8670fa6a",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "off",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"led\" : \"rojo\", \"orden\" : 0}",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1560,
        "y": 1000,
        "wires": [
            [
                "a319282dc20b1712"
            ]
        ]
    },
    {
        "id": "0befb2601c5453c7",
        "type": "change",
        "z": "240e9138468e39f6",
        "g": "e539cc8d8670fa6a",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "on",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"led\" : \"rojo\", \"orden\" : 1}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1560,
        "y": 880,
        "wires": [
            [
                "a319282dc20b1712"
            ]
        ]
    },
    {
        "id": "7235b33bb85139c3",
        "type": "inject",
        "z": "240e9138468e39f6",
        "g": "e539cc8d8670fa6a",
        "name": "36",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "36",
        "payloadType": "num",
        "x": 1290,
        "y": 1000,
        "wires": [
            [
                "4768707a9098fb23"
            ]
        ]
    },
    {
        "id": "fe142cdba710abf1",
        "type": "mqtt in",
        "z": "240e9138468e39f6",
        "g": "ec0e2ac7900fa3f9",
        "name": "",
        "topic": "iot/datos/json",
        "qos": "2",
        "datatype": "auto",
        "broker": "c8b2b5778aed34b0",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 110,
        "y": 320,
        "wires": [
            [
                "f758201befab6fdb"
            ]
        ]
    },
    {
        "id": "f758201befab6fdb",
        "type": "json",
        "z": "240e9138468e39f6",
        "g": "ec0e2ac7900fa3f9",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 450,
        "y": 320,
        "wires": [
            [
                "4877d8019e62a313"
            ]
        ]
    },
    {
        "id": "f144670f5c1d4397",
        "type": "change",
        "z": "240e9138468e39f6",
        "g": "41653db2dbc8eff5",
        "name": "Estado LED Rojo",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.LEDs.Rojo",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1310,
        "y": 100,
        "wires": [
            [
                "8fd217ed9224341c",
                "bed29fa72c8f9e99",
                "debd5c63615fff3e"
            ]
        ]
    },
    {
        "id": "22e6850228ea80f7",
        "type": "change",
        "z": "240e9138468e39f6",
        "g": "41653db2dbc8eff5",
        "name": "Estado LED verde",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.LEDs.Verde",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1310,
        "y": 240,
        "wires": [
            [
                "cd061775fa6b345c",
                "1eb41ef80e3d5aa2",
                "18c7c585c8eb32ef"
            ]
        ]
    },
    {
        "id": "708dcf7d93f0e426",
        "type": "change",
        "z": "240e9138468e39f6",
        "g": "ef3d086a30a1b87a",
        "name": "Presión",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.BME280.Presion",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 380,
        "wires": [
            [
                "5983285fa86d9906"
            ]
        ]
    },
    {
        "id": "e8d076d673b0062f",
        "type": "change",
        "z": "240e9138468e39f6",
        "g": "e1419462044728a3",
        "name": "Humedad",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.BME280.Humedad",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 540,
        "wires": [
            [
                "fa83b2151127c727"
            ]
        ]
    },
    {
        "id": "5b1970f2b93f41df",
        "type": "change",
        "z": "240e9138468e39f6",
        "g": "e539cc8d8670fa6a",
        "name": "Temperatura",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.BME280.Temperatura",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 640,
        "wires": [
            [
                "1d40c067aa6b81e9",
                "945f9d8631965dc1",
                "ed18196da15b9d12",
                "4768707a9098fb23"
            ]
        ]
    },
    {
        "id": "767ec8fc4ab1f4c1",
        "type": "smooth",
        "z": "240e9138468e39f6",
        "g": "8344f882bc6f7e0a",
        "name": "",
        "property": "payload",
        "action": "max",
        "count": "100",
        "round": "",
        "mult": "single",
        "reduce": false,
        "x": 360,
        "y": 500,
        "wires": [
            [
                "2a31ee24cca2ccc1"
            ]
        ]
    },
    {
        "id": "a56dd440b8eb4d6b",
        "type": "ui_text",
        "z": "240e9138468e39f6",
        "g": "8344f882bc6f7e0a",
        "group": "3d72c6d43da61785",
        "order": 7,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Tiempo de funcionamiento",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 770,
        "y": 800,
        "wires": []
    },
    {
        "id": "0d71042f96fd60e5",
        "type": "change",
        "z": "240e9138468e39f6",
        "g": "8344f882bc6f7e0a",
        "name": "uptime_ms",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.uptime_ms",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "uptime_ms",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 190,
        "y": 800,
        "wires": [
            [
                "8ede5d4f32a0687f"
            ]
        ]
    },
    {
        "id": "d81eb3faf849abe0",
        "type": "smooth",
        "z": "240e9138468e39f6",
        "g": "8344f882bc6f7e0a",
        "name": "",
        "property": "payload",
        "action": "min",
        "count": "100",
        "round": "",
        "mult": "single",
        "reduce": false,
        "x": 360,
        "y": 560,
        "wires": [
            [
                "2a0a6c8ba2f2d020"
            ]
        ]
    },
    {
        "id": "2a0a6c8ba2f2d020",
        "type": "ui_text",
        "z": "240e9138468e39f6",
        "g": "8344f882bc6f7e0a",
        "group": "3d72c6d43da61785",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": " RSSI mínimo",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 820,
        "y": 560,
        "wires": []
    },
    {
        "id": "2a31ee24cca2ccc1",
        "type": "ui_text",
        "z": "240e9138468e39f6",
        "g": "8344f882bc6f7e0a",
        "group": "3d72c6d43da61785",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": " RSSI máximo",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 820,
        "y": 500,
        "wires": []
    },
    {
        "id": "8ede5d4f32a0687f",
        "type": "function",
        "z": "240e9138468e39f6",
        "g": "8344f882bc6f7e0a",
        "name": "",
        "func": "var ms = msg.payload;\nconst days = Math.floor(ms / (24 * 60 * 60 * 1000));\nconst daysms = ms % (24 * 60 * 60 * 1000);\nconst hours = Math.floor(daysms / (60 * 60 * 1000));\nconst hoursms = ms % (60 * 60 * 1000);\nconst minutes = Math.floor(hoursms / (60 * 1000));\nconst minutesms = ms % (60 * 1000);\nmsg.payload = {};\nmsg.payload = days + \" días \" + hours + \"h \" + minutes + \"m \";\nreturn msg",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 440,
        "y": 800,
        "wires": [
            [
                "a56dd440b8eb4d6b"
            ]
        ]
    },
    {
        "id": "42cfb30568599827",
        "type": "link in",
        "z": "240e9138468e39f6",
        "g": "41653db2dbc8eff5",
        "name": "Salida_json",
        "links": [
            "4877d8019e62a313",
            "ca41f1007c32e3c3"
        ],
        "x": 1135,
        "y": 100,
        "wires": [
            [
                "f144670f5c1d4397"
            ]
        ]
    },
    {
        "id": "4877d8019e62a313",
        "type": "link out",
        "z": "240e9138468e39f6",
        "g": "ec0e2ac7900fa3f9",
        "name": "Salida_json",
        "links": [
            "42cfb30568599827",
            "507ee572dc146a37",
            "3914849762882418",
            "f27af90432a9d1ce",
            "f6cba8292f57fa68",
            "5a66b6806f77c5af",
            "f70e16858d537dd9",
            "8c1a1a4cb1f00504",
            "9128ab6fdf7afcdb",
            "081d3184c85328e8",
            "93556662e19cbdb7",
            "86861dbaf0395be9",
            "19182511d5a9c13a",
            "b0d289625ed1b4bc",
            "f847774e7a2cf413",
            "beed1420c3d87fff",
            "d8eeb12df7891916",
            "558414ec8a70ece0",
            "8ae5b84bd31d03da",
            "5edea480ab8a051b",
            "1f597d2636989d4f",
            "52d87709f6176090",
            "d02bca1c3752a1b1",
            "7547bfad5a02511d",
            "b067b408b502966a",
            "94d8182d038b09cf",
            "c643aead9980b2f5",
            "5bdefd42a80b318e",
            "39bc11bb85879eb6",
            "743b935e2b14ddda",
            "11d036d1910fb8cc",
            "fd83f404d2822d12",
            "cfeb876b04368a8d",
            "3f191666db19b70b"
        ],
        "x": 895,
        "y": 320,
        "wires": []
    },
    {
        "id": "507ee572dc146a37",
        "type": "link in",
        "z": "240e9138468e39f6",
        "g": "41653db2dbc8eff5",
        "name": "Salida_json",
        "links": [
            "4877d8019e62a313",
            "ca41f1007c32e3c3"
        ],
        "x": 1135,
        "y": 240,
        "wires": [
            [
                "22e6850228ea80f7"
            ]
        ]
    },
    {
        "id": "3914849762882418",
        "type": "link in",
        "z": "240e9138468e39f6",
        "g": "ef3d086a30a1b87a",
        "name": "Salida_json",
        "links": [
            "4877d8019e62a313",
            "ca41f1007c32e3c3"
        ],
        "x": 1135,
        "y": 380,
        "wires": [
            [
                "708dcf7d93f0e426"
            ]
        ]
    },
    {
        "id": "f27af90432a9d1ce",
        "type": "link in",
        "z": "240e9138468e39f6",
        "g": "e1419462044728a3",
        "name": "Salida_json",
        "links": [
            "4877d8019e62a313",
            "ca41f1007c32e3c3"
        ],
        "x": 1135,
        "y": 540,
        "wires": [
            [
                "e8d076d673b0062f"
            ]
        ]
    },
    {
        "id": "f6cba8292f57fa68",
        "type": "link in",
        "z": "240e9138468e39f6",
        "g": "e539cc8d8670fa6a",
        "name": "Salida_json",
        "links": [
            "4877d8019e62a313",
            "ca41f1007c32e3c3"
        ],
        "x": 1135,
        "y": 640,
        "wires": [
            [
                "5b1970f2b93f41df"
            ]
        ]
    },
    {
        "id": "f70e16858d537dd9",
        "type": "link in",
        "z": "240e9138468e39f6",
        "g": "8344f882bc6f7e0a",
        "name": "Salida_json",
        "links": [
            "4877d8019e62a313",
            "ca41f1007c32e3c3"
        ],
        "x": 55,
        "y": 500,
        "wires": [
            [
                "ba4e16a101fa8be0"
            ]
        ]
    },
    {
        "id": "8c1a1a4cb1f00504",
        "type": "link in",
        "z": "240e9138468e39f6",
        "g": "8344f882bc6f7e0a",
        "name": "Salida_json",
        "links": [
            "4877d8019e62a313",
            "ca41f1007c32e3c3"
        ],
        "x": 55,
        "y": 560,
        "wires": [
            [
                "b92239618d897343"
            ]
        ]
    },
    {
        "id": "9128ab6fdf7afcdb",
        "type": "link in",
        "z": "240e9138468e39f6",
        "g": "8344f882bc6f7e0a",
        "name": "Salida_json",
        "links": [
            "4877d8019e62a313",
            "ca41f1007c32e3c3"
        ],
        "x": 55,
        "y": 800,
        "wires": [
            [
                "0d71042f96fd60e5"
            ]
        ]
    },
    {
        "id": "26e6dec50cd22e0e",
        "type": "ui_text",
        "z": "240e9138468e39f6",
        "g": "8344f882bc6f7e0a",
        "group": "3d72c6d43da61785",
        "order": 8,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "interval_s",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 820,
        "y": 860,
        "wires": []
    },
    {
        "id": "86861dbaf0395be9",
        "type": "link in",
        "z": "240e9138468e39f6",
        "g": "8344f882bc6f7e0a",
        "name": "Salida_json",
        "links": [
            "4877d8019e62a313",
            "ca41f1007c32e3c3"
        ],
        "x": 55,
        "y": 440,
        "wires": [
            [
                "5032016908db4ee9"
            ]
        ]
    },
    {
        "id": "5032016908db4ee9",
        "type": "change",
        "z": "240e9138468e39f6",
        "g": "8344f882bc6f7e0a",
        "name": "SSID",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.SSID",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "SSID",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 170,
        "y": 440,
        "wires": [
            [
                "3809a9e51818d6af"
            ]
        ]
    },
    {
        "id": "3809a9e51818d6af",
        "type": "ui_text",
        "z": "240e9138468e39f6",
        "g": "8344f882bc6f7e0a",
        "group": "3d72c6d43da61785",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "SSID",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 850,
        "y": 440,
        "wires": []
    },
    {
        "id": "0bd685e285d408cc",
        "type": "change",
        "z": "240e9138468e39f6",
        "g": "8344f882bc6f7e0a",
        "name": "RSSI",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.RSSI",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "RSSI",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 170,
        "y": 620,
        "wires": [
            [
                "bc9372d0930381e5"
            ]
        ]
    },
    {
        "id": "19182511d5a9c13a",
        "type": "link in",
        "z": "240e9138468e39f6",
        "g": "8344f882bc6f7e0a",
        "name": "Salida_json",
        "links": [
            "4877d8019e62a313",
            "ca41f1007c32e3c3"
        ],
        "x": 55,
        "y": 620,
        "wires": [
            [
                "0bd685e285d408cc"
            ]
        ]
    },
    {
        "id": "bc9372d0930381e5",
        "type": "ui_text",
        "z": "240e9138468e39f6",
        "g": "8344f882bc6f7e0a",
        "group": "3d72c6d43da61785",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "RSSI",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 850,
        "y": 620,
        "wires": []
    },
    {
        "id": "b0d289625ed1b4bc",
        "type": "link in",
        "z": "240e9138468e39f6",
        "g": "8344f882bc6f7e0a",
        "name": "Salida_json",
        "links": [
            "4877d8019e62a313",
            "ca41f1007c32e3c3"
        ],
        "x": 55,
        "y": 680,
        "wires": [
            [
                "c4a8b15e93c31f15"
            ]
        ]
    },
    {
        "id": "c4a8b15e93c31f15",
        "type": "change",
        "z": "240e9138468e39f6",
        "g": "8344f882bc6f7e0a",
        "name": "localIP",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.localIP",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "localIP",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 180,
        "y": 680,
        "wires": [
            [
                "0a9e4ee6f718cadc"
            ]
        ]
    },
    {
        "id": "0a9e4ee6f718cadc",
        "type": "ui_text",
        "z": "240e9138468e39f6",
        "g": "8344f882bc6f7e0a",
        "group": "3d72c6d43da61785",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "localIP",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 840,
        "y": 680,
        "wires": []
    },
    {
        "id": "b50489b6bd82b0f7",
        "type": "ui_text",
        "z": "240e9138468e39f6",
        "g": "8344f882bc6f7e0a",
        "group": "3d72c6d43da61785",
        "order": 6,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "macAddress",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 830,
        "y": 740,
        "wires": []
    },
    {
        "id": "a40836b65d6efe39",
        "type": "change",
        "z": "240e9138468e39f6",
        "g": "8344f882bc6f7e0a",
        "name": "macAddress",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.macAddress",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "macAddress",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 190,
        "y": 740,
        "wires": [
            [
                "b50489b6bd82b0f7"
            ]
        ]
    },
    {
        "id": "f847774e7a2cf413",
        "type": "link in",
        "z": "240e9138468e39f6",
        "g": "8344f882bc6f7e0a",
        "name": "Salida_json",
        "links": [
            "4877d8019e62a313",
            "ca41f1007c32e3c3"
        ],
        "x": 55,
        "y": 740,
        "wires": [
            [
                "a40836b65d6efe39"
            ]
        ]
    },
    {
        "id": "0095a0e0e54af22c",
        "type": "mqtt in",
        "z": "240e9138468e39f6",
        "g": "ea102138d043bafa",
        "name": "",
        "topic": "iot/datos/json",
        "qos": "2",
        "datatype": "auto",
        "broker": "64cdcf7a3b4cd223",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 110,
        "y": 1060,
        "wires": [
            [
                "3c29a4510d854a3c"
            ]
        ]
    },
    {
        "id": "815d1be594737e12",
        "type": "range",
        "z": "240e9138468e39f6",
        "g": "ea102138d043bafa",
        "minin": "0",
        "maxin": "1023",
        "minout": "0",
        "maxout": "100",
        "action": "scale",
        "round": false,
        "property": "payload",
        "name": "",
        "x": 600,
        "y": 1060,
        "wires": [
            [
                "040b51d90c4176d1"
            ]
        ]
    },
    {
        "id": "040b51d90c4176d1",
        "type": "ui_gauge",
        "z": "240e9138468e39f6",
        "g": "ea102138d043bafa",
        "name": "",
        "group": "bf64e5c6fbbba3c3",
        "order": 0,
        "width": 0,
        "height": 0,
        "gtype": "donut",
        "title": "Dato ADC - método 2",
        "label": "%",
        "format": "{{value | number:1}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 880,
        "y": 1060,
        "wires": []
    },
    {
        "id": "3c29a4510d854a3c",
        "type": "json",
        "z": "240e9138468e39f6",
        "g": "ea102138d043bafa",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 270,
        "y": 1060,
        "wires": [
            [
                "7133b14cba1fa09f"
            ]
        ]
    },
    {
        "id": "7133b14cba1fa09f",
        "type": "change",
        "z": "240e9138468e39f6",
        "g": "ea102138d043bafa",
        "name": "Iluminación",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.ADC.Iluminacion",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Iluminacion",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 430,
        "y": 1060,
        "wires": [
            [
                "815d1be594737e12"
            ]
        ]
    },
    {
        "id": "b5c7f119232a415d",
        "type": "change",
        "z": "240e9138468e39f6",
        "g": "8344f882bc6f7e0a",
        "name": "interval_s",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.interval_s",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "interval_s",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 190,
        "y": 860,
        "wires": [
            [
                "26e6dec50cd22e0e"
            ]
        ]
    },
    {
        "id": "93556662e19cbdb7",
        "type": "link in",
        "z": "240e9138468e39f6",
        "g": "8344f882bc6f7e0a",
        "name": "Salida_json",
        "links": [
            "4877d8019e62a313",
            "ca41f1007c32e3c3"
        ],
        "x": 55,
        "y": 860,
        "wires": [
            [
                "b5c7f119232a415d"
            ]
        ]
    },
    {
        "id": "5050aab76f29694f",
        "type": "function",
        "z": "240e9138468e39f6",
        "g": "297629dbd540b327",
        "name": "",
        "func": "var dato = Number(msg.payload);\nmsg.payload = dato;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 400,
        "y": 960,
        "wires": [
            [
                "cc7b38fd3c9c7256"
            ]
        ]
    },
    {
        "id": "cc7b38fd3c9c7256",
        "type": "range",
        "z": "240e9138468e39f6",
        "g": "297629dbd540b327",
        "minin": "0",
        "maxin": "1023",
        "minout": "0",
        "maxout": "100",
        "action": "scale",
        "round": false,
        "property": "payload",
        "name": "",
        "x": 620,
        "y": 960,
        "wires": [
            [
                "5bab50b9af0e76e6"
            ]
        ]
    },
    {
        "id": "5bab50b9af0e76e6",
        "type": "ui_gauge",
        "z": "240e9138468e39f6",
        "g": "297629dbd540b327",
        "name": "",
        "group": "bf64e5c6fbbba3c3",
        "order": 0,
        "width": 0,
        "height": 0,
        "gtype": "donut",
        "title": "Dato ADC - método 1",
        "label": "%",
        "format": "{{value | number:1}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 880,
        "y": 960,
        "wires": []
    },
    {
        "id": "08e84a4803e5357c",
        "type": "change",
        "z": "240e9138468e39f6",
        "g": "297629dbd540b327",
        "name": "ADC Iluminacion",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.ADC.Iluminacion",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Iluminacion",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 210,
        "y": 960,
        "wires": [
            [
                "5050aab76f29694f"
            ]
        ]
    },
    {
        "id": "558414ec8a70ece0",
        "type": "link in",
        "z": "240e9138468e39f6",
        "g": "297629dbd540b327",
        "name": "Salida_json",
        "links": [
            "4877d8019e62a313",
            "ca41f1007c32e3c3"
        ],
        "x": 55,
        "y": 960,
        "wires": [
            [
                "08e84a4803e5357c"
            ]
        ]
    },
    {
        "id": "67916ee760372007",
        "type": "mqtt out",
        "z": "240e9138468e39f6",
        "name": "",
        "topic": "iot/cmd",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "64cdcf7a3b4cd223",
        "x": 2220,
        "y": 680,
        "wires": []
    },
    {
        "id": "a319282dc20b1712",
        "type": "link out",
        "z": "240e9138468e39f6",
        "g": "e539cc8d8670fa6a",
        "name": "",
        "links": [
            "4782d39686faaf05"
        ],
        "x": 1715,
        "y": 880,
        "wires": []
    },
    {
        "id": "4782d39686faaf05",
        "type": "link in",
        "z": "240e9138468e39f6",
        "name": "salida40",
        "links": [
            "a319282dc20b1712",
            "137df09f21d87c2f",
            "e4b1a3e75cbffc3c",
            "1fcd6ed1f5c0e56b",
            "d84be5d03107784f",
            "5f88d082e806c797",
            "bbb20cdb546b67e4",
            "14adc4302a095dcd",
            "1fdb812675334775"
        ],
        "x": 2105,
        "y": 680,
        "wires": [
            [
                "67916ee760372007"
            ]
        ]
    },
    {
        "id": "137df09f21d87c2f",
        "type": "link out",
        "z": "240e9138468e39f6",
        "g": "e539cc8d8670fa6a",
        "name": "",
        "links": [
            "4782d39686faaf05"
        ],
        "x": 1715,
        "y": 960,
        "wires": []
    },
    {
        "id": "e4b1a3e75cbffc3c",
        "type": "link out",
        "z": "240e9138468e39f6",
        "g": "8c42595fd702f856",
        "name": "",
        "links": [
            "4782d39686faaf05"
        ],
        "x": 2155,
        "y": 100,
        "wires": []
    },
    {
        "id": "d84be5d03107784f",
        "type": "link out",
        "z": "240e9138468e39f6",
        "g": "6793a44395d337f2",
        "name": "",
        "links": [
            "4782d39686faaf05"
        ],
        "x": 2155,
        "y": 240,
        "wires": []
    },
    {
        "id": "b92239618d897343",
        "type": "change",
        "z": "240e9138468e39f6",
        "g": "8344f882bc6f7e0a",
        "name": "RSSI",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.RSSI",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "RSSI",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 170,
        "y": 560,
        "wires": [
            [
                "d81eb3faf849abe0"
            ]
        ]
    },
    {
        "id": "ba4e16a101fa8be0",
        "type": "change",
        "z": "240e9138468e39f6",
        "g": "8344f882bc6f7e0a",
        "name": "RSSI",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.RSSI",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "RSSI",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 170,
        "y": 500,
        "wires": [
            [
                "767ec8fc4ab1f4c1"
            ]
        ]
    },
    {
        "id": "a6047788ab02d9a9",
        "type": "mqtt in",
        "z": "79e1efd2b7cf0d02",
        "g": "b4fed83d261cb969",
        "name": "Estado led rojo",
        "topic": "iot/rojo/estado",
        "qos": "2",
        "datatype": "auto",
        "broker": "64cdcf7a3b4cd223",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 180,
        "y": 100,
        "wires": [
            [
                "50d46fc6a3d3de6f",
                "069a53d25b9aa378"
            ]
        ]
    },
    {
        "id": "c3149fa7f57a0629",
        "type": "mqtt out",
        "z": "79e1efd2b7cf0d02",
        "g": "90e7335f291ea8dd",
        "name": "Led verde",
        "topic": "iot/verde/cmd",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "64cdcf7a3b4cd223",
        "x": 1260,
        "y": 600,
        "wires": []
    },
    {
        "id": "9bb4c76ed0081af5",
        "type": "inject",
        "z": "79e1efd2b7cf0d02",
        "g": "90e7335f291ea8dd",
        "name": "On",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "num",
        "x": 1070,
        "y": 580,
        "wires": [
            [
                "c3149fa7f57a0629"
            ]
        ]
    },
    {
        "id": "d32919527242649d",
        "type": "mqtt in",
        "z": "79e1efd2b7cf0d02",
        "g": "352236264866bec3",
        "name": "Temperatura",
        "topic": "iot/datos/temperatura",
        "qos": "2",
        "datatype": "auto",
        "broker": "64cdcf7a3b4cd223",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 150,
        "y": 640,
        "wires": [
            [
                "14f6a7e0e4dc4c60",
                "f976c7673e81d293",
                "8fbe2a5338dc462a",
                "56c8d43912b75a02"
            ]
        ]
    },
    {
        "id": "6cd380be060dd2e6",
        "type": "mqtt in",
        "z": "79e1efd2b7cf0d02",
        "g": "c988676a32d00f8b",
        "name": "Humedad",
        "topic": "iot/datos/humedad",
        "qos": "2",
        "datatype": "auto",
        "broker": "64cdcf7a3b4cd223",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 140,
        "y": 540,
        "wires": [
            [
                "1aec4f35e986a00b"
            ]
        ]
    },
    {
        "id": "67d101b1b5a89ffb",
        "type": "mqtt in",
        "z": "79e1efd2b7cf0d02",
        "g": "d4b6d2cdca33cc65",
        "name": "Presión",
        "topic": "iot/datos/presion",
        "qos": "2",
        "datatype": "auto",
        "broker": "64cdcf7a3b4cd223",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 130,
        "y": 380,
        "wires": [
            [
                "5c18989c01bf38c8"
            ]
        ]
    },
    {
        "id": "14f6a7e0e4dc4c60",
        "type": "function",
        "z": "79e1efd2b7cf0d02",
        "g": "352236264866bec3",
        "name": "",
        "func": "msg.topic = \"temperatura\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 420,
        "y": 640,
        "wires": [
            [
                "554ee62bb7f8dead"
            ]
        ]
    },
    {
        "id": "1aec4f35e986a00b",
        "type": "change",
        "z": "79e1efd2b7cf0d02",
        "g": "c988676a32d00f8b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "humedad",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 390,
        "y": 540,
        "wires": [
            [
                "e6055b97ee0fecfe"
            ]
        ]
    },
    {
        "id": "7eb497ab812a25be",
        "type": "mqtt out",
        "z": "79e1efd2b7cf0d02",
        "g": "e6031d3ff7a2c7b4",
        "name": "Led rojo",
        "topic": "iot/rojo/cmd",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "64cdcf7a3b4cd223",
        "x": 1260,
        "y": 440,
        "wires": []
    },
    {
        "id": "0318856b60cbd6e1",
        "type": "inject",
        "z": "79e1efd2b7cf0d02",
        "g": "e6031d3ff7a2c7b4",
        "name": "On",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "num",
        "x": 1070,
        "y": 420,
        "wires": [
            [
                "7eb497ab812a25be"
            ]
        ]
    },
    {
        "id": "6e26c3bd36cae061",
        "type": "inject",
        "z": "79e1efd2b7cf0d02",
        "g": "90e7335f291ea8dd",
        "name": "Off",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "0",
        "payloadType": "num",
        "x": 1070,
        "y": 620,
        "wires": [
            [
                "c3149fa7f57a0629"
            ]
        ]
    },
    {
        "id": "2e8f03dc1c942c24",
        "type": "inject",
        "z": "79e1efd2b7cf0d02",
        "g": "e6031d3ff7a2c7b4",
        "name": "Off",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "0",
        "payloadType": "num",
        "x": 1070,
        "y": 460,
        "wires": [
            [
                "7eb497ab812a25be"
            ]
        ]
    },
    {
        "id": "5b4db520284435b2",
        "type": "mqtt in",
        "z": "79e1efd2b7cf0d02",
        "g": "b4fed83d261cb969",
        "name": "Estado led verde",
        "topic": "iot/verde/estado",
        "qos": "2",
        "datatype": "auto",
        "broker": "64cdcf7a3b4cd223",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 160,
        "y": 240,
        "wires": [
            [
                "3964eb999b71da93",
                "be8c6fca32a6f82c",
                "5508fdeecdc940bb"
            ]
        ]
    },
    {
        "id": "3964eb999b71da93",
        "type": "ui_led",
        "z": "79e1efd2b7cf0d02",
        "g": "b4fed83d261cb969",
        "order": 3,
        "group": "fadc24b19848c47b",
        "width": "4",
        "height": "1",
        "label": "LED ",
        "labelPlacement": "left",
        "labelAlignment": "center",
        "colorForValue": [
            {
                "color": "#33d17a",
                "value": "on",
                "valueType": "str"
            },
            {
                "color": "#9a9996",
                "value": "off",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 670,
        "y": 240,
        "wires": []
    },
    {
        "id": "e7a52f948e70f729",
        "type": "ui_button",
        "z": "79e1efd2b7cf0d02",
        "g": "e37aeb7da330393e",
        "name": "",
        "group": "fadc24b19848c47b",
        "order": 1,
        "width": "1",
        "height": "1",
        "passthru": false,
        "label": "On",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "1",
        "payloadType": "num",
        "topic": "topic",
        "topicType": "msg",
        "x": 1050,
        "y": 220,
        "wires": [
            [
                "4fe663ed27d540de"
            ]
        ]
    },
    {
        "id": "f0e063bdf3c27c89",
        "type": "ui_button",
        "z": "79e1efd2b7cf0d02",
        "g": "e37aeb7da330393e",
        "name": "",
        "group": "fadc24b19848c47b",
        "order": 2,
        "width": "1",
        "height": "1",
        "passthru": false,
        "label": "Off",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "0",
        "payloadType": "num",
        "topic": "topic",
        "topicType": "msg",
        "x": 1050,
        "y": 260,
        "wires": [
            [
                "4fe663ed27d540de"
            ]
        ]
    },
    {
        "id": "6ecf19a0e1375f1e",
        "type": "mqtt out",
        "z": "79e1efd2b7cf0d02",
        "g": "c74e5f6560244f59",
        "name": "Led rojo",
        "topic": "iot/rojo/cmd",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "64cdcf7a3b4cd223",
        "x": 1260,
        "y": 100,
        "wires": []
    },
    {
        "id": "4fe663ed27d540de",
        "type": "mqtt out",
        "z": "79e1efd2b7cf0d02",
        "g": "e37aeb7da330393e",
        "name": "Led verde",
        "topic": "iot/verde/cmd",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "64cdcf7a3b4cd223",
        "x": 1260,
        "y": 240,
        "wires": []
    },
    {
        "id": "d786eed394f22b5a",
        "type": "ui_text",
        "z": "79e1efd2b7cf0d02",
        "g": "352236264866bec3",
        "group": "13bc2dd9a45cc0e9",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Última actualización",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 620,
        "y": 680,
        "wires": []
    },
    {
        "id": "f976c7673e81d293",
        "type": "function",
        "z": "79e1efd2b7cf0d02",
        "g": "352236264866bec3",
        "name": "",
        "func": "var fecha = new Date();\n\nmsg.payload = fecha.toLocaleString('es-ES', { timeZone: 'Europe/Madrid', hour12: false });\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 420,
        "y": 680,
        "wires": [
            [
                "d786eed394f22b5a"
            ]
        ]
    },
    {
        "id": "e6055b97ee0fecfe",
        "type": "ui_gauge",
        "z": "79e1efd2b7cf0d02",
        "g": "c988676a32d00f8b",
        "name": "",
        "group": "cb79f73074024dbb",
        "order": 1,
        "width": 0,
        "height": 0,
        "gtype": "wave",
        "title": "Humedad",
        "label": "%",
        "format": "{{value}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 660,
        "y": 540,
        "wires": []
    },
    {
        "id": "1d5b713945b2fdec",
        "type": "ui_chart",
        "z": "79e1efd2b7cf0d02",
        "g": "d4b6d2cdca33cc65",
        "name": "",
        "group": "d27cc3eaafc9bcc8",
        "order": 2,
        "width": 0,
        "height": 0,
        "label": "Presión (mbar)",
        "chartType": "line",
        "legend": "true",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 640,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "5c18989c01bf38c8",
        "type": "change",
        "z": "79e1efd2b7cf0d02",
        "g": "d4b6d2cdca33cc65",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Presión",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 370,
        "y": 380,
        "wires": [
            [
                "1d5b713945b2fdec"
            ]
        ]
    },
    {
        "id": "d6b149cd6e27b2a2",
        "type": "inject",
        "z": "79e1efd2b7cf0d02",
        "g": "d4b6d2cdca33cc65",
        "name": "Reset chart",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "[ ]",
        "payloadType": "json",
        "x": 370,
        "y": 440,
        "wires": [
            [
                "1d5b713945b2fdec"
            ]
        ]
    },
    {
        "id": "b6ce87f818aaecac",
        "type": "smooth",
        "z": "79e1efd2b7cf0d02",
        "g": "352236264866bec3",
        "name": "",
        "property": "payload",
        "action": "mean",
        "count": "6",
        "round": "2",
        "mult": "single",
        "reduce": false,
        "x": 220,
        "y": 800,
        "wires": [
            [
                "9c366eefdfe04fbf"
            ]
        ]
    },
    {
        "id": "f968752fa6c28624",
        "type": "ui_chart",
        "z": "79e1efd2b7cf0d02",
        "g": "352236264866bec3",
        "name": "",
        "group": "13bc2dd9a45cc0e9",
        "order": 3,
        "width": 0,
        "height": 0,
        "label": "Temperatura (ºC)",
        "chartType": "line",
        "legend": "true",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 630,
        "y": 720,
        "wires": [
            []
        ]
    },
    {
        "id": "d89e4bd5d49896c3",
        "type": "inject",
        "z": "79e1efd2b7cf0d02",
        "g": "352236264866bec3",
        "name": "Reset chart",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "[ ]",
        "payloadType": "json",
        "x": 410,
        "y": 720,
        "wires": [
            [
                "f968752fa6c28624"
            ]
        ]
    },
    {
        "id": "8fbe2a5338dc462a",
        "type": "change",
        "z": "79e1efd2b7cf0d02",
        "g": "352236264866bec3",
        "name": "Actual",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "temperatura_actual",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 210,
        "y": 760,
        "wires": [
            [
                "b6ce87f818aaecac",
                "51acf678a736f6a1"
            ]
        ]
    },
    {
        "id": "554ee62bb7f8dead",
        "type": "ui_gauge",
        "z": "79e1efd2b7cf0d02",
        "g": "352236264866bec3",
        "name": "",
        "group": "13bc2dd9a45cc0e9",
        "order": 2,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Temperatura",
        "label": "ºC",
        "format": "{{value}}",
        "min": "-5",
        "max": "50",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 650,
        "y": 640,
        "wires": []
    },
    {
        "id": "9c366eefdfe04fbf",
        "type": "change",
        "z": "79e1efd2b7cf0d02",
        "g": "352236264866bec3",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "temperatura_media",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 230,
        "y": 840,
        "wires": [
            [
                "51acf678a736f6a1"
            ]
        ]
    },
    {
        "id": "51acf678a736f6a1",
        "type": "function",
        "z": "79e1efd2b7cf0d02",
        "g": "352236264866bec3",
        "name": "Diferencia actual y media",
        "func": "var msg1 = {};\nvar msg2 = {};\nvar msg3 = {};\ncontext.data = context.data || {};\nswitch (msg.topic){\n    case \"temperatura_media\":\n        context.data.temperatura_media = msg.payload;\n        msg = null;\n        break;\n    case \"temperatura_actual\":\n        context.data.temperatura_actual = msg.payload;\n        msg = null;\n        break;\n    default:\n        msg = null;\n        break;\n}\n\nif (context.data.temperatura_actual != null && context.data.temperatura_media != null){\n    msg1.payload = Math.abs(context.data.temperatura_actual-context.data.temperatura_media);\n    msg1.topic = \"Diferencia\";\n    msg2.payload = context.data.temperatura_actual;\n    msg2.topic = \"Actual\";\n    msg3.payload = context.data.temperatura_media;\n    msg3.topic = \"Media\";\n    context.data = null;\n    return [msg1, msg2, msg3];\n}else {return msg;}",
        "outputs": 3,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 450,
        "y": 800,
        "wires": [
            [
                "f968752fa6c28624"
            ],
            [
                "f968752fa6c28624"
            ],
            [
                "f968752fa6c28624"
            ]
        ]
    },
    {
        "id": "1a79e1f1d7d855e8",
        "type": "ui_text",
        "z": "79e1efd2b7cf0d02",
        "g": "b4fed83d261cb969",
        "group": "fadc24b19848c47b",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Última actualización",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "<style>     #nr-dashboard-cardtitle{text-align: center !important;} </style>",
        "x": 620,
        "y": 280,
        "wires": []
    },
    {
        "id": "50d46fc6a3d3de6f",
        "type": "function",
        "z": "79e1efd2b7cf0d02",
        "name": "",
        "func": "var fecha = new Date();\n\nmsg.payload = fecha.toLocaleString('es-ES', { timeZone: 'Europe/Madrid', hour12: false });\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "be8c6fca32a6f82c",
        "type": "function",
        "z": "79e1efd2b7cf0d02",
        "g": "b4fed83d261cb969",
        "name": "",
        "func": "var fecha = new Date();\n\nmsg.payload = fecha.toLocaleString('es-ES', { timeZone: 'Europe/Madrid', hour12: false });\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 280,
        "wires": [
            [
                "1a79e1f1d7d855e8"
            ]
        ]
    },
    {
        "id": "56c8d43912b75a02",
        "type": "switch",
        "z": "79e1efd2b7cf0d02",
        "g": "352236264866bec3",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "gte",
                "v": "25",
                "vt": "num"
            },
            {
                "t": "lt",
                "v": "25",
                "vt": "num"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 210,
        "y": 940,
        "wires": [
            [
                "20120fed3f616cf7",
                "ebb4b5aeaea3b4bb"
            ],
            [
                "94e421e9f0b7b91b",
                "503e802577b4e178"
            ]
        ]
    },
    {
        "id": "20120fed3f616cf7",
        "type": "change",
        "z": "79e1efd2b7cf0d02",
        "g": "352236264866bec3",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "off",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "0",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 420,
        "y": 920,
        "wires": [
            [
                "747f15d270d31b62"
            ]
        ]
    },
    {
        "id": "94e421e9f0b7b91b",
        "type": "change",
        "z": "79e1efd2b7cf0d02",
        "g": "352236264866bec3",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "on",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "1",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 420,
        "y": 960,
        "wires": [
            [
                "747f15d270d31b62"
            ]
        ]
    },
    {
        "id": "503e802577b4e178",
        "type": "change",
        "z": "79e1efd2b7cf0d02",
        "g": "352236264866bec3",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "off",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "0",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 420,
        "y": 1000,
        "wires": [
            [
                "b1be2beb5dab6d27"
            ]
        ]
    },
    {
        "id": "ebb4b5aeaea3b4bb",
        "type": "change",
        "z": "79e1efd2b7cf0d02",
        "g": "352236264866bec3",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "on",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "1",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 420,
        "y": 880,
        "wires": [
            [
                "b1be2beb5dab6d27"
            ]
        ]
    },
    {
        "id": "747f15d270d31b62",
        "type": "mqtt out",
        "z": "79e1efd2b7cf0d02",
        "g": "352236264866bec3",
        "name": "Led verde",
        "topic": "iot/verde/cmd",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "64cdcf7a3b4cd223",
        "x": 660,
        "y": 980,
        "wires": []
    },
    {
        "id": "b1be2beb5dab6d27",
        "type": "mqtt out",
        "z": "79e1efd2b7cf0d02",
        "g": "352236264866bec3",
        "name": "Led rojo",
        "topic": "iot/rojo/cmd",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "64cdcf7a3b4cd223",
        "x": 660,
        "y": 880,
        "wires": []
    },
    {
        "id": "9f1b88539a1d3436",
        "type": "inject",
        "z": "79e1efd2b7cf0d02",
        "g": "352236264866bec3",
        "name": "36",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "36",
        "payloadType": "num",
        "x": 150,
        "y": 1000,
        "wires": [
            [
                "56c8d43912b75a02"
            ]
        ]
    },
    {
        "id": "b002d636c993db56",
        "type": "ui_text",
        "z": "79e1efd2b7cf0d02",
        "g": "b4fed83d261cb969",
        "group": "fadc24b19848c47b",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Estado:",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 660,
        "y": 200,
        "wires": []
    },
    {
        "id": "5508fdeecdc940bb",
        "type": "function",
        "z": "79e1efd2b7cf0d02",
        "g": "b4fed83d261cb969",
        "name": "",
        "func": "switch (msg.payload) {\n    case \"off\":\n        msg.payload = \"Apagado\";\n        break;\n    default:\n        msg.payload = \"Encendido\";\n        break;\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 200,
        "wires": [
            [
                "b002d636c993db56"
            ]
        ]
    },
    {
        "id": "069a53d25b9aa378",
        "type": "function",
        "z": "79e1efd2b7cf0d02",
        "g": "b4fed83d261cb969",
        "name": "",
        "func": "switch (msg.payload) {\n    case \"off\":\n        msg.payload = \"Apagado\";\n        break;\n    default:\n        msg.payload = \"Encendido\";\n        break;\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "5bb9bc8965e13cb7",
        "type": "mqtt in",
        "z": "79e1efd2b7cf0d02",
        "g": "7f061c58298ef81e",
        "name": "",
        "topic": "iot/datos/adc_read",
        "qos": "2",
        "datatype": "auto",
        "broker": "64cdcf7a3b4cd223",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 170,
        "y": 1100,
        "wires": [
            [
                "0956face0e6f3598"
            ]
        ]
    },
    {
        "id": "0956face0e6f3598",
        "type": "function",
        "z": "79e1efd2b7cf0d02",
        "g": "7f061c58298ef81e",
        "name": "",
        "func": "var dato = Number(msg.payload);\nmsg.payload = dato;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 390,
        "y": 1100,
        "wires": [
            [
                "bd7ff32f4a4240c0"
            ]
        ]
    },
    {
        "id": "bd7ff32f4a4240c0",
        "type": "range",
        "z": "79e1efd2b7cf0d02",
        "g": "7f061c58298ef81e",
        "minin": "0",
        "maxin": "1023",
        "minout": "0",
        "maxout": "100",
        "action": "scale",
        "round": false,
        "property": "payload",
        "name": "",
        "x": 570,
        "y": 1100,
        "wires": [
            [
                "be8cec68cf632eef"
            ]
        ]
    },
    {
        "id": "be8cec68cf632eef",
        "type": "ui_gauge",
        "z": "79e1efd2b7cf0d02",
        "g": "7f061c58298ef81e",
        "name": "",
        "group": "1482f7c9cab5d4a1",
        "order": 0,
        "width": 0,
        "height": 0,
        "gtype": "donut",
        "title": "Dato ADC - método 1",
        "label": "%",
        "format": "{{value | number:1}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 850,
        "y": 1100,
        "wires": []
    },
    {
        "id": "c38d796ff32f7042",
        "type": "mqtt in",
        "z": "79e1efd2b7cf0d02",
        "g": "2a56d2a7be9c7b76",
        "name": "",
        "topic": "iot/datos/json",
        "qos": "2",
        "datatype": "auto",
        "broker": "64cdcf7a3b4cd223",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 150,
        "y": 1200,
        "wires": [
            [
                "64febcac4f03edfe"
            ]
        ]
    },
    {
        "id": "0b158c5b6bfceb48",
        "type": "range",
        "z": "79e1efd2b7cf0d02",
        "g": "2a56d2a7be9c7b76",
        "minin": "0",
        "maxin": "1023",
        "minout": "0",
        "maxout": "100",
        "action": "scale",
        "round": false,
        "property": "payload",
        "name": "",
        "x": 640,
        "y": 1200,
        "wires": [
            [
                "42d0e8a2a2d23c0e"
            ]
        ]
    },
    {
        "id": "42d0e8a2a2d23c0e",
        "type": "ui_gauge",
        "z": "79e1efd2b7cf0d02",
        "g": "2a56d2a7be9c7b76",
        "name": "",
        "group": "1482f7c9cab5d4a1",
        "order": 0,
        "width": 0,
        "height": 0,
        "gtype": "donut",
        "title": "Dato ADC - método 2",
        "label": "%",
        "format": "{{value | number:1}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 840,
        "y": 1200,
        "wires": []
    },
    {
        "id": "64febcac4f03edfe",
        "type": "json",
        "z": "79e1efd2b7cf0d02",
        "g": "2a56d2a7be9c7b76",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 310,
        "y": 1200,
        "wires": [
            [
                "268cd8dcd1bc1833"
            ]
        ]
    },
    {
        "id": "268cd8dcd1bc1833",
        "type": "change",
        "z": "79e1efd2b7cf0d02",
        "g": "2a56d2a7be9c7b76",
        "name": "Iluminación",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.ADC.Iluminacion",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 470,
        "y": 1200,
        "wires": [
            [
                "0b158c5b6bfceb48"
            ]
        ]
    },
    {
        "id": "85747a3c6e9d4917",
        "type": "inject",
        "z": "24ab647bb9010131",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 120,
        "y": 120,
        "wires": [
            [
                "10e664ab558bae5a"
            ]
        ]
    },
    {
        "id": "10e664ab558bae5a",
        "type": "debug",
        "z": "24ab647bb9010131",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 890,
        "y": 160,
        "wires": []
    },
    {
        "id": "dc387c1f76236218",
        "type": "inject",
        "z": "24ab647bb9010131",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"writer\":\"rhyloo\",\"count\":42}",
        "payloadType": "json",
        "x": 120,
        "y": 300,
        "wires": [
            [
                "0ab09e898683690f"
            ]
        ]
    },
    {
        "id": "0ab09e898683690f",
        "type": "json",
        "z": "24ab647bb9010131",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 290,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "32c43b31552f946c",
        "type": "inject",
        "z": "24ab647bb9010131",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "print",
        "payload": "{\"writer\":\"rhyloo\",\"count\":42}",
        "payloadType": "json",
        "x": 590,
        "y": 380,
        "wires": [
            []
        ]
    },
    {
        "id": "89bb923a341d45cb",
        "type": "inject",
        "z": "24ab647bb9010131",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "aa",
        "payload": "{\"writer\":\"Peter\",\"count\":42}",
        "payloadType": "json",
        "x": 760,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "8dc6e36c47ea2ab3",
        "type": "comment",
        "z": "24ab647bb9010131",
        "name": "js",
        "info": "/* jshint browser: true, esversion: 6, asi: true */\n/* globals uibuilder */\n// @ts-nocheck\n\n/** Minimalist code for uibuilder and Node-RED */\n\n// return formatted HTML version of JSON object\nfunction syntaxHighlight(json) {\n    json = JSON.stringify(json, undefined, 4)\n    console.log(json)\n    json = json.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;')\n    json = json.replace(/(\"(\\\\u[a-zA-Z0-9]{4}|\\\\[^u]|[^\\\\\"])*\"(\\s*:)?|\\b(true|false|null)\\b|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?)/g, function (match) {\n        var cls = 'number'\n        if (/^\"/.test(match)) {\n            if (/:$/.test(match)) {\n                cls = 'key'\n            } else {\n                cls = 'string'\n            }\n        } else if (/true|false/.test(match)) {\n            cls = 'boolean'\n        } else if (/null/.test(match)) {\n            cls = 'null'\n        }\n        return '<span class=\"' + cls + '\">' + match + '</span>'\n    })\n    return json\n} // --- End of syntaxHighlight --- //\n\nfunction test(json) {\n    if (json.topic == \"print\")\n    json2 = json.payload.writer\n    else\n    json2 = json.payload.writer\n    return json2\n}\n\n// run this function when the document is loaded\nwindow.onload = function() {\n    // Start up uibuilder - see the docs for the optional parameters\n    uibuilder.start()\n\n    // Listen for incoming messages from Node-RED\n    uibuilder.onChange('msg', function(msg){\n        console.info('[indexjs:uibuilder.onChange] msg received from Node-RED server:', msg)\n        var msg2 = msg\n        // dump the msg as text to the \"msg\" html element\n        console.log(\"Console log msg:\" + msg)\n        console.log(msg)\n\n        const eMsg = document.getElementById('msg')\n        eMsg.innerHTML = syntaxHighlight(msg)\n        \n        console.log(\"Console log msg2:\" + msg)\n        // dump the msg as text to the \"msg\" html element\n        const eMsg2 = document.getElementById('writer')\n        eMsg2.innerHTML = test(msg2)\n    })\n    uibuilder.onChange('sentCtrlMsg', function (msg) {\n        \n}\n\n",
        "x": 220,
        "y": 520,
        "wires": []
    },
    {
        "id": "1c5c4c901bfbe1ad",
        "type": "comment",
        "z": "24ab647bb9010131",
        "name": "html",
        "info": "<!doctype html>\n<html lang=\"en\"><head>\n\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n\n    <title>Node-RED UI Builder - Blank template</title>\n    <meta name=\"description\" content=\"Node-RED UI Builder - Blank template\">\n    <link rel=\"icon\" href=\"./images/node-blue.ico\">\n\n    <link type=\"text/css\" rel=\"stylesheet\" href=\"./index.css\" media=\"all\">\n\n</head><body>\n    \n    <h1>uibuilder Blank Template</h1>\n    <pre id=\"msg\" class=\"syntax-highlight\">Waiting for a message from Node-RED</pre>\n    <pre id=\"writer\" class=\"syntax-highlight\">Waiting for a message from Node-RED</pre>\n<button class=\"md-raised md-button md-ink-ripple\" type=\"button\" ng-transclude=\"\" ng-click=\"me.buttonClick($event)\" ng-disabled=\"me.item.disabled\" aria-label=\"buttonOff\" ng-style=\"{'background-color':me.item.getText(), 'color':me.item.getColor(), 'z-index':1, 'padding':'0px'}\" style=\"z-index: 1; padding: 0px;\"> <ui-icon ng-show=\"me.item.icon.length\" icon=\"\" ng-style=\"{color:me.item.getColor()}\" aria-hidden=\"true\" class=\"ng-hide\"><!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> </ui-icon> <span ng-bind-html=\"me.item.getLabel()\">Off</span> <!----> <div class=\"md-ripple-container\" style=\"\"></div></button>\n<b-button pill variant=\"secondary\" v-on:click=\"sendMe\">Send Me</b-button>\n    <script src=\"../uibuilder/vendor/socket.io/socket.io.js\"></script>\n    <script src=\"./uibuilderfe.min.js\"></script>\n    <script src=\"./index.js\"></script>\n\n</body></html>",
        "x": 380,
        "y": 520,
        "wires": []
    },
    {
        "id": "49f9186afa7eb0ab",
        "type": "comment",
        "z": "24ab647bb9010131",
        "name": "css",
        "info": "/*  Colours for Syntax Highlighted pre's */\n.syntax-highlight {color:white;background-color:black;padding:5px 10px;}\n.syntax-highlight > .key {color:#ffbf35}\n.syntax-highlight > .string {color:#5dff39;}\n.syntax-highlight > .number {color:#70aeff;}\n.syntax-highlight > .boolean {color:#b993ff;}",
        "x": 540,
        "y": 520,
        "wires": []
    },
    {
        "id": "ed4df6a34c9bd10f",
        "type": "random",
        "z": "24ab647bb9010131",
        "name": "",
        "low": 1,
        "high": "100",
        "inte": "true",
        "property": "payload",
        "x": 120,
        "y": 440,
        "wires": [
            [
                "93a46bb79ea18a92"
            ]
        ]
    },
    {
        "id": "93a46bb79ea18a92",
        "type": "function",
        "z": "24ab647bb9010131",
        "name": "",
        "func": "var number = msg.payload\nmsg.payload = { \"water\": number, \"count\": 42 }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 300,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "83348437e1e546cf",
        "type": "inject",
        "z": "24ab647bb9010131",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "num",
        "x": 80,
        "y": 580,
        "wires": [
            [
                "ed4df6a34c9bd10f"
            ]
        ]
    },
    {
        "id": "02e19d82a87400f1",
        "type": "function",
        "z": "24ab647bb9010131",
        "name": "",
        "func": "msg.payload = msg.payload;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 560,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "dfaadf3ab199e00c",
        "type": "mqtt in",
        "z": "13df9ad25c9618e4",
        "g": "2f2d6fcd70cbfe4a",
        "name": "Estado y LWT",
        "topic": "infind/GRUPO3/conexion",
        "qos": "2",
        "datatype": "auto",
        "broker": "8b67b1bd51c43347",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 110,
        "y": 180,
        "wires": [
            [
                "d5b5d13671439e9a"
            ]
        ]
    },
    {
        "id": "1eaec8b318944fc3",
        "type": "debug",
        "z": "13df9ad25c9618e4",
        "g": "2f2d6fcd70cbfe4a",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 590,
        "y": 60,
        "wires": []
    },
    {
        "id": "56640648f318fb19",
        "type": "inject",
        "z": "13df9ad25c9618e4",
        "g": "2f2d6fcd70cbfe4a",
        "name": "Online",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"online\":true}",
        "payloadType": "str",
        "x": 110,
        "y": 60,
        "wires": [
            [
                "d5b5d13671439e9a"
            ]
        ]
    },
    {
        "id": "631359044b52c8b1",
        "type": "inject",
        "z": "13df9ad25c9618e4",
        "g": "2f2d6fcd70cbfe4a",
        "name": "Offline",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"online\":false}",
        "payloadType": "str",
        "x": 110,
        "y": 120,
        "wires": [
            [
                "d5b5d13671439e9a"
            ]
        ]
    },
    {
        "id": "a30adc92797161ad",
        "type": "mqtt in",
        "z": "13df9ad25c9618e4",
        "g": "31d7abf2d95de80e",
        "name": "Sensores",
        "topic": "infind/GRUPO3/datos",
        "qos": "2",
        "datatype": "auto",
        "broker": "8b67b1bd51c43347",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 100,
        "y": 400,
        "wires": [
            [
                "fd4c253fa4036aa9",
                "495dd803d5128cd4"
            ]
        ]
    },
    {
        "id": "e4e313be7cf72272",
        "type": "debug",
        "z": "13df9ad25c9618e4",
        "g": "31d7abf2d95de80e",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 410,
        "y": 280,
        "wires": []
    },
    {
        "id": "204e8951dbb09c53",
        "type": "inject",
        "z": "13df9ad25c9618e4",
        "g": "31d7abf2d95de80e",
        "name": "Datos",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{  \"Uptime\":12300,  \"Vcc\":4.97,  \"DHT11\":{\"temp\":-2.0,\"hum\":37.0},  \"LED\":100,  \"Wifi\":{\"SSId\":\"infind\",\"IP\":\"192.168.0.100\",\"RSSI\":56}  }",
        "payloadType": "str",
        "x": 130,
        "y": 280,
        "wires": [
            [
                "fd4c253fa4036aa9"
            ]
        ]
    },
    {
        "id": "9beb600c63b60280",
        "type": "mqtt in",
        "z": "13df9ad25c9618e4",
        "g": "5cba6c5db0d46559",
        "name": "Sensores",
        "topic": "infind/GRUPO3/led/status",
        "qos": "2",
        "datatype": "auto",
        "broker": "8b67b1bd51c43347",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 100,
        "y": 1020,
        "wires": [
            [
                "5ae2c99e08b2c418",
                "6f2c3dd3b98b38db"
            ]
        ]
    },
    {
        "id": "93107118806b4b86",
        "type": "inject",
        "z": "13df9ad25c9618e4",
        "g": "5cba6c5db0d46559",
        "name": "Status",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{ \"led\":75 }",
        "payloadType": "str",
        "x": 110,
        "y": 900,
        "wires": [
            [
                "5ae2c99e08b2c418"
            ]
        ],
        "info": "# Status\n\n- Topic: infind/GRUPOX/led/status\n- Acción: Publicar\n- Descripción: El dispositivo confirma la configuración de intensidad del LED [0-100] después de aplicarla\n- Ejemplo: { \"led\":75 } "
    },
    {
        "id": "b5d1dddf4e575f4e",
        "type": "link in",
        "z": "13df9ad25c9618e4",
        "g": "2f2d6fcd70cbfe4a",
        "name": "",
        "links": [
            "d5b5d13671439e9a"
        ],
        "x": 355,
        "y": 60,
        "wires": [
            [
                "1eaec8b318944fc3",
                "06e1a8509d49c5a1"
            ]
        ]
    },
    {
        "id": "d5b5d13671439e9a",
        "type": "link out",
        "z": "13df9ad25c9618e4",
        "g": "2f2d6fcd70cbfe4a",
        "name": "",
        "links": [
            "b5d1dddf4e575f4e"
        ],
        "x": 295,
        "y": 60,
        "wires": []
    },
    {
        "id": "fd4c253fa4036aa9",
        "type": "json",
        "z": "13df9ad25c9618e4",
        "g": "31d7abf2d95de80e",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 290,
        "y": 380,
        "wires": [
            [
                "e4e313be7cf72272",
                "ecccce0a5594afdb",
                "39d6fac3b45b36ea",
                "2a35eff3801fbdb8",
                "cdeea9f974f54573",
                "bee0e551b2c2a3bf",
                "30fc991dc7523ddb",
                "34d884309e9afa81"
            ]
        ]
    },
    {
        "id": "06e1a8509d49c5a1",
        "type": "json",
        "z": "13df9ad25c9618e4",
        "g": "2f2d6fcd70cbfe4a",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 430,
        "y": 120,
        "wires": [
            [
                "02738aad3e6d70d4"
            ]
        ]
    },
    {
        "id": "89c9e5866eeb4402",
        "type": "ui_led",
        "z": "13df9ad25c9618e4",
        "g": "2f2d6fcd70cbfe4a",
        "order": 1,
        "group": "b8b5fb6b4bfeb434",
        "width": "2",
        "height": "2",
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "false",
                "valueType": "bool"
            },
            {
                "color": "#008000",
                "value": "true",
                "valueType": "bool"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 630,
        "y": 180,
        "wires": []
    },
    {
        "id": "02738aad3e6d70d4",
        "type": "change",
        "z": "13df9ad25c9618e4",
        "g": "2f2d6fcd70cbfe4a",
        "name": "Online",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.online",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 470,
        "y": 180,
        "wires": [
            [
                "89c9e5866eeb4402"
            ]
        ]
    },
    {
        "id": "7873a2401884d320",
        "type": "ui_text",
        "z": "13df9ad25c9618e4",
        "g": "31d7abf2d95de80e",
        "group": "27e360b8dee7f0ae",
        "order": 0,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Uptime (s): ",
        "format": "{{msg.payload.Uptime}}",
        "layout": "row-left",
        "className": "",
        "x": 610,
        "y": 320,
        "wires": []
    },
    {
        "id": "ecccce0a5594afdb",
        "type": "function",
        "z": "13df9ad25c9618e4",
        "g": "31d7abf2d95de80e",
        "name": "ms",
        "func": "msg.payload.Uptime = msg.payload.Uptime/1000;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 440,
        "y": 320,
        "wires": [
            [
                "7873a2401884d320"
            ]
        ]
    },
    {
        "id": "39d6fac3b45b36ea",
        "type": "ui_gauge",
        "z": "13df9ad25c9618e4",
        "g": "31d7abf2d95de80e",
        "name": "",
        "group": "27e360b8dee7f0ae",
        "order": 2,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Voltios Vcc",
        "label": "V",
        "format": "{{msg.payload.Vcc}}",
        "min": 0,
        "max": "5",
        "colors": [
            "#ff0000",
            "#e6e600",
            "#008080"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 610,
        "y": 360,
        "wires": []
    },
    {
        "id": "2a35eff3801fbdb8",
        "type": "ui_gauge",
        "z": "13df9ad25c9618e4",
        "g": "31d7abf2d95de80e",
        "name": "",
        "group": "27e360b8dee7f0ae",
        "order": 2,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Temperatura",
        "label": "ºC",
        "format": "{{msg.payload.DHT11.temp | number:1}}",
        "min": "-5",
        "max": "50",
        "colors": [
            "#0080ff",
            "#00ff00",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 610,
        "y": 400,
        "wires": []
    },
    {
        "id": "0fc0b1c73d0162a9",
        "type": "inject",
        "z": "13df9ad25c9618e4",
        "g": "c59e69ccdd22540f",
        "name": "Nivel: 75",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "5",
        "topic": "",
        "payload": "{ \"level\":75 }",
        "payloadType": "str",
        "x": 120,
        "y": 660,
        "wires": [
            [
                "02e9f915f64990b0"
            ]
        ]
    },
    {
        "id": "02e9f915f64990b0",
        "type": "mqtt out",
        "z": "13df9ad25c9618e4",
        "g": "c59e69ccdd22540f",
        "name": "Set Level",
        "topic": "infind/GRUPO3/led/cmd",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "8b67b1bd51c43347",
        "x": 540,
        "y": 720,
        "wires": []
    },
    {
        "id": "e741bb926c073ddc",
        "type": "inject",
        "z": "13df9ad25c9618e4",
        "g": "c59e69ccdd22540f",
        "name": "Nivel:0",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "7.5",
        "topic": "",
        "payload": "{ \"level\":0}",
        "payloadType": "str",
        "x": 110,
        "y": 700,
        "wires": [
            [
                "02e9f915f64990b0"
            ]
        ]
    },
    {
        "id": "cdeea9f974f54573",
        "type": "ui_gauge",
        "z": "13df9ad25c9618e4",
        "g": "31d7abf2d95de80e",
        "name": "",
        "group": "27e360b8dee7f0ae",
        "order": 2,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Humedad",
        "label": "%",
        "format": "{{msg.payload.DHT11.hum}}",
        "min": "0",
        "max": "100",
        "colors": [
            "#0080ff",
            "#00ff00",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 600,
        "y": 440,
        "wires": []
    },
    {
        "id": "495dd803d5128cd4",
        "type": "debug",
        "z": "13df9ad25c9618e4",
        "g": "31d7abf2d95de80e",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 300,
        "y": 440,
        "wires": []
    },
    {
        "id": "1031733d058764be",
        "type": "ui_slider",
        "z": "13df9ad25c9618e4",
        "g": "c59e69ccdd22540f",
        "name": "",
        "label": "Nivel LED",
        "tooltip": "",
        "group": "27e360b8dee7f0ae",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": true,
        "outs": "end",
        "topic": "topic",
        "topicType": "msg",
        "min": 0,
        "max": "100",
        "step": 1,
        "className": "",
        "x": 100,
        "y": 800,
        "wires": [
            [
                "612853001cbb9f90"
            ]
        ]
    },
    {
        "id": "612853001cbb9f90",
        "type": "function",
        "z": "13df9ad25c9618e4",
        "g": "c59e69ccdd22540f",
        "name": "",
        "func": "msg.payload= \"{ \\\"level\\\":\"+msg.payload+\" }\"\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 300,
        "y": 800,
        "wires": [
            [
                "02e9f915f64990b0"
            ]
        ]
    },
    {
        "id": "bee0e551b2c2a3bf",
        "type": "ui_text",
        "z": "13df9ad25c9618e4",
        "g": "31d7abf2d95de80e",
        "group": "27e360b8dee7f0ae",
        "order": 0,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "SSId: ",
        "format": "{{msg.payload.Wifi.SSId}}",
        "layout": "row-left",
        "className": "",
        "x": 590,
        "y": 480,
        "wires": []
    },
    {
        "id": "30fc991dc7523ddb",
        "type": "ui_text",
        "z": "13df9ad25c9618e4",
        "g": "31d7abf2d95de80e",
        "group": "27e360b8dee7f0ae",
        "order": 0,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "IP: ",
        "format": "{{msg.payload.Wifi.IP}}",
        "layout": "row-left",
        "className": "",
        "x": 590,
        "y": 520,
        "wires": []
    },
    {
        "id": "34d884309e9afa81",
        "type": "ui_text",
        "z": "13df9ad25c9618e4",
        "g": "31d7abf2d95de80e",
        "group": "27e360b8dee7f0ae",
        "order": 0,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "RSSI: ",
        "format": "{{msg.payload.Wifi.RSSI}}",
        "layout": "row-left",
        "className": "",
        "x": 590,
        "y": 560,
        "wires": []
    },
    {
        "id": "29d5550a23b4d981",
        "type": "ui_gauge",
        "z": "13df9ad25c9618e4",
        "g": "5cba6c5db0d46559",
        "name": "",
        "group": "27e360b8dee7f0ae",
        "order": 8,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "gauge",
        "label": "units",
        "format": "{{msg.payload.led}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#005680",
            "#c0c0c0",
            "#80ffff"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 470,
        "y": 980,
        "wires": []
    },
    {
        "id": "5ae2c99e08b2c418",
        "type": "json",
        "z": "13df9ad25c9618e4",
        "g": "5cba6c5db0d46559",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 290,
        "y": 1000,
        "wires": [
            [
                "29d5550a23b4d981"
            ]
        ]
    },
    {
        "id": "6f2c3dd3b98b38db",
        "type": "debug",
        "z": "13df9ad25c9618e4",
        "g": "5cba6c5db0d46559",
        "name": "debug 4",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 440,
        "y": 900,
        "wires": []
    },
    {
        "id": "bd8e92c58e986043",
        "type": "http response",
        "z": "a43193f9452562d4",
        "name": "OTA Response",
        "statusCode": "",
        "headers": {},
        "x": 2772.559814453125,
        "y": 663.1071910858154,
        "wires": []
    },
    {
        "id": "8ad9254a301cc9e1",
        "type": "http in",
        "z": "a43193f9452562d4",
        "name": "OTA Manager",
        "url": "/esp8266-ota",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 88.05558013916016,
        "y": 648.2856712341309,
        "wires": [
            [
                "12342794a20eb41a"
            ]
        ]
    },
    {
        "id": "25990e299e8ea478",
        "type": "file",
        "z": "a43193f9452562d4",
        "name": "Save md5 Checksum",
        "filename": "",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "x": 1539.9998168945312,
        "y": 845.8333740234375,
        "wires": [
            []
        ]
    },
    {
        "id": "e41d936cb00e38e2",
        "type": "file in",
        "z": "a43193f9452562d4",
        "name": "Read firmware",
        "filename": "",
        "format": "",
        "x": 842.0833740234375,
        "y": 846.6666870117188,
        "wires": [
            [
                "3eaeda14915885af"
            ]
        ]
    },
    {
        "id": "3a79386246aae5fb",
        "type": "change",
        "z": "a43193f9452562d4",
        "name": "Extract filename",
        "rules": [
            {
                "t": "set",
                "p": "filename",
                "pt": "msg",
                "to": "firmware.directory",
                "tot": "flow"
            },
            {
                "t": "change",
                "p": "filename",
                "pt": "msg",
                "from": "$",
                "fromt": "re",
                "to": "req.files.firmware[0].originalname",
                "tot": "msg"
            },
            {
                "t": "delete",
                "p": "req",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "res",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 619.375,
        "y": 847.9166870117188,
        "wires": [
            [
                "e41d936cb00e38e2"
            ]
        ]
    },
    {
        "id": "72ab6f4ff778dbd2",
        "type": "change",
        "z": "a43193f9452562d4",
        "name": "",
        "rules": [
            {
                "t": "change",
                "p": "filename",
                "pt": "msg",
                "from": "bin$",
                "fromt": "re",
                "to": "md5",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1225.625,
        "y": 846.25,
        "wires": [
            [
                "25990e299e8ea478"
            ]
        ]
    },
    {
        "id": "319d75c67a0d36f4",
        "type": "comment",
        "z": "a43193f9452562d4",
        "name": "Firmware Upgrade",
        "info": "The system determines which firmware to send based\non the MAC address, version, and MD5 headers in the\nrequest from the ESP8266.\n\nFirstly, it checks if a firmware hash file with \nthe MAC address as the name exists, or else if a \nfirmware file with the version as the name exists.\nIf neither exist then no update is available.\n\nIt then reads the corresponding MD5 hash from the\nhash file and compares to the MD5 hash in the\nrequest.  If they match then the firmware is up\nto date and no update is required.\n\nOtherwise, it sends the contents of the firmware\nbin file and the MD5 hash value.",
        "x": 103.5,
        "y": 46,
        "wires": []
    },
    {
        "id": "8ddbca4d41b63a4f",
        "type": "comment",
        "z": "a43193f9452562d4",
        "name": "Firmware Management",
        "info": "",
        "x": 110.5,
        "y": 542,
        "wires": []
    },
    {
        "id": "485c752861a20405",
        "type": "template",
        "z": "a43193f9452562d4",
        "name": "Firmware Manager",
        "field": "payload",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "<html>\n    <head>\n        <title>ESP8266 OTA Firmware Manager</title>\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n        <link rel=\"stylesheet\" href=\"http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css\">\n        <script src=\"https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js\"></script>\n        <script src=\"http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js\"></script>\n        <style>\n            .file-btn-grp {\n                display: none;\n            }\n            body {\n                background-color: #f6f6f6;\n            }\n            .text_holder {\n                display: block;\n                max-width: 100%;\n                word-wrap: break-word;\n                line-height: 30px;\n            }\n            #main {\n                margin-top: 50px;\n                background-color: #ffffff;\n                border-radius: 5px;\n                width: 70%;\n                min-width: 500px;\n                border: 1px solid #545454;\n            }\n            .alert {\n                margin-top: 10px;\n                margin-bottom: 5px;\n            }\n            .link {\n                font-style: italic;\n            }\n            .listentry {\n                display: none;\n                list-style-type: none;\n            }\n        </style>\n\n    </head>\n    <body>\n        <div class=\"container\" id=\"main\">\n            <h1><small>ESP8266 OTA Firmware Manager</small></h1>\n            <h2><small>Upload New Firmware</small></h2>\n\n            <form role =\"form\" id=\"main_input_box\" action=\"esp8266-ota\" method=\"POST\" enctype=\"multipart/form-data\" class=\"form-inline\">\n                <input type=\"file\" accept=\".bin\" class=\"hidden\" id=\"fileUpload\" name=\"firmware\" placeholder=\"firmware.bin\">\n                <div class=\"form-group\">\n                <div class=\"input-group\">\n                    <span class=\"input-group-btn\">\n                        <button id=\"browse\" type=\"button\" class=\"btn btn-primary\">Browse...</button>\n                    </span>\n                    <input id=\"filename\" size=100 readonly=\"\" class=\"form-control\" placeholder=\"Firmware.bin\">\n                    <span class=\"input-group-btn\">\n                        <input type=\"submit\" value=\"Upload\" class=\"btn btn-primary add_button\">\n                    </span>\n                </div>\n                </div>\n            </form>\n\n            <h2><small>Current Firmware</small></h2>\n            <ul class=\"list-group\" id=\"list_of_items\">\n            </ul>\n        </div>\n\n        <div id=\"linkModal\" class=\"modal fade\" role=\"dialog\">\n            <div class=\"modal-dialog\">\n        \n                <!-- Modal content-->\n                <div class=\"modal-content\">\n                    <div class=\"modal-header\">\n                        <button type=\"button\" class=\"close\" data-dismiss=\"modal\">&times;</button>\n                        <h4 class=\"modal-title\">Create Symbolic Link</h4>\n                    </div>\n                    <div class=\"modal-body\">\n                        <form class=\"form-horizontal\" id=\"linkForm\" role=\"form\" action=\"#\" method=\"POST\">\n                            <div class=\"form-group\">\n                                <label class=\"control-label  col-sm-2\" for=\"linkName\">Link:</label> \n                                <div class=\"col-sm-10\">\n                                    <input id=\"linkName\" name=\"linkName\" class=\"form-control\"/>\n                                </div>\n                            </div>\n                            <div class=\"form-group\">\n                                <label class=\"control-label  col-sm-2\" for=\"linkFile\">To:</label> \n                                <div class=\"col-sm-10\">\n                                    <input class=\"form-control\" id=\"linkFile\" name=\"linkFile\"/>\n                                </div>\n                            </div>\n                        </form>\n                    </div>\n                    <div class=\"modal-footer\">\n                        <button type=\"submit\" class=\"btn btn-success link-create\">Create</button>\n                        <button type=\"button\" class=\"btn btn-warning\" data-dismiss=\"modal\">Cancel</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n        <script>\n\n            var deleteButton = \"<button id='delete' class='btn btn-warning'>Delete</button>\";\n            var linkButton = \"<button id='link' class='btn btn-success'>Link</button>\";\n            var oneButton = \"<div class='file-btn-grp btn-group pull-right'>\" + deleteButton + \"</div>\";\n            var twoButtons = \"<div class='file-btn-grp btn-group pull-right'>\" + deleteButton + linkButton + \"</div>\";\n            \n            function addListEntry(list, filename, linkname) {\n            \n                var entry;\n                \n                if (linkname === undefined) {\n                    entry = $(\"<li class='listentry list-group-item'><div class='text_holder'><span>\" \n                    + filename + \"</span>\" + twoButtons + \"</div></li>\");\n                } else {\n                    entry = $(\"<li class='listentry list-group-item'><div class='text_holder'><span class='link'>\" \n                    + filename + \"</span> <span class='glyphicon glyphicon-arrow-right'></span> \" \n                    + linkname + oneButton + \"</div></li>\");\n                }\n                \n                entry.mouseover(function(){\n                    $(this).find(\".btn-group\").fadeIn(\"fast\");\n                });\n                entry.mouseleave(function(){\n                    $(this).find(\".btn-group\").fadeOut(\"slow\");\n                });\n                \n                entry.on(\"click\", \"button#delete\", function(){\n                    var listItem = this.parentElement.parentElement.parentElement;\n                    var file = this.parentElement.parentElement.childNodes[0].childNodes[0].data;\n                    $.ajax({\n                        type: 'DELETE',\n                        data: {\"filename\": file},\n                        success: function(result) {\n                            $(listItem).fadeOut(\"slow\", function(){\n                                listItem.remove();\n                            });\n                        },\n                        error: function(result) {\n                            $(listItem).append(\"<div class='alert alert-danger'>\"\n                                + \"<a href='#' class='close' data-dismiss='alert'\"\n                                + \"aria-label='close'>&times;</a>\"\n                                + result.responseText + \"</div>\");\n                        }\n                    });\n                });\n           \n                entry.on(\"click\", \"button#link\", function(){\n                    var file = this.parentElement.parentElement.childNodes[0].childNodes[0].data;\n                    $(\"#linkName\").val(\"\");\n                    $(\"#linkFile\").prop(\"disabled\", true).val(file);\n                    $(\"#linkName\").parent().removeClass(\"has-error\");\n                    $(\"#linkModal\").modal();\n                    $('#linkModal').on('shown.bs.modal', function () {\n                        $('#linkName').focus();\n                    });\n                });\n                \n                if (list.children().length == 0) {\n                    list.append(entry);\n                    entry.fadeIn(\"slow\");\n                    return;\n                }\n\n                if (filename < $(\"li:first span:first\", list).text()) {\n                    $(\"li:first\", list).before(entry);\n                    entry.fadeIn(\"slow\");\n                    return;\n                }\n                if (filename > $(\"li:last span:first\", list).text()) {\n                    $(\"li:last\", list).after(entry);\n                    entry.fadeIn(\"slow\");\n                    return;\n                }\n                \n                var count = 0;\n                var $li = $(\"li\", list);\n                do {\n                    var index = parseInt($li.length / 2);\n                    var $compare = $li.eq(index);\n                    var compare = $(\"span:first\",$compare).text();\n                    if (filename === compare) {\n                        break;\n                    }\n                    else if (filename > compare) {\n                        $li = $li.slice(index, $li.length);\n                    } else {\n                        $li = $li.slice(0, index);\n                    }\n                } while ($li.length > 1);\n\n                if (filename === compare) {\n                    $compare.slideUp(\"fast\").slideDown(\"slow\");\n                    return;\n                } else if (filename < compare) { \n                    entry.insertBefore($compare); \n                } else { \n                    entry.insertAfter($compare); \n                }\n                entry.slideDown(\"slow\");\n            }\n            \n            \n            var files = String(\"{{payload.files}}\").split(',');\n            var links = String(\"{{payload.links}}\").split(',');\n            \n            var list_of_items = $(\"#list_of_items\");\n            \n            files.forEach(function(file,index) {\n                if (links[index] == \"\") {\n                    addListEntry(this, file.slice(0,-4));\n                } else {\n                    addListEntry(this, file.slice(0,-4), links[index].slice(0,-4));\n                }\n            },list_of_items);\n           \n           \n            $(\"#linkModal\").on(\"click\", \"button.link-create\", function(event){\n               event.preventDefault();\n               if ($(\"#linkName\").val() == \"\") {\n                    $('#linkName').focus();\n                    $('#linkName').parent().addClass(\"has-error\");\n                    return false;\n               }\n               $(\"#linkFile\").prop(\"disabled\",false);               \n               $.ajax({\n                    type: 'PUT',\n                    data: $(\"#linkForm\").serialize(),\n                    success: function(result) {\n                        $(\"#linkModal\").modal('hide');\n                        addListEntry(list_of_items, $('#linkName').val(), $('#linkFile').val());\n                    },\n                    error: function(result) {\n                        $(\"#linkFile\").prop(\"disabled\", true);\n                        $('#linkName').focus();\n                        $('#linkName').parent().addClass(\"has-error\");\n                        $(linkForm).append(\"<div id='linkError' class='alert alert-danger'>\"\n                             + \"<a href='#' class='close' data-dismiss='alert'\"\n                             + \"aria-label='close'>&times;</a>\"\n                             + result.responseText + \"</div>\");\n                    }\n                });\n            });\n            \n            $(\"#browse\").on('click', function () {\n                fileUpload.click();\n            });\n            \n            $(\"#fileUpload\").on('change', function () {\n                $(\"#filename\").val($(\"#fileUpload\").val().split('/').pop().split('\\\\').pop());\n            });\n            \n            var frm = $(\"#main_input_box\");\n            \n            frm.submit( function( e ) {\n                e.preventDefault();\n                if ($('#fileUpload').val() == \"\") return null;\n                $.ajax( {\n                    url: frm.attr('action'),\n                    type: frm.attr('method'),\n                    data: new FormData( this ),\n                    processData: false,\n                    contentType: false,\n                    success: function(result) {\n                        addListEntry(list_of_items, $('#fileUpload').val().slice(0,-4).split('\\\\').pop());\n                        $('#fileUpload').val('');\n                        $(':text').val('');\n                    },\n                    error: function(result) {\n                        $(\"#main_input_box\").append(\"<div class='alert alert-danger'>\"\n                             + \"<a href='#' class='close' data-dismiss='alert'\"\n                             + \"aria-label='close'>&times;</a>\"\n                             + result.responseText + \"</div>\");\n                    }\n\n                });\n            });\n        </script>\n    </body>\n</html>",
        "output": "str",
        "x": 1381.3333740234375,
        "y": 645.8135375976562,
        "wires": [
            [
                "bd8e92c58e986043"
            ]
        ]
    },
    {
        "id": "1649c4977994eb61",
        "type": "http in",
        "z": "a43193f9452562d4",
        "name": "OTA Delete",
        "url": "/esp8266-ota",
        "method": "delete",
        "upload": false,
        "swaggerDoc": "",
        "x": 83.125,
        "y": 933.75,
        "wires": [
            [
                "7bc256301dc109eb"
            ]
        ]
    },
    {
        "id": "99e38eadd16b15bf",
        "type": "catch",
        "z": "a43193f9452562d4",
        "name": "File Error",
        "scope": [
            "e4bb9da0a7d3a501",
            "302d0c5c07faa824",
            "8eb5cc497dfc9319",
            "cda498639522b0d1",
            "bc6a0c7c3144df43"
        ],
        "x": 1870.6665573120117,
        "y": 805.3333158493042,
        "wires": [
            [
                "58be7524738ce76c"
            ]
        ]
    },
    {
        "id": "58be7524738ce76c",
        "type": "change",
        "z": "a43193f9452562d4",
        "name": "Error",
        "rules": [
            {
                "t": "set",
                "p": "statusCode",
                "pt": "msg",
                "to": "500",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "error.message",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2159,
        "y": 791,
        "wires": [
            [
                "bd8e92c58e986043"
            ]
        ]
    },
    {
        "id": "fd3dfb38f31f1426",
        "type": "change",
        "z": "a43193f9452562d4",
        "name": "Change to MD5 filename",
        "rules": [
            {
                "t": "change",
                "p": "payload.filename",
                "pt": "msg",
                "from": "bin",
                "fromt": "str",
                "to": "md5",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1879.1666564941406,
        "y": 936.6666269302368,
        "wires": [
            [
                "302d0c5c07faa824"
            ]
        ]
    },
    {
        "id": "8406a3849f1cd590",
        "type": "http in",
        "z": "a43193f9452562d4",
        "name": "OTA Link",
        "url": "/esp8266-ota",
        "method": "put",
        "upload": false,
        "swaggerDoc": "",
        "x": 84,
        "y": 1041.5,
        "wires": [
            [
                "3ae4160bd63e0341"
            ]
        ]
    },
    {
        "id": "3ae4160bd63e0341",
        "type": "change",
        "z": "a43193f9452562d4",
        "name": "Extract filename",
        "rules": [
            {
                "t": "change",
                "p": "payload.linkName",
                "pt": "msg",
                "from": "$",
                "fromt": "re",
                "to": ".bin",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload.linkFile",
                "pt": "msg",
                "from": "$",
                "fromt": "re",
                "to": ".bin",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1385,
        "y": 1044,
        "wires": [
            [
                "8eb5cc497dfc9319"
            ]
        ]
    },
    {
        "id": "a92d64597b791f82",
        "type": "change",
        "z": "a43193f9452562d4",
        "name": "Change to MD5 Filename",
        "rules": [
            {
                "t": "change",
                "p": "payload.linkName",
                "pt": "msg",
                "from": "bin$",
                "fromt": "re",
                "to": "md5",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload.linkFile",
                "pt": "msg",
                "from": "bin$",
                "fromt": "re",
                "to": "md5",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1908,
        "y": 1045,
        "wires": [
            [
                "cda498639522b0d1"
            ]
        ]
    },
    {
        "id": "7bc256301dc109eb",
        "type": "change",
        "z": "a43193f9452562d4",
        "name": "Extract filename",
        "rules": [
            {
                "t": "change",
                "p": "payload.filename",
                "pt": "msg",
                "from": "$",
                "fromt": "re",
                "to": ".bin",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1382.5,
        "y": 937.5,
        "wires": [
            [
                "e4bb9da0a7d3a501"
            ]
        ]
    },
    {
        "id": "38b92bdc91223c2c",
        "type": "http response",
        "z": "a43193f9452562d4",
        "name": "OTA Response",
        "x": 3210.059814453125,
        "y": 366.06256103515625,
        "wires": []
    },
    {
        "id": "1bf6140c858cf0ef",
        "type": "file in",
        "z": "a43193f9452562d4",
        "name": "Load Firmware",
        "filename": "filename",
        "filenameType": "msg",
        "format": "",
        "sendError": false,
        "x": 2586.999786376953,
        "y": 399.88400077819824,
        "wires": [
            [
                "38b92bdc91223c2c",
                "9b2f875ac25af443"
            ]
        ]
    },
    {
        "id": "e1024e4ff3d510bd",
        "type": "change",
        "z": "a43193f9452562d4",
        "name": "No Update",
        "rules": [
            {
                "t": "set",
                "p": "statusCode",
                "pt": "msg",
                "to": "304",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2956.107421875,
        "y": 258.52682304382324,
        "wires": [
            [
                "38b92bdc91223c2c"
            ]
        ]
    },
    {
        "id": "2fafb6a308eb7732",
        "type": "change",
        "z": "a43193f9452562d4",
        "name": "Forbidden",
        "rules": [
            {
                "t": "set",
                "p": "statusCode",
                "pt": "msg",
                "to": "403",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Forbidden",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2933.999755859375,
        "y": 135.84826469421387,
        "wires": [
            [
                "38b92bdc91223c2c"
            ]
        ]
    },
    {
        "id": "9b2f875ac25af443",
        "type": "debug",
        "z": "a43193f9452562d4",
        "name": "Update sent",
        "active": true,
        "console": "false",
        "complete": "req.headers.x-esp8266-sta-mac",
        "x": 2932.0000610351562,
        "y": 405.955472946167,
        "wires": []
    },
    {
        "id": "ebdd9cfedabb6851",
        "type": "change",
        "z": "a43193f9452562d4",
        "name": "Save MD5 Hash",
        "rules": [
            {
                "t": "set",
                "p": "headers.x-MD5",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "change",
                "p": "filename",
                "pt": "msg",
                "from": "md5",
                "fromt": "str",
                "to": "bin",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2375.785789489746,
        "y": 387.0268669128418,
        "wires": [
            [
                "1bf6140c858cf0ef"
            ]
        ]
    },
    {
        "id": "c90ec0d226a68c11",
        "type": "switch",
        "z": "a43193f9452562d4",
        "name": "Update type",
        "property": "req.headers.x-esp8266-mode",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "spiffs",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "sketch",
                "vt": "str"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 474.5179748535156,
        "y": 228.52685356140137,
        "wires": [
            [
                "e1024e4ff3d510bd"
            ],
            [
                "53b5fa34136e8b17"
            ]
        ]
    },
    {
        "id": "e1949839d4cd7ef8",
        "type": "switch",
        "z": "a43193f9452562d4",
        "name": "Compare MD5 hash",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "req.headers.x-esp8266-sketch-md5",
                "vt": "msg"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "outputs": 2,
        "x": 1945.41064453125,
        "y": 342.13403129577637,
        "wires": [
            [
                "e1024e4ff3d510bd",
                "3d514a7b77c4e737"
            ],
            [
                "ebdd9cfedabb6851",
                "f657e29e4c2abb1e"
            ]
        ]
    },
    {
        "id": "6479672fce9ef8c7",
        "type": "catch",
        "z": "a43193f9452562d4",
        "name": "File error",
        "scope": [
            "1bf6140c858cf0ef",
            "bace0d35836c8d87"
        ],
        "x": 2628.3572387695312,
        "y": 348.52682304382324,
        "wires": [
            [
                "e1024e4ff3d510bd",
                "30b6f430532463ef"
            ]
        ]
    },
    {
        "id": "c8ccf35b11a423af",
        "type": "switch",
        "z": "a43193f9452562d4",
        "name": "Check user agent",
        "property": "req.headers.user-agent",
        "propertyType": "msg",
        "rules": [
            {
                "t": "neq",
                "v": "ESP8266-http-Update",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 290,
        "y": 140,
        "wires": [
            [
                "2fafb6a308eb7732"
            ],
            [
                "c90ec0d226a68c11"
            ]
        ]
    },
    {
        "id": "53b5fa34136e8b17",
        "type": "change",
        "z": "a43193f9452562d4",
        "name": "Get MAC hash filename",
        "rules": [
            {
                "t": "set",
                "p": "filename",
                "pt": "msg",
                "to": "firmware.directory",
                "tot": "flow"
            },
            {
                "t": "change",
                "p": "filename",
                "pt": "msg",
                "from": "$",
                "fromt": "re",
                "to": "req.headers.x-esp8266-sta-mac",
                "tot": "msg"
            },
            {
                "t": "change",
                "p": "filename",
                "pt": "msg",
                "from": "$",
                "fromt": "re",
                "to": ".md5",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 703.6428451538086,
        "y": 354.9554100036621,
        "wires": [
            [
                "8725631065c8f057"
            ]
        ]
    },
    {
        "id": "bace0d35836c8d87",
        "type": "file in",
        "z": "a43193f9452562d4",
        "name": "Load Hash",
        "filename": "",
        "format": "utf8",
        "sendError": false,
        "x": 1734.410629272461,
        "y": 341.7768840789795,
        "wires": [
            [
                "e1949839d4cd7ef8"
            ]
        ]
    },
    {
        "id": "3f50a364d5026f4c",
        "type": "change",
        "z": "a43193f9452562d4",
        "name": "Get Version hash filename",
        "rules": [
            {
                "t": "set",
                "p": "filename",
                "pt": "msg",
                "to": "firmware.directory",
                "tot": "flow"
            },
            {
                "t": "change",
                "p": "filename",
                "pt": "msg",
                "from": "$",
                "fromt": "re",
                "to": "req.headers.x-esp8266-version",
                "tot": "msg"
            },
            {
                "t": "change",
                "p": "filename",
                "pt": "msg",
                "from": "$",
                "fromt": "re",
                "to": ".md5",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1183.7857666015625,
        "y": 459.5982036590576,
        "wires": [
            [
                "b91674c82b73a515",
                "6c2e3ed78ff1828b"
            ]
        ]
    },
    {
        "id": "30b6f430532463ef",
        "type": "debug",
        "z": "a43193f9452562d4",
        "name": "Firmware file error",
        "active": true,
        "console": "false",
        "complete": "error",
        "x": 2891.2142944335938,
        "y": 347.09826469421387,
        "wires": []
    },
    {
        "id": "c444f513a6b6a252",
        "type": "http in",
        "z": "a43193f9452562d4",
        "name": "OTA Request",
        "url": "/esp8266-ota/update",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 75,
        "y": 134.95541191101074,
        "wires": [
            [
                "c8ccf35b11a423af",
                "08e6bc0a944e47be"
            ]
        ]
    },
    {
        "id": "eef781e23a0c2a85",
        "type": "switch",
        "z": "a43193f9452562d4",
        "name": "",
        "property": "req.headers.x-esp8266-version",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nnull"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "outputs": 2,
        "x": 687.4642333984375,
        "y": 466.74108695983887,
        "wires": [
            [
                "3f50a364d5026f4c"
            ],
            [
                "d47654243d11f45a"
            ]
        ]
    },
    {
        "id": "d47654243d11f45a",
        "type": "change",
        "z": "a43193f9452562d4",
        "name": "Version in Request",
        "rules": [
            {
                "t": "set",
                "p": "req.headers.x-esp8266-version",
                "pt": "msg",
                "to": "req.params.version",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 896.9285278320312,
        "y": 532.8125286102295,
        "wires": [
            [
                "3f50a364d5026f4c"
            ]
        ]
    },
    {
        "id": "08e6bc0a944e47be",
        "type": "debug",
        "z": "a43193f9452562d4",
        "name": "Update req",
        "active": true,
        "tosidebar": true,
        "console": false,
        "complete": "true",
        "statusVal": "",
        "statusType": "auto",
        "x": 246.2144012451172,
        "y": 235.66967582702637,
        "wires": []
    },
    {
        "id": "c0d491d04c0d434d",
        "type": "debug",
        "z": "a43193f9452562d4",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "false",
        "x": 1291.773494720459,
        "y": 382.1797161102295,
        "wires": []
    },
    {
        "id": "d3f244fc45adece6",
        "type": "debug",
        "z": "a43193f9452562d4",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "false",
        "x": 1290,
        "y": 280,
        "wires": []
    },
    {
        "id": "6c2e3ed78ff1828b",
        "type": "debug",
        "z": "a43193f9452562d4",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "filename",
        "x": 1393.0234375,
        "y": 555.0390625,
        "wires": []
    },
    {
        "id": "556d541d6eab0c13",
        "type": "debug",
        "z": "a43193f9452562d4",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "filename",
        "x": 1770.0234375,
        "y": 524.0390625,
        "wires": []
    },
    {
        "id": "d5bca0febc4ea1c2",
        "type": "debug",
        "z": "a43193f9452562d4",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "filename",
        "x": 1789.0234375,
        "y": 407.0390625,
        "wires": []
    },
    {
        "id": "3d514a7b77c4e737",
        "type": "debug",
        "z": "a43193f9452562d4",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "filename",
        "x": 2148.0234375,
        "y": 279.0390625,
        "wires": []
    },
    {
        "id": "f657e29e4c2abb1e",
        "type": "debug",
        "z": "a43193f9452562d4",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "filename",
        "x": 2170.0234375,
        "y": 506.0390625,
        "wires": []
    },
    {
        "id": "bc6a0c7c3144df43",
        "type": "fs-ops-move",
        "z": "a43193f9452562d4",
        "name": "Store firmware",
        "sourcePath": "req.files.firmware[0].destination",
        "sourcePathType": "msg",
        "sourceFilename": "req.files.firmware[0].filename",
        "sourceFilenameType": "msg",
        "destPath": "firmware.directory",
        "destPathType": "flow",
        "destFilename": "req.files.firmware[0].originalname",
        "destFilenameType": "msg",
        "link": false,
        "x": 365.89284896850586,
        "y": 818.3332557678223,
        "wires": [
            [
                "3a79386246aae5fb",
                "bd8e92c58e986043"
            ]
        ]
    },
    {
        "id": "8eb5cc497dfc9319",
        "type": "fs-ops-move",
        "z": "a43193f9452562d4",
        "name": "Link firmware",
        "sourcePath": "",
        "sourcePathType": "str",
        "sourceFilename": "payload.linkFile",
        "sourceFilenameType": "msg",
        "destPath": "firmware.directory",
        "destPathType": "flow",
        "destFilename": "payload.linkName",
        "destFilenameType": "msg",
        "link": true,
        "x": 1644.5,
        "y": 1044,
        "wires": [
            [
                "a92d64597b791f82"
            ]
        ]
    },
    {
        "id": "cda498639522b0d1",
        "type": "fs-ops-move",
        "z": "a43193f9452562d4",
        "name": "Link MD5",
        "sourcePath": "",
        "sourcePathType": "str",
        "sourceFilename": "payload.linkFile",
        "sourceFilenameType": "msg",
        "destPath": "firmware.directory",
        "destPathType": "flow",
        "destFilename": "payload.linkName",
        "destFilenameType": "msg",
        "link": true,
        "x": 2152.5,
        "y": 1044,
        "wires": [
            [
                "bd8e92c58e986043"
            ]
        ]
    },
    {
        "id": "e4bb9da0a7d3a501",
        "type": "fs-ops-delete",
        "z": "a43193f9452562d4",
        "name": "Delete firmware",
        "path": "firmware.directory",
        "pathType": "flow",
        "filename": "payload.filename",
        "filenameType": "msg",
        "x": 1628.6250457763672,
        "y": 936.5832777023315,
        "wires": [
            [
                "fd3dfb38f31f1426"
            ]
        ]
    },
    {
        "id": "302d0c5c07faa824",
        "type": "fs-ops-delete",
        "z": "a43193f9452562d4",
        "name": "Delete MD5 Hash",
        "path": "firmware.directory",
        "pathType": "flow",
        "filename": "payload.filename",
        "filenameType": "msg",
        "x": 2170.833206176758,
        "y": 936.6665878295898,
        "wires": [
            [
                "bd8e92c58e986043"
            ]
        ]
    },
    {
        "id": "b91674c82b73a515",
        "type": "fs-ops-access",
        "z": "a43193f9452562d4",
        "name": "Check for MD5 file exists",
        "path": "",
        "pathType": "str",
        "filename": "filename",
        "filenameType": "msg",
        "read": true,
        "write": false,
        "throwerror": false,
        "x": 1497.2857055664062,
        "y": 459.6696147918701,
        "wires": [
            [
                "bace0d35836c8d87",
                "d5bca0febc4ea1c2"
            ],
            [
                "e1024e4ff3d510bd",
                "556d541d6eab0c13"
            ]
        ]
    },
    {
        "id": "8725631065c8f057",
        "type": "fs-ops-access",
        "z": "a43193f9452562d4",
        "name": "Check for MD5 file exists",
        "path": "",
        "pathType": "str",
        "filename": "filename",
        "filenameType": "msg",
        "read": true,
        "write": false,
        "throwerror": false,
        "x": 1009.357177734375,
        "y": 349.09826469421387,
        "wires": [
            [
                "bace0d35836c8d87",
                "d3f244fc45adece6"
            ],
            [
                "eef781e23a0c2a85",
                "c0d491d04c0d434d"
            ]
        ]
    },
    {
        "id": "307eb70a95d584c7",
        "type": "fs-ops-link",
        "z": "a43193f9452562d4",
        "name": "Get Links",
        "path": "firmware.directory",
        "pathType": "flow",
        "filename": "payload.files",
        "filenameType": "msg",
        "link": "payload.links",
        "linkType": "msg",
        "x": 776.4999923706055,
        "y": 648.3333110809326,
        "wires": [
            [
                "485c752861a20405"
            ]
        ]
    },
    {
        "id": "12342794a20eb41a",
        "type": "fs-ops-dir",
        "z": "a43193f9452562d4",
        "name": "Firmware listing",
        "path": "firmware.directory",
        "pathType": "flow",
        "filter": "*.bin",
        "filterType": "str",
        "dir": "payload.files",
        "dirType": "msg",
        "x": 493.0355987548828,
        "y": 647.8015928268433,
        "wires": [
            [
                "307eb70a95d584c7"
            ]
        ]
    },
    {
        "id": "3eaeda14915885af",
        "type": "md5",
        "z": "a43193f9452562d4",
        "name": "",
        "fieldToHash": "payload",
        "hashField": "payload",
        "hashFieldType": "msg",
        "x": 1031.6668090820312,
        "y": 846.6666259765625,
        "wires": [
            [
                "72ab6f4ff778dbd2"
            ]
        ]
    },
    {
        "id": "b0744d4557e56190",
        "type": "config",
        "z": "a43193f9452562d4",
        "name": "Firmware Config",
        "properties": [
            {
                "p": "firmware.directory",
                "pt": "flow",
                "to": "/home/rhyloo/OTA/",
                "tot": "str"
            }
        ],
        "active": true,
        "x": 123.0714111328125,
        "y": 360.1428527832031,
        "wires": []
    },
    {
        "id": "1188246186822415",
        "type": "httpInMultipart",
        "z": "a43193f9452562d4",
        "name": "OTA Upload",
        "url": "/esp8266-ota",
        "method": "post",
        "fields": "[{ \"name\": \"firmware\"}]",
        "swaggerDoc": "",
        "x": 79.7857437133789,
        "y": 812.4286108016968,
        "wires": [
            [
                "bc6a0c7c3144df43"
            ]
        ]
    },
    {
        "id": "1077eb7e8ada2c39",
        "type": "comment",
        "z": "a43193f9452562d4",
        "name": "Dirección Gestionar Firmwares",
        "info": "http://192.168.144.66:1880/esp8266-ota",
        "x": 190,
        "y": 1140,
        "wires": []
    },
    {
        "id": "696c19e5.d26f78",
        "type": "inject",
        "z": "45a4e39f.03efac",
        "g": "0cdda659d54342bd",
        "name": "start flow",
        "props": [
            {
                "p": "payload",
                "v": "",
                "vt": "date"
            },
            {
                "p": "topic",
                "v": "",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 60,
        "wires": [
            [
                "6baf2f65.ab099",
                "338058ea.875b28"
            ]
        ]
    },
    {
        "id": "6baf2f65.ab099",
        "type": "http request",
        "z": "45a4e39f.03efac",
        "g": "0cdda659d54342bd",
        "name": "AEMET http request",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://www.aemet.es/xml/municipios/localidad_29901.xml",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 360,
        "y": 100,
        "wires": [
            [
                "2cf239ee.fe0836"
            ]
        ]
    },
    {
        "id": "2cf239ee.fe0836",
        "type": "xml",
        "z": "45a4e39f.03efac",
        "g": "0cdda659d54342bd",
        "name": "",
        "property": "payload",
        "attr": "",
        "chr": "",
        "x": 490,
        "y": 180,
        "wires": [
            [
                "338058ea.875b28",
                "e84f5da3.829a3",
                "85028a8d.668138",
                "c91834d1.9bf4b8",
                "ba35e1b7.ec857"
            ]
        ]
    },
    {
        "id": "338058ea.875b28",
        "type": "debug",
        "z": "45a4e39f.03efac",
        "g": "0cdda659d54342bd",
        "name": "whole xml",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 720,
        "y": 60,
        "wires": []
    },
    {
        "id": "e84f5da3.829a3",
        "type": "change",
        "z": "45a4e39f.03efac",
        "g": "0cdda659d54342bd",
        "name": "max. temp today",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.root.prediccion[0].dia[0].temperatura[0].maxima[0]",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 740,
        "y": 140,
        "wires": [
            [
                "80d43bb8.0e3d88"
            ]
        ]
    },
    {
        "id": "80d43bb8.0e3d88",
        "type": "debug",
        "z": "45a4e39f.03efac",
        "g": "0cdda659d54342bd",
        "name": "max. temp today",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 980,
        "y": 140,
        "wires": []
    },
    {
        "id": "85028a8d.668138",
        "type": "change",
        "z": "45a4e39f.03efac",
        "g": "0cdda659d54342bd",
        "name": "max. temp tomorrow",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.root.prediccion[0].dia[1].temperatura[0].maxima[0]",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 760,
        "y": 220,
        "wires": [
            [
                "fb2ad7fd.fd9d38"
            ]
        ]
    },
    {
        "id": "fb2ad7fd.fd9d38",
        "type": "debug",
        "z": "45a4e39f.03efac",
        "g": "0cdda659d54342bd",
        "name": "max. temp tomorrow",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 1000,
        "y": 220,
        "wires": []
    },
    {
        "id": "c91834d1.9bf4b8",
        "type": "change",
        "z": "45a4e39f.03efac",
        "g": "0cdda659d54342bd",
        "name": "min. temp today",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.root.prediccion[0].dia[0].temperatura[0].minima[0]",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 740,
        "y": 180,
        "wires": [
            [
                "a8feb814.7498e8"
            ]
        ]
    },
    {
        "id": "a8feb814.7498e8",
        "type": "debug",
        "z": "45a4e39f.03efac",
        "g": "0cdda659d54342bd",
        "name": "min. temp today",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 980,
        "y": 180,
        "wires": []
    },
    {
        "id": "ba35e1b7.ec857",
        "type": "change",
        "z": "45a4e39f.03efac",
        "g": "0cdda659d54342bd",
        "name": "min. temp tomorrow",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.root.prediccion[0].dia[1].temperatura[0].minima[0]",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 760,
        "y": 260,
        "wires": [
            [
                "50818085.451f5"
            ]
        ]
    },
    {
        "id": "50818085.451f5",
        "type": "debug",
        "z": "45a4e39f.03efac",
        "g": "0cdda659d54342bd",
        "name": "min. temp tomorrow",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 1000,
        "y": 260,
        "wires": []
    },
    {
        "id": "1cca111cc6a8d4bf",
        "type": "debug",
        "z": "45a4e39f.03efac",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 610,
        "y": 700,
        "wires": []
    },
    {
        "id": "4de9a5494932f329",
        "type": "function",
        "z": "45a4e39f.03efac",
        "name": "mensaje bienvenida",
        "func": "if(msg.payload.content.substring(0,1)!=\"/\")\n{\n msg.payload.content=\"Hola soy el bot de la tarea 9. Puedo responderte a estos comandos:\\n/start\\n/tiempo\";\n return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 380,
        "y": 440,
        "wires": [
            [
                "498462eef7447526"
            ]
        ]
    },
    {
        "id": "ff1ab0d052f8f0df",
        "type": "telegram receiver",
        "z": "45a4e39f.03efac",
        "name": "",
        "bot": "1f33bd2091f1c0f0",
        "saveDataDir": "",
        "filterCommands": true,
        "x": 150,
        "y": 400,
        "wires": [
            [
                "4de9a5494932f329",
                "cc3ede6e98bf8926"
            ],
            []
        ]
    },
    {
        "id": "498462eef7447526",
        "type": "telegram sender",
        "z": "45a4e39f.03efac",
        "name": "",
        "bot": "1f33bd2091f1c0f0",
        "haserroroutput": false,
        "outputs": 1,
        "x": 910,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "7b57d7fe124dd9c8",
        "type": "telegram command",
        "z": "45a4e39f.03efac",
        "name": "",
        "command": "/start",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "1f33bd2091f1c0f0",
        "strict": false,
        "hasresponse": true,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 2,
        "x": 110,
        "y": 460,
        "wires": [
            [
                "4de9a5494932f329"
            ],
            []
        ]
    },
    {
        "id": "7f3223281cc7ff75",
        "type": "telegram command",
        "z": "45a4e39f.03efac",
        "name": "",
        "command": "/tiempo",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "1f33bd2091f1c0f0",
        "strict": false,
        "hasresponse": true,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 2,
        "x": 90,
        "y": 580,
        "wires": [
            [
                "880ea544357607ba",
                "1cca111cc6a8d4bf"
            ],
            []
        ]
    },
    {
        "id": "880ea544357607ba",
        "type": "function",
        "z": "45a4e39f.03efac",
        "name": "function 5",
        "func": "msg.user = msg.payload;\nvar hora_str = new Date();\nvar hora = Number(hora_str.getHours());\nif (hora < 6) {\n    var value = 3;\n}else if ( hora >= 6 && hora < 12){\n    var value = 4;\n}else if (hora >= 12 && hora < 18){\n    var value = 5;\n}else if (hora >= 18 && hora < 24){\n    var value = 6;\n}\nmsg.mensaje = value;\nmsg.limit = 1;\nmsg.sort = { \"date\": -1 };\nmsg.payload = {};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 300,
        "y": 580,
        "wires": [
            [
                "9fd4a62bca7a0772",
                "1cca111cc6a8d4bf"
            ]
        ]
    },
    {
        "id": "067ec98f9ca3092e",
        "type": "function",
        "z": "45a4e39f.03efac",
        "name": "function 6",
        "func": "var period = msg.mensaje;\nmsg.elaborado = msg.payload.root.elaborado[0]\nmsg.prob_precipitacion = msg.payload.root.prediccion[0].dia[0].prob_precipitacion[period]._;\nmsg.periodo = msg.payload.root.prediccion[0].dia[0].prob_precipitacion[period].$.periodo;\nmsg.estado_del_cielo = msg.payload.root.prediccion[0].dia[0].estado_cielo[period].$.descripcion;\nmsg.prob_precipitacion_manana = msg.payload.root.prediccion[0].dia[1].prob_precipitacion[0]._;\nmsg.estado_del_cielo_manana = msg.payload.root.prediccion[0].dia[1].estado_cielo[0].$.descripcion;\n\n\nmsg.payload = msg.user;\nmsg.payload.content = \"\";\nmsg.payload.content += \"\\nSegún la AEMET la predicción para las próximas horas (\"+ msg.periodo + \"h)\"\nmsg.payload.content += \" es de \" + msg.estado_del_cielo;\nmsg.payload.content += \" y probabilidad de lluvia de \" + msg.prob_precipitacion + \"%. \"\nmsg.payload.content += \"Mañana se espera \" + msg.estado_del_cielo_manana + \" y probabilidad de lluvia de \" + msg.prob_precipitacion_manana + \"%.\";\nmsg.payload.content += \"\\nPredicción elaborada: \" + msg.elaborado + \".\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 860,
        "y": 580,
        "wires": [
            [
                "1cca111cc6a8d4bf",
                "498462eef7447526"
            ]
        ]
    },
    {
        "id": "9fd4a62bca7a0772",
        "type": "http request",
        "z": "45a4e39f.03efac",
        "name": "AEMET http request",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://www.aemet.es/xml/municipios/localidad_29901.xml",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 500,
        "y": 580,
        "wires": [
            [
                "ebc5420ffd97ea8c"
            ]
        ]
    },
    {
        "id": "ebc5420ffd97ea8c",
        "type": "xml",
        "z": "45a4e39f.03efac",
        "name": "",
        "property": "payload",
        "attr": "",
        "chr": "",
        "x": 690,
        "y": 580,
        "wires": [
            [
                "067ec98f9ca3092e"
            ]
        ]
    },
    {
        "id": "cc3ede6e98bf8926",
        "type": "debug",
        "z": "45a4e39f.03efac",
        "name": "debug 5",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 460,
        "y": 380,
        "wires": []
    },
    {
        "id": "eb7fd5e1.688b68",
        "type": "debug",
        "z": "ccd8ad10.a1f6a",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 572.0142135620117,
        "y": 120.00567054748535,
        "wires": []
    },
    {
        "id": "6a35b6f9.ecd878",
        "type": "json",
        "z": "ccd8ad10.a1f6a",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 418.0142135620117,
        "y": 162.00567626953125,
        "wires": [
            [
                "eb7fd5e1.688b68",
                "904efe22.796c"
            ]
        ]
    },
    {
        "id": "904efe22.796c",
        "type": "function",
        "z": "ccd8ad10.a1f6a",
        "name": "añade fecha",
        "func": "msg.payload.date=new Date();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 574.0142059326172,
        "y": 163.0056791305542,
        "wires": [
            [
                "ef7e002a.1aedd"
            ]
        ]
    },
    {
        "id": "ef7e002a.1aedd",
        "type": "mongodb out",
        "z": "ccd8ad10.a1f6a",
        "mongodb": "3752afa1.deaf9",
        "name": "",
        "collection": "test_descarga",
        "payonly": true,
        "upsert": false,
        "multi": false,
        "operation": "store",
        "x": 856.0142135620117,
        "y": 162.00567817687988,
        "wires": []
    },
    {
        "id": "e97b432c.ad89c",
        "type": "inject",
        "z": "ccd8ad10.a1f6a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 195.78974151611328,
        "y": 275.9715337753296,
        "wires": [
            [
                "5072d0ad.9eae5"
            ]
        ]
    },
    {
        "id": "5072d0ad.9eae5",
        "type": "mongodb in",
        "z": "ccd8ad10.a1f6a",
        "mongodb": "3752afa1.deaf9",
        "name": "",
        "collection": "test_descarga",
        "operation": "find",
        "x": 512.7868957519531,
        "y": 275.6988248825073,
        "wires": [
            [
                "21360331.5e623c"
            ]
        ]
    },
    {
        "id": "21360331.5e623c",
        "type": "debug",
        "z": "ccd8ad10.a1f6a",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 830,
        "y": 280,
        "wires": []
    },
    {
        "id": "553b3a49.aa67b4",
        "type": "http response",
        "z": "ccd8ad10.a1f6a",
        "name": "",
        "statusCode": "",
        "headers": {
            "Content-Disposition": "attachment; filename=registros.csv"
        },
        "x": 1145.9997367858887,
        "y": 583.000057220459,
        "wires": []
    },
    {
        "id": "a398a3af.87a8e",
        "type": "function",
        "z": "ccd8ad10.a1f6a",
        "name": "Unicode y separador",
        "func": "//add Unicode BOM character (byte order mark) to make EXCEL knows this is UTF-8\nif(global.get(\"separador_decimal\")==\"punto\")\n{\n    msg.payload='\\ufeff'+msg.payload;\n\n}\nelse\n{\n    msg.payload='\\ufeff'+(msg.payload).replace(/\\./g,\",\");\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 975.9998626708984,
        "y": 582.9999866485596,
        "wires": [
            [
                "553b3a49.aa67b4"
            ]
        ]
    },
    {
        "id": "d04c9d5b.0eff5",
        "type": "function",
        "z": "ccd8ad10.a1f6a",
        "name": "consulta",
        "func": "// fecha por defecto es hoy\nvar ahora = new Date();\n// pillo los globales si los hay, si no la fecha de hoy\nvar desde = new Date(global.get(\"desde\") || ahora);\nvar hasta = new Date(global.get(\"hasta\") || ahora); \n// el día de inicio desde las cero horas\nvar inicio = new Date(desde.getFullYear(),desde.getMonth(),desde.getDate(),0,0,0,0);\n// el día final es hasta final del día\nvar final = new Date(hasta.getFullYear(),hasta.getMonth(),hasta.getDate(),23,59,59,999);\n\nmsg.payload=\n[\n    { \"$match\": { \"date\": { \"$gte\": inicio , \"$lte\": final } } },\n    { \"$project\": {\n        \"_id\": 0,\n        \"date\": 1,\n        \"temperatura\": \"$BME280.Temperatura\",\n        \"humedad\": \"$BME280.Humedad\",\n        \"presion\": \"$BME280.Presion\"\n        }\n    },\n    { \"$sort\": {\"date\": 1} }\n];\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 254.00003814697266,
        "y": 583.0000076293945,
        "wires": [
            [
                "bc56c48b.90e4d8"
            ]
        ]
    },
    {
        "id": "d237b5f9.3d4858",
        "type": "http in",
        "z": "ccd8ad10.a1f6a",
        "name": "",
        "url": "/registros",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 91,
        "y": 582.9999866485596,
        "wires": [
            [
                "d04c9d5b.0eff5"
            ]
        ]
    },
    {
        "id": "2bc79054.4dac6",
        "type": "ui_template",
        "z": "ccd8ad10.a1f6a",
        "group": "a34ffe7a.04009",
        "name": "",
        "order": 3,
        "width": "0",
        "height": "0",
        "format": "<style>\n.button {\n    text-align: center;\n    font: bold 17px Arial;\n    text-decoration: none;\n    background-color: #339966;\n    color: white;\n    padding: 8px 10px;\n    border: 2px solid #CCCCCC;\n  }\n  \n  .button:hover\n  {\n   background-color: #26734d;\n  }\n\n</style>\n<a href=\"/registros\" class=\"button\">Descarga registros en CSV (EXCEL)</a>\n",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 110.0000228881836,
        "y": 474.9998197555542,
        "wires": [
            []
        ]
    },
    {
        "id": "bc56c48b.90e4d8",
        "type": "mongodb in",
        "z": "ccd8ad10.a1f6a",
        "mongodb": "3752afa1.deaf9",
        "name": "",
        "collection": "test_descarga",
        "operation": "aggregate",
        "x": 539.0142211914062,
        "y": 583.0056686401367,
        "wires": [
            [
                "a0152c6f.68517"
            ]
        ]
    },
    {
        "id": "a0152c6f.68517",
        "type": "csv",
        "z": "ccd8ad10.a1f6a",
        "name": "",
        "sep": ";",
        "hdrin": "",
        "hdrout": true,
        "multi": "one",
        "ret": "\\r\\n",
        "temp": "date, temperatura, humedad, presion",
        "skip": 0,
        "x": 795.0000076293945,
        "y": 582.999963760376,
        "wires": [
            [
                "a398a3af.87a8e"
            ]
        ]
    },
    {
        "id": "5ba69690.6f3a28",
        "type": "ui_switch",
        "z": "ccd8ad10.a1f6a",
        "name": "separdor decimal",
        "label": "{{msg.topic}}",
        "tooltip": "",
        "group": "a34ffe7a.04009",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "false",
        "topic": "",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 176.00296020507812,
        "y": 1087.9770593643188,
        "wires": [
            [
                "96e33153.98e75"
            ]
        ]
    },
    {
        "id": "64d25d3f.5e61c4",
        "type": "inject",
        "z": "ccd8ad10.a1f6a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "true",
        "payloadType": "bool",
        "x": 157.00002670288086,
        "y": 1010.8889408111572,
        "wires": [
            [
                "96e33153.98e75"
            ]
        ]
    },
    {
        "id": "96e33153.98e75",
        "type": "function",
        "z": "ccd8ad10.a1f6a",
        "name": "set global separador_decimal",
        "func": "if(msg.payload===true)\n{\n    global.set(\"separador_decimal\",\"coma\");\n    msg.topic=\"separador decimal = coma\";\n}\nelse\n{\n    global.set(\"separador_decimal\",\"punto\");\n    msg.topic=\"separador decimal = punto\";\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 485.01141357421875,
        "y": 1011.5963134765625,
        "wires": [
            [
                "5ba69690.6f3a28"
            ]
        ]
    },
    {
        "id": "fc86581d.721438",
        "type": "ui_date_picker",
        "z": "ccd8ad10.a1f6a",
        "name": "",
        "label": "Fecha inicio",
        "group": "a34ffe7a.04009",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "topic": "",
        "x": 313.7812728881836,
        "y": 778.7330231666565,
        "wires": [
            [
                "36e52eff.e79652"
            ]
        ]
    },
    {
        "id": "b5ec6fbf.5c7b8",
        "type": "ui_date_picker",
        "z": "ccd8ad10.a1f6a",
        "name": "",
        "label": "Fecha final",
        "group": "a34ffe7a.04009",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": true,
        "topic": "",
        "x": 316.7926254272461,
        "y": 827.7272605895996,
        "wires": [
            [
                "32225963.2490f6"
            ]
        ]
    },
    {
        "id": "36e52eff.e79652",
        "type": "change",
        "z": "ccd8ad10.a1f6a",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "desde",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 509.78694915771484,
        "y": 777.3949108123779,
        "wires": [
            []
        ]
    },
    {
        "id": "32225963.2490f6",
        "type": "change",
        "z": "ccd8ad10.a1f6a",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "hasta",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 513.0142288208008,
        "y": 828.2784652709961,
        "wires": [
            []
        ]
    },
    {
        "id": "13b2662f.d6754a",
        "type": "inject",
        "z": "ccd8ad10.a1f6a",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 115.7897720336914,
        "y": 803.1534633636475,
        "wires": [
            [
                "fc86581d.721438",
                "b5ec6fbf.5c7b8"
            ]
        ]
    },
    {
        "id": "b05d4923.ea6ff8",
        "type": "comment",
        "z": "ccd8ad10.a1f6a",
        "name": "Almacenamiento en base de datos",
        "info": "",
        "x": 227.7897491455078,
        "y": 73.08806610107422,
        "wires": []
    },
    {
        "id": "3e06173c.94cdb8",
        "type": "comment",
        "z": "ccd8ad10.a1f6a",
        "name": "Controles para seleccionar fechas",
        "info": "",
        "x": 172.7897605895996,
        "y": 706.630747795105,
        "wires": []
    },
    {
        "id": "8f0fda03.1a7698",
        "type": "comment",
        "z": "ccd8ad10.a1f6a",
        "name": "Botón en HTML para lanzar descarga de fichero",
        "info": "",
        "x": 219.78977966308594,
        "y": 427.08227348327637,
        "wires": []
    },
    {
        "id": "7aa4e397.e0472c",
        "type": "comment",
        "z": "ccd8ad10.a1f6a",
        "name": "Flujo para descarga de fichero",
        "info": "",
        "x": 162.0142059326172,
        "y": 525.0056400299072,
        "wires": []
    },
    {
        "id": "243ebda4.07bf32",
        "type": "comment",
        "z": "ccd8ad10.a1f6a",
        "name": "Selector de separador decimal",
        "info": "",
        "x": 169.01419067382812,
        "y": 950.5510654449463,
        "wires": []
    },
    {
        "id": "e0c0c223.1a6a7",
        "type": "mqtt in",
        "z": "ccd8ad10.a1f6a",
        "name": "",
        "topic": "iot/datos/json",
        "qos": "2",
        "datatype": "auto",
        "broker": "2b251178.95ad2e",
        "nl": false,
        "rap": false,
        "inputs": 0,
        "x": 210,
        "y": 160,
        "wires": [
            [
                "6a35b6f9.ecd878"
            ]
        ]
    },
    {
        "id": "21f9347e8aef3828",
        "type": "http response",
        "z": "122f65d809b34d8e",
        "g": "0f1cf58e08b73cc2",
        "name": "OTA Response",
        "statusCode": "",
        "headers": {},
        "x": 1560,
        "y": 300,
        "wires": []
    },
    {
        "id": "d2824f6f609c0386",
        "type": "http in",
        "z": "122f65d809b34d8e",
        "name": "OTA Manager",
        "url": "/upload-into-database",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 90,
        "y": 160,
        "wires": [
            [
                "62515f6e3d807c47"
            ]
        ]
    },
    {
        "id": "bda262cf2eaa8c3a",
        "type": "file in",
        "z": "122f65d809b34d8e",
        "name": "Read firmware",
        "filename": "filename",
        "filenameType": "msg",
        "format": "utf8",
        "encoding": "utf8",
        "allProps": false,
        "x": 780,
        "y": 240,
        "wires": [
            [
                "46f6454f8d3bdb92"
            ]
        ]
    },
    {
        "id": "4b0e1b8ee55ee3dc",
        "type": "change",
        "z": "122f65d809b34d8e",
        "name": "Extract filename",
        "rules": [
            {
                "t": "set",
                "p": "filename",
                "pt": "msg",
                "to": "firmware.directory",
                "tot": "flow"
            },
            {
                "t": "change",
                "p": "filename",
                "pt": "msg",
                "from": "$",
                "fromt": "re",
                "to": "req.files.firmware[0].originalname",
                "tot": "msg"
            },
            {
                "t": "delete",
                "p": "req",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "res",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 240,
        "wires": [
            [
                "bda262cf2eaa8c3a"
            ]
        ]
    },
    {
        "id": "fb39343aee052faa",
        "type": "comment",
        "z": "122f65d809b34d8e",
        "name": "MongoDB upload",
        "info": "",
        "x": 100,
        "y": 60,
        "wires": []
    },
    {
        "id": "75f8dc9625317378",
        "type": "template",
        "z": "122f65d809b34d8e",
        "name": "Firmware Manager",
        "field": "payload",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "<html>\n    <head>\n        <title>Database File Manager</title>\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n        <link rel=\"stylesheet\" href=\"http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css\">\n        <script src=\"https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js\"></script>\n        <script src=\"http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js\"></script>\n        <style>\n            .file-btn-grp {\n                display: none;\n            }\n            body {\n                background-color: #f6f6f6;\n            }\n            .text_holder {\n                display: block;\n                max-width: 100%;\n                word-wrap: break-word;\n                line-height: 30px;\n            }\n            #main {\n                margin-top: 50px;\n                background-color: #ffffff;\n                border-radius: 5px;\n                width: 70%;\n                min-width: 500px;\n                border: 1px solid #545454;\n            }\n            .alert {\n                margin-top: 10px;\n                margin-bottom: 5px;\n            }\n            .link {\n                font-style: italic;\n            }\n            .listentry {\n                display: none;\n                list-style-type: none;\n            }\n        </style>\n\n    </head>\n    <body>\n        <div class=\"container\" id=\"main\">\n            <h1><small>Database File Manager</small></h1>\n            <h2><small>Upload New Files</small></h2>\n<form action=\"test\" method=\"POST\">\n    <label for=\"cars\">Choose a collection:</label>\n    <select name=\"cars\" id=\"cars\">\n    <option value=\"test2\">test2</option>\n    <option value=\"test3\">test3</option>\n    <option value=\"test4\">test4</option>\n    <option value=\"test5\">test5</option>\n  </select>\n    <br><br>\n    <input type=\"submit\" value=\"Submit\">\n</form>\n            <form role =\"form\" id=\"main_input_box\" action=\"upload-into-database\" method=\"POST\" enctype=\"multipart/form-data\" class=\"form-inline\">\n                <input type=\"file\" accept=\".json\" class=\"hidden\" id=\"fileUpload\" name=\"firmware\" placeholder=\"firmware.bin\">\n                <div class=\"form-group\">\n                <div class=\"input-group\">\n                    <span class=\"input-group-btn\">\n                        <button id=\"browse\" type=\"button\" class=\"btn btn-primary\">Browse...</button>\n                    </span>\n                    <input id=\"filename\" size=100 readonly=\"\" class=\"form-control\" placeholder=\"File\">\n                    <span class=\"input-group-btn\">\n                        <input type=\"submit\" value=\"Upload\" class=\"btn btn-primary add_button\">\n                    </span>\n                </div>\n                </div>\n            </form>\n\n            <h2><small>Current Files</small></h2>\n            <ul class=\"list-group\" id=\"list_of_items\">\n            </ul>\n        </div>\n\n        <div id=\"linkModal\" class=\"modal fade\" role=\"dialog\">\n            <div class=\"modal-dialog\">\n        \n                <!-- Modal content-->\n                <div class=\"modal-content\">\n                    <div class=\"modal-header\">\n                        <button type=\"button\" class=\"close\" data-dismiss=\"modal\">&times;</button>\n                        <h4 class=\"modal-title\">Create Symbolic Link</h4>\n                    </div>\n                    <div class=\"modal-body\">\n                        <form class=\"form-horizontal\" id=\"linkForm\" role=\"form\" action=\"#\" method=\"POST\">\n                            <div class=\"form-group\">\n                                <label class=\"control-label  col-sm-2\" for=\"linkName\">Link:</label> \n                                <div class=\"col-sm-10\">\n                                    <input id=\"linkName\" name=\"linkName\" class=\"form-control\"/>\n                                </div>\n                            </div>\n                            <div class=\"form-group\">\n                                <label class=\"control-label  col-sm-2\" for=\"linkFile\">To:</label> \n                                <div class=\"col-sm-10\">\n                                    <input class=\"form-control\" id=\"linkFile\" name=\"linkFile\"/>\n                                </div>\n                            </div>\n                        </form>\n                    </div>\n                    <div class=\"modal-footer\">\n                        <button type=\"submit\" class=\"btn btn-success link-create\">Create</button>\n                        <button type=\"button\" class=\"btn btn-warning\" data-dismiss=\"modal\">Cancel</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n        <script>\n\n            var deleteButton = \"<button id='delete' class='btn btn-warning'>Delete</button>\";\n            var linkButton = \"<button id='link' class='btn btn-success'>Link</button>\";\n            var oneButton = \"<div class='file-btn-grp btn-group pull-right'>\" + deleteButton + \"</div>\";\n            var twoButtons = \"<div class='file-btn-grp btn-group pull-right'>\" + deleteButton + linkButton + \"</div>\";\n            \n            function addListEntry(list, filename, linkname) {\n            \n                var entry;\n                \n                if (linkname === undefined) {\n                    entry = $(\"<li class='listentry list-group-item'><div class='text_holder'><span>\" \n                    + filename + \"</span>\" + twoButtons + \"</div></li>\");\n                } else {\n                    entry = $(\"<li class='listentry list-group-item'><div class='text_holder'><span class='link'>\" \n                    + filename + \"</span> <span class='glyphicon glyphicon-arrow-right'></span> \" \n                    + linkname + oneButton + \"</div></li>\");\n                }\n                \n                entry.mouseover(function(){\n                    $(this).find(\".btn-group\").fadeIn(\"fast\");\n                });\n                entry.mouseleave(function(){\n                    $(this).find(\".btn-group\").fadeOut(\"slow\");\n                });\n                \n                entry.on(\"click\", \"button#delete\", function(){\n                    var listItem = this.parentElement.parentElement.parentElement;\n                    var file = this.parentElement.parentElement.childNodes[0].childNodes[0].data;\n                    $.ajax({\n                        type: 'DELETE',\n                        data: {\"filename\": file},\n                        success: function(result) {\n                            $(listItem).fadeOut(\"slow\", function(){\n                                listItem.remove();\n                            });\n                        },\n                        error: function(result) {\n                            $(listItem).append(\"<div class='alert alert-danger'>\"\n                                + \"<a href='#' class='close' data-dismiss='alert'\"\n                                + \"aria-label='close'>&times;</a>\"\n                                + result.responseText + \"</div>\");\n                        }\n                    });\n                });\n           \n                entry.on(\"click\", \"button#link\", function(){\n                    var file = this.parentElement.parentElement.childNodes[0].childNodes[0].data;\n                    $(\"#linkName\").val(\"\");\n                    $(\"#linkFile\").prop(\"disabled\", true).val(file);\n                    $(\"#linkName\").parent().removeClass(\"has-error\");\n                    $(\"#linkModal\").modal();\n                    $('#linkModal').on('shown.bs.modal', function () {\n                        $('#linkName').focus();\n                    });\n                });\n                \n                if (list.children().length == 0) {\n                    list.append(entry);\n                    entry.fadeIn(\"slow\");\n                    return;\n                }\n\n                if (filename < $(\"li:first span:first\", list).text()) {\n                    $(\"li:first\", list).before(entry);\n                    entry.fadeIn(\"slow\");\n                    return;\n                }\n                if (filename > $(\"li:last span:first\", list).text()) {\n                    $(\"li:last\", list).after(entry);\n                    entry.fadeIn(\"slow\");\n                    return;\n                }\n                \n                var count = 0;\n                var $li = $(\"li\", list);\n                do {\n                    var index = parseInt($li.length / 2);\n                    var $compare = $li.eq(index);\n                    var compare = $(\"span:first\",$compare).text();\n                    if (filename === compare) {\n                        break;\n                    }\n                    else if (filename > compare) {\n                        $li = $li.slice(index, $li.length);\n                    } else {\n                        $li = $li.slice(0, index);\n                    }\n                } while ($li.length > 1);\n\n                if (filename === compare) {\n                    $compare.slideUp(\"fast\").slideDown(\"slow\");\n                    return;\n                } else if (filename < compare) { \n                    entry.insertBefore($compare); \n                } else { \n                    entry.insertAfter($compare); \n                }\n                entry.slideDown(\"slow\");\n            }\n            \n            \n            var files = String(\"{{payload.files}}\").split(',');\n            var links = String(\"{{payload.links}}\").split(',');\n            \n            var list_of_items = $(\"#list_of_items\");\n            \n            files.forEach(function(file,index) {\n                if (links[index] == \"\") {\n                    addListEntry(this, file.slice(0,-4));\n                } else {\n                    addListEntry(this, file.slice(0,-4), links[index].slice(0,-4));\n                }\n            },list_of_items);\n           \n           \n            $(\"#linkModal\").on(\"click\", \"button.link-create\", function(event){\n               event.preventDefault();\n               if ($(\"#linkName\").val() == \"\") {\n                    $('#linkName').focus();\n                    $('#linkName').parent().addClass(\"has-error\");\n                    return false;\n               }\n               $(\"#linkFile\").prop(\"disabled\",false);               \n               $.ajax({\n                    type: 'PUT',\n                    data: $(\"#linkForm\").serialize(),\n                    success: function(result) {\n                        $(\"#linkModal\").modal('hide');\n                        addListEntry(list_of_items, $('#linkName').val(), $('#linkFile').val());\n                    },\n                    error: function(result) {\n                        $(\"#linkFile\").prop(\"disabled\", true);\n                        $('#linkName').focus();\n                        $('#linkName').parent().addClass(\"has-error\");\n                        $(linkForm).append(\"<div id='linkError' class='alert alert-danger'>\"\n                             + \"<a href='#' class='close' data-dismiss='alert'\"\n                             + \"aria-label='close'>&times;</a>\"\n                             + result.responseText + \"</div>\");\n                    }\n                });\n            });\n            \n            $(\"#browse\").on('click', function () {\n                fileUpload.click();\n            });\n            \n            $(\"#fileUpload\").on('change', function () {\n                $(\"#filename\").val($(\"#fileUpload\").val().split('/').pop().split('\\\\').pop());\n            });\n            \n            var frm = $(\"#main_input_box\");\n            \n            frm.submit( function( e ) {\n                e.preventDefault();\n                if ($('#fileUpload').val() == \"\") return null;\n                $.ajax( {\n                    url: frm.attr('action'),\n                    type: frm.attr('method'),\n                    data: new FormData( this ),\n                    processData: false,\n                    contentType: false,\n                    success: function(result) {\n                        addListEntry(list_of_items, $('#fileUpload').val().slice(0,-4).split('\\\\').pop());\n                        $('#fileUpload').val('');\n                        $(':text').val('');\n                    },\n                    error: function(result) {\n                        $(\"#main_input_box\").append(\"<div class='alert alert-danger'>\"\n                             + \"<a href='#' class='close' data-dismiss='alert'\"\n                             + \"aria-label='close'>&times;</a>\"\n                             + result.responseText + \"</div>\");\n                    }\n\n                });\n            });\n            //form=document.getElementById(\"my_options\");\n            //function askForChange() {\n            //form.action=\"test\";\n            //form.submit();\n            //}\n        </script>\n    </body>\n</html>",
        "output": "str",
        "x": 670,
        "y": 160,
        "wires": [
            [
                "b4b83576edf903b5"
            ]
        ]
    },
    {
        "id": "cab2d982dca2c30f",
        "type": "http in",
        "z": "122f65d809b34d8e",
        "name": "OTA Delete",
        "url": "/upload-into-database",
        "method": "delete",
        "upload": false,
        "swaggerDoc": "",
        "x": 90,
        "y": 480,
        "wires": [
            [
                "d20bc9138a0169be"
            ]
        ]
    },
    {
        "id": "10a5ab5dcfc58f1b",
        "type": "catch",
        "z": "122f65d809b34d8e",
        "name": "File Error",
        "scope": [
            "e28249513db9b6d9",
            "577364685ab43781",
            "cb89692e72e4a1a9",
            "bc3bb6ffb291288e",
            "4ab20d5b0eb3589e"
        ],
        "x": 80,
        "y": 340,
        "wires": [
            [
                "baf996edda360108"
            ]
        ]
    },
    {
        "id": "baf996edda360108",
        "type": "change",
        "z": "122f65d809b34d8e",
        "name": "Error",
        "rules": [
            {
                "t": "set",
                "p": "statusCode",
                "pt": "msg",
                "to": "500",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "error.message",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 230,
        "y": 340,
        "wires": [
            [
                "2757674848698812"
            ]
        ]
    },
    {
        "id": "83cd387005aedfca",
        "type": "change",
        "z": "122f65d809b34d8e",
        "name": "Change to MD5 filename",
        "rules": [
            {
                "t": "change",
                "p": "payload.filename",
                "pt": "msg",
                "from": "bin",
                "fromt": "str",
                "to": "md5",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 850,
        "y": 480,
        "wires": [
            [
                "577364685ab43781"
            ]
        ]
    },
    {
        "id": "5163f3c78ba48b6d",
        "type": "http in",
        "z": "122f65d809b34d8e",
        "name": "OTA Link",
        "url": "/upload-into-database",
        "method": "put",
        "upload": false,
        "swaggerDoc": "",
        "x": 80,
        "y": 400,
        "wires": [
            [
                "ad13d04db5f53905"
            ]
        ]
    },
    {
        "id": "ad13d04db5f53905",
        "type": "change",
        "z": "122f65d809b34d8e",
        "name": "Extract filename",
        "rules": [
            {
                "t": "change",
                "p": "payload.linkName",
                "pt": "msg",
                "from": "$",
                "fromt": "re",
                "to": ".bin",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload.linkFile",
                "pt": "msg",
                "from": "$",
                "fromt": "re",
                "to": ".txt",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 320,
        "y": 400,
        "wires": [
            [
                "cb89692e72e4a1a9"
            ]
        ]
    },
    {
        "id": "90b8bceb32c9c7c8",
        "type": "change",
        "z": "122f65d809b34d8e",
        "name": "Change to MD5 Filename",
        "rules": [
            {
                "t": "change",
                "p": "payload.linkName",
                "pt": "msg",
                "from": "bin$",
                "fromt": "re",
                "to": "md5",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload.linkFile",
                "pt": "msg",
                "from": "bin$",
                "fromt": "re",
                "to": "md5",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 850,
        "y": 400,
        "wires": [
            [
                "bc3bb6ffb291288e"
            ]
        ]
    },
    {
        "id": "d20bc9138a0169be",
        "type": "change",
        "z": "122f65d809b34d8e",
        "name": "Extract filename",
        "rules": [
            {
                "t": "change",
                "p": "payload.filename",
                "pt": "msg",
                "from": "$",
                "fromt": "re",
                "to": ".txt",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 320,
        "y": 480,
        "wires": [
            [
                "e28249513db9b6d9",
                "229b68c9527f20eb"
            ]
        ]
    },
    {
        "id": "cb89692e72e4a1a9",
        "type": "fs-ops-move",
        "z": "122f65d809b34d8e",
        "name": "Link firmware",
        "sourcePath": "",
        "sourcePathType": "str",
        "sourceFilename": "payload.linkFile",
        "sourceFilenameType": "msg",
        "destPath": "firmware.directory",
        "destPathType": "flow",
        "destFilename": "payload.linkName",
        "destFilenameType": "msg",
        "link": true,
        "x": 590,
        "y": 400,
        "wires": [
            [
                "90b8bceb32c9c7c8"
            ]
        ]
    },
    {
        "id": "bc3bb6ffb291288e",
        "type": "fs-ops-move",
        "z": "122f65d809b34d8e",
        "name": "Link MD5",
        "sourcePath": "",
        "sourcePathType": "str",
        "sourceFilename": "payload.linkFile",
        "sourceFilenameType": "msg",
        "destPath": "firmware.directory",
        "destPathType": "flow",
        "destFilename": "payload.linkName",
        "destFilenameType": "msg",
        "link": true,
        "x": 1060,
        "y": 400,
        "wires": [
            [
                "9830d71cb39f6027"
            ]
        ]
    },
    {
        "id": "e28249513db9b6d9",
        "type": "fs-ops-delete",
        "z": "122f65d809b34d8e",
        "name": "Delete firmware",
        "path": "firmware.directory",
        "pathType": "flow",
        "filename": "payload.filename",
        "filenameType": "msg",
        "x": 600,
        "y": 480,
        "wires": [
            [
                "83cd387005aedfca"
            ]
        ]
    },
    {
        "id": "577364685ab43781",
        "type": "fs-ops-delete",
        "z": "122f65d809b34d8e",
        "name": "Delete MD5 Hash",
        "path": "firmware.directory",
        "pathType": "flow",
        "filename": "payload.filename",
        "filenameType": "msg",
        "x": 1090,
        "y": 480,
        "wires": [
            [
                "9e5f7be850106284"
            ]
        ]
    },
    {
        "id": "f463a024845ffd4d",
        "type": "fs-ops-link",
        "z": "122f65d809b34d8e",
        "name": "Get Links",
        "path": "firmware.directory",
        "pathType": "flow",
        "filename": "payload.files",
        "filenameType": "msg",
        "link": "payload.links",
        "linkType": "msg",
        "x": 460,
        "y": 160,
        "wires": [
            [
                "75f8dc9625317378"
            ]
        ]
    },
    {
        "id": "62515f6e3d807c47",
        "type": "fs-ops-dir",
        "z": "122f65d809b34d8e",
        "name": "Firmware listing",
        "path": "firmware.directory",
        "pathType": "flow",
        "filter": "*.json",
        "filterType": "str",
        "dir": "payload.files",
        "dirType": "msg",
        "x": 280,
        "y": 160,
        "wires": [
            [
                "f463a024845ffd4d"
            ]
        ]
    },
    {
        "id": "4ce9f93ab2d5cb33",
        "type": "httpInMultipart",
        "z": "122f65d809b34d8e",
        "name": "OTA Upload",
        "url": "/upload-into-database",
        "method": "post",
        "fields": "[{ \"name\": \"firmware\"}]",
        "swaggerDoc": "",
        "x": 90,
        "y": 240,
        "wires": [
            [
                "4ab20d5b0eb3589e"
            ]
        ]
    },
    {
        "id": "67d2b0e7ed804d0b",
        "type": "mongodb out",
        "z": "122f65d809b34d8e",
        "mongodb": "96e271eba0b52a94",
        "name": "Load file into database",
        "collection": "recursos_de_las_pruebas",
        "payonly": false,
        "upsert": false,
        "multi": false,
        "operation": "store",
        "x": 1180,
        "y": 240,
        "wires": []
    },
    {
        "id": "4ab20d5b0eb3589e",
        "type": "fs-ops-move",
        "z": "122f65d809b34d8e",
        "name": "Store firmware",
        "sourcePath": "req.files.firmware[0].destination",
        "sourcePathType": "msg",
        "sourceFilename": "req.files.firmware[0].filename",
        "sourceFilenameType": "msg",
        "destPath": "firmware.directory",
        "destPathType": "flow",
        "destFilename": "req.files.firmware[0].originalname",
        "destFilenameType": "msg",
        "link": false,
        "x": 280,
        "y": 240,
        "wires": [
            [
                "ed09f8e811dd3ebb",
                "a338d691dbcbcc95",
                "4b0e1b8ee55ee3dc"
            ]
        ]
    },
    {
        "id": "574e891f993fcb91",
        "type": "inject",
        "z": "122f65d809b34d8e",
        "g": "0888e7373481d35e",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{}",
        "payloadType": "json",
        "x": 890,
        "y": 700,
        "wires": [
            [
                "c8ba76d152d7366a"
            ]
        ]
    },
    {
        "id": "c8ba76d152d7366a",
        "type": "mongodb out",
        "z": "122f65d809b34d8e",
        "g": "0888e7373481d35e",
        "mongodb": "96e271eba0b52a94",
        "name": "",
        "collection": "recursos_de_las_pruebas",
        "payonly": false,
        "upsert": false,
        "multi": false,
        "operation": "delete",
        "x": 1190,
        "y": 700,
        "wires": []
    },
    {
        "id": "46f6454f8d3bdb92",
        "type": "function",
        "z": "122f65d809b34d8e",
        "name": "Format JSON",
        "func": "msg.payload = JSON.parse(msg.payload);\nmsg.filename = flow.get(\"original_name\");;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 980,
        "y": 240,
        "wires": [
            [
                "67d2b0e7ed804d0b",
                "5f8702cdecbebdd1"
            ]
        ]
    },
    {
        "id": "b4b83576edf903b5",
        "type": "link out",
        "z": "122f65d809b34d8e",
        "name": "link out 2",
        "mode": "link",
        "links": [
            "e8c6e9ffed7b9a38"
        ],
        "x": 835,
        "y": 160,
        "wires": []
    },
    {
        "id": "e8c6e9ffed7b9a38",
        "type": "link in",
        "z": "122f65d809b34d8e",
        "g": "0f1cf58e08b73cc2",
        "name": "link in 17",
        "links": [
            "b4b83576edf903b5",
            "13e5a65e6bd44eda"
        ],
        "x": 1365,
        "y": 220,
        "wires": [
            [
                "21f9347e8aef3828"
            ]
        ]
    },
    {
        "id": "ed09f8e811dd3ebb",
        "type": "link out",
        "z": "122f65d809b34d8e",
        "name": "link out 3",
        "mode": "link",
        "links": [
            "a2b9b895f1a88888"
        ],
        "x": 415,
        "y": 200,
        "wires": []
    },
    {
        "id": "a2b9b895f1a88888",
        "type": "link in",
        "z": "122f65d809b34d8e",
        "g": "0f1cf58e08b73cc2",
        "name": "link in 18",
        "links": [
            "ed09f8e811dd3ebb"
        ],
        "x": 1365,
        "y": 260,
        "wires": [
            [
                "21f9347e8aef3828"
            ]
        ]
    },
    {
        "id": "8d9f6656f8f37055",
        "type": "link in",
        "z": "122f65d809b34d8e",
        "g": "0f1cf58e08b73cc2",
        "name": "link in 19",
        "links": [
            "2757674848698812"
        ],
        "x": 1365,
        "y": 300,
        "wires": [
            [
                "21f9347e8aef3828"
            ]
        ]
    },
    {
        "id": "2757674848698812",
        "type": "link out",
        "z": "122f65d809b34d8e",
        "name": "link out 4",
        "mode": "link",
        "links": [
            "8d9f6656f8f37055"
        ],
        "x": 425,
        "y": 340,
        "wires": []
    },
    {
        "id": "9e5f7be850106284",
        "type": "link out",
        "z": "122f65d809b34d8e",
        "name": "link out 5",
        "mode": "link",
        "links": [
            "5baf45c3e6032233"
        ],
        "x": 1225,
        "y": 480,
        "wires": []
    },
    {
        "id": "9830d71cb39f6027",
        "type": "link out",
        "z": "122f65d809b34d8e",
        "name": "link out 6",
        "mode": "link",
        "links": [
            "20ec2a5a24d52017"
        ],
        "x": 1225,
        "y": 400,
        "wires": []
    },
    {
        "id": "20ec2a5a24d52017",
        "type": "link in",
        "z": "122f65d809b34d8e",
        "g": "0f1cf58e08b73cc2",
        "name": "link in 20",
        "links": [
            "9830d71cb39f6027"
        ],
        "x": 1365,
        "y": 340,
        "wires": [
            [
                "21f9347e8aef3828"
            ]
        ]
    },
    {
        "id": "5baf45c3e6032233",
        "type": "link in",
        "z": "122f65d809b34d8e",
        "g": "0f1cf58e08b73cc2",
        "name": "link in 21",
        "links": [
            "9e5f7be850106284"
        ],
        "x": 1365,
        "y": 380,
        "wires": [
            [
                "21f9347e8aef3828"
            ]
        ]
    },
    {
        "id": "78dabba95c4207d3",
        "type": "config",
        "z": "122f65d809b34d8e",
        "name": "Database Config",
        "properties": [
            {
                "p": "firmware.directory",
                "pt": "flow",
                "to": "/home/rhyloo/OTA/",
                "tot": "str"
            },
            {
                "p": "database.name",
                "pt": "flow",
                "to": "test",
                "tot": "str"
            }
        ],
        "active": true,
        "x": 330,
        "y": 60,
        "wires": []
    },
    {
        "id": "b36aa30.3a7276",
        "type": "http request",
        "z": "122f65d809b34d8e",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "url": "",
        "x": 970,
        "y": 760,
        "wires": [
            [
                "1ef9987c.956c78"
            ]
        ]
    },
    {
        "id": "11167f67.5d5031",
        "type": "inject",
        "z": "122f65d809b34d8e",
        "name": "cars on craigslist",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "http://localhost:1880/upload-into-database",
        "payloadType": "str",
        "x": 640,
        "y": 760,
        "wires": [
            [
                "70154cd4.de1444"
            ]
        ]
    },
    {
        "id": "70154cd4.de1444",
        "type": "change",
        "z": "122f65d809b34d8e",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 810,
        "y": 760,
        "wires": [
            [
                "b36aa30.3a7276"
            ]
        ]
    },
    {
        "id": "1ef9987c.956c78",
        "type": "debug",
        "z": "122f65d809b34d8e",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "false",
        "x": 1130,
        "y": 760,
        "wires": []
    },
    {
        "id": "a338d691dbcbcc95",
        "type": "change",
        "z": "122f65d809b34d8e",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "original_name",
                "pt": "flow",
                "to": "req.files.firmware[0].originalname",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 500,
        "y": 280,
        "wires": [
            [
                "8c7f90b7fc20034e"
            ]
        ]
    },
    {
        "id": "229b68c9527f20eb",
        "type": "mongodb out",
        "z": "122f65d809b34d8e",
        "mongodb": "96e271eba0b52a94",
        "name": "Remove file from database",
        "collection": "recursos_de_las_pruebas",
        "payonly": false,
        "upsert": false,
        "multi": false,
        "operation": "delete",
        "x": 600,
        "y": 560,
        "wires": []
    },
    {
        "id": "5f8702cdecbebdd1",
        "type": "debug",
        "z": "122f65d809b34d8e",
        "name": "debug 8",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1140,
        "y": 300,
        "wires": []
    },
    {
        "id": "ba5bdf24521f902e",
        "type": "mongodb out",
        "z": "122f65d809b34d8e",
        "mongodb": "96e271eba0b52a94",
        "name": "Remove file from database",
        "collection": "recursos_de_las_pruebas",
        "payonly": false,
        "upsert": false,
        "multi": false,
        "operation": "delete",
        "x": 900,
        "y": 320,
        "wires": []
    },
    {
        "id": "8c7f90b7fc20034e",
        "type": "function",
        "z": "122f65d809b34d8e",
        "name": "Get name",
        "func": "var name = flow.get(\"original_name\");\nmsg.payload = JSON.parse('{\"filename\":\"' + name + '\"}');\nreturn msg;\n'{\"firstName\": \"John\",\"lastName\": \"Doe\",\"location\": \"New York\"}'",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 700,
        "y": 280,
        "wires": [
            [
                "ba5bdf24521f902e"
            ]
        ]
    },
    {
        "id": "4ccb8e8716f24a2a",
        "type": "debug",
        "z": "122f65d809b34d8e",
        "name": "debug 10",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 480,
        "y": 680,
        "wires": []
    },
    {
        "id": "8bd48ac4766a807d",
        "type": "function",
        "z": "122f65d809b34d8e",
        "name": "function 14",
        "func": "msg.req = { \"_readableState\": { \"objectMode\": false, \"highWaterMark\": 16384, \"buffer\": { \"head\": null, \"tail\": null, \"length\": 0 }, \"length\": 0, \"pipes\": [], \"flowing\": null, \"ended\": true, \"endEmitted\": false, \"reading\": false, \"constructed\": true, \"sync\": true, \"needReadable\": false, \"emittedReadable\": false, \"readableListening\": false, \"resumeScheduled\": false, \"errorEmitted\": false, \"emitClose\": true, \"autoDestroy\": true, \"destroyed\": false, \"errored\": null, \"closed\": false, \"closeEmitted\": false, \"defaultEncoding\": \"utf8\", \"awaitDrainWriters\": null, \"multiAwaitDrain\": false, \"readingMore\": true, \"dataEmitted\": false, \"decoder\": null, \"encoding\": null }, \"_events\": {}, \"_eventsCount\": 1, \"socket\": \"[internal]\", \"httpVersionMajor\": 1, \"httpVersionMinor\": 1, \"httpVersion\": \"1.1\", \"complete\": true, \"rawHeaders\": [\"Host\", \"localhost:1880\", \"User-Agent\", \"Mozilla/5.0 (X11; Linux x86_64; rv:106.0) Gecko/20100101 Firefox/106.0\", \"Accept\", \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\", \"Accept-Language\", \"en-US,en;q=0.5\", \"Accept-Encoding\", \"gzip, deflate, br\", \"Connection\", \"keep-alive\", \"Upgrade-Insecure-Requests\", \"1\", \"Sec-Fetch-Dest\", \"document\", \"Sec-Fetch-Mode\", \"navigate\", \"Sec-Fetch-Site\", \"none\", \"Sec-Fetch-User\", \"?1\", \"If-None-Match\", \"W/\\\"3128-qMtiVcwBVBzxIdUCUeE/ULHRlsg\\\"\"], \"rawTrailers\": [], \"aborted\": false, \"upgrade\": false, \"url\": \"/upload-into-database\", \"method\": \"GET\", \"statusCode\": null, \"statusMessage\": null, \"client\": \"[internal]\", \"_consuming\": false, \"_dumped\": false, \"baseUrl\": \"\", \"originalUrl\": \"/upload-into-database\", \"_parsedUrl\": { \"protocol\": null, \"slashes\": null, \"auth\": null, \"host\": null, \"port\": null, \"hostname\": null, \"hash\": null, \"search\": null, \"query\": null, \"pathname\": \"/upload-into-database\", \"path\": \"/upload-into-database\", \"href\": \"/upload-into-database\", \"_raw\": \"/upload-into-database\" }, \"params\": {}, \"query\": { \"files\": [\"acertijo.txt\", \"test.txt\"], \"links\": [\"\", \"\"] }, \"res\": \"[internal]\", \"body\": {}, \"_parsedOriginalUrl\": { \"protocol\": null, \"slashes\": null, \"auth\": null, \"host\": null, \"port\": null, \"hostname\": null, \"hash\": null, \"search\": null, \"query\": null, \"pathname\": \"/upload-into-database\", \"path\": \"/upload-into-database\", \"href\": \"/upload-into-database\", \"_raw\": \"/upload-into-database\" }, \"route\": { \"path\": \"/upload-into-database\", \"stack\": [{ \"name\": \"cookieParser\", \"keys\": [], \"regexp\": { \"__enc__\": true, \"type\": \"regexp\", \"data\": \"/^\\\\/?$/i\" }, \"method\": \"get\" }, { \"name\": \"httpMiddleware\", \"keys\": [], \"regexp\": { \"__enc__\": true, \"type\": \"regexp\", \"data\": \"/^\\\\/?$/i\" }, \"method\": \"get\" }, { \"name\": \"corsHandler\", \"keys\": [], \"regexp\": { \"__enc__\": true, \"type\": \"regexp\", \"data\": \"/^\\\\/?$/i\" }, \"method\": \"get\" }, { \"name\": \"metricsHandler\", \"keys\": [], \"regexp\": { \"__enc__\": true, \"type\": \"regexp\", \"data\": \"/^\\\\/?$/i\" }, \"method\": \"get\" }, { \"name\": \"<anonymous>\", \"keys\": [], \"regexp\": { \"__enc__\": true, \"type\": \"regexp\", \"data\": \"/^\\\\/?$/i\" }, \"method\": \"get\" }, { \"name\": \"<anonymous>\", \"keys\": [], \"regexp\": { \"__enc__\": true, \"type\": \"regexp\", \"data\": \"/^\\\\/?$/i\" }, \"method\": \"get\" }], \"methods\": { \"get\": true } }, \"cookies\": {}, \"signedCookies\": {} };\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 290,
        "y": 620,
        "wires": [
            [
                "6e6303ec1355dd7b"
            ]
        ]
    },
    {
        "id": "3ea1869ededca123",
        "type": "function",
        "z": "122f65d809b34d8e",
        "name": "function 15",
        "func": "flow.set(\"database.name\", msg.payload.cars); \nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 290,
        "y": 680,
        "wires": [
            [
                "4ccb8e8716f24a2a"
            ]
        ]
    },
    {
        "id": "6e6303ec1355dd7b",
        "type": "fs-ops-dir",
        "z": "122f65d809b34d8e",
        "name": "Firmware listing",
        "path": "firmware.directory",
        "pathType": "flow",
        "filter": "*.txt",
        "filterType": "str",
        "dir": "payload.files",
        "dirType": "msg",
        "x": 500,
        "y": 620,
        "wires": [
            [
                "a29930999c9591dd"
            ]
        ]
    },
    {
        "id": "a29930999c9591dd",
        "type": "fs-ops-link",
        "z": "122f65d809b34d8e",
        "name": "Get Links",
        "path": "firmware.directory",
        "pathType": "flow",
        "filename": "payload.files",
        "filenameType": "msg",
        "link": "payload.links",
        "linkType": "msg",
        "x": 720,
        "y": 620,
        "wires": [
            [
                "7c32016dc0bd0ac8"
            ]
        ]
    },
    {
        "id": "13e5a65e6bd44eda",
        "type": "link out",
        "z": "122f65d809b34d8e",
        "name": "link out 7",
        "mode": "link",
        "links": [
            "e8c6e9ffed7b9a38"
        ],
        "x": 1095,
        "y": 620,
        "wires": []
    },
    {
        "id": "eb17e5a1f3da02dc",
        "type": "http in",
        "z": "122f65d809b34d8e",
        "name": "OTA Manager",
        "url": "/test",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 90,
        "y": 620,
        "wires": [
            [
                "8bd48ac4766a807d"
            ]
        ]
    },
    {
        "id": "08fcca7c8fe2ad73",
        "type": "http in",
        "z": "122f65d809b34d8e",
        "name": "",
        "url": "/test",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 80,
        "y": 680,
        "wires": [
            [
                "8bd48ac4766a807d",
                "3ea1869ededca123"
            ]
        ]
    },
    {
        "id": "7c32016dc0bd0ac8",
        "type": "template",
        "z": "122f65d809b34d8e",
        "name": "Firmware Manager",
        "field": "payload",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "<html>\n    <head>\n        <title>Database File Manager</title>\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n        <link rel=\"stylesheet\" href=\"http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css\">\n        <script src=\"https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js\"></script>\n        <script src=\"http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js\"></script>\n        <style>\n            .file-btn-grp {\n                display: none;\n            }\n            body {\n                background-color: #f6f6f6;\n            }\n            .text_holder {\n                display: block;\n                max-width: 100%;\n                word-wrap: break-word;\n                line-height: 30px;\n            }\n            #main {\n                margin-top: 50px;\n                background-color: #ffffff;\n                border-radius: 5px;\n                width: 70%;\n                min-width: 500px;\n                border: 1px solid #545454;\n            }\n            .alert {\n                margin-top: 10px;\n                margin-bottom: 5px;\n            }\n            .link {\n                font-style: italic;\n            }\n            .listentry {\n                display: none;\n                list-style-type: none;\n            }\n        </style>\n\n    </head>\n    <body>\n        <div class=\"container\" id=\"main\">\n            <h1><small>Database File Manager</small></h1>\n            <h2><small>Upload New Files</small></h2>\n<form action=\"test\" method=\"POST\">\n    <label for=\"cars\">Choose a collection:</label>\n    <select name=\"cars\" id=\"cars\">\n    <option value=\"test2\">test2</option>\n    <option value=\"test3\">test3</option>\n    <option value=\"test4\">test4</option>\n    <option value=\"test5\">test5</option>\n  </select>\n    <br><br>\n    <input type=\"submit\" value=\"Submit\">\n</form>\n            <form role =\"form\" id=\"main_input_box\" action=\"upload-into-database\" method=\"POST\" enctype=\"multipart/form-data\" class=\"form-inline\">\n                <input type=\"file\" accept=\".txt\" class=\"hidden\" id=\"fileUpload\" name=\"firmware\" placeholder=\"firmware.bin\">\n                <div class=\"form-group\">\n                <div class=\"input-group\">\n                    <span class=\"input-group-btn\">\n                        <button id=\"browse\" type=\"button\" class=\"btn btn-primary\">Browse...</button>\n                    </span>\n                    <input id=\"filename\" size=100 readonly=\"\" class=\"form-control\" placeholder=\"File\">\n                    <span class=\"input-group-btn\">\n                        <input type=\"submit\" value=\"Upload\" class=\"btn btn-primary add_button\">\n                    </span>\n                </div>\n                </div>\n            </form>\n\n            <h2><small>Current Files</small></h2>\n            <ul class=\"list-group\" id=\"list_of_items\">\n            </ul>\n        </div>\n\n        <div id=\"linkModal\" class=\"modal fade\" role=\"dialog\">\n            <div class=\"modal-dialog\">\n        \n                <!-- Modal content-->\n                <div class=\"modal-content\">\n                    <div class=\"modal-header\">\n                        <button type=\"button\" class=\"close\" data-dismiss=\"modal\">&times;</button>\n                        <h4 class=\"modal-title\">Create Symbolic Link</h4>\n                    </div>\n                    <div class=\"modal-body\">\n                        <form class=\"form-horizontal\" id=\"linkForm\" role=\"form\" action=\"#\" method=\"POST\">\n                            <div class=\"form-group\">\n                                <label class=\"control-label  col-sm-2\" for=\"linkName\">Link:</label> \n                                <div class=\"col-sm-10\">\n                                    <input id=\"linkName\" name=\"linkName\" class=\"form-control\"/>\n                                </div>\n                            </div>\n                            <div class=\"form-group\">\n                                <label class=\"control-label  col-sm-2\" for=\"linkFile\">To:</label> \n                                <div class=\"col-sm-10\">\n                                    <input class=\"form-control\" id=\"linkFile\" name=\"linkFile\"/>\n                                </div>\n                            </div>\n                        </form>\n                    </div>\n                    <div class=\"modal-footer\">\n                        <button type=\"submit\" class=\"btn btn-success link-create\">Create</button>\n                        <button type=\"button\" class=\"btn btn-warning\" data-dismiss=\"modal\">Cancel</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n        <script>\n\n            var deleteButton = \"<button id='delete' class='btn btn-warning'>Delete</button>\";\n            var linkButton = \"<button id='link' class='btn btn-success'>Link</button>\";\n            var oneButton = \"<div class='file-btn-grp btn-group pull-right'>\" + deleteButton + \"</div>\";\n            var twoButtons = \"<div class='file-btn-grp btn-group pull-right'>\" + deleteButton + linkButton + \"</div>\";\n            \n            function addListEntry(list, filename, linkname) {\n            \n                var entry;\n                \n                if (linkname === undefined) {\n                    entry = $(\"<li class='listentry list-group-item'><div class='text_holder'><span>\" \n                    + filename + \"</span>\" + twoButtons + \"</div></li>\");\n                } else {\n                    entry = $(\"<li class='listentry list-group-item'><div class='text_holder'><span class='link'>\" \n                    + filename + \"</span> <span class='glyphicon glyphicon-arrow-right'></span> \" \n                    + linkname + oneButton + \"</div></li>\");\n                }\n                \n                entry.mouseover(function(){\n                    $(this).find(\".btn-group\").fadeIn(\"fast\");\n                });\n                entry.mouseleave(function(){\n                    $(this).find(\".btn-group\").fadeOut(\"slow\");\n                });\n                \n                entry.on(\"click\", \"button#delete\", function(){\n                    var listItem = this.parentElement.parentElement.parentElement;\n                    var file = this.parentElement.parentElement.childNodes[0].childNodes[0].data;\n                    $.ajax({\n                        type: 'DELETE',\n                        data: {\"filename\": file},\n                        success: function(result) {\n                            $(listItem).fadeOut(\"slow\", function(){\n                                listItem.remove();\n                            });\n                        },\n                        error: function(result) {\n                            $(listItem).append(\"<div class='alert alert-danger'>\"\n                                + \"<a href='#' class='close' data-dismiss='alert'\"\n                                + \"aria-label='close'>&times;</a>\"\n                                + result.responseText + \"</div>\");\n                        }\n                    });\n                });\n           \n                entry.on(\"click\", \"button#link\", function(){\n                    var file = this.parentElement.parentElement.childNodes[0].childNodes[0].data;\n                    $(\"#linkName\").val(\"\");\n                    $(\"#linkFile\").prop(\"disabled\", true).val(file);\n                    $(\"#linkName\").parent().removeClass(\"has-error\");\n                    $(\"#linkModal\").modal();\n                    $('#linkModal').on('shown.bs.modal', function () {\n                        $('#linkName').focus();\n                    });\n                });\n                \n                if (list.children().length == 0) {\n                    list.append(entry);\n                    entry.fadeIn(\"slow\");\n                    return;\n                }\n\n                if (filename < $(\"li:first span:first\", list).text()) {\n                    $(\"li:first\", list).before(entry);\n                    entry.fadeIn(\"slow\");\n                    return;\n                }\n                if (filename > $(\"li:last span:first\", list).text()) {\n                    $(\"li:last\", list).after(entry);\n                    entry.fadeIn(\"slow\");\n                    return;\n                }\n                \n                var count = 0;\n                var $li = $(\"li\", list);\n                do {\n                    var index = parseInt($li.length / 2);\n                    var $compare = $li.eq(index);\n                    var compare = $(\"span:first\",$compare).text();\n                    if (filename === compare) {\n                        break;\n                    }\n                    else if (filename > compare) {\n                        $li = $li.slice(index, $li.length);\n                    } else {\n                        $li = $li.slice(0, index);\n                    }\n                } while ($li.length > 1);\n\n                if (filename === compare) {\n                    $compare.slideUp(\"fast\").slideDown(\"slow\");\n                    return;\n                } else if (filename < compare) { \n                    entry.insertBefore($compare); \n                } else { \n                    entry.insertAfter($compare); \n                }\n                entry.slideDown(\"slow\");\n            }\n            \n            \n            var files = String(\"{{payload.files}}\").split(',');\n            var links = String(\"{{payload.links}}\").split(',');\n            \n            var list_of_items = $(\"#list_of_items\");\n            \n            files.forEach(function(file,index) {\n                if (links[index] == \"\") {\n                    addListEntry(this, file.slice(0,-4));\n                } else {\n                    addListEntry(this, file.slice(0,-4), links[index].slice(0,-4));\n                }\n            },list_of_items);\n           \n           \n            $(\"#linkModal\").on(\"click\", \"button.link-create\", function(event){\n               event.preventDefault();\n               if ($(\"#linkName\").val() == \"\") {\n                    $('#linkName').focus();\n                    $('#linkName').parent().addClass(\"has-error\");\n                    return false;\n               }\n               $(\"#linkFile\").prop(\"disabled\",false);               \n               $.ajax({\n                    type: 'PUT',\n                    data: $(\"#linkForm\").serialize(),\n                    success: function(result) {\n                        $(\"#linkModal\").modal('hide');\n                        addListEntry(list_of_items, $('#linkName').val(), $('#linkFile').val());\n                    },\n                    error: function(result) {\n                        $(\"#linkFile\").prop(\"disabled\", true);\n                        $('#linkName').focus();\n                        $('#linkName').parent().addClass(\"has-error\");\n                        $(linkForm).append(\"<div id='linkError' class='alert alert-danger'>\"\n                             + \"<a href='#' class='close' data-dismiss='alert'\"\n                             + \"aria-label='close'>&times;</a>\"\n                             + result.responseText + \"</div>\");\n                    }\n                });\n            });\n            \n            $(\"#browse\").on('click', function () {\n                fileUpload.click();\n            });\n            \n            $(\"#fileUpload\").on('change', function () {\n                $(\"#filename\").val($(\"#fileUpload\").val().split('/').pop().split('\\\\').pop());\n            });\n            \n            var frm = $(\"#main_input_box\");\n            \n            frm.submit( function( e ) {\n                e.preventDefault();\n                if ($('#fileUpload').val() == \"\") return null;\n                $.ajax( {\n                    url: frm.attr('action'),\n                    type: frm.attr('method'),\n                    data: new FormData( this ),\n                    processData: false,\n                    contentType: false,\n                    success: function(result) {\n                        addListEntry(list_of_items, $('#fileUpload').val().slice(0,-4).split('\\\\').pop());\n                        $('#fileUpload').val('');\n                        $(':text').val('');\n                    },\n                    error: function(result) {\n                        $(\"#main_input_box\").append(\"<div class='alert alert-danger'>\"\n                             + \"<a href='#' class='close' data-dismiss='alert'\"\n                             + \"aria-label='close'>&times;</a>\"\n                             + result.responseText + \"</div>\");\n                    }\n\n                });\n            });\n            //form=document.getElementById(\"my_options\");\n            //function askForChange() {\n            //form.action=\"test\";\n            //form.submit();\n            //}\n        </script>\n    </body>\n</html>",
        "output": "str",
        "x": 910,
        "y": 620,
        "wires": [
            [
                "13e5a65e6bd44eda"
            ]
        ]
    },
    {
        "id": "f3dc491e67b9826c",
        "type": "function",
        "z": "b056b4cf9a298e0d",
        "g": "74c5e0e865fd749f",
        "name": "mensaje bienvenida",
        "func": "msg.payload = global.get(\"user\");\nif(msg.payload.content.substring(0,1)!=\"/\")\n{\n msg.payload.content=\"Bienvenidos aventureros. ¿Estáis listos para entrar en google? Accede al menú y mira todas las opciones disponibles.\";\n return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 400,
        "y": 340,
        "wires": [
            [
                "fedcb4bb1ace3832"
            ]
        ]
    },
    {
        "id": "d064a8a08363d9a0",
        "type": "telegram receiver",
        "z": "b056b4cf9a298e0d",
        "g": "74c5e0e865fd749f",
        "name": "",
        "bot": "d95354d46509e771",
        "saveDataDir": "",
        "filterCommands": true,
        "x": 130,
        "y": 120,
        "wires": [
            [
                "22daf5dc41a5c8e3",
                "32e1c65c1907a6cf"
            ],
            []
        ]
    },
    {
        "id": "20a682fad8758c49",
        "type": "telegram sender",
        "z": "b056b4cf9a298e0d",
        "g": "4cd2d92b6f1e42de",
        "name": "",
        "bot": "d95354d46509e771",
        "haserroroutput": false,
        "outputs": 1,
        "x": 1510,
        "y": 80,
        "wires": [
            [
                "18eebd5c17ad471e"
            ]
        ]
    },
    {
        "id": "22a622e6e3a77723",
        "type": "subflow:7cbc96056c55979a",
        "z": "b056b4cf9a298e0d",
        "g": "407e3e089de46a03",
        "name": "Cara002",
        "x": 580,
        "y": 520,
        "wires": [
            [
                "ad9e883957d3685b"
            ],
            [
                "1f58fb8b96bce92e"
            ],
            [
                "7dc2883e2ed41873"
            ]
        ],
        "icon": "font-awesome/fa-asl-interpreting"
    },
    {
        "id": "a483d173586b9e5e",
        "type": "change",
        "z": "b056b4cf9a298e0d",
        "g": "74c5e0e865fd749f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "user",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 320,
        "y": 220,
        "wires": [
            [
                "a5686142f35c81ec"
            ]
        ]
    },
    {
        "id": "a5686142f35c81ec",
        "type": "debug",
        "z": "b056b4cf9a298e0d",
        "g": "74c5e0e865fd749f",
        "name": "debug 16",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 540,
        "y": 220,
        "wires": []
    },
    {
        "id": "eafe96754ad3092d",
        "type": "telegram command",
        "z": "b056b4cf9a298e0d",
        "g": "74c5e0e865fd749f",
        "name": "",
        "command": "/start",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "d95354d46509e771",
        "strict": false,
        "hasresponse": false,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 1,
        "x": 90,
        "y": 220,
        "wires": [
            [
                "a483d173586b9e5e"
            ]
        ]
    },
    {
        "id": "fedcb4bb1ace3832",
        "type": "link out",
        "z": "b056b4cf9a298e0d",
        "g": "74c5e0e865fd749f",
        "name": "link out 8",
        "mode": "link",
        "links": [
            "880fa11cf1585bf1",
            "d8313757e30311dd"
        ],
        "x": 585,
        "y": 340,
        "wires": []
    },
    {
        "id": "b4e7a71c03156b8f",
        "type": "complete",
        "z": "b056b4cf9a298e0d",
        "g": "74c5e0e865fd749f",
        "name": "",
        "scope": [
            "a5686142f35c81ec"
        ],
        "uncaught": false,
        "x": 110,
        "y": 340,
        "wires": [
            [
                "f3dc491e67b9826c"
            ]
        ]
    },
    {
        "id": "d8313757e30311dd",
        "type": "link in",
        "z": "b056b4cf9a298e0d",
        "g": "4cd2d92b6f1e42de",
        "name": "link in 23",
        "links": [
            "e34ad49609205470",
            "fedcb4bb1ace3832",
            "f8d2fc3e0e98c026",
            "f3f6865a4acc64a8"
        ],
        "x": 1065,
        "y": 80,
        "wires": [
            [
                "20a682fad8758c49"
            ]
        ]
    },
    {
        "id": "c8318c5c0b6342cd",
        "type": "complete",
        "z": "b056b4cf9a298e0d",
        "g": "407e3e089de46a03",
        "name": "",
        "scope": [
            "f3dc491e67b9826c"
        ],
        "uncaught": false,
        "x": 110,
        "y": 520,
        "wires": [
            [
                "b8246bec0ff6bd43"
            ]
        ]
    },
    {
        "id": "cfe27898c4972426",
        "type": "function",
        "z": "b056b4cf9a298e0d",
        "g": "4cd2d92b6f1e42de",
        "name": "",
        "func": "var time = global.get(\"time\");\ntime = time - 1;\nglobal.set(\"time\", time);\n\nvar sec_num = time;\nvar hours = Math.floor(sec_num / 3600);\nvar minutes = Math.floor((sec_num - (hours * 3600)) / 60);\nvar seconds = sec_num - (hours * 3600) - (minutes * 60);\n\nif (hours < 10) { hours = \"0\" + hours; }\nif (minutes < 10) { minutes = \"0\" + minutes; }\nif (seconds < 10) { seconds = \"0\" + seconds; }\n\nmsg.payload = hours + ':' + minutes + ':' + seconds;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1640,
        "y": 300,
        "wires": [
            [
                "5b392c70bdeeab37"
            ]
        ]
    },
    {
        "id": "7b3e58db5fa243a0",
        "type": "controltimer",
        "z": "b056b4cf9a298e0d",
        "g": "4cd2d92b6f1e42de",
        "name": "",
        "timerType": "loop",
        "timerDurationUnit": "second",
        "timerDurationType": "num",
        "timerDuration": 1,
        "timerLoopTimeoutUnit": "second",
        "timerLoopTimeoutType": "num",
        "timerLoopTimeout": 0,
        "loopTimeoutMessageType": "str",
        "loopTimeoutMessage": "LOOP_TIMEOUT",
        "timerMaxLoopIterationsType": "num",
        "timerMaxLoopIterations": 0,
        "loopMaxIterationsMessageType": "str",
        "loopMaxIterationsMessage": "MAX_LOOP_ITERATIONS",
        "isConsecutiveStartActionTimerResetAllowed": false,
        "isRunningTimerProgressVisible": true,
        "outputReceivedMessageOnTimerTrigger": true,
        "outputReceivedMessageOnTimerHalt": false,
        "startTimerOnReceivalOfUnknownMessage": true,
        "resetTimerOnReceivalOfUnknownMessage": false,
        "isDebugModeEnabled": true,
        "timerTriggeredMessageType": "str",
        "timerTriggeredMessage": "TIMER_TRIGGERED",
        "timerHaltedMessageType": "str",
        "timerHaltedMessage": "TIMER_HALTED",
        "isStartActionEnabled": true,
        "isStopActionEnabled": true,
        "isResetActionEnabled": true,
        "isPauseActionEnabled": true,
        "isContinueActionEnabled": true,
        "actionPropertyNameType": "str",
        "actionPropertyName": "payload",
        "startActionNameType": "str",
        "startActionName": "START",
        "stopActionNameType": "str",
        "stopActionName": "STOP",
        "resetActionNameType": "str",
        "resetActionName": "RESET",
        "pauseActionNameType": "str",
        "pauseActionName": "PAUSE",
        "continueActionNameType": "str",
        "continueActionName": "CONTINUE",
        "x": 1440,
        "y": 300,
        "wires": [
            [
                "cfe27898c4972426"
            ],
            []
        ]
    },
    {
        "id": "08f030f5381a1c7d",
        "type": "config",
        "z": "b056b4cf9a298e0d",
        "g": "74c5e0e865fd749f",
        "name": "",
        "properties": [
            {
                "p": "time",
                "pt": "global",
                "to": "3600",
                "tot": "num"
            },
            {
                "p": "Game",
                "pt": "global",
                "to": "0",
                "tot": "str"
            },
            {
                "p": "save_random",
                "pt": "global",
                "to": "0",
                "tot": "num"
            }
        ],
        "active": true,
        "x": 310,
        "y": 280,
        "wires": []
    },
    {
        "id": "da39ff3f3bd01714",
        "type": "function",
        "z": "b056b4cf9a298e0d",
        "g": "4cd2d92b6f1e42de",
        "name": "Send an inline message",
        "func": "var texto = msg.payload;\nmsg.payload = global.get(\"user\");\nmsg.payload.content = texto;\nmsg.payload.type = \"message\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1230,
        "y": 140,
        "wires": [
            [
                "20a682fad8758c49"
            ]
        ]
    },
    {
        "id": "ad9e883957d3685b",
        "type": "link out",
        "z": "b056b4cf9a298e0d",
        "g": "407e3e089de46a03",
        "name": "link out 10",
        "mode": "link",
        "links": [
            "56de6b18ecd69a81"
        ],
        "x": 755,
        "y": 480,
        "wires": []
    },
    {
        "id": "56de6b18ecd69a81",
        "type": "link in",
        "z": "b056b4cf9a298e0d",
        "g": "4cd2d92b6f1e42de",
        "name": "link in 24",
        "links": [
            "5e29b723009e3677",
            "dc20f200c13eb39a",
            "ad9e883957d3685b",
            "b2227557ab57b7ef",
            "7e40046c60ee2860",
            "ca6fc1c375a4484a"
        ],
        "x": 1065,
        "y": 140,
        "wires": [
            [
                "da39ff3f3bd01714"
            ]
        ]
    },
    {
        "id": "5b392c70bdeeab37",
        "type": "ui_text",
        "z": "b056b4cf9a298e0d",
        "g": "4cd2d92b6f1e42de",
        "group": "f870df7d6c3cc2e9",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Game time - User",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1850,
        "y": 300,
        "wires": []
    },
    {
        "id": "8cf6b99ba10ac475",
        "type": "complete",
        "z": "b056b4cf9a298e0d",
        "g": "74c5e0e865fd749f",
        "name": "",
        "scope": [
            "a5686142f35c81ec"
        ],
        "uncaught": false,
        "x": 110,
        "y": 280,
        "wires": [
            [
                "08f030f5381a1c7d"
            ]
        ]
    },
    {
        "id": "078431c881436679",
        "type": "debug",
        "z": "b056b4cf9a298e0d",
        "g": "74c5e0e865fd749f",
        "name": "debug 6",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 540,
        "y": 140,
        "wires": []
    },
    {
        "id": "22daf5dc41a5c8e3",
        "type": "change",
        "z": "b056b4cf9a298e0d",
        "g": "74c5e0e865fd749f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "user",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 340,
        "y": 140,
        "wires": [
            [
                "078431c881436679"
            ]
        ]
    },
    {
        "id": "18eebd5c17ad471e",
        "type": "debug",
        "z": "b056b4cf9a298e0d",
        "g": "4cd2d92b6f1e42de",
        "name": "debug 21",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1680,
        "y": 80,
        "wires": []
    },
    {
        "id": "32e1c65c1907a6cf",
        "type": "function",
        "z": "b056b4cf9a298e0d",
        "g": "74c5e0e865fd749f",
        "name": "Delete messages from user",
        "func": "msg.payload = global.get(\"user\");\nvar chat_id = msg.payload.chatId;\nvar message_id = msg.payload.messageId;\nmsg.payload.type = \"deleteMessage\";\nmsg.payload.content = message_id;\n\nreturn msg;\n\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 380,
        "y": 80,
        "wires": [
            [
                "f3f6865a4acc64a8"
            ]
        ]
    },
    {
        "id": "f3f6865a4acc64a8",
        "type": "link out",
        "z": "b056b4cf9a298e0d",
        "g": "74c5e0e865fd749f",
        "name": "link out 13",
        "mode": "link",
        "links": [
            "d8313757e30311dd"
        ],
        "x": 575,
        "y": 80,
        "wires": []
    },
    {
        "id": "0d44cb0ff1d349ea",
        "type": "ui_led",
        "z": "b056b4cf9a298e0d",
        "g": "4cd2d92b6f1e42de",
        "order": 3,
        "group": "f870df7d6c3cc2e9",
        "width": 0,
        "height": 0,
        "label": "Cara002",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ffff00",
                "value": "0",
                "valueType": "num"
            },
            {
                "color": "#008000",
                "value": "1",
                "valueType": "num"
            },
            {
                "color": "#ff0000",
                "value": "2",
                "valueType": "num"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "Cara002",
        "x": 1880,
        "y": 520,
        "wires": []
    },
    {
        "id": "b8246bec0ff6bd43",
        "type": "delay",
        "z": "b056b4cf9a298e0d",
        "g": "407e3e089de46a03",
        "name": "",
        "pauseType": "delay",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 320,
        "y": 520,
        "wires": [
            [
                "22a622e6e3a77723"
            ]
        ]
    },
    {
        "id": "1f58fb8b96bce92e",
        "type": "link out",
        "z": "b056b4cf9a298e0d",
        "g": "407e3e089de46a03",
        "name": "link out 17",
        "mode": "link",
        "links": [
            "ef258efaabcdd988",
            "0b1f4c3a444e4988"
        ],
        "x": 755,
        "y": 520,
        "wires": []
    },
    {
        "id": "7dc2883e2ed41873",
        "type": "link out",
        "z": "b056b4cf9a298e0d",
        "g": "407e3e089de46a03",
        "name": "link out 18",
        "mode": "link",
        "links": [
            "a30bf994eae7cd3e"
        ],
        "x": 755,
        "y": 560,
        "wires": []
    },
    {
        "id": "ef258efaabcdd988",
        "type": "link in",
        "z": "b056b4cf9a298e0d",
        "g": "4cd2d92b6f1e42de",
        "name": "link in 26",
        "links": [
            "5e29b723009e3677",
            "dc20f200c13eb39a",
            "b2227557ab57b7ef",
            "1f58fb8b96bce92e",
            "f6583d92a29357b9"
        ],
        "x": 1065,
        "y": 520,
        "wires": [
            [
                "0d44cb0ff1d349ea"
            ]
        ]
    },
    {
        "id": "a30bf994eae7cd3e",
        "type": "link in",
        "z": "b056b4cf9a298e0d",
        "g": "4cd2d92b6f1e42de",
        "name": "link in 27",
        "links": [
            "5e29b723009e3677",
            "dc20f200c13eb39a",
            "b2227557ab57b7ef",
            "7dc2883e2ed41873",
            "12cc4231e9594b77",
            "592ea0f1449e87e8",
            "e789e8e1711a246d"
        ],
        "x": 1065,
        "y": 300,
        "wires": [
            [
                "1990a18743a761a9"
            ]
        ]
    },
    {
        "id": "1990a18743a761a9",
        "type": "function",
        "z": "b056b4cf9a298e0d",
        "g": "4cd2d92b6f1e42de",
        "name": "Control Clock",
        "func": "switch (msg.payload) {\n    case 0:\n        msg.payload = \"STOP\";\n        break;\n    case 1:\n        msg.payload = \"START\";\n        break;\n    case 2:\n        msg.payload = \"RESET\";\n        break;\n    case 3:\n        msg.payload = \"PAUSE\";\n        break;\n    case 4:\n        msg.payload = \"CONTINUE\";\n        break;\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1220,
        "y": 300,
        "wires": [
            [
                "7b3e58db5fa243a0",
                "7651d8dfb22cc43e"
            ]
        ]
    },
    {
        "id": "7e40046c60ee2860",
        "type": "link out",
        "z": "b056b4cf9a298e0d",
        "g": "f0bc3c69188895b3",
        "name": "link out 19",
        "mode": "link",
        "links": [
            "56de6b18ecd69a81"
        ],
        "x": 755,
        "y": 660,
        "wires": []
    },
    {
        "id": "fdb7e2982875f8ba",
        "type": "delay",
        "z": "b056b4cf9a298e0d",
        "g": "f0bc3c69188895b3",
        "name": "",
        "pauseType": "delay",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 420,
        "y": 700,
        "wires": [
            [
                "323b84f05b7a90a2"
            ]
        ]
    },
    {
        "id": "323b84f05b7a90a2",
        "type": "subflow:72ea5fcb0b022fe1",
        "z": "b056b4cf9a298e0d",
        "g": "f0bc3c69188895b3",
        "name": "",
        "x": 590,
        "y": 700,
        "wires": [
            [
                "7e40046c60ee2860"
            ],
            [
                "90effe8f20f81252"
            ],
            [
                "e789e8e1711a246d"
            ]
        ]
    },
    {
        "id": "e851ebc98b56550e",
        "type": "function",
        "z": "b056b4cf9a298e0d",
        "g": "f0bc3c69188895b3",
        "name": "terminado?",
        "func": "if (msg.payload == 2){\n    return msg;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 230,
        "y": 700,
        "wires": [
            [
                "fdb7e2982875f8ba"
            ]
        ]
    },
    {
        "id": "0b1f4c3a444e4988",
        "type": "link in",
        "z": "b056b4cf9a298e0d",
        "g": "f0bc3c69188895b3",
        "name": "link in 28",
        "links": [
            "1f58fb8b96bce92e"
        ],
        "x": 55,
        "y": 700,
        "wires": [
            [
                "e851ebc98b56550e"
            ]
        ]
    },
    {
        "id": "5d4807349eb7d70c",
        "type": "link in",
        "z": "b056b4cf9a298e0d",
        "g": "4cd2d92b6f1e42de",
        "name": "link in 29",
        "links": [
            "5e29b723009e3677",
            "dc20f200c13eb39a",
            "b2227557ab57b7ef",
            "f6583d92a29357b9",
            "90effe8f20f81252"
        ],
        "x": 1065,
        "y": 560,
        "wires": [
            [
                "5985ed6bdc4ed23d"
            ]
        ]
    },
    {
        "id": "5985ed6bdc4ed23d",
        "type": "ui_led",
        "z": "b056b4cf9a298e0d",
        "g": "4cd2d92b6f1e42de",
        "order": 4,
        "group": "f870df7d6c3cc2e9",
        "width": 0,
        "height": 0,
        "label": "Cara003",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ffff00",
                "value": "0",
                "valueType": "num"
            },
            {
                "color": "#008000",
                "value": "1",
                "valueType": "num"
            },
            {
                "color": "#ff0000",
                "value": "2",
                "valueType": "num"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "Cara003",
        "x": 1880,
        "y": 560,
        "wires": []
    },
    {
        "id": "c8b701ed5904c646",
        "type": "exec",
        "z": "b056b4cf9a298e0d",
        "command": "hostname -I",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 290,
        "y": 1100,
        "wires": [
            [
                "8c565092cc31b72a"
            ],
            [
                "8c565092cc31b72a"
            ],
            [
                "8c565092cc31b72a"
            ]
        ]
    },
    {
        "id": "54c3cce6610825af",
        "type": "inject",
        "z": "b056b4cf9a298e0d",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 120,
        "y": 1100,
        "wires": [
            [
                "c8b701ed5904c646"
            ]
        ]
    },
    {
        "id": "8c565092cc31b72a",
        "type": "debug",
        "z": "b056b4cf9a298e0d",
        "name": "debug 28",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 480,
        "y": 1100,
        "wires": []
    },
    {
        "id": "ca6fc1c375a4484a",
        "type": "link out",
        "z": "b056b4cf9a298e0d",
        "g": "ef9e0b05387b0f7f",
        "name": "link out 20",
        "mode": "link",
        "links": [
            "56de6b18ecd69a81"
        ],
        "x": 755,
        "y": 840,
        "wires": []
    },
    {
        "id": "81702d1a90090e50",
        "type": "delay",
        "z": "b056b4cf9a298e0d",
        "g": "ef9e0b05387b0f7f",
        "name": "",
        "pauseType": "delay",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 420,
        "y": 880,
        "wires": [
            [
                "d5f490ad8e2a8675"
            ]
        ]
    },
    {
        "id": "5dbd7316c3660276",
        "type": "function",
        "z": "b056b4cf9a298e0d",
        "g": "ef9e0b05387b0f7f",
        "name": "terminado?",
        "func": "if (msg.payload == 2){\n    return msg;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 230,
        "y": 880,
        "wires": [
            [
                "81702d1a90090e50"
            ]
        ]
    },
    {
        "id": "6fdb94005210418f",
        "type": "link in",
        "z": "b056b4cf9a298e0d",
        "g": "ef9e0b05387b0f7f",
        "name": "link in 30",
        "links": [
            "90effe8f20f81252"
        ],
        "x": 55,
        "y": 880,
        "wires": [
            [
                "5dbd7316c3660276"
            ]
        ]
    },
    {
        "id": "d5f490ad8e2a8675",
        "type": "subflow:90d9a362f6d9804b",
        "z": "b056b4cf9a298e0d",
        "g": "ef9e0b05387b0f7f",
        "name": "",
        "x": 600,
        "y": 880,
        "wires": [
            [
                "ca6fc1c375a4484a"
            ],
            [
                "376f1e1e0b41f292"
            ],
            [
                "592ea0f1449e87e8"
            ]
        ]
    },
    {
        "id": "376f1e1e0b41f292",
        "type": "link out",
        "z": "b056b4cf9a298e0d",
        "g": "ef9e0b05387b0f7f",
        "name": "link out 25",
        "mode": "link",
        "links": [
            "adf692ef0a9e9fb2"
        ],
        "x": 755,
        "y": 880,
        "wires": []
    },
    {
        "id": "592ea0f1449e87e8",
        "type": "link out",
        "z": "b056b4cf9a298e0d",
        "g": "ef9e0b05387b0f7f",
        "name": "link out 26",
        "mode": "link",
        "links": [
            "a30bf994eae7cd3e"
        ],
        "x": 755,
        "y": 920,
        "wires": []
    },
    {
        "id": "8e79c92367f424a4",
        "type": "ui_led",
        "z": "b056b4cf9a298e0d",
        "g": "4cd2d92b6f1e42de",
        "order": 5,
        "group": "f870df7d6c3cc2e9",
        "width": 0,
        "height": 0,
        "label": "Cara005",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ffff00",
                "value": "0",
                "valueType": "num"
            },
            {
                "color": "#008000",
                "value": "1",
                "valueType": "num"
            },
            {
                "color": "#ff0000",
                "value": "2",
                "valueType": "num"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "Cara005",
        "x": 1880,
        "y": 600,
        "wires": []
    },
    {
        "id": "adf692ef0a9e9fb2",
        "type": "link in",
        "z": "b056b4cf9a298e0d",
        "g": "4cd2d92b6f1e42de",
        "name": "link in 32",
        "links": [
            "5e29b723009e3677",
            "dc20f200c13eb39a",
            "b2227557ab57b7ef",
            "f6583d92a29357b9",
            "376f1e1e0b41f292"
        ],
        "x": 1065,
        "y": 600,
        "wires": [
            [
                "8e79c92367f424a4"
            ]
        ]
    },
    {
        "id": "90effe8f20f81252",
        "type": "link out",
        "z": "b056b4cf9a298e0d",
        "g": "f0bc3c69188895b3",
        "name": "link out 27",
        "mode": "link",
        "links": [
            "5d4807349eb7d70c",
            "6fdb94005210418f"
        ],
        "x": 755,
        "y": 700,
        "wires": []
    },
    {
        "id": "7651d8dfb22cc43e",
        "type": "debug",
        "z": "b056b4cf9a298e0d",
        "g": "4cd2d92b6f1e42de",
        "name": "debug 31",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1460,
        "y": 360,
        "wires": []
    },
    {
        "id": "e789e8e1711a246d",
        "type": "link out",
        "z": "b056b4cf9a298e0d",
        "g": "f0bc3c69188895b3",
        "name": "link out 28",
        "mode": "link",
        "links": [
            "a30bf994eae7cd3e"
        ],
        "x": 755,
        "y": 740,
        "wires": []
    },
    {
        "id": "a2fc907344de6d8a",
        "type": "debug",
        "z": "e124bbec17d40651",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 547.0141983032227,
        "y": 126.00568771362305,
        "wires": []
    },
    {
        "id": "1c305de4d82de9c2",
        "type": "json",
        "z": "e124bbec17d40651",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 393.01419830322266,
        "y": 168.00569343566895,
        "wires": [
            [
                "a2fc907344de6d8a",
                "d33ac88c6ce120b7"
            ]
        ]
    },
    {
        "id": "d33ac88c6ce120b7",
        "type": "function",
        "z": "e124bbec17d40651",
        "name": "añade fecha",
        "func": "msg.payload.date=new Date();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 549.0141906738281,
        "y": 169.0056962966919,
        "wires": [
            [
                "b71d13c66d89b292"
            ]
        ]
    },
    {
        "id": "b71d13c66d89b292",
        "type": "mongodb out",
        "z": "e124bbec17d40651",
        "mongodb": "3752afa1.deaf9",
        "name": "",
        "collection": "test_agrega",
        "payonly": true,
        "upsert": false,
        "multi": false,
        "operation": "store",
        "x": 828.0142021179199,
        "y": 168.00568771362305,
        "wires": []
    },
    {
        "id": "27aea1532517a43b",
        "type": "inject",
        "z": "e124bbec17d40651",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 172.7897186279297,
        "y": 261.9715576171875,
        "wires": [
            [
                "8739f53cf1bb5475"
            ]
        ]
    },
    {
        "id": "8739f53cf1bb5475",
        "type": "mongodb in",
        "z": "e124bbec17d40651",
        "mongodb": "3752afa1.deaf9",
        "name": "",
        "collection": "test_agrega",
        "operation": "find",
        "x": 479.78687286376953,
        "y": 261.69884872436523,
        "wires": [
            [
                "d118ec6cbfc571a9"
            ]
        ]
    },
    {
        "id": "d118ec6cbfc571a9",
        "type": "debug",
        "z": "e124bbec17d40651",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 888.7897109985352,
        "y": 263.81244564056396,
        "wires": []
    },
    {
        "id": "a02946380512c1c2",
        "type": "comment",
        "z": "e124bbec17d40651",
        "name": "Almacenamiento en base de datos",
        "info": "",
        "x": 202.78973388671875,
        "y": 79.08808326721191,
        "wires": []
    },
    {
        "id": "c7b8687c56b02fd9",
        "type": "function",
        "z": "e124bbec17d40651",
        "name": "agrega por días",
        "func": "// fecha por defecto es hoy\nvar ahora = new Date();\n// pillo los globales si los hay, si no la fecha de hoy\nvar desde = new Date(global.get(\"desde\") || ahora);\nvar hasta = new Date(global.get(\"hasta\") || ahora); \n// el día de inicio desde las cero horas\nvar inicio = new Date(desde.getFullYear(),desde.getMonth(),desde.getDate(),1,0,0,0);\n// el día final es hasta final del día\nvar final = new Date(hasta.getFullYear(),hasta.getMonth(),hasta.getDate(),24,59,59,99);\n\nmsg.payload=\n[\n    { \"$match\": { \"date\": { \"$gte\": inicio , \"$lte\": final } } },\n    { \"$project\": {\n        \"date\": 1,\n        \"temperatura\": \"$BME280.Temperatura\"\n        }\n    },\n    { \"$group\": {\n        \"_id\": { \n        \"$dateFromParts\" : {\n            \"year\": { \"$year\": \"$date\" }, \n            \"month\": { \"$month\": \"$date\" },\n            \"day\": { \"$dayOfMonth\": \"$date\" }\n        }},\n\n        \"Tmedia\":{\"$avg\":\"$temperatura\"},\n        \"Tmax\":  {\"$max\":\"$temperatura\"},\n        \"Tmin\":  {\"$min\":\"$temperatura\"},\n        \"datos\": {\"$sum\":1},\n    }},\n    { \"$sort\": {\"_id\": 1} }\n];\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 269.314266204834,
        "y": 718.0055141448975,
        "wires": [
            [
                "539a9ea3512020a7"
            ]
        ]
    },
    {
        "id": "539a9ea3512020a7",
        "type": "mongodb in",
        "z": "e124bbec17d40651",
        "mongodb": "3752afa1.deaf9",
        "name": "",
        "collection": "test_agrega",
        "operation": "aggregate",
        "x": 543.3284492492676,
        "y": 718.0113296508789,
        "wires": [
            [
                "bc3d1c26265c1a7d",
                "3282fc564feba52e"
            ]
        ]
    },
    {
        "id": "bc3d1c26265c1a7d",
        "type": "function",
        "z": "e124bbec17d40651",
        "name": "genera datos gráfica",
        "func": "var arrayavg=[];\nvar arraymax=[];\nvar arraymin=[];\n\n// los arrays usados en la represenstación gráfica deben contener objetos JSON con dos campos: {x , y}\n// en x debemos poner la hora en formato \"timestamp\". Si tenemos un objeto fecha se puede convertir usando el método getTime()\n// en y debemos poner el valor de la variable\n// mas info en: https://github.com/node-red/node-red-dashboard/blob/master/Charts.md\n\nif(Array.isArray(msg.payload) && msg.payload.length>0)\n{\n    for (var i = 0; i < msg.payload.length; i++) { // añade datos a los array\n        arrayavg.push({x : msg.payload[i]._id.getTime() , y : msg.payload[i].Tmedia});\n        arraymax.push({x : msg.payload[i]._id.getTime() , y : msg.payload[i].Tmax});\n        arraymin.push({x : msg.payload[i]._id.getTime() , y : msg.payload[i].Tmin});\n    }\n}\n    \nmsg.payload = [{\n        \"series\":[\"T.media\",\"T.max\",\"T.min\"],\n        \"data\":[arrayavg, arraymax, arraymin],\n        \"labels\":[\"\"]\n        }];\n\nreturn msg;  ",
        "outputs": "1",
        "noerr": 0,
        "x": 859.0142402648926,
        "y": 777.0056324005127,
        "wires": [
            [
                "81db042e5e69f5f1"
            ]
        ]
    },
    {
        "id": "81db042e5e69f5f1",
        "type": "ui_chart",
        "z": "e124bbec17d40651",
        "name": "",
        "group": "970b2d92940cc035",
        "order": 8,
        "width": 0,
        "height": 0,
        "label": "Temperaturas diarias",
        "chartType": "line",
        "legend": "true",
        "xformat": "D/M",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "colors": [
            "#008000",
            "#ff0000",
            "#0080ff",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 2,
        "x": 1088.014072418213,
        "y": 777.0055847167969,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "30625925796ef13d",
        "type": "change",
        "z": "e124bbec17d40651",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "desde",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 394.0057258605957,
        "y": 438.5766592025757,
        "wires": [
            [
                "1e99ec801a739960"
            ]
        ]
    },
    {
        "id": "dadba7bb0af1d36b",
        "type": "change",
        "z": "e124bbec17d40651",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "hasta",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 397.232967376709,
        "y": 490.4602007865906,
        "wires": [
            [
                "1e99ec801a739960"
            ]
        ]
    },
    {
        "id": "1e99ec801a739960",
        "type": "link out",
        "z": "e124bbec17d40651",
        "name": "",
        "links": [],
        "x": 596.7698726654053,
        "y": 470.70737075805664,
        "wires": []
    },
    {
        "id": "5c852cceec460465",
        "type": "link in",
        "z": "e124bbec17d40651",
        "name": "",
        "links": [],
        "x": 115.78126525878906,
        "y": 678.8350811004639,
        "wires": [
            [
                "c7b8687c56b02fd9",
                "4982f1ea4ac82c96"
            ]
        ]
    },
    {
        "id": "4982f1ea4ac82c96",
        "type": "function",
        "z": "e124bbec17d40651",
        "name": "agreaga todo",
        "func": "// fecha por defecto es hoy\nvar ahora = new Date();\n// pillo los globales si los hay, si no la fecha de hoy\nvar desde = new Date(global.get(\"desde\") || ahora);\nvar hasta = new Date(global.get(\"hasta\") || ahora); \n// el día de inicio desde las cero horas\nvar inicio = new Date(desde.getFullYear(),desde.getMonth(),desde.getDate(),1,0,0,0);\n// el día final es hasta final del día\nvar final = new Date(hasta.getFullYear(),hasta.getMonth(),hasta.getDate(),24,59,59,99);\n\nmsg.payload=\n[\n    { \"$match\": { \"date\": { \"$gte\": inicio , \"$lte\": final } } },\n    { \"$project\": {\n        \"temperatura\": \"$BME280.Temperatura\"\n        }\n    },\n    { \"$group\": {\n        \"_id\": 0,\n        \"Tmedia\":{\"$avg\":\"$temperatura\"},\n        \"Tmax\":  {\"$max\":\"$temperatura\"},\n        \"Tmin\":  {\"$min\":\"$temperatura\"},\n        \"datos\": {\"$sum\":1}\n    }}\n];\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 264.01423263549805,
        "y": 636.9146575927734,
        "wires": [
            [
                "238d7e44c04a8810"
            ]
        ]
    },
    {
        "id": "238d7e44c04a8810",
        "type": "mongodb in",
        "z": "e124bbec17d40651",
        "mongodb": "3752afa1.deaf9",
        "name": "",
        "collection": "test_agrega",
        "operation": "aggregate",
        "x": 543.0284309387207,
        "y": 635.9202737808228,
        "wires": [
            [
                "27e40a90ef928a39",
                "a0c908b7694f1ef0",
                "17fecee46f9ee5c0",
                "934730b3846b60c3",
                "2e9b21727b3a9d4e"
            ]
        ]
    },
    {
        "id": "27e40a90ef928a39",
        "type": "ui_text",
        "z": "e124bbec17d40651",
        "group": "970b2d92940cc035",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Média en el período",
        "format": "{{msg.payload[0].Tmedia | number:1 }}ºC",
        "layout": "row-left",
        "x": 1042.792636871338,
        "y": 557.3292970657349,
        "wires": []
    },
    {
        "id": "a0c908b7694f1ef0",
        "type": "ui_text",
        "z": "e124bbec17d40651",
        "group": "970b2d92940cc035",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Máxima en el período",
        "format": "{{msg.payload[0].Tmax | number:1 }}ºC",
        "layout": "row-left",
        "x": 1037.0142250061035,
        "y": 596.7327833175659,
        "wires": []
    },
    {
        "id": "17fecee46f9ee5c0",
        "type": "ui_text",
        "z": "e124bbec17d40651",
        "group": "970b2d92940cc035",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Mínima en el período",
        "format": "{{msg.payload[0].Tmin | number:1 }}ºC",
        "layout": "row-left",
        "x": 1036.0142250061035,
        "y": 634.7327489852905,
        "wires": []
    },
    {
        "id": "94ec24b7edd7fab1",
        "type": "comment",
        "z": "e124bbec17d40651",
        "name": "Controles para seleccionar fechas",
        "info": "",
        "x": 198.00001525878906,
        "y": 373.82383251190186,
        "wires": []
    },
    {
        "id": "a70e90d5112c8b40",
        "type": "comment",
        "z": "e124bbec17d40651",
        "name": "Consultas agregadas",
        "info": "",
        "x": 173.7897720336914,
        "y": 579.3663816452026,
        "wires": []
    },
    {
        "id": "3282fc564feba52e",
        "type": "debug",
        "z": "e124bbec17d40651",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 846.789737701416,
        "y": 737.8124227523804,
        "wires": []
    },
    {
        "id": "934730b3846b60c3",
        "type": "debug",
        "z": "e124bbec17d40651",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 812.0142364501953,
        "y": 545.0055742263794,
        "wires": []
    },
    {
        "id": "2e9b21727b3a9d4e",
        "type": "ui_text",
        "z": "e124bbec17d40651",
        "group": "970b2d92940cc035",
        "order": 6,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Número de datos",
        "format": "{{msg.payload[0].datos }} muestras",
        "layout": "row-left",
        "x": 1032.0142402648926,
        "y": 682.0055913925171,
        "wires": []
    },
    {
        "id": "94b83f62d7415cb4",
        "type": "ui_date_picker",
        "z": "e124bbec17d40651",
        "name": "",
        "label": "Fecha de inicio",
        "group": "970b2d92940cc035",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "topic": "",
        "x": 185.76986694335938,
        "y": 434.73571586608887,
        "wires": [
            [
                "30625925796ef13d"
            ]
        ]
    },
    {
        "id": "9817d8acea692ecd",
        "type": "ui_date_picker",
        "z": "e124bbec17d40651",
        "name": "",
        "label": "Fecha de final",
        "group": "970b2d92940cc035",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": true,
        "topic": "",
        "x": 162.7783966064453,
        "y": 488.7414951324463,
        "wires": [
            [
                "dadba7bb0af1d36b"
            ]
        ]
    },
    {
        "id": "0406c81e19dabaa7",
        "type": "mqtt in",
        "z": "e124bbec17d40651",
        "name": "",
        "topic": "iot/datos/json",
        "qos": "2",
        "datatype": "auto",
        "broker": "2b251178.95ad2e",
        "nl": false,
        "rap": false,
        "inputs": 0,
        "x": 150,
        "y": 171.1111159324646,
        "wires": [
            [
                "1c305de4d82de9c2"
            ]
        ]
    },
    {
        "id": "2b1fd44b018140ee",
        "type": "ui_text_input",
        "z": "03c76acfc9a07adb",
        "name": "",
        "label": "",
        "tooltip": "",
        "group": "ef4e3347ed457b9c",
        "order": 0,
        "width": 0,
        "height": 0,
        "passthru": true,
        "mode": "text",
        "delay": "0",
        "topic": "topic",
        "sendOnBlur": true,
        "className": "",
        "topicType": "msg",
        "x": 80,
        "y": 180,
        "wires": [
            [
                "08d055d326c442f3"
            ]
        ]
    },
    {
        "id": "fea16bf35a5b6776",
        "type": "mongodb in",
        "z": "03c76acfc9a07adb",
        "mongodb": "f605fa69.8f5008",
        "name": "Colección: datousuario",
        "collection": "datosusuario",
        "operation": "find",
        "x": 500,
        "y": 180,
        "wires": [
            [
                "c53aef741aedf07b"
            ]
        ]
    },
    {
        "id": "92630cfa0aa3f6ba",
        "type": "debug",
        "z": "03c76acfc9a07adb",
        "name": "debug 13",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1000,
        "y": 220,
        "wires": []
    },
    {
        "id": "08d055d326c442f3",
        "type": "function",
        "z": "03c76acfc9a07adb",
        "name": "Finder",
        "func": "var user = msg.payload;\nflow.set(\"user\", user);\nmsg.payload = {\"usuario\":user};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 270,
        "y": 180,
        "wires": [
            [
                "fea16bf35a5b6776"
            ]
        ]
    },
    {
        "id": "9f868786c5ba7ce5",
        "type": "mongodb in",
        "z": "03c76acfc9a07adb",
        "mongodb": "f605fa69.8f5008",
        "name": "Colección: hashusuario",
        "collection": "hashusuario",
        "operation": "find",
        "x": 510,
        "y": 260,
        "wires": [
            [
                "049dad2d81834087"
            ]
        ]
    },
    {
        "id": "c53aef741aedf07b",
        "type": "function",
        "z": "03c76acfc9a07adb",
        "name": "Set pass as flow var",
        "func": "flow.set(\"password\", msg.payload[0].password);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 800,
        "y": 180,
        "wires": [
            [
                "92630cfa0aa3f6ba"
            ]
        ]
    },
    {
        "id": "049dad2d81834087",
        "type": "function",
        "z": "03c76acfc9a07adb",
        "name": "Set hash as flow var",
        "func": "flow.set(\"hash\", msg.payload[0].hash);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 800,
        "y": 260,
        "wires": [
            [
                "92630cfa0aa3f6ba"
            ]
        ]
    },
    {
        "id": "bb7b9511815b13de",
        "type": "mqtt out",
        "z": "03c76acfc9a07adb",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "64cdcf7a3b4cd223",
        "x": 850,
        "y": 320,
        "wires": []
    },
    {
        "id": "8c89d76f308cbeee",
        "type": "function",
        "z": "03c76acfc9a07adb",
        "name": "Generate JSON",
        "func": "var user = flow.get(\"user\");\nvar password = flow.get(\"password\");\nvar hash = flow.get(\"hash\");\nmsg.topic = \"examen/nodered/\";\nmsg.topic = msg.topic + password;\nmsg.payload = { \"usuario\": user, \"password\": password, \"hash\": hash };\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 300,
        "y": 320,
        "wires": [
            [
                "8e30187b8aa0c3f8"
            ]
        ]
    },
    {
        "id": "8e30187b8aa0c3f8",
        "type": "json",
        "z": "03c76acfc9a07adb",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 550,
        "y": 320,
        "wires": [
            [
                "bb7b9511815b13de"
            ]
        ]
    },
    {
        "id": "d9ce5f1f9c1579e9",
        "type": "mqtt in",
        "z": "03c76acfc9a07adb",
        "g": "9c2f3a58f83b946f",
        "name": "",
        "topic": "respuesta/usuario/7742805",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "64cdcf7a3b4cd223",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 150,
        "y": 440,
        "wires": [
            [
                "47d6ae483f6a2bd1"
            ]
        ]
    },
    {
        "id": "47d6ae483f6a2bd1",
        "type": "debug",
        "z": "03c76acfc9a07adb",
        "g": "9c2f3a58f83b946f",
        "name": "debug 14",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 420,
        "y": 440,
        "wires": []
    },
    {
        "id": "080a623157448939",
        "type": "function",
        "z": "03c76acfc9a07adb",
        "name": "Finder",
        "func": "var user = flow.get(\"user\");\nmsg.payload = {\"usuario\":user};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 270,
        "y": 260,
        "wires": [
            [
                "9f868786c5ba7ce5"
            ]
        ]
    },
    {
        "id": "4f2367b80d0a8388",
        "type": "complete",
        "z": "03c76acfc9a07adb",
        "name": "",
        "scope": [
            "c53aef741aedf07b"
        ],
        "uncaught": false,
        "x": 90,
        "y": 260,
        "wires": [
            [
                "080a623157448939"
            ]
        ]
    },
    {
        "id": "deacca659cf6a327",
        "type": "complete",
        "z": "03c76acfc9a07adb",
        "name": "",
        "scope": [
            "049dad2d81834087"
        ],
        "uncaught": false,
        "x": 90,
        "y": 320,
        "wires": [
            [
                "8c89d76f308cbeee"
            ]
        ]
    },
    {
        "id": "8121d49eefc3b958",
        "type": "mqtt in",
        "z": "03c76acfc9a07adb",
        "name": "",
        "topic": "examen/datos/NODO14319362",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "64cdcf7a3b4cd223",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 170,
        "y": 540,
        "wires": [
            [
                "4e04fd6c0992a865"
            ]
        ]
    },
    {
        "id": "4e04fd6c0992a865",
        "type": "debug",
        "z": "03c76acfc9a07adb",
        "name": "debug 15",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 440,
        "y": 540,
        "wires": []
    },
    {
        "id": "ccfe11fbbed43d4e",
        "type": "telegram command",
        "z": "b23dfd10f01a4521",
        "name": "",
        "command": "/tiempo",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "1f33bd2091f1c0f0",
        "strict": false,
        "hasresponse": false,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 1,
        "x": 130,
        "y": 980,
        "wires": [
            [
                "a674ddf7c07917a6"
            ]
        ]
    },
    {
        "id": "a674ddf7c07917a6",
        "type": "function",
        "z": "b23dfd10f01a4521",
        "name": "function 7",
        "func": "msg.user = msg.payload;\nvar hora_str = new Date();\nvar hora = Number(hora_str.getHours());\nif (hora < 6) {\n    var value = 3;\n}else if ( hora >= 6 && hora < 12){\n    var value = 4;\n}else if (hora >= 12 && hora < 18){\n    var value = 5;\n}else if (hora >= 18 && hora < 24){\n    var value = 6;\n}\nmsg.mensaje = value;\nmsg.limit = 1;\nmsg.sort = { \"date\": -1 };\nmsg.payload = {};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 300,
        "y": 980,
        "wires": [
            [
                "c2d2ecc035fb300b"
            ]
        ]
    },
    {
        "id": "276e58b1359e1c7c",
        "type": "function",
        "z": "b23dfd10f01a4521",
        "name": "function 8",
        "func": "var period = msg.mensaje;\nmsg.elaborado = msg.payload.root.elaborado[0]\nmsg.prob_precipitacion = msg.payload.root.prediccion[0].dia[0].prob_precipitacion[period]._;\nmsg.periodo = msg.payload.root.prediccion[0].dia[0].prob_precipitacion[period].$.periodo;\nmsg.estado_del_cielo = msg.payload.root.prediccion[0].dia[0].estado_cielo[period].$.descripcion;\nmsg.prob_precipitacion_manana = msg.payload.root.prediccion[0].dia[1].prob_precipitacion[0]._;\nmsg.estado_del_cielo_manana = msg.payload.root.prediccion[0].dia[1].estado_cielo[0].$.descripcion;\n\n\nmsg.payload = msg.user;\nmsg.payload.content = \"\";\nmsg.payload.content += \"\\nSegún la AEMET la predicción para las próximas horas (\"+ msg.periodo + \"h)\"\nmsg.payload.content += \" es de \" + msg.estado_del_cielo;\nmsg.payload.content += \" y probabilidad de lluvia de \" + msg.prob_precipitacion + \"%. \"\nmsg.payload.content += \"Mañana se espera \" + msg.estado_del_cielo_manana + \" y probabilidad de lluvia de \" + msg.prob_precipitacion_manana + \"%.\";\nmsg.payload.content += \"\\nPredicción elaborada: \" + msg.elaborado + \".\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 920,
        "y": 980,
        "wires": [
            []
        ]
    },
    {
        "id": "c2d2ecc035fb300b",
        "type": "http request",
        "z": "b23dfd10f01a4521",
        "name": "AEMET http request",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://www.aemet.es/xml/municipios/localidad_29901.xml",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 540,
        "y": 980,
        "wires": [
            [
                "f23289d067bd0fa3"
            ]
        ]
    },
    {
        "id": "f23289d067bd0fa3",
        "type": "xml",
        "z": "b23dfd10f01a4521",
        "name": "",
        "property": "payload",
        "attr": "",
        "chr": "",
        "x": 750,
        "y": 980,
        "wires": [
            [
                "276e58b1359e1c7c"
            ]
        ]
    },
    {
        "id": "44dfea54ec883d66",
        "type": "debug",
        "z": "b23dfd10f01a4521",
        "name": "debug 11",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1320,
        "y": 780,
        "wires": []
    },
    {
        "id": "12692250830d75c6",
        "type": "inject",
        "z": "b23dfd10f01a4521",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "II3/ESP004/cmd/cara004",
        "payload": "0",
        "payloadType": "num",
        "x": 230,
        "y": 620,
        "wires": [
            [
                "df9f920e3170ddf5"
            ]
        ]
    },
    {
        "id": "198f1fb018051790",
        "type": "mqtt out",
        "z": "b23dfd10f01a4521",
        "name": "",
        "topic": "II3/ESP004/cmd/cara004",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "2b251178.95ad2e",
        "x": 750,
        "y": 680,
        "wires": []
    },
    {
        "id": "895ad541ac1ed699",
        "type": "inject",
        "z": "b23dfd10f01a4521",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "II3/ESP004/cmd/cara004",
        "payload": "1",
        "payloadType": "num",
        "x": 230,
        "y": 680,
        "wires": [
            [
                "df9f920e3170ddf5"
            ]
        ]
    },
    {
        "id": "df9f920e3170ddf5",
        "type": "function",
        "z": "b23dfd10f01a4521",
        "name": "function 17",
        "func": "msg.payload = {\n    \"commands\": {\n        \"1\": { \"action\": \"activar_led\", \"value\": \"1\" },\n        \"2\": { \"action\": \"enable_game\", \"value\": \"1\" },\n        \"3\": { \"action\": \"get_sequence\", \"value\": \"010204\" }\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 470,
        "y": 640,
        "wires": [
            [
                "198f1fb018051790",
                "3fa040803ea0ef0b"
            ]
        ]
    },
    {
        "id": "3fa040803ea0ef0b",
        "type": "debug",
        "z": "b23dfd10f01a4521",
        "name": "debug 12",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640.0833129882812,
        "y": 731.0833435058594,
        "wires": []
    },
    {
        "id": "1d03197f3c061eb1",
        "type": "telegram reply",
        "z": "b23dfd10f01a4521",
        "name": "",
        "bot": "d95354d46509e771",
        "x": 900,
        "y": 160,
        "wires": [
            [
                "22a1024f0a5078c2"
            ]
        ]
    },
    {
        "id": "45b13b8067bd0463",
        "type": "telegram event",
        "z": "b23dfd10f01a4521",
        "name": "",
        "bot": "d95354d46509e771",
        "event": "callback_query",
        "autoanswer": true,
        "x": 200,
        "y": 260,
        "wires": [
            [
                "de872b1f544a4849"
            ]
        ]
    },
    {
        "id": "d0400cc2d42c64a1",
        "type": "telegram control",
        "z": "b23dfd10f01a4521",
        "name": "",
        "bot": "d95354d46509e771",
        "outputs": 1,
        "checkconnection": false,
        "hostname": "",
        "interval": 10,
        "timeout": 1,
        "x": 220,
        "y": 80,
        "wires": [
            [
                "3d9b46ce2ae6df0f"
            ]
        ]
    },
    {
        "id": "3d9b46ce2ae6df0f",
        "type": "debug",
        "z": "b23dfd10f01a4521",
        "name": "debug 22",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 460,
        "y": 80,
        "wires": []
    },
    {
        "id": "410b2e29e96f730c",
        "type": "function",
        "z": "b23dfd10f01a4521",
        "name": "function 18",
        "func": "var texto = msg.payload;\nmsg.payload = global.get(\"user\");\nmsg.payload.content = \"te gusta el pan ?\";\nmsg.payload.type = \"message\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 470,
        "y": 160,
        "wires": [
            [
                "c22d0fc5e8d6920e"
            ]
        ]
    },
    {
        "id": "b7c420a071e870e1",
        "type": "change",
        "z": "b23dfd10f01a4521",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "user",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 280,
        "y": 160,
        "wires": [
            [
                "410b2e29e96f730c"
            ]
        ]
    },
    {
        "id": "c22d0fc5e8d6920e",
        "type": "telegram sender",
        "z": "b23dfd10f01a4521",
        "name": "",
        "bot": "d95354d46509e771",
        "haserroroutput": false,
        "outputs": 1,
        "x": 670,
        "y": 160,
        "wires": [
            [
                "1d03197f3c061eb1"
            ]
        ]
    },
    {
        "id": "22a1024f0a5078c2",
        "type": "debug",
        "z": "b23dfd10f01a4521",
        "name": "debug 23",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1080,
        "y": 160,
        "wires": []
    },
    {
        "id": "97f5e9edd2802103",
        "type": "state-machine",
        "z": "b23dfd10f01a4521",
        "name": "",
        "triggerProperty": "topic",
        "triggerPropertyType": "msg",
        "stateProperty": "topic",
        "statePropertyType": "msg",
        "outputStateChangeOnly": false,
        "throwException": false,
        "states": [
            "start",
            "game1",
            "game2"
        ],
        "transitions": [
            {
                "name": "game 1",
                "from": "start",
                "to": "start"
            }
        ],
        "x": 380,
        "y": 1120,
        "wires": [
            [
                "362a9acb79e1d7ca"
            ]
        ]
    },
    {
        "id": "79f25662b28050dd",
        "type": "inject",
        "z": "b23dfd10f01a4521",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 180,
        "y": 1120,
        "wires": [
            [
                "97f5e9edd2802103"
            ]
        ]
    },
    {
        "id": "362a9acb79e1d7ca",
        "type": "debug",
        "z": "b23dfd10f01a4521",
        "name": "debug 24",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 580,
        "y": 1120,
        "wires": []
    },
    {
        "id": "9bdde8bb42ac5b19",
        "type": "finite-state-machine",
        "z": "b23dfd10f01a4521",
        "name": "",
        "fsmDefinition": "{\"state\":{\"status\":\"IDLE\",\"data\":{\"x\":5}},\"transitions\":{\"IDLE\":{\"run\":\"RUNNING\"},\"RUNNING\":{\"stop\":\"IDLE\"}}}",
        "sendInitialState": true,
        "sendStateWithoutChange": true,
        "showTransitionErrors": true,
        "x": 390,
        "y": 1160,
        "wires": [
            [
                "86b04bf2bfeb5ee2"
            ]
        ]
    },
    {
        "id": "86b04bf2bfeb5ee2",
        "type": "debug",
        "z": "b23dfd10f01a4521",
        "name": "debug 25",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 620,
        "y": 1160,
        "wires": []
    },
    {
        "id": "8cc29a55472fde41",
        "type": "inject",
        "z": "b23dfd10f01a4521",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "run",
        "payload": "run",
        "payloadType": "str",
        "x": 170,
        "y": 1160,
        "wires": [
            [
                "9bdde8bb42ac5b19"
            ]
        ]
    },
    {
        "id": "de872b1f544a4849",
        "type": "function",
        "z": "b23dfd10f01a4521",
        "name": "function 19",
        "func": "var show_alert = false; // you can set this to true to open a dialog with the answer in the client.\n\n// msg.payload.content contains the callback data from the keyboard.\n// You may change this value here.\nmsg.payload.options = show_alert;\n\nreturn [msg];",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 430,
        "y": 260,
        "wires": [
            [
                "14bc9dd2719eec8b"
            ]
        ]
    },
    {
        "id": "14bc9dd2719eec8b",
        "type": "telegram sender",
        "z": "b23dfd10f01a4521",
        "name": "",
        "bot": "d95354d46509e771",
        "haserroroutput": false,
        "outputs": 1,
        "x": 710,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "1a2629111d9359b7",
        "type": "function",
        "z": "b23dfd10f01a4521",
        "name": "function 20",
        "func": "var opts = {\n    reply_to_message_id: msg.payload.messageId,\n    reply_markup: JSON.stringify({\n        \"inline_keyboard\": [[\n            {\n                \"text\": \"Yes\",\n                \"callback_data\": \"FOO YES\"\n            },\n            {\n                \"text\": \"No\",\n                \"callback_data\": \"FOO NO\"\n            }]\n        ]\n    })\n};\n\nmsg.payload.content = 'Are you sure?';\nmsg.payload.options = opts;\n\nreturn [msg];",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 430,
        "y": 340,
        "wires": [
            [
                "d3033b7e02e5a0e4"
            ]
        ]
    },
    {
        "id": "d3033b7e02e5a0e4",
        "type": "telegram sender",
        "z": "b23dfd10f01a4521",
        "name": "",
        "bot": "d95354d46509e771",
        "haserroroutput": false,
        "outputs": 1,
        "x": 710,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "19423ee5387d4eca",
        "type": "telegram command",
        "z": "b23dfd10f01a4521",
        "name": "",
        "command": "/menu",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "d95354d46509e771",
        "strict": false,
        "hasresponse": false,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 1,
        "x": 170,
        "y": 340,
        "wires": [
            [
                "1a2629111d9359b7"
            ]
        ]
    },
    {
        "id": "66a34744cd46d525",
        "type": "function",
        "z": "b23dfd10f01a4521",
        "name": "function 21",
        "func": "msg.payload.content = \"/home/rhyloo/nol/pics/AUD-20221122-WA0012.aac\";\nmsg.payload.type = 'audio';\n\n/* type can be one of the following\nphoto\naudio\nvideo\nsticker\ndice\nvoice\ndocument\n*/\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 430,
        "y": 460,
        "wires": [
            [
                "751c8b2e1c8308c8"
            ]
        ]
    },
    {
        "id": "751c8b2e1c8308c8",
        "type": "telegram sender",
        "z": "b23dfd10f01a4521",
        "name": "",
        "bot": "d95354d46509e771",
        "haserroroutput": false,
        "outputs": 1,
        "x": 710,
        "y": 460,
        "wires": [
            []
        ]
    },
    {
        "id": "93d57dffb3c04f77",
        "type": "telegram command",
        "z": "b23dfd10f01a4521",
        "name": "",
        "command": "/tiempo",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "d95354d46509e771",
        "strict": false,
        "hasresponse": false,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 1,
        "x": 170,
        "y": 460,
        "wires": [
            [
                "66a34744cd46d525"
            ]
        ]
    },
    {
        "id": "f7d93e22ce1faa13",
        "type": "file in",
        "z": "b23dfd10f01a4521",
        "name": "",
        "filename": "/home/rhyloo/nol/pics/foo.jpeg",
        "filenameType": "str",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 430,
        "y": 800,
        "wires": [
            [
                "02b00a3680685ea1"
            ]
        ]
    },
    {
        "id": "02b00a3680685ea1",
        "type": "mongodb out",
        "z": "b23dfd10f01a4521",
        "mongodb": "6046a47177835823",
        "name": "",
        "collection": "test",
        "payonly": false,
        "upsert": false,
        "multi": false,
        "operation": "store",
        "x": 730,
        "y": 800,
        "wires": []
    },
    {
        "id": "9ed1dc9910ace64f",
        "type": "inject",
        "z": "b23dfd10f01a4521",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 800,
        "wires": [
            [
                "f7d93e22ce1faa13"
            ]
        ]
    },
    {
        "id": "2bb6decf9cc889b5",
        "type": "function",
        "z": "b23dfd10f01a4521",
        "name": "Recupera un acertijo aleatorio de la base de datos",
        "func": "msg.payload = {\"filename\":\"/home/rhyloo/nol/pics/foo.jpeg\"};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 490,
        "y": 860,
        "wires": [
            [
                "8fd0cf9f2119d17a"
            ]
        ]
    },
    {
        "id": "8fd0cf9f2119d17a",
        "type": "mongodb in",
        "z": "b23dfd10f01a4521",
        "mongodb": "6046a47177835823",
        "name": "",
        "collection": "test",
        "operation": "find",
        "x": 830,
        "y": 860,
        "wires": [
            [
                "9a3a99cb954ede25"
            ]
        ]
    },
    {
        "id": "c18f8a03da6877a1",
        "type": "inject",
        "z": "b23dfd10f01a4521",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 860,
        "wires": [
            [
                "2bb6decf9cc889b5"
            ]
        ]
    },
    {
        "id": "3528be3381a42afd",
        "type": "function",
        "z": "b23dfd10f01a4521",
        "name": "function 22",
        "func": "flow.set(\"photo\", msg.payload[0].payload);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 860,
        "wires": [
            [
                "44dfea54ec883d66"
            ]
        ]
    },
    {
        "id": "9f8e3c4efe2ab1ec",
        "type": "buffer-maker",
        "z": "b23dfd10f01a4521",
        "name": "",
        "specification": "",
        "specificationType": "ui",
        "items": [
            {
                "name": "item1",
                "type": "int16be",
                "data": "payload",
                "dataType": "msg"
            }
        ],
        "swap1": "",
        "swap2": "",
        "swap3": "",
        "swap1Type": "swap",
        "swap2Type": "swap",
        "swap3Type": "swap",
        "msgProperty": "payload",
        "msgPropertyType": "str",
        "x": 990,
        "y": 500,
        "wires": [
            []
        ]
    },
    {
        "id": "9a3a99cb954ede25",
        "type": "buffer-parser",
        "z": "b23dfd10f01a4521",
        "name": "",
        "data": "payload",
        "dataType": "msg",
        "specification": "spec",
        "specificationType": "ui",
        "items": [
            {
                "type": "buffer",
                "name": "item1",
                "offset": 0,
                "length": 1,
                "offsetbit": 0,
                "scale": "1",
                "mask": ""
            }
        ],
        "swap1": "",
        "swap2": "",
        "swap3": "",
        "swap1Type": "swap",
        "swap2Type": "swap",
        "swap3Type": "swap",
        "msgProperty": "payload",
        "msgPropertyType": "str",
        "resultType": "object",
        "resultTypeType": "return",
        "multipleResult": true,
        "fanOutMultipleResult": false,
        "setTopic": true,
        "outputs": 1,
        "x": 1030,
        "y": 860,
        "wires": [
            [
                "3528be3381a42afd",
                "44dfea54ec883d66"
            ]
        ]
    },
    {
        "id": "051b9e4cb82ebccd",
        "type": "mongodb in",
        "z": "b23dfd10f01a4521",
        "mongodb": "96e271eba0b52a94",
        "name": "",
        "collection": "recursos_de_las_pruebas",
        "operation": "find",
        "x": 590,
        "y": 1280,
        "wires": [
            [
                "fe0f41ded1231895"
            ]
        ]
    },
    {
        "id": "8dac6d5fc35eabe9",
        "type": "mongodb out",
        "z": "b23dfd10f01a4521",
        "mongodb": "96e271eba0b52a94",
        "name": "",
        "collection": "recursos_de_las_pruebas",
        "payonly": false,
        "upsert": false,
        "multi": false,
        "operation": "store",
        "x": 610,
        "y": 1360,
        "wires": []
    },
    {
        "id": "e4c1b5a1df6803f9",
        "type": "inject",
        "z": "b23dfd10f01a4521",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 300,
        "y": 1280,
        "wires": [
            [
                "051b9e4cb82ebccd"
            ]
        ]
    },
    {
        "id": "fe0f41ded1231895",
        "type": "debug",
        "z": "b23dfd10f01a4521",
        "name": "debug 30",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 980,
        "y": 1280,
        "wires": []
    },
    {
        "id": "52394374208c00e9",
        "type": "debug",
        "z": "f607af27c5f161a8",
        "g": "3802ea70904128df",
        "name": "debug 1",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 440,
        "y": 80,
        "wires": []
    },
    {
        "id": "656c134d0f9f327f",
        "type": "mqtt in",
        "z": "f607af27c5f161a8",
        "g": "3802ea70904128df",
        "name": "",
        "topic": "infind/ESP_00000001/pub",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "64cdcf7a3b4cd223",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 190,
        "y": 80,
        "wires": [
            [
                "52394374208c00e9"
            ]
        ]
    },
    {
        "id": "4be3a05697cd5570",
        "type": "mqtt out",
        "z": "f607af27c5f161a8",
        "g": "3802ea70904128df",
        "name": "",
        "topic": "infind/ESP_00000001/sub",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "64cdcf7a3b4cd223",
        "x": 410,
        "y": 240,
        "wires": []
    },
    {
        "id": "0fd587eb0eafb375",
        "type": "inject",
        "z": "f607af27c5f161a8",
        "g": "3802ea70904128df",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "num",
        "x": 170,
        "y": 240,
        "wires": [
            [
                "4be3a05697cd5570"
            ]
        ]
    },
    {
        "id": "b716332f62494002",
        "type": "inject",
        "z": "f607af27c5f161a8",
        "g": "3802ea70904128df",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "0",
        "payloadType": "num",
        "x": 170,
        "y": 200,
        "wires": [
            [
                "4be3a05697cd5570"
            ]
        ]
    },
    {
        "id": "be4f60e6d63e9492",
        "type": "inject",
        "z": "f607af27c5f161a8",
        "g": "3802ea70904128df",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "lala",
        "payload": "0",
        "payloadType": "num",
        "x": 170,
        "y": 280,
        "wires": [
            [
                "4be3a05697cd5570"
            ]
        ]
    },
    {
        "id": "dcaf5c2a91acb687",
        "type": "inject",
        "z": "f607af27c5f161a8",
        "g": "3802ea70904128df",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "lala",
        "payload": "1",
        "payloadType": "num",
        "x": 170,
        "y": 320,
        "wires": [
            [
                "4be3a05697cd5570"
            ]
        ]
    },
    {
        "id": "dc1bc819707c9cf3",
        "type": "inject",
        "z": "f607af27c5f161a8",
        "g": "3802ea70904128df",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 160,
        "wires": [
            [
                "4be3a05697cd5570",
                "52394374208c00e9"
            ]
        ]
    },
    {
        "id": "16532ba976a11c74",
        "type": "comment",
        "z": "f607af27c5f161a8",
        "g": "3802ea70904128df",
        "name": "He probado este archivo en casa y en clase, el ID_PLACA ha cambiado, por lo tanto depende de la red, en el código .ino lo he fijado.",
        "info": "",
        "x": 540,
        "y": 360,
        "wires": []
    },
    {
        "id": "abbcfa50c29b1d0e",
        "type": "comment",
        "z": "f607af27c5f161a8",
        "g": "3802ea70904128df",
        "name": "Para facilitar la correción.",
        "info": "",
        "x": 210,
        "y": 400,
        "wires": []
    },
    {
        "id": "bf3cf708f17e653c",
        "type": "mqtt in",
        "z": "f607af27c5f161a8",
        "g": "a048d8410ae79405",
        "name": "",
        "topic": "infind/ESP_00000001/pub/Jorge/temperatura",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "64cdcf7a3b4cd223",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 1270,
        "y": 120,
        "wires": [
            [
                "115662fced1d8e26",
                "b91994e2fa49fa0e"
            ]
        ]
    },
    {
        "id": "7517801765a0bc1e",
        "type": "change",
        "z": "f607af27c5f161a8",
        "g": "09a81a457253b8d4",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "humedad",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1490,
        "y": 260,
        "wires": [
            [
                "26a3407919839168"
            ]
        ]
    },
    {
        "id": "26a3407919839168",
        "type": "ui_gauge",
        "z": "f607af27c5f161a8",
        "g": "09a81a457253b8d4",
        "name": "",
        "group": "d20b3cd14e645d48",
        "order": 1,
        "width": 0,
        "height": 0,
        "gtype": "wave",
        "title": "Humedad",
        "label": "%",
        "format": "{{value}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 1760,
        "y": 260,
        "wires": []
    },
    {
        "id": "1e5340d074ece8ae",
        "type": "change",
        "z": "f607af27c5f161a8",
        "g": "09a81a457253b8d4",
        "name": "Humedad",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.humedad",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1240,
        "y": 260,
        "wires": [
            [
                "7517801765a0bc1e"
            ]
        ]
    },
    {
        "id": "ca3e93bac4356c89",
        "type": "function",
        "z": "f607af27c5f161a8",
        "g": "f70edc445b47629c",
        "name": "",
        "func": "msg.topic = \"temperatura\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1520,
        "y": 460,
        "wires": [
            [
                "e677eb22f7e51387"
            ]
        ]
    },
    {
        "id": "6e05f0706402d735",
        "type": "ui_text",
        "z": "f607af27c5f161a8",
        "g": "f70edc445b47629c",
        "group": "8a548b476cc419b4",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Hora de recepción",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1710,
        "y": 500,
        "wires": []
    },
    {
        "id": "ba2dc2f18933cb5f",
        "type": "function",
        "z": "f607af27c5f161a8",
        "g": "f70edc445b47629c",
        "name": "",
        "func": "var fecha = new Date();\n\nmsg.payload = fecha.toLocaleString('es-ES', { timeZone: 'Europe/Madrid', hour12: false });\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1520,
        "y": 500,
        "wires": [
            [
                "6e05f0706402d735"
            ]
        ]
    },
    {
        "id": "9e64c4cf25735c0d",
        "type": "smooth",
        "z": "f607af27c5f161a8",
        "g": "f70edc445b47629c",
        "name": "",
        "property": "payload",
        "action": "mean",
        "count": "6",
        "round": "2",
        "mult": "single",
        "reduce": false,
        "x": 1320,
        "y": 620,
        "wires": [
            [
                "e9d37dc65615b879"
            ]
        ]
    },
    {
        "id": "08ceaac9c4335523",
        "type": "ui_chart",
        "z": "f607af27c5f161a8",
        "g": "f70edc445b47629c",
        "name": "",
        "group": "8a548b476cc419b4",
        "order": 3,
        "width": 0,
        "height": 0,
        "label": "Temperatura (ºC)",
        "chartType": "line",
        "legend": "true",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1730,
        "y": 540,
        "wires": [
            []
        ]
    },
    {
        "id": "2a290ddb8ccdd81a",
        "type": "inject",
        "z": "f607af27c5f161a8",
        "g": "f70edc445b47629c",
        "name": "Reset chart",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "[ ]",
        "payloadType": "json",
        "x": 1510,
        "y": 540,
        "wires": [
            [
                "08ceaac9c4335523"
            ]
        ]
    },
    {
        "id": "b84786aa7f2eaa95",
        "type": "change",
        "z": "f607af27c5f161a8",
        "g": "f70edc445b47629c",
        "name": "Actual",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "temperatura_actual",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1310,
        "y": 580,
        "wires": [
            [
                "9e64c4cf25735c0d",
                "c45991bc1d5f2828"
            ]
        ]
    },
    {
        "id": "e677eb22f7e51387",
        "type": "ui_gauge",
        "z": "f607af27c5f161a8",
        "g": "f70edc445b47629c",
        "name": "",
        "group": "8a548b476cc419b4",
        "order": 2,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Temperatura",
        "label": "ºC",
        "format": "{{value | number:1}}",
        "min": "-5",
        "max": "50",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 1750,
        "y": 460,
        "wires": []
    },
    {
        "id": "e9d37dc65615b879",
        "type": "change",
        "z": "f607af27c5f161a8",
        "g": "f70edc445b47629c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "temperatura_media",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1330,
        "y": 660,
        "wires": [
            [
                "c45991bc1d5f2828"
            ]
        ]
    },
    {
        "id": "c45991bc1d5f2828",
        "type": "function",
        "z": "f607af27c5f161a8",
        "g": "f70edc445b47629c",
        "name": "Diferencia actual y media",
        "func": "var msg1 = {};\nvar msg2 = {};\nvar msg3 = {};\ncontext.data = context.data || {};\nswitch (msg.topic){\n    case \"temperatura_media\":\n        context.data.temperatura_media = msg.payload;\n        msg = null;\n        break;\n    case \"temperatura_actual\":\n        context.data.temperatura_actual = msg.payload;\n        msg = null;\n        break;\n    default:\n        msg = null;\n        break;\n}\n\nif (context.data.temperatura_actual != null && context.data.temperatura_media != null){\n    msg1.payload = Math.abs(context.data.temperatura_actual-context.data.temperatura_media);\n    msg1.topic = \"Diferencia\";\n    msg2.payload = context.data.temperatura_actual;\n    msg2.topic = \"Actual\";\n    msg3.payload = context.data.temperatura_media;\n    msg3.topic = \"Media\";\n    context.data = null;\n    return [msg1, msg2, msg3];\n}else {return msg;}",
        "outputs": 3,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1550,
        "y": 620,
        "wires": [
            [
                "08ceaac9c4335523"
            ],
            [
                "08ceaac9c4335523"
            ],
            [
                "08ceaac9c4335523"
            ]
        ]
    },
    {
        "id": "ddcbce2f08623d57",
        "type": "change",
        "z": "f607af27c5f161a8",
        "g": "f70edc445b47629c",
        "name": "Temperatura",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.temperatura",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1250,
        "y": 460,
        "wires": [
            [
                "ca3e93bac4356c89",
                "ba2dc2f18933cb5f",
                "b84786aa7f2eaa95"
            ]
        ]
    },
    {
        "id": "115662fced1d8e26",
        "type": "link out",
        "z": "f607af27c5f161a8",
        "g": "a048d8410ae79405",
        "name": "Salida_json_tarea_4",
        "mode": "link",
        "links": [
            "a62dca5ec68c60eb",
            "be94424c81d39ed9",
            "c838b32e0076c737"
        ],
        "x": 1805,
        "y": 120,
        "wires": []
    },
    {
        "id": "be94424c81d39ed9",
        "type": "link in",
        "z": "f607af27c5f161a8",
        "g": "09a81a457253b8d4",
        "name": "link in 1",
        "links": [
            "115662fced1d8e26"
        ],
        "x": 1115,
        "y": 260,
        "wires": [
            [
                "1e5340d074ece8ae"
            ]
        ]
    },
    {
        "id": "a62dca5ec68c60eb",
        "type": "link in",
        "z": "f607af27c5f161a8",
        "g": "f70edc445b47629c",
        "name": "link in 2",
        "links": [
            "115662fced1d8e26"
        ],
        "x": 1115,
        "y": 460,
        "wires": [
            [
                "ddcbce2f08623d57"
            ]
        ]
    },
    {
        "id": "e2abbcccb1b32b84",
        "type": "change",
        "z": "f607af27c5f161a8",
        "g": "77511cc01629b614",
        "name": "Humedad",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.sensacion_termica",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1240,
        "y": 360,
        "wires": [
            [
                "81ab1216e764cf5c"
            ]
        ]
    },
    {
        "id": "c838b32e0076c737",
        "type": "link in",
        "z": "f607af27c5f161a8",
        "g": "77511cc01629b614",
        "name": "link in 3",
        "links": [
            "115662fced1d8e26"
        ],
        "x": 1115,
        "y": 360,
        "wires": [
            [
                "e2abbcccb1b32b84"
            ]
        ]
    },
    {
        "id": "81ab1216e764cf5c",
        "type": "change",
        "z": "f607af27c5f161a8",
        "g": "77511cc01629b614",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "sensacion_termica",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1490,
        "y": 360,
        "wires": [
            [
                "0e47d32a6d09d79e"
            ]
        ]
    },
    {
        "id": "0e47d32a6d09d79e",
        "type": "ui_gauge",
        "z": "f607af27c5f161a8",
        "g": "77511cc01629b614",
        "name": "",
        "group": "e968a1c70a34a463",
        "order": 4,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Sensación térmica",
        "label": "ºC",
        "format": "{{value | number:1}}",
        "min": "-5",
        "max": "50",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 1730,
        "y": 360,
        "wires": []
    },
    {
        "id": "b91994e2fa49fa0e",
        "type": "debug",
        "z": "f607af27c5f161a8",
        "g": "a048d8410ae79405",
        "name": "debug 2",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1740,
        "y": 160,
        "wires": []
    },
    {
        "id": "7f779793dea8a999",
        "type": "mqtt in",
        "z": "75eea1382d17332e",
        "g": "649ef4596360f731",
        "name": "",
        "topic": "iot/datos/json",
        "qos": "2",
        "datatype": "auto",
        "broker": "6ac432b491b7d6fc",
        "nl": false,
        "rap": false,
        "inputs": 0,
        "x": 130,
        "y": 80,
        "wires": [
            [
                "a59bb6fcd156702e"
            ]
        ]
    },
    {
        "id": "a59bb6fcd156702e",
        "type": "json",
        "z": "75eea1382d17332e",
        "g": "649ef4596360f731",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 290,
        "y": 80,
        "wires": [
            [
                "591c77a9793c708d"
            ]
        ]
    },
    {
        "id": "badb7991e0aad159",
        "type": "debug",
        "z": "75eea1382d17332e",
        "g": "649ef4596360f731",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 690,
        "y": 180,
        "wires": []
    },
    {
        "id": "7a4d07f793ab64bb",
        "type": "mongodb out",
        "z": "75eea1382d17332e",
        "g": "649ef4596360f731",
        "mongodb": "ca0dd972168dc6a0",
        "name": "",
        "collection": "datos",
        "payonly": true,
        "upsert": false,
        "multi": false,
        "operation": "store",
        "x": 750,
        "y": 100,
        "wires": []
    },
    {
        "id": "d059edbed9ddbeb5",
        "type": "mongodb in",
        "z": "75eea1382d17332e",
        "g": "74039604ee5e8650",
        "mongodb": "05cea6759e795a87",
        "name": "",
        "collection": "datos",
        "operation": "find",
        "x": 540,
        "y": 1040,
        "wires": [
            [
                "e633e2181efcddf6"
            ]
        ]
    },
    {
        "id": "25d009209369ec68",
        "type": "inject",
        "z": "75eea1382d17332e",
        "g": "74039604ee5e8650",
        "name": "",
        "props": [
            {
                "p": "payload",
                "v": "{ }",
                "vt": "json"
            },
            {
                "p": "topic",
                "v": "",
                "vt": "string"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{ }",
        "payloadType": "json",
        "x": 126.99993896484375,
        "y": 1040.3665533065796,
        "wires": [
            [
                "d059edbed9ddbeb5"
            ]
        ]
    },
    {
        "id": "e633e2181efcddf6",
        "type": "debug",
        "z": "75eea1382d17332e",
        "g": "74039604ee5e8650",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1050,
        "y": 1040,
        "wires": []
    },
    {
        "id": "591c77a9793c708d",
        "type": "function",
        "z": "75eea1382d17332e",
        "g": "649ef4596360f731",
        "name": "+ fecha",
        "func": "msg.payload.date = new Date();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 480,
        "y": 140,
        "wires": [
            [
                "7a4d07f793ab64bb",
                "6977ecf391846a70",
                "badb7991e0aad159"
            ]
        ]
    },
    {
        "id": "dcf1e87d2ec6acb9",
        "type": "inject",
        "z": "75eea1382d17332e",
        "g": "647824b5fc68c9b4",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"date\":\"2022-10-17T17:56:58.583Z\"}",
        "payloadType": "json",
        "x": 130,
        "y": 1220,
        "wires": [
            [
                "72f818b5b9b50f36"
            ]
        ]
    },
    {
        "id": "72f818b5b9b50f36",
        "type": "mongodb out",
        "z": "75eea1382d17332e",
        "g": "647824b5fc68c9b4",
        "mongodb": "ca0dd972168dc6a0",
        "name": "",
        "collection": "datos_json",
        "payonly": true,
        "upsert": false,
        "multi": false,
        "operation": "delete",
        "x": 440,
        "y": 1220,
        "wires": []
    },
    {
        "id": "0b978e33f3b44517",
        "type": "comment",
        "z": "75eea1382d17332e",
        "g": "647824b5fc68c9b4",
        "name": "borrar una coleccion",
        "info": "inyectar un JSON vacío: {}\nseleccionar \"remove\" en la configuración del nodo mongoDB ",
        "x": 150,
        "y": 1160,
        "wires": []
    },
    {
        "id": "ab7651e781273dc2",
        "type": "comment",
        "z": "75eea1382d17332e",
        "g": "74039604ee5e8650",
        "name": "consultar una coleccion",
        "info": "",
        "x": 160,
        "y": 980,
        "wires": []
    },
    {
        "id": "b87f92065b60fba0",
        "type": "template",
        "z": "75eea1382d17332e",
        "g": "afde8b33977a814c",
        "name": "lista en formato html",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": " <h1>Registros: </h1>\n <ul>\n{{#payload}}\n  <li>{{date}} : {{BME280.Temperatura }}ºC, {{BME280.Humedad}}% </li>\n{{/payload}}\n </ul>",
        "output": "str",
        "x": 900,
        "y": 440,
        "wires": [
            [
                "649cdc3e1838217a"
            ]
        ]
    },
    {
        "id": "649cdc3e1838217a",
        "type": "ui_template",
        "z": "75eea1382d17332e",
        "g": "afde8b33977a814c",
        "group": "f4f4dc208bbef1ee",
        "name": "",
        "order": 3,
        "width": "6",
        "height": "4",
        "format": "<div ng-bind-html=\"msg.payload\"></div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": false,
        "templateScope": "local",
        "className": "",
        "x": 1080,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "74e1a0933c20455b",
        "type": "function",
        "z": "75eea1382d17332e",
        "g": "afde8b33977a814c",
        "name": "",
        "func": "var limite = flow.get(\"parametro\");;\nmsg.payload = {};\nmsg.limit = limite;\nmsg.sort = {\"date\" : -1};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 280,
        "y": 460,
        "wires": [
            [
                "7dcaf3d3f771ef36"
            ]
        ]
    },
    {
        "id": "cc84ac7703124f01",
        "type": "ui_chart",
        "z": "75eea1382d17332e",
        "g": "afde8b33977a814c",
        "name": "",
        "group": "f4f4dc208bbef1ee",
        "order": 1,
        "width": 0,
        "height": 0,
        "label": "chart",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1090,
        "y": 480,
        "wires": [
            []
        ]
    },
    {
        "id": "27362b5fe3d6b6a5",
        "type": "mongodb in",
        "z": "75eea1382d17332e",
        "g": "647824b5fc68c9b4",
        "mongodb": "ca0dd972168dc6a0",
        "name": "",
        "collection": "datos_json",
        "operation": "find",
        "x": 780,
        "y": 1280,
        "wires": [
            [
                "57a686d4d340dcce"
            ]
        ]
    },
    {
        "id": "a2529eef44698b6f",
        "type": "inject",
        "z": "75eea1382d17332e",
        "g": "647824b5fc68c9b4",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"ADC.Iluminacion\":10}",
        "payloadType": "json",
        "x": 180,
        "y": 1280,
        "wires": [
            [
                "27362b5fe3d6b6a5",
                "72f818b5b9b50f36"
            ]
        ]
    },
    {
        "id": "57a686d4d340dcce",
        "type": "debug",
        "z": "75eea1382d17332e",
        "g": "647824b5fc68c9b4",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1050,
        "y": 1280,
        "wires": []
    },
    {
        "id": "1c82d5fe266a00a9",
        "type": "function",
        "z": "75eea1382d17332e",
        "g": "647824b5fc68c9b4",
        "name": "",
        "func": "msg.payload={\"date\": new Date(\"2022-10-17T17:57:28.587Z\")}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 520,
        "y": 1340,
        "wires": [
            [
                "27362b5fe3d6b6a5"
            ]
        ]
    },
    {
        "id": "724254f70da10925",
        "type": "inject",
        "z": "75eea1382d17332e",
        "g": "647824b5fc68c9b4",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 140,
        "y": 1340,
        "wires": [
            [
                "1c82d5fe266a00a9"
            ]
        ]
    },
    {
        "id": "5df3852ac3ab31cc",
        "type": "inject",
        "z": "75eea1382d17332e",
        "g": "647824b5fc68c9b4",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"conexion.SSID\": \"MASTER\"}",
        "payloadType": "json",
        "x": 330,
        "y": 1160,
        "wires": [
            [
                "27362b5fe3d6b6a5",
                "72f818b5b9b50f36"
            ]
        ]
    },
    {
        "id": "0aafc89b687c69aa",
        "type": "mongodb out",
        "z": "75eea1382d17332e",
        "g": "647824b5fc68c9b4",
        "mongodb": "05cea6759e795a87",
        "name": "",
        "collection": "datos",
        "payonly": true,
        "upsert": false,
        "multi": false,
        "operation": "delete",
        "x": 340,
        "y": 1400,
        "wires": []
    },
    {
        "id": "378b2a78242c7b03",
        "type": "inject",
        "z": "75eea1382d17332e",
        "g": "647824b5fc68c9b4",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{}",
        "payloadType": "json",
        "x": 130,
        "y": 1400,
        "wires": [
            [
                "0aafc89b687c69aa"
            ]
        ]
    },
    {
        "id": "6977ecf391846a70",
        "type": "mongodb out",
        "z": "75eea1382d17332e",
        "g": "649ef4596360f731",
        "mongodb": "05cea6759e795a87",
        "name": "",
        "collection": "datos",
        "payonly": true,
        "upsert": false,
        "multi": false,
        "operation": "store",
        "x": 720,
        "y": 140,
        "wires": []
    },
    {
        "id": "2069b7e6f1cd6d4a",
        "type": "mongodb in",
        "z": "75eea1382d17332e",
        "g": "649ef4596360f731",
        "mongodb": "05cea6759e795a87",
        "name": "",
        "collection": "datos",
        "operation": "find",
        "x": 700,
        "y": 240,
        "wires": [
            [
                "08902129e849bece"
            ]
        ]
    },
    {
        "id": "08902129e849bece",
        "type": "debug",
        "z": "75eea1382d17332e",
        "g": "649ef4596360f731",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1050,
        "y": 240,
        "wires": []
    },
    {
        "id": "f63c76414327d523",
        "type": "function",
        "z": "75eea1382d17332e",
        "g": "649ef4596360f731",
        "name": "Get values sorted and limited",
        "func": "msg.payload = {};\nmsg.topic = \"\";\nmsg.sort = {\"date\":-1};\nmsg.limit = 10;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 420,
        "y": 240,
        "wires": [
            [
                "2069b7e6f1cd6d4a"
            ]
        ]
    },
    {
        "id": "296f70f22f6ab008",
        "type": "complete",
        "z": "75eea1382d17332e",
        "g": "649ef4596360f731",
        "name": "",
        "scope": [
            "591c77a9793c708d"
        ],
        "uncaught": false,
        "x": 130,
        "y": 240,
        "wires": [
            [
                "f63c76414327d523"
            ]
        ]
    },
    {
        "id": "f42515b31c65e764",
        "type": "function",
        "z": "75eea1382d17332e",
        "g": "309aebc5883aca03",
        "name": "Get values sorted and limited",
        "func": "msg.payload = {};\nmsg.topic = \"\";\nmsg.sort = {\"date\":-1};\nmsg.limit = 1;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 420,
        "y": 340,
        "wires": [
            [
                "282380279cde19b8"
            ]
        ]
    },
    {
        "id": "b3feb7a105d0ccab",
        "type": "complete",
        "z": "75eea1382d17332e",
        "g": "309aebc5883aca03",
        "name": "",
        "scope": [
            "591c77a9793c708d"
        ],
        "uncaught": false,
        "x": 130,
        "y": 340,
        "wires": [
            [
                "f42515b31c65e764"
            ]
        ]
    },
    {
        "id": "282380279cde19b8",
        "type": "mongodb in",
        "z": "75eea1382d17332e",
        "g": "309aebc5883aca03",
        "mongodb": "05cea6759e795a87",
        "name": "",
        "collection": "datos",
        "operation": "find",
        "x": 700,
        "y": 340,
        "wires": [
            [
                "7ac6fd944f48629d"
            ]
        ]
    },
    {
        "id": "35488a2546801986",
        "type": "function",
        "z": "75eea1382d17332e",
        "g": "0e2ac29ec655628c",
        "name": "",
        "func": "var fecha = new Date();\n\nmsg.payload = fecha.toLocaleString('es-ES', { timeZone: 'Europe/Madrid', hour12: false });\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1620,
        "y": 160,
        "wires": [
            [
                "91210b14b56a06a8"
            ]
        ]
    },
    {
        "id": "c789f80eaee226f6",
        "type": "ui_led",
        "z": "75eea1382d17332e",
        "g": "0e2ac29ec655628c",
        "order": 3,
        "group": "2888ca9d00385ef8",
        "width": "4",
        "height": "1",
        "label": "LED",
        "labelPlacement": "left",
        "labelAlignment": "center",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "1",
                "valueType": "num"
            },
            {
                "color": "#9a9996",
                "value": "0",
                "valueType": "num"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 1930,
        "y": 120,
        "wires": []
    },
    {
        "id": "28e6ed79667c4c8f",
        "type": "ui_led",
        "z": "75eea1382d17332e",
        "g": "0e2ac29ec655628c",
        "order": 3,
        "group": "f8b2658284e752dc",
        "width": "4",
        "height": "1",
        "label": "LED ",
        "labelPlacement": "left",
        "labelAlignment": "center",
        "colorForValue": [
            {
                "color": "#33d17a",
                "value": "1",
                "valueType": "num"
            },
            {
                "color": "#9a9996",
                "value": "0",
                "valueType": "num"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 1930,
        "y": 260,
        "wires": []
    },
    {
        "id": "91210b14b56a06a8",
        "type": "ui_text",
        "z": "75eea1382d17332e",
        "g": "0e2ac29ec655628c",
        "group": "2888ca9d00385ef8",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Última actualización",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1880,
        "y": 160,
        "wires": []
    },
    {
        "id": "c8821c52cb6aa60d",
        "type": "ui_text",
        "z": "75eea1382d17332e",
        "g": "0e2ac29ec655628c",
        "group": "f8b2658284e752dc",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Última actualización",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "<style>     #nr-dashboard-cardtitle{text-align: center !important;} </style>",
        "x": 1880,
        "y": 300,
        "wires": []
    },
    {
        "id": "0c1290d36881709a",
        "type": "function",
        "z": "75eea1382d17332e",
        "g": "0e2ac29ec655628c",
        "name": "",
        "func": "var fecha = new Date();\n\nmsg.payload = fecha.toLocaleString('es-ES', { timeZone: 'Europe/Madrid', hour12: false });\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1620,
        "y": 300,
        "wires": [
            [
                "c8821c52cb6aa60d"
            ]
        ]
    },
    {
        "id": "da7b924c6c0c0103",
        "type": "ui_text",
        "z": "75eea1382d17332e",
        "g": "0e2ac29ec655628c",
        "group": "f8b2658284e752dc",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Estado:",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1920,
        "y": 220,
        "wires": []
    },
    {
        "id": "0fc37db329e8b96f",
        "type": "function",
        "z": "75eea1382d17332e",
        "g": "0e2ac29ec655628c",
        "name": "",
        "func": "switch (msg.payload) {\n    case 0:\n        msg.payload = \"Apagado\";\n        break;\n    default:\n        msg.payload = \"Encendido\";\n        break;\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1620,
        "y": 220,
        "wires": [
            [
                "da7b924c6c0c0103"
            ]
        ]
    },
    {
        "id": "36c01bb5bb9b678e",
        "type": "function",
        "z": "75eea1382d17332e",
        "g": "0e2ac29ec655628c",
        "name": "",
        "func": "switch (msg.payload) {\n    case 0:\n        msg.payload = \"Apagado\";\n        break;\n    default:\n        msg.payload = \"Encendido\";\n        break;\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1620,
        "y": 80,
        "wires": [
            [
                "eda6447af7c8bffe"
            ]
        ]
    },
    {
        "id": "eda6447af7c8bffe",
        "type": "ui_text",
        "z": "75eea1382d17332e",
        "g": "0e2ac29ec655628c",
        "group": "2888ca9d00385ef8",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Estado:",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1920,
        "y": 80,
        "wires": []
    },
    {
        "id": "d5ec909fc2a947e1",
        "type": "change",
        "z": "75eea1382d17332e",
        "g": "0e2ac29ec655628c",
        "name": "Estado LED Rojo",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.LEDs.Rojo",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1430,
        "y": 120,
        "wires": [
            [
                "36c01bb5bb9b678e",
                "c789f80eaee226f6",
                "35488a2546801986"
            ]
        ]
    },
    {
        "id": "d4c8025a303bf89d",
        "type": "change",
        "z": "75eea1382d17332e",
        "g": "0e2ac29ec655628c",
        "name": "Estado LED verde",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.LEDs.Verde",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1430,
        "y": 260,
        "wires": [
            [
                "0fc37db329e8b96f",
                "28e6ed79667c4c8f",
                "0c1290d36881709a"
            ]
        ]
    },
    {
        "id": "cd903d736c615d53",
        "type": "change",
        "z": "75eea1382d17332e",
        "g": "b0912d74dc61c016",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "humedad",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1650,
        "y": 560,
        "wires": [
            [
                "71406a0bea54bf24"
            ]
        ]
    },
    {
        "id": "71406a0bea54bf24",
        "type": "ui_gauge",
        "z": "75eea1382d17332e",
        "g": "b0912d74dc61c016",
        "name": "",
        "group": "c271ce14649409b0",
        "order": 1,
        "width": 0,
        "height": 0,
        "gtype": "wave",
        "title": "Humedad",
        "label": "%",
        "format": "{{value}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 1920,
        "y": 560,
        "wires": []
    },
    {
        "id": "efcacea8ecaf383f",
        "type": "change",
        "z": "75eea1382d17332e",
        "g": "b0912d74dc61c016",
        "name": "Humedad",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.BME280.Humedad",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1400,
        "y": 560,
        "wires": [
            [
                "cd903d736c615d53"
            ]
        ]
    },
    {
        "id": "f89d21a2a60f29a1",
        "type": "function",
        "z": "75eea1382d17332e",
        "g": "11e204a348f1b70b",
        "name": "",
        "func": "msg.topic = \"temperatura\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1680,
        "y": 660,
        "wires": [
            [
                "72dc3c90ef2b4e37"
            ]
        ]
    },
    {
        "id": "c842633427d582d2",
        "type": "ui_text",
        "z": "75eea1382d17332e",
        "g": "11e204a348f1b70b",
        "group": "4f2fd049c27a14a1",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Última actualización",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1880,
        "y": 700,
        "wires": []
    },
    {
        "id": "f8b068809ebdb8b6",
        "type": "function",
        "z": "75eea1382d17332e",
        "g": "11e204a348f1b70b",
        "name": "",
        "func": "var fecha = new Date();\n\nmsg.payload = fecha.toLocaleString('es-ES', { timeZone: 'Europe/Madrid', hour12: false });\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1680,
        "y": 700,
        "wires": [
            [
                "c842633427d582d2"
            ]
        ]
    },
    {
        "id": "72dc3c90ef2b4e37",
        "type": "ui_gauge",
        "z": "75eea1382d17332e",
        "g": "11e204a348f1b70b",
        "name": "",
        "group": "4f2fd049c27a14a1",
        "order": 4,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Temperatura",
        "label": "ºC",
        "format": "{{value}}",
        "min": "-5",
        "max": "50",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 1910,
        "y": 660,
        "wires": []
    },
    {
        "id": "ab5b598a7284062b",
        "type": "change",
        "z": "75eea1382d17332e",
        "g": "11e204a348f1b70b",
        "name": "Temperatura",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.BME280.Temperatura",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1410,
        "y": 660,
        "wires": [
            [
                "f89d21a2a60f29a1",
                "f8b068809ebdb8b6"
            ]
        ]
    },
    {
        "id": "ae0a7684d57a1068",
        "type": "smooth",
        "z": "75eea1382d17332e",
        "g": "0db9cf2dc5229a25",
        "name": "",
        "property": "payload",
        "action": "max",
        "count": "100",
        "round": "",
        "mult": "single",
        "reduce": false,
        "x": 1580,
        "y": 860,
        "wires": [
            [
                "a104d7e8a817aee0"
            ]
        ]
    },
    {
        "id": "56f6517c336fdc8a",
        "type": "ui_text",
        "z": "75eea1382d17332e",
        "g": "0db9cf2dc5229a25",
        "group": "cbfbdc48914b032d",
        "order": 7,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Tiempo de funcionamiento",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1990,
        "y": 1160,
        "wires": []
    },
    {
        "id": "8155232e168b87d5",
        "type": "change",
        "z": "75eea1382d17332e",
        "g": "0db9cf2dc5229a25",
        "name": "uptime_ms",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.uptime_ms",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "uptime_ms",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1410,
        "y": 1160,
        "wires": [
            [
                "270d6d4a8f0fa0e7"
            ]
        ]
    },
    {
        "id": "42e4cbc6aa1ca7c8",
        "type": "smooth",
        "z": "75eea1382d17332e",
        "g": "0db9cf2dc5229a25",
        "name": "",
        "property": "payload",
        "action": "min",
        "count": "100",
        "round": "",
        "mult": "single",
        "reduce": false,
        "x": 1580,
        "y": 920,
        "wires": [
            [
                "4541c44ae5248be3"
            ]
        ]
    },
    {
        "id": "4541c44ae5248be3",
        "type": "ui_text",
        "z": "75eea1382d17332e",
        "g": "0db9cf2dc5229a25",
        "group": "cbfbdc48914b032d",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": " RSSI mínimo",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 2040,
        "y": 920,
        "wires": []
    },
    {
        "id": "a104d7e8a817aee0",
        "type": "ui_text",
        "z": "75eea1382d17332e",
        "g": "0db9cf2dc5229a25",
        "group": "cbfbdc48914b032d",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": " RSSI máximo",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 2040,
        "y": 860,
        "wires": []
    },
    {
        "id": "270d6d4a8f0fa0e7",
        "type": "function",
        "z": "75eea1382d17332e",
        "g": "0db9cf2dc5229a25",
        "name": "",
        "func": "var ms = msg.payload;\nconst days = Math.floor(ms / (24 * 60 * 60 * 1000));\nconst daysms = ms % (24 * 60 * 60 * 1000);\nconst hours = Math.floor(daysms / (60 * 60 * 1000));\nconst hoursms = ms % (60 * 60 * 1000);\nconst minutes = Math.floor(hoursms / (60 * 1000));\nconst minutesms = ms % (60 * 1000);\nmsg.payload = {};\nmsg.payload = days + \" días \" + hours + \"h \" + minutes + \"m \";\nreturn msg",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1660,
        "y": 1160,
        "wires": [
            [
                "56f6517c336fdc8a"
            ]
        ]
    },
    {
        "id": "32ea389529d5ffcb",
        "type": "ui_text",
        "z": "75eea1382d17332e",
        "g": "0db9cf2dc5229a25",
        "group": "cbfbdc48914b032d",
        "order": 8,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "interval_s",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 2040,
        "y": 1220,
        "wires": []
    },
    {
        "id": "a14de9fcda319b0d",
        "type": "change",
        "z": "75eea1382d17332e",
        "g": "0db9cf2dc5229a25",
        "name": "RSSI",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.RSSI",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "RSSI",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1390,
        "y": 980,
        "wires": [
            [
                "360b50a2f9d7985c"
            ]
        ]
    },
    {
        "id": "94b3e846c8f45a0b",
        "type": "ui_text",
        "z": "75eea1382d17332e",
        "g": "0db9cf2dc5229a25",
        "group": "cbfbdc48914b032d",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "SSID",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 2070,
        "y": 800,
        "wires": []
    },
    {
        "id": "360b50a2f9d7985c",
        "type": "ui_text",
        "z": "75eea1382d17332e",
        "g": "0db9cf2dc5229a25",
        "group": "cbfbdc48914b032d",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "RSSI",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 2070,
        "y": 980,
        "wires": []
    },
    {
        "id": "d47785b8c4041f8b",
        "type": "change",
        "z": "75eea1382d17332e",
        "g": "0db9cf2dc5229a25",
        "name": "localIP",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.localIP",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "localIP",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1400,
        "y": 1040,
        "wires": [
            [
                "7483a81f26b192b8"
            ]
        ]
    },
    {
        "id": "7483a81f26b192b8",
        "type": "ui_text",
        "z": "75eea1382d17332e",
        "g": "0db9cf2dc5229a25",
        "group": "cbfbdc48914b032d",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "localIP",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 2060,
        "y": 1040,
        "wires": []
    },
    {
        "id": "78e3cdb157e1129f",
        "type": "ui_text",
        "z": "75eea1382d17332e",
        "g": "0db9cf2dc5229a25",
        "group": "cbfbdc48914b032d",
        "order": 6,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "macAddress",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 2050,
        "y": 1100,
        "wires": []
    },
    {
        "id": "977cb46e7b213e58",
        "type": "change",
        "z": "75eea1382d17332e",
        "g": "0db9cf2dc5229a25",
        "name": "SSID",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.SSID",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "SSID",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1390,
        "y": 800,
        "wires": [
            [
                "94b3e846c8f45a0b"
            ]
        ]
    },
    {
        "id": "e05bacd595fd7b9b",
        "type": "change",
        "z": "75eea1382d17332e",
        "g": "0db9cf2dc5229a25",
        "name": "macAddress",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.macAddress",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "macAddress",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1410,
        "y": 1100,
        "wires": [
            [
                "78e3cdb157e1129f"
            ]
        ]
    },
    {
        "id": "71373ff3bff73c36",
        "type": "change",
        "z": "75eea1382d17332e",
        "g": "0db9cf2dc5229a25",
        "name": "interval_s",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.interval_s",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "interval_s",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1410,
        "y": 1220,
        "wires": [
            [
                "32ea389529d5ffcb"
            ]
        ]
    },
    {
        "id": "623a369218616077",
        "type": "change",
        "z": "75eea1382d17332e",
        "g": "0db9cf2dc5229a25",
        "name": "RSSI",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.RSSI",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "RSSI",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1390,
        "y": 920,
        "wires": [
            [
                "42e4cbc6aa1ca7c8"
            ]
        ]
    },
    {
        "id": "9cd0af2162c11169",
        "type": "change",
        "z": "75eea1382d17332e",
        "g": "0db9cf2dc5229a25",
        "name": "RSSI",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.RSSI",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "RSSI",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1390,
        "y": 860,
        "wires": [
            [
                "ae0a7684d57a1068"
            ]
        ]
    },
    {
        "id": "e6c2f71338d5c14c",
        "type": "link out",
        "z": "75eea1382d17332e",
        "g": "309aebc5883aca03",
        "name": "link out 1",
        "mode": "link",
        "links": [
            "2d9aa2659ce8abc2",
            "f58e23e1fe46bea9",
            "318364f7ce2c10db",
            "62ccfc102a121707",
            "0d328427efb18475",
            "57ef0f8e9c967f80",
            "1845dc66ab84b372",
            "ba5d751411b241a0",
            "5a28e07148ec276d",
            "b1d676d63b987cfa",
            "6650bb9b207e419d",
            "9ebb6be22a8b749e",
            "47b5bd66bc2ddc3f"
        ],
        "x": 1125,
        "y": 340,
        "wires": []
    },
    {
        "id": "2d9aa2659ce8abc2",
        "type": "link in",
        "z": "75eea1382d17332e",
        "g": "0db9cf2dc5229a25",
        "name": "link in 4",
        "links": [
            "e6c2f71338d5c14c"
        ],
        "x": 1265,
        "y": 800,
        "wires": [
            [
                "977cb46e7b213e58"
            ]
        ]
    },
    {
        "id": "f58e23e1fe46bea9",
        "type": "link in",
        "z": "75eea1382d17332e",
        "g": "0db9cf2dc5229a25",
        "name": "link in 5",
        "links": [
            "e6c2f71338d5c14c"
        ],
        "x": 1265,
        "y": 860,
        "wires": [
            [
                "9cd0af2162c11169"
            ]
        ]
    },
    {
        "id": "0d328427efb18475",
        "type": "link in",
        "z": "75eea1382d17332e",
        "g": "0db9cf2dc5229a25",
        "name": "link in 7",
        "links": [
            "e6c2f71338d5c14c"
        ],
        "x": 1265,
        "y": 980,
        "wires": [
            [
                "a14de9fcda319b0d"
            ]
        ]
    },
    {
        "id": "318364f7ce2c10db",
        "type": "link in",
        "z": "75eea1382d17332e",
        "g": "0db9cf2dc5229a25",
        "name": "link in 6",
        "links": [
            "e6c2f71338d5c14c"
        ],
        "x": 1265,
        "y": 920,
        "wires": [
            [
                "623a369218616077"
            ]
        ]
    },
    {
        "id": "62ccfc102a121707",
        "type": "link in",
        "z": "75eea1382d17332e",
        "g": "0db9cf2dc5229a25",
        "name": "link in 8",
        "links": [
            "e6c2f71338d5c14c"
        ],
        "x": 1265,
        "y": 1040,
        "wires": [
            [
                "d47785b8c4041f8b"
            ]
        ]
    },
    {
        "id": "57ef0f8e9c967f80",
        "type": "link in",
        "z": "75eea1382d17332e",
        "g": "0db9cf2dc5229a25",
        "name": "link in 9",
        "links": [
            "e6c2f71338d5c14c"
        ],
        "x": 1265,
        "y": 1100,
        "wires": [
            [
                "e05bacd595fd7b9b"
            ]
        ]
    },
    {
        "id": "1845dc66ab84b372",
        "type": "link in",
        "z": "75eea1382d17332e",
        "g": "0db9cf2dc5229a25",
        "name": "link in 10",
        "links": [
            "e6c2f71338d5c14c"
        ],
        "x": 1265,
        "y": 1160,
        "wires": [
            [
                "8155232e168b87d5"
            ]
        ]
    },
    {
        "id": "ba5d751411b241a0",
        "type": "link in",
        "z": "75eea1382d17332e",
        "g": "0db9cf2dc5229a25",
        "name": "link in 11",
        "links": [
            "e6c2f71338d5c14c"
        ],
        "x": 1265,
        "y": 1220,
        "wires": [
            [
                "71373ff3bff73c36"
            ]
        ]
    },
    {
        "id": "7ac6fd944f48629d",
        "type": "function",
        "z": "75eea1382d17332e",
        "g": "309aebc5883aca03",
        "name": "Array to JSON",
        "func": "msg.payload = msg.payload[0];\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 980,
        "y": 340,
        "wires": [
            [
                "e6c2f71338d5c14c"
            ]
        ]
    },
    {
        "id": "afe8663976092c61",
        "type": "ui_chart",
        "z": "75eea1382d17332e",
        "g": "ecfef77c05bf3b51",
        "name": "",
        "group": "98ee1182cc353ad6",
        "order": 2,
        "width": "0",
        "height": "0",
        "label": "Presión (mbar)",
        "chartType": "line",
        "legend": "true",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1900,
        "y": 420,
        "wires": [
            []
        ]
    },
    {
        "id": "c1bf3fb784624a5e",
        "type": "change",
        "z": "75eea1382d17332e",
        "g": "ecfef77c05bf3b51",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Presión",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1630,
        "y": 400,
        "wires": [
            [
                "afe8663976092c61"
            ]
        ]
    },
    {
        "id": "d808403632946b1e",
        "type": "inject",
        "z": "75eea1382d17332e",
        "g": "ecfef77c05bf3b51",
        "name": "Reset chart",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "[ ]",
        "payloadType": "json",
        "x": 1630,
        "y": 460,
        "wires": [
            [
                "afe8663976092c61"
            ]
        ]
    },
    {
        "id": "256909c3dc5dc377",
        "type": "change",
        "z": "75eea1382d17332e",
        "g": "ecfef77c05bf3b51",
        "name": "Presión",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.BME280.Presion",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1400,
        "y": 400,
        "wires": [
            [
                "c1bf3fb784624a5e"
            ]
        ]
    },
    {
        "id": "5a28e07148ec276d",
        "type": "link in",
        "z": "75eea1382d17332e",
        "g": "0e2ac29ec655628c",
        "name": "link in 12",
        "links": [
            "e6c2f71338d5c14c"
        ],
        "x": 1275,
        "y": 120,
        "wires": [
            [
                "d5ec909fc2a947e1"
            ]
        ]
    },
    {
        "id": "b1d676d63b987cfa",
        "type": "link in",
        "z": "75eea1382d17332e",
        "g": "0e2ac29ec655628c",
        "name": "link in 13",
        "links": [
            "e6c2f71338d5c14c"
        ],
        "x": 1275,
        "y": 260,
        "wires": [
            [
                "d4c8025a303bf89d"
            ]
        ]
    },
    {
        "id": "6650bb9b207e419d",
        "type": "link in",
        "z": "75eea1382d17332e",
        "g": "ecfef77c05bf3b51",
        "name": "link in 14",
        "links": [
            "e6c2f71338d5c14c"
        ],
        "x": 1275,
        "y": 400,
        "wires": [
            [
                "256909c3dc5dc377"
            ]
        ]
    },
    {
        "id": "9ebb6be22a8b749e",
        "type": "link in",
        "z": "75eea1382d17332e",
        "g": "b0912d74dc61c016",
        "name": "link in 15",
        "links": [
            "e6c2f71338d5c14c"
        ],
        "x": 1275,
        "y": 560,
        "wires": [
            [
                "efcacea8ecaf383f"
            ]
        ]
    },
    {
        "id": "47b5bd66bc2ddc3f",
        "type": "link in",
        "z": "75eea1382d17332e",
        "g": "11e204a348f1b70b",
        "name": "link in 16",
        "links": [
            "e6c2f71338d5c14c"
        ],
        "x": 1285,
        "y": 660,
        "wires": [
            [
                "ab5b598a7284062b"
            ]
        ]
    },
    {
        "id": "7dcaf3d3f771ef36",
        "type": "mongodb in",
        "z": "75eea1382d17332e",
        "g": "afde8b33977a814c",
        "mongodb": "05cea6759e795a87",
        "name": "",
        "collection": "datos",
        "operation": "find",
        "x": 500,
        "y": 460,
        "wires": [
            [
                "d5de2f5917a146a0",
                "edd20832146cd32f"
            ]
        ]
    },
    {
        "id": "d5de2f5917a146a0",
        "type": "function",
        "z": "75eea1382d17332e",
        "g": "afde8b33977a814c",
        "name": "genera datos gráfica",
        "func": "var arraytemp=[];\nvar arrayhum=[];\n\n// los arrays usados en la represenstación gráfica deben contener objetos JSON con dos campos: {x , y}\n// en x debemos poner la hora en formato \"timestamp\". Si tenemos un objeto fecha se puede convertir usando el método getTime()\n// en y debemos poner el valor de la variable\n// mas info en: https://github.com/node-red/node-red-dashboard/blob/master/Charts.md\n\nif (Array.isArray(msg.payload) && msg.payload.length > 0 && msg.payload.length <= flow.get(\"parametro\"))\n{\n    for (var i = 0; i < msg.payload.length; i++) { // añade datos a los arrays\n        arraytemp.push({x : msg.payload[i].date.getTime() , y : msg.payload[i].BME280.Temperatura});\n        arrayhum.push({x : msg.payload[i].date.getTime() , y : msg.payload[i].BME280.Humedad});\n    }\n    msg.payload = [{\n        \"series\": [\"Temperatura\", \"Humedad\"],\n        \"data\": [arraytemp, arrayhum],\n        \"labels\": [\"\"]\n    }];\n} else {\n    msg.payload = [];\n}\n\nreturn msg;  ",
        "outputs": "1",
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 760,
        "y": 480,
        "wires": [
            [
                "cc84ac7703124f01"
            ]
        ]
    },
    {
        "id": "86d07dfd046950cc",
        "type": "change",
        "z": "75eea1382d17332e",
        "g": "afde8b33977a814c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "parametro",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 310,
        "y": 540,
        "wires": [
            []
        ]
    },
    {
        "id": "7f3ed60624f4d963",
        "type": "ui_slider",
        "z": "75eea1382d17332e",
        "g": "afde8b33977a814c",
        "name": "",
        "label": "slider",
        "tooltip": "",
        "group": "f4f4dc208bbef1ee",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": true,
        "outs": "end",
        "topic": "topic",
        "topicType": "msg",
        "min": 0,
        "max": "100",
        "step": 1,
        "className": "",
        "x": 110,
        "y": 540,
        "wires": [
            [
                "86d07dfd046950cc"
            ]
        ]
    },
    {
        "id": "4f83812c8667c336",
        "type": "complete",
        "z": "75eea1382d17332e",
        "g": "afde8b33977a814c",
        "name": "",
        "scope": [
            "86d07dfd046950cc"
        ],
        "uncaught": false,
        "x": 130,
        "y": 460,
        "wires": [
            [
                "74e1a0933c20455b"
            ]
        ]
    },
    {
        "id": "edd20832146cd32f",
        "type": "function",
        "z": "75eea1382d17332e",
        "g": "afde8b33977a814c",
        "name": "function 2",
        "func": "if(flow.get(\"parametro\") == 0){\n    msg.payload = [];\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 720,
        "y": 440,
        "wires": [
            [
                "b87f92065b60fba0"
            ]
        ]
    },
    {
        "id": "a808d4145868dfcb",
        "type": "function",
        "z": "75eea1382d17332e",
        "g": "2cb4b78c22252d47",
        "name": "function 3",
        "func": "var limite = global.get(\"user_input\");\nmsg.payload = { \"BME280.Temperatura\": { \"$gte\": limite } }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 640,
        "wires": [
            [
                "9d01d3f2713c5ee4"
            ]
        ]
    },
    {
        "id": "a7d4d5b8cd46d80f",
        "type": "ui_button",
        "z": "75eea1382d17332e",
        "g": "2cb4b78c22252d47",
        "name": "",
        "group": "9eaa5333ae7be1f9",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Actualizar gráfica",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 150,
        "y": 640,
        "wires": [
            [
                "a808d4145868dfcb"
            ]
        ]
    },
    {
        "id": "9d01d3f2713c5ee4",
        "type": "mongodb in",
        "z": "75eea1382d17332e",
        "g": "2cb4b78c22252d47",
        "mongodb": "05cea6759e795a87",
        "name": "",
        "collection": "datos",
        "operation": "find",
        "x": 600,
        "y": 640,
        "wires": [
            [
                "6e717116f9d3c7cd"
            ]
        ]
    },
    {
        "id": "f7791d5d91ac1f32",
        "type": "ui_chart",
        "z": "75eea1382d17332e",
        "g": "2cb4b78c22252d47",
        "name": "",
        "group": "9eaa5333ae7be1f9",
        "order": 6,
        "width": 0,
        "height": 0,
        "label": "chart",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1090,
        "y": 640,
        "wires": [
            []
        ]
    },
    {
        "id": "a90bb90d02d2f1e7",
        "type": "ui_numeric",
        "z": "75eea1382d17332e",
        "g": "2cb4b78c22252d47",
        "name": "",
        "label": "user_input",
        "tooltip": "",
        "group": "9eaa5333ae7be1f9",
        "order": 4,
        "width": 0,
        "height": 0,
        "wrap": false,
        "passthru": true,
        "topic": "topic",
        "topicType": "msg",
        "format": "{{value}}",
        "min": 0,
        "max": "50",
        "step": 1,
        "className": "",
        "x": 130,
        "y": 720,
        "wires": [
            [
                "b725253c3965a384"
            ]
        ]
    },
    {
        "id": "b725253c3965a384",
        "type": "change",
        "z": "75eea1382d17332e",
        "g": "2cb4b78c22252d47",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "user_input",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 360,
        "y": 720,
        "wires": [
            []
        ]
    },
    {
        "id": "6e717116f9d3c7cd",
        "type": "function",
        "z": "75eea1382d17332e",
        "g": "2cb4b78c22252d47",
        "name": "genera datos gráfica",
        "func": "var arraytemp=[];\nvar arrayhum=[];\n\n// los arrays usados en la represenstación gráfica deben contener objetos JSON con dos campos: {x , y}\n// en x debemos poner la hora en formato \"timestamp\". Si tenemos un objeto fecha se puede convertir usando el método getTime()\n// en y debemos poner el valor de la variable\n// mas info en: https://github.com/node-red/node-red-dashboard/blob/master/Charts.md\n\nif(Array.isArray(msg.payload) && msg.payload.length>0)\n{\n    for (var i = 0; i < msg.payload.length; i++) { // añade datos a los arrays\n        arraytemp.push({x : msg.payload[i].date.getTime() , y : msg.payload[i].BME280.Temperatura});\n        arrayhum.push({x : msg.payload[i].date.getTime() , y : msg.payload[i].BME280.Humedad});\n    }\n}\n    \nmsg.payload = [{\n        \"series\":[\"Temperatura\",\"Humedad\"],\n        \"data\":[arraytemp, arrayhum],\n        \"labels\":[\"\"]\n        }];\n\nreturn msg;  ",
        "outputs": "1",
        "noerr": 0,
        "x": 880,
        "y": 640,
        "wires": [
            [
                "f7791d5d91ac1f32"
            ]
        ]
    },
    {
        "id": "b56732462606b9af",
        "type": "function",
        "z": "75eea1382d17332e",
        "g": "4f5cec43fc4200ad",
        "name": "function 4",
        "func": "var ms_per_minute = 60000;\n//obtiene el timestamp actual\nvar now_ms = new Date().getTime();\n// crear el objeto fecha con la hora de hace 5 minutos\nvar fiveminsago = new Date(now_ms-5*ms_per_minute);\nvar fiveteenminsago = new Date(now_ms - 15 * ms_per_minute);\n\n//Seleccionar con fecha posterior o igual a hacer 5 minutos\nmsg.payload = {$and: [{ \"date\": {\"$gte\": fiveteenminsago}}, {\"date\": { \"$lte\": fiveminsago }}]};\nmsg.sort= {\"date\":1};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 820,
        "wires": [
            [
                "6f4d50e205eb162b"
            ]
        ]
    },
    {
        "id": "6be94e771d69de4a",
        "type": "template",
        "z": "75eea1382d17332e",
        "g": "4f5cec43fc4200ad",
        "name": "lista en formato html",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": " <h1>Registros: </h1>\n <ul>\n{{#payload}}\n  <li>{{date}} : {{BME280.Temperatura }}ºC, {{BME280.Humedad}}% </li>\n{{/payload}}\n </ul>",
        "output": "str",
        "x": 880,
        "y": 820,
        "wires": [
            [
                "fdd6d82ca6c347e1"
            ]
        ]
    },
    {
        "id": "fdd6d82ca6c347e1",
        "type": "ui_template",
        "z": "75eea1382d17332e",
        "g": "4f5cec43fc4200ad",
        "group": "24a2032a9df17ba3",
        "name": "",
        "order": 3,
        "width": "6",
        "height": "4",
        "format": "<div ng-bind-html=\"msg.payload\"></div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": false,
        "templateScope": "local",
        "className": "",
        "x": 1080,
        "y": 820,
        "wires": [
            []
        ]
    },
    {
        "id": "9a39cdd28bddc058",
        "type": "complete",
        "z": "75eea1382d17332e",
        "g": "4f5cec43fc4200ad",
        "name": "",
        "scope": [
            "591c77a9793c708d"
        ],
        "uncaught": false,
        "x": 130,
        "y": 820,
        "wires": [
            [
                "b56732462606b9af"
            ]
        ]
    },
    {
        "id": "653b079df9522d00",
        "type": "debug",
        "z": "75eea1382d17332e",
        "g": "4f5cec43fc4200ad",
        "name": "debug 3",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 900,
        "y": 880,
        "wires": []
    },
    {
        "id": "6f4d50e205eb162b",
        "type": "mongodb in",
        "z": "75eea1382d17332e",
        "g": "4f5cec43fc4200ad",
        "mongodb": "05cea6759e795a87",
        "name": "",
        "collection": "datos",
        "operation": "find",
        "x": 600,
        "y": 820,
        "wires": [
            [
                "6be94e771d69de4a",
                "653b079df9522d00"
            ]
        ]
    },
    {
        "id": "59748828a812a89b",
        "type": "mqtt in",
        "z": "7a16d1d00dfc8197",
        "g": "c7c0429a558afdbb",
        "name": "",
        "topic": "iot/datos/json",
        "qos": "2",
        "datatype": "auto",
        "broker": "c8b2b5778aed34b0",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 110,
        "y": 160,
        "wires": [
            [
                "d3c0f3815c2be508"
            ]
        ]
    },
    {
        "id": "802965d63aa780f9",
        "type": "debug",
        "z": "7a16d1d00dfc8197",
        "g": "c7c0429a558afdbb",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 470,
        "y": 120,
        "wires": []
    },
    {
        "id": "d3c0f3815c2be508",
        "type": "json",
        "z": "7a16d1d00dfc8197",
        "g": "c7c0429a558afdbb",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 290,
        "y": 160,
        "wires": [
            [
                "802965d63aa780f9",
                "dfc1fbfc52694eb9",
                "81f681fdf7787ad4"
            ]
        ]
    },
    {
        "id": "dfc1fbfc52694eb9",
        "type": "change",
        "z": "7a16d1d00dfc8197",
        "g": "c7c0429a558afdbb",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.BME280.Temperatura",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 480,
        "y": 160,
        "wires": [
            [
                "95333310b95e92fa"
            ]
        ]
    },
    {
        "id": "95333310b95e92fa",
        "type": "debug",
        "z": "7a16d1d00dfc8197",
        "g": "c7c0429a558afdbb",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 670,
        "y": 160,
        "wires": []
    },
    {
        "id": "81f681fdf7787ad4",
        "type": "change",
        "z": "7a16d1d00dfc8197",
        "g": "c7c0429a558afdbb",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.uptime_ms",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 480,
        "y": 200,
        "wires": [
            [
                "2a8f15b29bcad07a"
            ]
        ]
    },
    {
        "id": "2a8f15b29bcad07a",
        "type": "debug",
        "z": "7a16d1d00dfc8197",
        "g": "c7c0429a558afdbb",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 670,
        "y": 200,
        "wires": []
    },
    {
        "id": "d0a952bb3fdf3e13",
        "type": "comment",
        "z": "7a16d1d00dfc8197",
        "g": "c7c0429a558afdbb",
        "name": "Como trabajar con JSON - Ejemplo de la clase",
        "info": "",
        "x": 730,
        "y": 60,
        "wires": []
    },
    {
        "id": "4cb8f01d2df3d74f",
        "type": "function",
        "z": "7a16d1d00dfc8197",
        "g": "b8c01bdb213bdf2a",
        "name": "",
        "func": "var fecha = new Date();\n\nmsg.payload = fecha.toLocaleString('es-ES', { timeZone: 'Europe/Madrid', hour12: false });\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1500,
        "y": 140,
        "wires": [
            [
                "e2055f0387091010"
            ]
        ]
    },
    {
        "id": "ac467beb4fa9e5cd",
        "type": "ui_chart",
        "z": "7a16d1d00dfc8197",
        "g": "3257a317712f0b5d",
        "name": "",
        "group": "386ddfb962d0c80d",
        "order": 2,
        "width": "0",
        "height": "0",
        "label": "Presión (mbar)",
        "chartType": "line",
        "legend": "true",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1780,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "0bf89d5da91f6860",
        "type": "change",
        "z": "7a16d1d00dfc8197",
        "g": "3257a317712f0b5d",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Presión",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1510,
        "y": 380,
        "wires": [
            [
                "ac467beb4fa9e5cd"
            ]
        ]
    },
    {
        "id": "0c22465deb2518f3",
        "type": "inject",
        "z": "7a16d1d00dfc8197",
        "g": "3257a317712f0b5d",
        "name": "Reset chart",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "[ ]",
        "payloadType": "json",
        "x": 1510,
        "y": 440,
        "wires": [
            [
                "ac467beb4fa9e5cd"
            ]
        ]
    },
    {
        "id": "a75ae4d1e0601868",
        "type": "ui_led",
        "z": "7a16d1d00dfc8197",
        "g": "b8c01bdb213bdf2a",
        "order": 3,
        "group": "6d8ffaa69a25c68f",
        "width": "4",
        "height": "1",
        "label": "LED",
        "labelPlacement": "left",
        "labelAlignment": "center",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "1",
                "valueType": "num"
            },
            {
                "color": "#9a9996",
                "value": "0",
                "valueType": "num"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 1810,
        "y": 100,
        "wires": []
    },
    {
        "id": "da6150a919471ea8",
        "type": "ui_led",
        "z": "7a16d1d00dfc8197",
        "g": "b8c01bdb213bdf2a",
        "order": 3,
        "group": "e8ccf6ad47502312",
        "width": "4",
        "height": "1",
        "label": "LED ",
        "labelPlacement": "left",
        "labelAlignment": "center",
        "colorForValue": [
            {
                "color": "#33d17a",
                "value": "1",
                "valueType": "num"
            },
            {
                "color": "#9a9996",
                "value": "0",
                "valueType": "num"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 1810,
        "y": 240,
        "wires": []
    },
    {
        "id": "e2055f0387091010",
        "type": "ui_text",
        "z": "7a16d1d00dfc8197",
        "g": "b8c01bdb213bdf2a",
        "group": "6d8ffaa69a25c68f",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Última actualización",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1760,
        "y": 140,
        "wires": []
    },
    {
        "id": "68c887ccacdcc65f",
        "type": "ui_text",
        "z": "7a16d1d00dfc8197",
        "g": "b8c01bdb213bdf2a",
        "group": "e8ccf6ad47502312",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Última actualización",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "<style>     #nr-dashboard-cardtitle{text-align: center !important;} </style>",
        "x": 1760,
        "y": 280,
        "wires": []
    },
    {
        "id": "5cdcf77d76247d41",
        "type": "function",
        "z": "7a16d1d00dfc8197",
        "g": "b8c01bdb213bdf2a",
        "name": "",
        "func": "var fecha = new Date();\n\nmsg.payload = fecha.toLocaleString('es-ES', { timeZone: 'Europe/Madrid', hour12: false });\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1500,
        "y": 280,
        "wires": [
            [
                "68c887ccacdcc65f"
            ]
        ]
    },
    {
        "id": "4f7466319b72ba9f",
        "type": "ui_text",
        "z": "7a16d1d00dfc8197",
        "g": "b8c01bdb213bdf2a",
        "group": "e8ccf6ad47502312",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Estado:",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1800,
        "y": 200,
        "wires": []
    },
    {
        "id": "90081377270e04ad",
        "type": "function",
        "z": "7a16d1d00dfc8197",
        "g": "b8c01bdb213bdf2a",
        "name": "",
        "func": "switch (msg.payload) {\n    case 0:\n        msg.payload = \"Apagado\";\n        break;\n    default:\n        msg.payload = \"Encendido\";\n        break;\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1500,
        "y": 200,
        "wires": [
            [
                "4f7466319b72ba9f"
            ]
        ]
    },
    {
        "id": "98d40d99ba4151d8",
        "type": "function",
        "z": "7a16d1d00dfc8197",
        "g": "b8c01bdb213bdf2a",
        "name": "",
        "func": "switch (msg.payload) {\n    case 0:\n        msg.payload = \"Apagado\";\n        break;\n    default:\n        msg.payload = \"Encendido\";\n        break;\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1500,
        "y": 60,
        "wires": [
            [
                "9af423a7bb2d837b"
            ]
        ]
    },
    {
        "id": "9af423a7bb2d837b",
        "type": "ui_text",
        "z": "7a16d1d00dfc8197",
        "g": "b8c01bdb213bdf2a",
        "group": "6d8ffaa69a25c68f",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Estado:",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1800,
        "y": 60,
        "wires": []
    },
    {
        "id": "df8576ebbb006b55",
        "type": "change",
        "z": "7a16d1d00dfc8197",
        "g": "bd1d576d98dfa972",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "humedad",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1530,
        "y": 540,
        "wires": [
            [
                "0dade4400d16e36b"
            ]
        ]
    },
    {
        "id": "0dade4400d16e36b",
        "type": "ui_gauge",
        "z": "7a16d1d00dfc8197",
        "g": "bd1d576d98dfa972",
        "name": "",
        "group": "8599d9afed430a9d",
        "order": 1,
        "width": 0,
        "height": 0,
        "gtype": "wave",
        "title": "Humedad",
        "label": "%",
        "format": "{{value}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 1800,
        "y": 540,
        "wires": []
    },
    {
        "id": "a3e895b119eb3e8a",
        "type": "ui_button",
        "z": "7a16d1d00dfc8197",
        "g": "3d2c5d33e37d6dbc",
        "name": "",
        "group": "6d8ffaa69a25c68f",
        "order": 1,
        "width": "1",
        "height": "1",
        "passthru": false,
        "label": "On",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "{\"led\" : \"rojo\", \"orden\" : 1}",
        "payloadType": "json",
        "topic": "topic",
        "topicType": "msg",
        "x": 2010,
        "y": 80,
        "wires": [
            [
                "d4e8dcae1e01bbde"
            ]
        ]
    },
    {
        "id": "cdeccc9446a56f4d",
        "type": "ui_button",
        "z": "7a16d1d00dfc8197",
        "g": "3d2c5d33e37d6dbc",
        "name": "",
        "group": "6d8ffaa69a25c68f",
        "order": 2,
        "width": "1",
        "height": "1",
        "passthru": false,
        "label": "Off",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "{\"led\" : \"rojo\", \"orden\" : 0}",
        "payloadType": "json",
        "topic": "topic",
        "topicType": "msg",
        "x": 2010,
        "y": 120,
        "wires": [
            [
                "d4e8dcae1e01bbde"
            ]
        ]
    },
    {
        "id": "a575f5aa8818b254",
        "type": "ui_button",
        "z": "7a16d1d00dfc8197",
        "g": "468e6c6d4d6b1f4f",
        "name": "",
        "group": "e8ccf6ad47502312",
        "order": 1,
        "width": "1",
        "height": "1",
        "passthru": false,
        "label": "On",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "{\"led\" : \"verde\", \"orden\" : 1}",
        "payloadType": "json",
        "topic": "topic",
        "topicType": "msg",
        "x": 2010,
        "y": 220,
        "wires": [
            [
                "2de928be198426c0"
            ]
        ]
    },
    {
        "id": "5a74bade7286704b",
        "type": "ui_button",
        "z": "7a16d1d00dfc8197",
        "g": "468e6c6d4d6b1f4f",
        "name": "",
        "group": "e8ccf6ad47502312",
        "order": 2,
        "width": "1",
        "height": "1",
        "passthru": false,
        "label": "Off",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "{\"led\" : \"verde\", \"orden\" : 0}",
        "payloadType": "json",
        "topic": "topic",
        "topicType": "msg",
        "x": 2010,
        "y": 260,
        "wires": [
            [
                "2de928be198426c0"
            ]
        ]
    },
    {
        "id": "e0764da71cdb6c9d",
        "type": "function",
        "z": "7a16d1d00dfc8197",
        "g": "dbca49f1bd3c48a5",
        "name": "",
        "func": "msg.topic = \"temperatura\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1560,
        "y": 640,
        "wires": [
            [
                "42fac8ce51fd0a3a"
            ]
        ]
    },
    {
        "id": "586df285533f6f31",
        "type": "ui_text",
        "z": "7a16d1d00dfc8197",
        "g": "dbca49f1bd3c48a5",
        "group": "60916e8014cfd3f7",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Última actualización",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1760,
        "y": 680,
        "wires": []
    },
    {
        "id": "df88c371cc0be2e4",
        "type": "function",
        "z": "7a16d1d00dfc8197",
        "g": "dbca49f1bd3c48a5",
        "name": "",
        "func": "var fecha = new Date();\n\nmsg.payload = fecha.toLocaleString('es-ES', { timeZone: 'Europe/Madrid', hour12: false });\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1560,
        "y": 680,
        "wires": [
            [
                "586df285533f6f31"
            ]
        ]
    },
    {
        "id": "4d5bb2109cea33e8",
        "type": "smooth",
        "z": "7a16d1d00dfc8197",
        "g": "dbca49f1bd3c48a5",
        "name": "",
        "property": "payload",
        "action": "mean",
        "count": "6",
        "round": "2",
        "mult": "single",
        "reduce": false,
        "x": 1360,
        "y": 800,
        "wires": [
            [
                "5704ab749fabf2e9"
            ]
        ]
    },
    {
        "id": "adc396252b607fcf",
        "type": "ui_chart",
        "z": "7a16d1d00dfc8197",
        "g": "dbca49f1bd3c48a5",
        "name": "",
        "group": "60916e8014cfd3f7",
        "order": 3,
        "width": 0,
        "height": 0,
        "label": "Temperatura (ºC)",
        "chartType": "line",
        "legend": "true",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1770,
        "y": 720,
        "wires": [
            []
        ]
    },
    {
        "id": "81bd016eeeb4be54",
        "type": "inject",
        "z": "7a16d1d00dfc8197",
        "g": "dbca49f1bd3c48a5",
        "name": "Reset chart",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "[ ]",
        "payloadType": "json",
        "x": 1550,
        "y": 720,
        "wires": [
            [
                "adc396252b607fcf"
            ]
        ]
    },
    {
        "id": "1938fe3092c18ea1",
        "type": "change",
        "z": "7a16d1d00dfc8197",
        "g": "dbca49f1bd3c48a5",
        "name": "Actual",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "temperatura_actual",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1350,
        "y": 760,
        "wires": [
            [
                "4d5bb2109cea33e8",
                "d882a0a8d0875314"
            ]
        ]
    },
    {
        "id": "42fac8ce51fd0a3a",
        "type": "ui_gauge",
        "z": "7a16d1d00dfc8197",
        "g": "dbca49f1bd3c48a5",
        "name": "",
        "group": "60916e8014cfd3f7",
        "order": 2,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Temperatura",
        "label": "ºC",
        "format": "{{value}}",
        "min": "-5",
        "max": "50",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 1790,
        "y": 640,
        "wires": []
    },
    {
        "id": "5704ab749fabf2e9",
        "type": "change",
        "z": "7a16d1d00dfc8197",
        "g": "dbca49f1bd3c48a5",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "temperatura_media",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1370,
        "y": 840,
        "wires": [
            [
                "d882a0a8d0875314"
            ]
        ]
    },
    {
        "id": "d882a0a8d0875314",
        "type": "function",
        "z": "7a16d1d00dfc8197",
        "g": "dbca49f1bd3c48a5",
        "name": "Diferencia actual y media",
        "func": "var msg1 = {};\nvar msg2 = {};\nvar msg3 = {};\ncontext.data = context.data || {};\nswitch (msg.topic){\n    case \"temperatura_media\":\n        context.data.temperatura_media = msg.payload;\n        msg = null;\n        break;\n    case \"temperatura_actual\":\n        context.data.temperatura_actual = msg.payload;\n        msg = null;\n        break;\n    default:\n        msg = null;\n        break;\n}\n\nif (context.data.temperatura_actual != null && context.data.temperatura_media != null){\n    msg1.payload = Math.abs(context.data.temperatura_actual-context.data.temperatura_media);\n    msg1.topic = \"Diferencia\";\n    msg2.payload = context.data.temperatura_actual;\n    msg2.topic = \"Actual\";\n    msg3.payload = context.data.temperatura_media;\n    msg3.topic = \"Media\";\n    context.data = null;\n    return [msg1, msg2, msg3];\n}else {return msg;}",
        "outputs": 3,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1590,
        "y": 800,
        "wires": [
            [
                "adc396252b607fcf"
            ],
            [
                "adc396252b607fcf"
            ],
            [
                "adc396252b607fcf"
            ]
        ]
    },
    {
        "id": "f6032ef4a6cd9a63",
        "type": "switch",
        "z": "7a16d1d00dfc8197",
        "g": "dbca49f1bd3c48a5",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "gte",
                "v": "25",
                "vt": "num"
            },
            {
                "t": "lt",
                "v": "25",
                "vt": "num"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 1350,
        "y": 940,
        "wires": [
            [
                "c66a0a61f42d9796",
                "4b1991113899510a"
            ],
            [
                "79ece79b8d5b4b0c",
                "7cb53c8f3869c255"
            ]
        ]
    },
    {
        "id": "c66a0a61f42d9796",
        "type": "change",
        "z": "7a16d1d00dfc8197",
        "g": "dbca49f1bd3c48a5",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "off",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"led\" : \"rojo\", \"orden\" : 0}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1560,
        "y": 920,
        "wires": [
            [
                "974389dfd6e7f220"
            ]
        ]
    },
    {
        "id": "79ece79b8d5b4b0c",
        "type": "change",
        "z": "7a16d1d00dfc8197",
        "g": "dbca49f1bd3c48a5",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "on",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"led\" : \"verde\", \"orden\" : 1}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1560,
        "y": 960,
        "wires": [
            [
                "974389dfd6e7f220"
            ]
        ]
    },
    {
        "id": "7cb53c8f3869c255",
        "type": "change",
        "z": "7a16d1d00dfc8197",
        "g": "dbca49f1bd3c48a5",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "off",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"led\" : \"rojo\", \"orden\" : 0}",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1560,
        "y": 1000,
        "wires": [
            [
                "cb380d0e41af31f9"
            ]
        ]
    },
    {
        "id": "4b1991113899510a",
        "type": "change",
        "z": "7a16d1d00dfc8197",
        "g": "dbca49f1bd3c48a5",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "on",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"led\" : \"rojo\", \"orden\" : 1}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1560,
        "y": 880,
        "wires": [
            [
                "cb380d0e41af31f9"
            ]
        ]
    },
    {
        "id": "b7ae8fed5888903a",
        "type": "inject",
        "z": "7a16d1d00dfc8197",
        "g": "dbca49f1bd3c48a5",
        "name": "36",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "36",
        "payloadType": "num",
        "x": 1290,
        "y": 1000,
        "wires": [
            [
                "f6032ef4a6cd9a63"
            ]
        ]
    },
    {
        "id": "f65447cd6de160aa",
        "type": "mqtt in",
        "z": "7a16d1d00dfc8197",
        "g": "041b608dd6eb6675",
        "name": "",
        "topic": "iot/datos/json",
        "qos": "2",
        "datatype": "auto",
        "broker": "c8b2b5778aed34b0",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 110,
        "y": 320,
        "wires": [
            [
                "799272e0826da5f6"
            ]
        ]
    },
    {
        "id": "799272e0826da5f6",
        "type": "json",
        "z": "7a16d1d00dfc8197",
        "g": "041b608dd6eb6675",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 450,
        "y": 320,
        "wires": [
            [
                "79275135c0703271"
            ]
        ]
    },
    {
        "id": "27817793bcf88e31",
        "type": "change",
        "z": "7a16d1d00dfc8197",
        "g": "b8c01bdb213bdf2a",
        "name": "Estado LED Rojo",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.LEDs.Rojo",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1310,
        "y": 100,
        "wires": [
            [
                "98d40d99ba4151d8",
                "a75ae4d1e0601868",
                "4cb8f01d2df3d74f"
            ]
        ]
    },
    {
        "id": "f25ae044dbb399de",
        "type": "change",
        "z": "7a16d1d00dfc8197",
        "g": "b8c01bdb213bdf2a",
        "name": "Estado LED verde",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.LEDs.Verde",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1310,
        "y": 240,
        "wires": [
            [
                "90081377270e04ad",
                "da6150a919471ea8",
                "5cdcf77d76247d41"
            ]
        ]
    },
    {
        "id": "c74bc10f4d3ffd14",
        "type": "change",
        "z": "7a16d1d00dfc8197",
        "g": "3257a317712f0b5d",
        "name": "Presión",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.BME280.Presion",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 380,
        "wires": [
            [
                "0bf89d5da91f6860"
            ]
        ]
    },
    {
        "id": "8a82934c652213bc",
        "type": "change",
        "z": "7a16d1d00dfc8197",
        "g": "bd1d576d98dfa972",
        "name": "Humedad",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.BME280.Humedad",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 540,
        "wires": [
            [
                "df8576ebbb006b55"
            ]
        ]
    },
    {
        "id": "a067e5a35fbb5be2",
        "type": "change",
        "z": "7a16d1d00dfc8197",
        "g": "dbca49f1bd3c48a5",
        "name": "Temperatura",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.BME280.Temperatura",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 640,
        "wires": [
            [
                "e0764da71cdb6c9d",
                "df88c371cc0be2e4",
                "1938fe3092c18ea1",
                "f6032ef4a6cd9a63"
            ]
        ]
    },
    {
        "id": "75e116c16eee6f2f",
        "type": "smooth",
        "z": "7a16d1d00dfc8197",
        "g": "56f47bfd6c62f39d",
        "name": "",
        "property": "payload",
        "action": "max",
        "count": "100",
        "round": "",
        "mult": "single",
        "reduce": false,
        "x": 360,
        "y": 500,
        "wires": [
            [
                "9c1fcf13d5ed9ff8"
            ]
        ]
    },
    {
        "id": "e4c0e07228390da8",
        "type": "ui_text",
        "z": "7a16d1d00dfc8197",
        "g": "56f47bfd6c62f39d",
        "group": "3d72c6d43da61785",
        "order": 7,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Tiempo de funcionamiento",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 770,
        "y": 800,
        "wires": []
    },
    {
        "id": "ebe2bb9ad1bb9cdb",
        "type": "change",
        "z": "7a16d1d00dfc8197",
        "g": "56f47bfd6c62f39d",
        "name": "uptime_ms",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.uptime_ms",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "uptime_ms",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 190,
        "y": 800,
        "wires": [
            [
                "5775f9d37e91db3b"
            ]
        ]
    },
    {
        "id": "f030180e4bfe3703",
        "type": "smooth",
        "z": "7a16d1d00dfc8197",
        "g": "56f47bfd6c62f39d",
        "name": "",
        "property": "payload",
        "action": "min",
        "count": "100",
        "round": "",
        "mult": "single",
        "reduce": false,
        "x": 360,
        "y": 560,
        "wires": [
            [
                "5caacceb8ded1f96"
            ]
        ]
    },
    {
        "id": "5caacceb8ded1f96",
        "type": "ui_text",
        "z": "7a16d1d00dfc8197",
        "g": "56f47bfd6c62f39d",
        "group": "3d72c6d43da61785",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": " RSSI mínimo",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 820,
        "y": 560,
        "wires": []
    },
    {
        "id": "9c1fcf13d5ed9ff8",
        "type": "ui_text",
        "z": "7a16d1d00dfc8197",
        "g": "56f47bfd6c62f39d",
        "group": "3d72c6d43da61785",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": " RSSI máximo",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 820,
        "y": 500,
        "wires": []
    },
    {
        "id": "5775f9d37e91db3b",
        "type": "function",
        "z": "7a16d1d00dfc8197",
        "g": "56f47bfd6c62f39d",
        "name": "",
        "func": "var ms = msg.payload;\nconst days = Math.floor(ms / (24 * 60 * 60 * 1000));\nconst daysms = ms % (24 * 60 * 60 * 1000);\nconst hours = Math.floor(daysms / (60 * 60 * 1000));\nconst hoursms = ms % (60 * 60 * 1000);\nconst minutes = Math.floor(hoursms / (60 * 1000));\nconst minutesms = ms % (60 * 1000);\nmsg.payload = {};\nmsg.payload = days + \" días \" + hours + \"h \" + minutes + \"m \";\nreturn msg",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 440,
        "y": 800,
        "wires": [
            [
                "e4c0e07228390da8"
            ]
        ]
    },
    {
        "id": "3918e1aced349285",
        "type": "link in",
        "z": "7a16d1d00dfc8197",
        "g": "b8c01bdb213bdf2a",
        "name": "Salida_json",
        "links": [
            "79275135c0703271",
            "ca41f1007c32e3c3"
        ],
        "x": 1135,
        "y": 100,
        "wires": [
            [
                "27817793bcf88e31"
            ]
        ]
    },
    {
        "id": "79275135c0703271",
        "type": "link out",
        "z": "7a16d1d00dfc8197",
        "g": "041b608dd6eb6675",
        "name": "Salida_json",
        "links": [
            "3918e1aced349285",
            "101e32c11977c276",
            "1d774783e282a20a",
            "64a56b2722da04c3",
            "928dcbeb51fc5086",
            "5a66b6806f77c5af",
            "25eb006b1666ca7f",
            "7ae171d59544969a",
            "39e932748ff43175",
            "081d3184c85328e8",
            "cb2954d6c2be0874",
            "7675caa924841d24",
            "db2eadd8ec509eb4",
            "cecdf7cfdcccd41b",
            "4941fbcb1f9c03cf",
            "beed1420c3d87fff",
            "d8eeb12df7891916",
            "5d14b82297f7ba81",
            "8ae5b84bd31d03da",
            "5edea480ab8a051b",
            "1f597d2636989d4f",
            "52d87709f6176090",
            "d02bca1c3752a1b1",
            "7547bfad5a02511d",
            "b067b408b502966a",
            "94d8182d038b09cf",
            "c643aead9980b2f5",
            "5bdefd42a80b318e",
            "39bc11bb85879eb6",
            "743b935e2b14ddda",
            "11d036d1910fb8cc",
            "fd83f404d2822d12",
            "cfeb876b04368a8d",
            "3f191666db19b70b"
        ],
        "x": 895,
        "y": 320,
        "wires": []
    },
    {
        "id": "101e32c11977c276",
        "type": "link in",
        "z": "7a16d1d00dfc8197",
        "g": "b8c01bdb213bdf2a",
        "name": "Salida_json",
        "links": [
            "79275135c0703271",
            "ca41f1007c32e3c3"
        ],
        "x": 1135,
        "y": 240,
        "wires": [
            [
                "f25ae044dbb399de"
            ]
        ]
    },
    {
        "id": "1d774783e282a20a",
        "type": "link in",
        "z": "7a16d1d00dfc8197",
        "g": "3257a317712f0b5d",
        "name": "Salida_json",
        "links": [
            "79275135c0703271",
            "ca41f1007c32e3c3"
        ],
        "x": 1135,
        "y": 380,
        "wires": [
            [
                "c74bc10f4d3ffd14"
            ]
        ]
    },
    {
        "id": "64a56b2722da04c3",
        "type": "link in",
        "z": "7a16d1d00dfc8197",
        "g": "bd1d576d98dfa972",
        "name": "Salida_json",
        "links": [
            "79275135c0703271",
            "ca41f1007c32e3c3"
        ],
        "x": 1135,
        "y": 540,
        "wires": [
            [
                "8a82934c652213bc"
            ]
        ]
    },
    {
        "id": "928dcbeb51fc5086",
        "type": "link in",
        "z": "7a16d1d00dfc8197",
        "g": "dbca49f1bd3c48a5",
        "name": "Salida_json",
        "links": [
            "79275135c0703271",
            "ca41f1007c32e3c3"
        ],
        "x": 1135,
        "y": 640,
        "wires": [
            [
                "a067e5a35fbb5be2"
            ]
        ]
    },
    {
        "id": "25eb006b1666ca7f",
        "type": "link in",
        "z": "7a16d1d00dfc8197",
        "g": "56f47bfd6c62f39d",
        "name": "Salida_json",
        "links": [
            "79275135c0703271",
            "ca41f1007c32e3c3"
        ],
        "x": 55,
        "y": 500,
        "wires": [
            [
                "b0309b7f2c71a620"
            ]
        ]
    },
    {
        "id": "7ae171d59544969a",
        "type": "link in",
        "z": "7a16d1d00dfc8197",
        "g": "56f47bfd6c62f39d",
        "name": "Salida_json",
        "links": [
            "79275135c0703271",
            "ca41f1007c32e3c3"
        ],
        "x": 55,
        "y": 560,
        "wires": [
            [
                "8805564321fdfd81"
            ]
        ]
    },
    {
        "id": "39e932748ff43175",
        "type": "link in",
        "z": "7a16d1d00dfc8197",
        "g": "56f47bfd6c62f39d",
        "name": "Salida_json",
        "links": [
            "79275135c0703271",
            "ca41f1007c32e3c3"
        ],
        "x": 55,
        "y": 800,
        "wires": [
            [
                "ebe2bb9ad1bb9cdb"
            ]
        ]
    },
    {
        "id": "d54d2b8c330c2a35",
        "type": "ui_text",
        "z": "7a16d1d00dfc8197",
        "g": "56f47bfd6c62f39d",
        "group": "3d72c6d43da61785",
        "order": 8,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "interval_s",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 820,
        "y": 860,
        "wires": []
    },
    {
        "id": "7675caa924841d24",
        "type": "link in",
        "z": "7a16d1d00dfc8197",
        "g": "56f47bfd6c62f39d",
        "name": "Salida_json",
        "links": [
            "79275135c0703271",
            "ca41f1007c32e3c3"
        ],
        "x": 55,
        "y": 440,
        "wires": [
            [
                "b40246d5cdcbf5ab"
            ]
        ]
    },
    {
        "id": "b40246d5cdcbf5ab",
        "type": "change",
        "z": "7a16d1d00dfc8197",
        "g": "56f47bfd6c62f39d",
        "name": "SSID",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.SSID",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "SSID",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 170,
        "y": 440,
        "wires": [
            [
                "e6d1ad2858e87d28"
            ]
        ]
    },
    {
        "id": "e6d1ad2858e87d28",
        "type": "ui_text",
        "z": "7a16d1d00dfc8197",
        "g": "56f47bfd6c62f39d",
        "group": "3d72c6d43da61785",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "SSID",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 850,
        "y": 440,
        "wires": []
    },
    {
        "id": "97281a27e3228f6d",
        "type": "change",
        "z": "7a16d1d00dfc8197",
        "g": "56f47bfd6c62f39d",
        "name": "RSSI",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.RSSI",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "RSSI",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 170,
        "y": 620,
        "wires": [
            [
                "4cee9caf880dbf75"
            ]
        ]
    },
    {
        "id": "db2eadd8ec509eb4",
        "type": "link in",
        "z": "7a16d1d00dfc8197",
        "g": "56f47bfd6c62f39d",
        "name": "Salida_json",
        "links": [
            "79275135c0703271",
            "ca41f1007c32e3c3"
        ],
        "x": 55,
        "y": 620,
        "wires": [
            [
                "97281a27e3228f6d"
            ]
        ]
    },
    {
        "id": "4cee9caf880dbf75",
        "type": "ui_text",
        "z": "7a16d1d00dfc8197",
        "g": "56f47bfd6c62f39d",
        "group": "3d72c6d43da61785",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "RSSI",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 850,
        "y": 620,
        "wires": []
    },
    {
        "id": "cecdf7cfdcccd41b",
        "type": "link in",
        "z": "7a16d1d00dfc8197",
        "g": "56f47bfd6c62f39d",
        "name": "Salida_json",
        "links": [
            "79275135c0703271",
            "ca41f1007c32e3c3"
        ],
        "x": 55,
        "y": 680,
        "wires": [
            [
                "289daa805cbc742e"
            ]
        ]
    },
    {
        "id": "289daa805cbc742e",
        "type": "change",
        "z": "7a16d1d00dfc8197",
        "g": "56f47bfd6c62f39d",
        "name": "localIP",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.localIP",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "localIP",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 180,
        "y": 680,
        "wires": [
            [
                "9eddd2aa8bce368b"
            ]
        ]
    },
    {
        "id": "9eddd2aa8bce368b",
        "type": "ui_text",
        "z": "7a16d1d00dfc8197",
        "g": "56f47bfd6c62f39d",
        "group": "3d72c6d43da61785",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "localIP",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 840,
        "y": 680,
        "wires": []
    },
    {
        "id": "a2429eed43b732b0",
        "type": "ui_text",
        "z": "7a16d1d00dfc8197",
        "g": "56f47bfd6c62f39d",
        "group": "3d72c6d43da61785",
        "order": 6,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "macAddress",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 830,
        "y": 740,
        "wires": []
    },
    {
        "id": "9466fa22036a1157",
        "type": "change",
        "z": "7a16d1d00dfc8197",
        "g": "56f47bfd6c62f39d",
        "name": "macAddress",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.macAddress",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "macAddress",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 190,
        "y": 740,
        "wires": [
            [
                "a2429eed43b732b0"
            ]
        ]
    },
    {
        "id": "4941fbcb1f9c03cf",
        "type": "link in",
        "z": "7a16d1d00dfc8197",
        "g": "56f47bfd6c62f39d",
        "name": "Salida_json",
        "links": [
            "79275135c0703271",
            "ca41f1007c32e3c3"
        ],
        "x": 55,
        "y": 740,
        "wires": [
            [
                "9466fa22036a1157"
            ]
        ]
    },
    {
        "id": "a49bbd13db558966",
        "type": "mqtt in",
        "z": "7a16d1d00dfc8197",
        "g": "f852a0b06ec1fb53",
        "name": "",
        "topic": "iot/datos/json",
        "qos": "2",
        "datatype": "auto",
        "broker": "64cdcf7a3b4cd223",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 110,
        "y": 1060,
        "wires": [
            [
                "9fbdab756e4eec55"
            ]
        ]
    },
    {
        "id": "88ec140e74fb1777",
        "type": "range",
        "z": "7a16d1d00dfc8197",
        "g": "f852a0b06ec1fb53",
        "minin": "0",
        "maxin": "1023",
        "minout": "0",
        "maxout": "100",
        "action": "scale",
        "round": false,
        "property": "payload",
        "name": "",
        "x": 600,
        "y": 1060,
        "wires": [
            [
                "954c0d76d404f264"
            ]
        ]
    },
    {
        "id": "954c0d76d404f264",
        "type": "ui_gauge",
        "z": "7a16d1d00dfc8197",
        "g": "f852a0b06ec1fb53",
        "name": "",
        "group": "bf64e5c6fbbba3c3",
        "order": 0,
        "width": 0,
        "height": 0,
        "gtype": "donut",
        "title": "Dato ADC - método 2",
        "label": "%",
        "format": "{{value | number:1}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 880,
        "y": 1060,
        "wires": []
    },
    {
        "id": "9fbdab756e4eec55",
        "type": "json",
        "z": "7a16d1d00dfc8197",
        "g": "f852a0b06ec1fb53",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 270,
        "y": 1060,
        "wires": [
            [
                "19ecfa97bba1fbeb"
            ]
        ]
    },
    {
        "id": "19ecfa97bba1fbeb",
        "type": "change",
        "z": "7a16d1d00dfc8197",
        "g": "f852a0b06ec1fb53",
        "name": "Iluminación",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.ADC.Iluminacion",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Iluminacion",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 430,
        "y": 1060,
        "wires": [
            [
                "88ec140e74fb1777"
            ]
        ]
    },
    {
        "id": "7498e7d5edf5c8b1",
        "type": "change",
        "z": "7a16d1d00dfc8197",
        "g": "56f47bfd6c62f39d",
        "name": "interval_s",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.interval_s",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "interval_s",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 190,
        "y": 860,
        "wires": [
            [
                "d54d2b8c330c2a35"
            ]
        ]
    },
    {
        "id": "cb2954d6c2be0874",
        "type": "link in",
        "z": "7a16d1d00dfc8197",
        "g": "56f47bfd6c62f39d",
        "name": "Salida_json",
        "links": [
            "79275135c0703271",
            "ca41f1007c32e3c3"
        ],
        "x": 55,
        "y": 860,
        "wires": [
            [
                "7498e7d5edf5c8b1"
            ]
        ]
    },
    {
        "id": "0a4f9588acac850f",
        "type": "function",
        "z": "7a16d1d00dfc8197",
        "g": "f442450b16d4f47c",
        "name": "",
        "func": "var dato = Number(msg.payload);\nmsg.payload = dato;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 400,
        "y": 960,
        "wires": [
            [
                "6d4e0b39baf6f600"
            ]
        ]
    },
    {
        "id": "6d4e0b39baf6f600",
        "type": "range",
        "z": "7a16d1d00dfc8197",
        "g": "f442450b16d4f47c",
        "minin": "0",
        "maxin": "1023",
        "minout": "0",
        "maxout": "100",
        "action": "scale",
        "round": false,
        "property": "payload",
        "name": "",
        "x": 620,
        "y": 960,
        "wires": [
            [
                "52335c1dfa0dc709"
            ]
        ]
    },
    {
        "id": "52335c1dfa0dc709",
        "type": "ui_gauge",
        "z": "7a16d1d00dfc8197",
        "g": "f442450b16d4f47c",
        "name": "",
        "group": "bf64e5c6fbbba3c3",
        "order": 0,
        "width": 0,
        "height": 0,
        "gtype": "donut",
        "title": "Dato ADC - método 1",
        "label": "%",
        "format": "{{value | number:1}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 880,
        "y": 960,
        "wires": []
    },
    {
        "id": "4ebf5669ba48e5b0",
        "type": "change",
        "z": "7a16d1d00dfc8197",
        "g": "f442450b16d4f47c",
        "name": "ADC Iluminacion",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.ADC.Iluminacion",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Iluminacion",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 210,
        "y": 960,
        "wires": [
            [
                "0a4f9588acac850f"
            ]
        ]
    },
    {
        "id": "5d14b82297f7ba81",
        "type": "link in",
        "z": "7a16d1d00dfc8197",
        "g": "f442450b16d4f47c",
        "name": "Salida_json",
        "links": [
            "79275135c0703271",
            "ca41f1007c32e3c3"
        ],
        "x": 55,
        "y": 960,
        "wires": [
            [
                "4ebf5669ba48e5b0"
            ]
        ]
    },
    {
        "id": "8b700da855e04c5a",
        "type": "mqtt out",
        "z": "7a16d1d00dfc8197",
        "name": "",
        "topic": "iot/cmd",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "64cdcf7a3b4cd223",
        "x": 2220,
        "y": 680,
        "wires": []
    },
    {
        "id": "cb380d0e41af31f9",
        "type": "link out",
        "z": "7a16d1d00dfc8197",
        "g": "dbca49f1bd3c48a5",
        "name": "",
        "links": [
            "3ddb962031d30d91"
        ],
        "x": 1715,
        "y": 880,
        "wires": []
    },
    {
        "id": "3ddb962031d30d91",
        "type": "link in",
        "z": "7a16d1d00dfc8197",
        "name": "salida40",
        "links": [
            "cb380d0e41af31f9",
            "974389dfd6e7f220",
            "d4e8dcae1e01bbde",
            "1fcd6ed1f5c0e56b",
            "2de928be198426c0",
            "5f88d082e806c797",
            "bbb20cdb546b67e4",
            "14adc4302a095dcd",
            "1fdb812675334775"
        ],
        "x": 2105,
        "y": 680,
        "wires": [
            [
                "8b700da855e04c5a"
            ]
        ]
    },
    {
        "id": "974389dfd6e7f220",
        "type": "link out",
        "z": "7a16d1d00dfc8197",
        "g": "dbca49f1bd3c48a5",
        "name": "",
        "links": [
            "3ddb962031d30d91"
        ],
        "x": 1715,
        "y": 960,
        "wires": []
    },
    {
        "id": "d4e8dcae1e01bbde",
        "type": "link out",
        "z": "7a16d1d00dfc8197",
        "g": "3d2c5d33e37d6dbc",
        "name": "",
        "links": [
            "3ddb962031d30d91"
        ],
        "x": 2155,
        "y": 100,
        "wires": []
    },
    {
        "id": "2de928be198426c0",
        "type": "link out",
        "z": "7a16d1d00dfc8197",
        "g": "468e6c6d4d6b1f4f",
        "name": "",
        "links": [
            "3ddb962031d30d91"
        ],
        "x": 2155,
        "y": 240,
        "wires": []
    },
    {
        "id": "8805564321fdfd81",
        "type": "change",
        "z": "7a16d1d00dfc8197",
        "g": "56f47bfd6c62f39d",
        "name": "RSSI",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.RSSI",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "RSSI",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 170,
        "y": 560,
        "wires": [
            [
                "f030180e4bfe3703"
            ]
        ]
    },
    {
        "id": "b0309b7f2c71a620",
        "type": "change",
        "z": "7a16d1d00dfc8197",
        "g": "56f47bfd6c62f39d",
        "name": "RSSI",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.conexion.RSSI",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "RSSI",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 170,
        "y": 500,
        "wires": [
            [
                "75e116c16eee6f2f"
            ]
        ]
    },
    {
        "id": "20f3ca81ba60bc3c",
        "type": "mqtt in",
        "z": "0e6efdbc0f657beb",
        "g": "ab8c3f4c897cc372",
        "name": "Estado led rojo",
        "topic": "iot/rojo/estado",
        "qos": "2",
        "datatype": "auto",
        "broker": "64cdcf7a3b4cd223",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 180,
        "y": 100,
        "wires": [
            [
                "6a8bb56259311e2e",
                "d460ae5fa28aa23e"
            ]
        ]
    },
    {
        "id": "cd1d542ade044b6e",
        "type": "mqtt out",
        "z": "0e6efdbc0f657beb",
        "g": "677e44441bd53f9b",
        "name": "Led verde",
        "topic": "iot/verde/cmd",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "64cdcf7a3b4cd223",
        "x": 1260,
        "y": 600,
        "wires": []
    },
    {
        "id": "775e2e8d4707df80",
        "type": "inject",
        "z": "0e6efdbc0f657beb",
        "g": "677e44441bd53f9b",
        "name": "On",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "num",
        "x": 1070,
        "y": 580,
        "wires": [
            [
                "cd1d542ade044b6e"
            ]
        ]
    },
    {
        "id": "40c35a047f906adf",
        "type": "mqtt in",
        "z": "0e6efdbc0f657beb",
        "g": "24141e590783e1a1",
        "name": "Temperatura",
        "topic": "iot/datos/temperatura",
        "qos": "2",
        "datatype": "auto",
        "broker": "64cdcf7a3b4cd223",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 150,
        "y": 640,
        "wires": [
            [
                "fc2e8b0be097732b",
                "b54103c554e4ba82",
                "4e94c5701316cc0b",
                "55d5fb152d4c3a9d"
            ]
        ]
    },
    {
        "id": "9b98909d93690fd6",
        "type": "mqtt in",
        "z": "0e6efdbc0f657beb",
        "g": "14d796290fd84b33",
        "name": "Humedad",
        "topic": "iot/datos/humedad",
        "qos": "2",
        "datatype": "auto",
        "broker": "64cdcf7a3b4cd223",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 140,
        "y": 540,
        "wires": [
            [
                "37bc48b9b1c67b23"
            ]
        ]
    },
    {
        "id": "1d77737950ce731b",
        "type": "mqtt in",
        "z": "0e6efdbc0f657beb",
        "g": "5bb4c6d4afb4abcd",
        "name": "Presión",
        "topic": "iot/datos/presion",
        "qos": "2",
        "datatype": "auto",
        "broker": "64cdcf7a3b4cd223",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 130,
        "y": 380,
        "wires": [
            [
                "685f4482369c0041"
            ]
        ]
    },
    {
        "id": "fc2e8b0be097732b",
        "type": "function",
        "z": "0e6efdbc0f657beb",
        "g": "24141e590783e1a1",
        "name": "",
        "func": "msg.topic = \"temperatura\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 420,
        "y": 640,
        "wires": [
            [
                "11de0c479e604499"
            ]
        ]
    },
    {
        "id": "37bc48b9b1c67b23",
        "type": "change",
        "z": "0e6efdbc0f657beb",
        "g": "14d796290fd84b33",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "humedad",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 390,
        "y": 540,
        "wires": [
            [
                "087515cd867744a8"
            ]
        ]
    },
    {
        "id": "bf0fa0651dbcb639",
        "type": "mqtt out",
        "z": "0e6efdbc0f657beb",
        "g": "dc3604968aa40363",
        "name": "Led rojo",
        "topic": "iot/rojo/cmd",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "64cdcf7a3b4cd223",
        "x": 1260,
        "y": 440,
        "wires": []
    },
    {
        "id": "12b09a43e03cd7c3",
        "type": "inject",
        "z": "0e6efdbc0f657beb",
        "g": "dc3604968aa40363",
        "name": "On",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "num",
        "x": 1070,
        "y": 420,
        "wires": [
            [
                "bf0fa0651dbcb639"
            ]
        ]
    },
    {
        "id": "27246a49e3b44cf7",
        "type": "inject",
        "z": "0e6efdbc0f657beb",
        "g": "677e44441bd53f9b",
        "name": "Off",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "0",
        "payloadType": "num",
        "x": 1070,
        "y": 620,
        "wires": [
            [
                "cd1d542ade044b6e"
            ]
        ]
    },
    {
        "id": "1a25f85e90ce5a07",
        "type": "inject",
        "z": "0e6efdbc0f657beb",
        "g": "dc3604968aa40363",
        "name": "Off",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "0",
        "payloadType": "num",
        "x": 1070,
        "y": 460,
        "wires": [
            [
                "bf0fa0651dbcb639"
            ]
        ]
    },
    {
        "id": "6705535eb46a3532",
        "type": "mqtt in",
        "z": "0e6efdbc0f657beb",
        "g": "ab8c3f4c897cc372",
        "name": "Estado led verde",
        "topic": "iot/verde/estado",
        "qos": "2",
        "datatype": "auto",
        "broker": "64cdcf7a3b4cd223",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 160,
        "y": 240,
        "wires": [
            [
                "d7dfae2c4d71b915",
                "46b609c7d63313ca",
                "03099a7a3c6bb3cd"
            ]
        ]
    },
    {
        "id": "d7dfae2c4d71b915",
        "type": "ui_led",
        "z": "0e6efdbc0f657beb",
        "g": "ab8c3f4c897cc372",
        "order": 3,
        "group": "fadc24b19848c47b",
        "width": "4",
        "height": "1",
        "label": "LED ",
        "labelPlacement": "left",
        "labelAlignment": "center",
        "colorForValue": [
            {
                "color": "#33d17a",
                "value": "on",
                "valueType": "str"
            },
            {
                "color": "#9a9996",
                "value": "off",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 670,
        "y": 240,
        "wires": []
    },
    {
        "id": "e38ef2355ba0469d",
        "type": "ui_button",
        "z": "0e6efdbc0f657beb",
        "g": "15fc3268ac0fe9a3",
        "name": "",
        "group": "fadc24b19848c47b",
        "order": 1,
        "width": "1",
        "height": "1",
        "passthru": false,
        "label": "On",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "1",
        "payloadType": "num",
        "topic": "topic",
        "topicType": "msg",
        "x": 1050,
        "y": 220,
        "wires": [
            [
                "9a177d0af14eb248"
            ]
        ]
    },
    {
        "id": "8d34f5ed47f740e4",
        "type": "ui_button",
        "z": "0e6efdbc0f657beb",
        "g": "15fc3268ac0fe9a3",
        "name": "",
        "group": "fadc24b19848c47b",
        "order": 2,
        "width": "1",
        "height": "1",
        "passthru": false,
        "label": "Off",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "0",
        "payloadType": "num",
        "topic": "topic",
        "topicType": "msg",
        "x": 1050,
        "y": 260,
        "wires": [
            [
                "9a177d0af14eb248"
            ]
        ]
    },
    {
        "id": "da450c45cefeb990",
        "type": "mqtt out",
        "z": "0e6efdbc0f657beb",
        "g": "1c282d6c2598c6e5",
        "name": "Led rojo",
        "topic": "iot/rojo/cmd",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "64cdcf7a3b4cd223",
        "x": 1260,
        "y": 100,
        "wires": []
    },
    {
        "id": "9a177d0af14eb248",
        "type": "mqtt out",
        "z": "0e6efdbc0f657beb",
        "g": "15fc3268ac0fe9a3",
        "name": "Led verde",
        "topic": "iot/verde/cmd",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "64cdcf7a3b4cd223",
        "x": 1260,
        "y": 240,
        "wires": []
    },
    {
        "id": "e6f58469b48a6b11",
        "type": "ui_text",
        "z": "0e6efdbc0f657beb",
        "g": "24141e590783e1a1",
        "group": "13bc2dd9a45cc0e9",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Última actualización",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 620,
        "y": 680,
        "wires": []
    },
    {
        "id": "b54103c554e4ba82",
        "type": "function",
        "z": "0e6efdbc0f657beb",
        "g": "24141e590783e1a1",
        "name": "",
        "func": "var fecha = new Date();\n\nmsg.payload = fecha.toLocaleString('es-ES', { timeZone: 'Europe/Madrid', hour12: false });\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 420,
        "y": 680,
        "wires": [
            [
                "e6f58469b48a6b11"
            ]
        ]
    },
    {
        "id": "087515cd867744a8",
        "type": "ui_gauge",
        "z": "0e6efdbc0f657beb",
        "g": "14d796290fd84b33",
        "name": "",
        "group": "cb79f73074024dbb",
        "order": 1,
        "width": 0,
        "height": 0,
        "gtype": "wave",
        "title": "Humedad",
        "label": "%",
        "format": "{{value}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 660,
        "y": 540,
        "wires": []
    },
    {
        "id": "dbdcf136fa815719",
        "type": "ui_chart",
        "z": "0e6efdbc0f657beb",
        "g": "5bb4c6d4afb4abcd",
        "name": "",
        "group": "d27cc3eaafc9bcc8",
        "order": 2,
        "width": 0,
        "height": 0,
        "label": "Presión (mbar)",
        "chartType": "line",
        "legend": "true",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 640,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "685f4482369c0041",
        "type": "change",
        "z": "0e6efdbc0f657beb",
        "g": "5bb4c6d4afb4abcd",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Presión",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 370,
        "y": 380,
        "wires": [
            [
                "dbdcf136fa815719"
            ]
        ]
    },
    {
        "id": "3a6a6e542f5e87ab",
        "type": "inject",
        "z": "0e6efdbc0f657beb",
        "g": "5bb4c6d4afb4abcd",
        "name": "Reset chart",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "[ ]",
        "payloadType": "json",
        "x": 370,
        "y": 440,
        "wires": [
            [
                "dbdcf136fa815719"
            ]
        ]
    },
    {
        "id": "8cb8331ca1a9e3c4",
        "type": "smooth",
        "z": "0e6efdbc0f657beb",
        "g": "24141e590783e1a1",
        "name": "",
        "property": "payload",
        "action": "mean",
        "count": "6",
        "round": "2",
        "mult": "single",
        "reduce": false,
        "x": 220,
        "y": 800,
        "wires": [
            [
                "502d712e31183eee"
            ]
        ]
    },
    {
        "id": "4b2175a517582ac0",
        "type": "ui_chart",
        "z": "0e6efdbc0f657beb",
        "g": "24141e590783e1a1",
        "name": "",
        "group": "13bc2dd9a45cc0e9",
        "order": 3,
        "width": 0,
        "height": 0,
        "label": "Temperatura (ºC)",
        "chartType": "line",
        "legend": "true",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 630,
        "y": 720,
        "wires": [
            []
        ]
    },
    {
        "id": "1f5639249330428c",
        "type": "inject",
        "z": "0e6efdbc0f657beb",
        "g": "24141e590783e1a1",
        "name": "Reset chart",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "[ ]",
        "payloadType": "json",
        "x": 410,
        "y": 720,
        "wires": [
            [
                "4b2175a517582ac0"
            ]
        ]
    },
    {
        "id": "4e94c5701316cc0b",
        "type": "change",
        "z": "0e6efdbc0f657beb",
        "g": "24141e590783e1a1",
        "name": "Actual",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "temperatura_actual",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 210,
        "y": 760,
        "wires": [
            [
                "8cb8331ca1a9e3c4",
                "3be2b77b1a6a3263"
            ]
        ]
    },
    {
        "id": "11de0c479e604499",
        "type": "ui_gauge",
        "z": "0e6efdbc0f657beb",
        "g": "24141e590783e1a1",
        "name": "",
        "group": "13bc2dd9a45cc0e9",
        "order": 2,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Temperatura",
        "label": "ºC",
        "format": "{{value}}",
        "min": "-5",
        "max": "50",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 650,
        "y": 640,
        "wires": []
    },
    {
        "id": "502d712e31183eee",
        "type": "change",
        "z": "0e6efdbc0f657beb",
        "g": "24141e590783e1a1",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "temperatura_media",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 230,
        "y": 840,
        "wires": [
            [
                "3be2b77b1a6a3263"
            ]
        ]
    },
    {
        "id": "3be2b77b1a6a3263",
        "type": "function",
        "z": "0e6efdbc0f657beb",
        "g": "24141e590783e1a1",
        "name": "Diferencia actual y media",
        "func": "var msg1 = {};\nvar msg2 = {};\nvar msg3 = {};\ncontext.data = context.data || {};\nswitch (msg.topic){\n    case \"temperatura_media\":\n        context.data.temperatura_media = msg.payload;\n        msg = null;\n        break;\n    case \"temperatura_actual\":\n        context.data.temperatura_actual = msg.payload;\n        msg = null;\n        break;\n    default:\n        msg = null;\n        break;\n}\n\nif (context.data.temperatura_actual != null && context.data.temperatura_media != null){\n    msg1.payload = Math.abs(context.data.temperatura_actual-context.data.temperatura_media);\n    msg1.topic = \"Diferencia\";\n    msg2.payload = context.data.temperatura_actual;\n    msg2.topic = \"Actual\";\n    msg3.payload = context.data.temperatura_media;\n    msg3.topic = \"Media\";\n    context.data = null;\n    return [msg1, msg2, msg3];\n}else {return msg;}",
        "outputs": 3,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 450,
        "y": 800,
        "wires": [
            [
                "4b2175a517582ac0"
            ],
            [
                "4b2175a517582ac0"
            ],
            [
                "4b2175a517582ac0"
            ]
        ]
    },
    {
        "id": "0fd81b8b3685de7e",
        "type": "ui_text",
        "z": "0e6efdbc0f657beb",
        "g": "ab8c3f4c897cc372",
        "group": "fadc24b19848c47b",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Última actualización",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "<style>     #nr-dashboard-cardtitle{text-align: center !important;} </style>",
        "x": 620,
        "y": 280,
        "wires": []
    },
    {
        "id": "6a8bb56259311e2e",
        "type": "function",
        "z": "0e6efdbc0f657beb",
        "name": "",
        "func": "var fecha = new Date();\n\nmsg.payload = fecha.toLocaleString('es-ES', { timeZone: 'Europe/Madrid', hour12: false });\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "46b609c7d63313ca",
        "type": "function",
        "z": "0e6efdbc0f657beb",
        "g": "ab8c3f4c897cc372",
        "name": "",
        "func": "var fecha = new Date();\n\nmsg.payload = fecha.toLocaleString('es-ES', { timeZone: 'Europe/Madrid', hour12: false });\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 280,
        "wires": [
            [
                "0fd81b8b3685de7e"
            ]
        ]
    },
    {
        "id": "55d5fb152d4c3a9d",
        "type": "switch",
        "z": "0e6efdbc0f657beb",
        "g": "24141e590783e1a1",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "gte",
                "v": "25",
                "vt": "num"
            },
            {
                "t": "lt",
                "v": "25",
                "vt": "num"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 210,
        "y": 940,
        "wires": [
            [
                "6e5cdaa62deb69af",
                "34794e61787205bb"
            ],
            [
                "630441c3e8fee512",
                "18af0bb67619846a"
            ]
        ]
    },
    {
        "id": "6e5cdaa62deb69af",
        "type": "change",
        "z": "0e6efdbc0f657beb",
        "g": "24141e590783e1a1",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "off",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "0",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 420,
        "y": 920,
        "wires": [
            [
                "cdd3989e53dba123"
            ]
        ]
    },
    {
        "id": "630441c3e8fee512",
        "type": "change",
        "z": "0e6efdbc0f657beb",
        "g": "24141e590783e1a1",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "on",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "1",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 420,
        "y": 960,
        "wires": [
            [
                "cdd3989e53dba123"
            ]
        ]
    },
    {
        "id": "18af0bb67619846a",
        "type": "change",
        "z": "0e6efdbc0f657beb",
        "g": "24141e590783e1a1",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "off",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "0",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 420,
        "y": 1000,
        "wires": [
            [
                "9c91fbe878ae4064"
            ]
        ]
    },
    {
        "id": "34794e61787205bb",
        "type": "change",
        "z": "0e6efdbc0f657beb",
        "g": "24141e590783e1a1",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "on",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "1",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 420,
        "y": 880,
        "wires": [
            [
                "9c91fbe878ae4064"
            ]
        ]
    },
    {
        "id": "cdd3989e53dba123",
        "type": "mqtt out",
        "z": "0e6efdbc0f657beb",
        "g": "24141e590783e1a1",
        "name": "Led verde",
        "topic": "iot/verde/cmd",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "64cdcf7a3b4cd223",
        "x": 660,
        "y": 980,
        "wires": []
    },
    {
        "id": "9c91fbe878ae4064",
        "type": "mqtt out",
        "z": "0e6efdbc0f657beb",
        "g": "24141e590783e1a1",
        "name": "Led rojo",
        "topic": "iot/rojo/cmd",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "64cdcf7a3b4cd223",
        "x": 660,
        "y": 880,
        "wires": []
    },
    {
        "id": "7dfdd9cbce128ca4",
        "type": "inject",
        "z": "0e6efdbc0f657beb",
        "g": "24141e590783e1a1",
        "name": "36",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "36",
        "payloadType": "num",
        "x": 150,
        "y": 1000,
        "wires": [
            [
                "55d5fb152d4c3a9d"
            ]
        ]
    },
    {
        "id": "79a6d5f051253208",
        "type": "ui_text",
        "z": "0e6efdbc0f657beb",
        "g": "ab8c3f4c897cc372",
        "group": "fadc24b19848c47b",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Estado:",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 660,
        "y": 200,
        "wires": []
    },
    {
        "id": "03099a7a3c6bb3cd",
        "type": "function",
        "z": "0e6efdbc0f657beb",
        "g": "ab8c3f4c897cc372",
        "name": "",
        "func": "switch (msg.payload) {\n    case \"off\":\n        msg.payload = \"Apagado\";\n        break;\n    default:\n        msg.payload = \"Encendido\";\n        break;\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 200,
        "wires": [
            [
                "79a6d5f051253208"
            ]
        ]
    },
    {
        "id": "d460ae5fa28aa23e",
        "type": "function",
        "z": "0e6efdbc0f657beb",
        "g": "ab8c3f4c897cc372",
        "name": "",
        "func": "switch (msg.payload) {\n    case \"off\":\n        msg.payload = \"Apagado\";\n        break;\n    default:\n        msg.payload = \"Encendido\";\n        break;\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 360,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "d3a0b0daa96aa520",
        "type": "mqtt in",
        "z": "0e6efdbc0f657beb",
        "g": "f6c614057030cceb",
        "name": "",
        "topic": "iot/datos/adc_read",
        "qos": "2",
        "datatype": "auto",
        "broker": "64cdcf7a3b4cd223",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 170,
        "y": 1100,
        "wires": [
            [
                "461a74fd74ac18f8"
            ]
        ]
    },
    {
        "id": "461a74fd74ac18f8",
        "type": "function",
        "z": "0e6efdbc0f657beb",
        "g": "f6c614057030cceb",
        "name": "",
        "func": "var dato = Number(msg.payload);\nmsg.payload = dato;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 390,
        "y": 1100,
        "wires": [
            [
                "2461bf672adf44a2"
            ]
        ]
    },
    {
        "id": "2461bf672adf44a2",
        "type": "range",
        "z": "0e6efdbc0f657beb",
        "g": "f6c614057030cceb",
        "minin": "0",
        "maxin": "1023",
        "minout": "0",
        "maxout": "100",
        "action": "scale",
        "round": false,
        "property": "payload",
        "name": "",
        "x": 570,
        "y": 1100,
        "wires": [
            [
                "251c49f1fdd9a9c7"
            ]
        ]
    },
    {
        "id": "251c49f1fdd9a9c7",
        "type": "ui_gauge",
        "z": "0e6efdbc0f657beb",
        "g": "f6c614057030cceb",
        "name": "",
        "group": "1482f7c9cab5d4a1",
        "order": 0,
        "width": 0,
        "height": 0,
        "gtype": "donut",
        "title": "Dato ADC - método 1",
        "label": "%",
        "format": "{{value | number:1}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 850,
        "y": 1100,
        "wires": []
    },
    {
        "id": "6235fc2712622b67",
        "type": "mqtt in",
        "z": "0e6efdbc0f657beb",
        "g": "3a996c253c33e17a",
        "name": "",
        "topic": "iot/datos/json",
        "qos": "2",
        "datatype": "auto",
        "broker": "64cdcf7a3b4cd223",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 150,
        "y": 1200,
        "wires": [
            [
                "03548c5ced1efcc1"
            ]
        ]
    },
    {
        "id": "665a8bf053e26e54",
        "type": "range",
        "z": "0e6efdbc0f657beb",
        "g": "3a996c253c33e17a",
        "minin": "0",
        "maxin": "1023",
        "minout": "0",
        "maxout": "100",
        "action": "scale",
        "round": false,
        "property": "payload",
        "name": "",
        "x": 640,
        "y": 1200,
        "wires": [
            [
                "ebecfe8159b47b27"
            ]
        ]
    },
    {
        "id": "ebecfe8159b47b27",
        "type": "ui_gauge",
        "z": "0e6efdbc0f657beb",
        "g": "3a996c253c33e17a",
        "name": "",
        "group": "1482f7c9cab5d4a1",
        "order": 0,
        "width": 0,
        "height": 0,
        "gtype": "donut",
        "title": "Dato ADC - método 2",
        "label": "%",
        "format": "{{value | number:1}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 840,
        "y": 1200,
        "wires": []
    },
    {
        "id": "03548c5ced1efcc1",
        "type": "json",
        "z": "0e6efdbc0f657beb",
        "g": "3a996c253c33e17a",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 310,
        "y": 1200,
        "wires": [
            [
                "b8a3c7a5e5bd1c9b"
            ]
        ]
    },
    {
        "id": "b8a3c7a5e5bd1c9b",
        "type": "change",
        "z": "0e6efdbc0f657beb",
        "g": "3a996c253c33e17a",
        "name": "Iluminación",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.ADC.Iluminacion",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 470,
        "y": 1200,
        "wires": [
            [
                "665a8bf053e26e54"
            ]
        ]
    },
    {
        "id": "231973260d87bcdf",
        "type": "inject",
        "z": "2ecbb3a5fe8520af",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 120,
        "y": 120,
        "wires": [
            [
                "5eab1cfefe1a8610"
            ]
        ]
    },
    {
        "id": "5eab1cfefe1a8610",
        "type": "debug",
        "z": "2ecbb3a5fe8520af",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 890,
        "y": 160,
        "wires": []
    },
    {
        "id": "5557ff14e8228f0e",
        "type": "inject",
        "z": "2ecbb3a5fe8520af",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"writer\":\"rhyloo\",\"count\":42}",
        "payloadType": "json",
        "x": 120,
        "y": 300,
        "wires": [
            [
                "88ae467448911a6f"
            ]
        ]
    },
    {
        "id": "88ae467448911a6f",
        "type": "json",
        "z": "2ecbb3a5fe8520af",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 290,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "e896fa2c857bc675",
        "type": "inject",
        "z": "2ecbb3a5fe8520af",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "print",
        "payload": "{\"writer\":\"rhyloo\",\"count\":42}",
        "payloadType": "json",
        "x": 590,
        "y": 380,
        "wires": [
            []
        ]
    },
    {
        "id": "32c9d72b462930c8",
        "type": "inject",
        "z": "2ecbb3a5fe8520af",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "aa",
        "payload": "{\"writer\":\"Peter\",\"count\":42}",
        "payloadType": "json",
        "x": 760,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "0e2ef77838d41d13",
        "type": "comment",
        "z": "2ecbb3a5fe8520af",
        "name": "js",
        "info": "/* jshint browser: true, esversion: 6, asi: true */\n/* globals uibuilder */\n// @ts-nocheck\n\n/** Minimalist code for uibuilder and Node-RED */\n\n// return formatted HTML version of JSON object\nfunction syntaxHighlight(json) {\n    json = JSON.stringify(json, undefined, 4)\n    console.log(json)\n    json = json.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;')\n    json = json.replace(/(\"(\\\\u[a-zA-Z0-9]{4}|\\\\[^u]|[^\\\\\"])*\"(\\s*:)?|\\b(true|false|null)\\b|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?)/g, function (match) {\n        var cls = 'number'\n        if (/^\"/.test(match)) {\n            if (/:$/.test(match)) {\n                cls = 'key'\n            } else {\n                cls = 'string'\n            }\n        } else if (/true|false/.test(match)) {\n            cls = 'boolean'\n        } else if (/null/.test(match)) {\n            cls = 'null'\n        }\n        return '<span class=\"' + cls + '\">' + match + '</span>'\n    })\n    return json\n} // --- End of syntaxHighlight --- //\n\nfunction test(json) {\n    if (json.topic == \"print\")\n    json2 = json.payload.writer\n    else\n    json2 = json.payload.writer\n    return json2\n}\n\n// run this function when the document is loaded\nwindow.onload = function() {\n    // Start up uibuilder - see the docs for the optional parameters\n    uibuilder.start()\n\n    // Listen for incoming messages from Node-RED\n    uibuilder.onChange('msg', function(msg){\n        console.info('[indexjs:uibuilder.onChange] msg received from Node-RED server:', msg)\n        var msg2 = msg\n        // dump the msg as text to the \"msg\" html element\n        console.log(\"Console log msg:\" + msg)\n        console.log(msg)\n\n        const eMsg = document.getElementById('msg')\n        eMsg.innerHTML = syntaxHighlight(msg)\n        \n        console.log(\"Console log msg2:\" + msg)\n        // dump the msg as text to the \"msg\" html element\n        const eMsg2 = document.getElementById('writer')\n        eMsg2.innerHTML = test(msg2)\n    })\n    uibuilder.onChange('sentCtrlMsg', function (msg) {\n        \n}\n\n",
        "x": 220,
        "y": 520,
        "wires": []
    },
    {
        "id": "0fe05171fcb84929",
        "type": "comment",
        "z": "2ecbb3a5fe8520af",
        "name": "html",
        "info": "<!doctype html>\n<html lang=\"en\"><head>\n\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n\n    <title>Node-RED UI Builder - Blank template</title>\n    <meta name=\"description\" content=\"Node-RED UI Builder - Blank template\">\n    <link rel=\"icon\" href=\"./images/node-blue.ico\">\n\n    <link type=\"text/css\" rel=\"stylesheet\" href=\"./index.css\" media=\"all\">\n\n</head><body>\n    \n    <h1>uibuilder Blank Template</h1>\n    <pre id=\"msg\" class=\"syntax-highlight\">Waiting for a message from Node-RED</pre>\n    <pre id=\"writer\" class=\"syntax-highlight\">Waiting for a message from Node-RED</pre>\n<button class=\"md-raised md-button md-ink-ripple\" type=\"button\" ng-transclude=\"\" ng-click=\"me.buttonClick($event)\" ng-disabled=\"me.item.disabled\" aria-label=\"buttonOff\" ng-style=\"{'background-color':me.item.getText(), 'color':me.item.getColor(), 'z-index':1, 'padding':'0px'}\" style=\"z-index: 1; padding: 0px;\"> <ui-icon ng-show=\"me.item.icon.length\" icon=\"\" ng-style=\"{color:me.item.getColor()}\" aria-hidden=\"true\" class=\"ng-hide\"><!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> </ui-icon> <span ng-bind-html=\"me.item.getLabel()\">Off</span> <!----> <div class=\"md-ripple-container\" style=\"\"></div></button>\n<b-button pill variant=\"secondary\" v-on:click=\"sendMe\">Send Me</b-button>\n    <script src=\"../uibuilder/vendor/socket.io/socket.io.js\"></script>\n    <script src=\"./uibuilderfe.min.js\"></script>\n    <script src=\"./index.js\"></script>\n\n</body></html>",
        "x": 380,
        "y": 520,
        "wires": []
    },
    {
        "id": "fdd151e009ad8028",
        "type": "comment",
        "z": "2ecbb3a5fe8520af",
        "name": "css",
        "info": "/*  Colours for Syntax Highlighted pre's */\n.syntax-highlight {color:white;background-color:black;padding:5px 10px;}\n.syntax-highlight > .key {color:#ffbf35}\n.syntax-highlight > .string {color:#5dff39;}\n.syntax-highlight > .number {color:#70aeff;}\n.syntax-highlight > .boolean {color:#b993ff;}",
        "x": 540,
        "y": 520,
        "wires": []
    },
    {
        "id": "160eecd4cca8fa72",
        "type": "random",
        "z": "2ecbb3a5fe8520af",
        "name": "",
        "low": 1,
        "high": "100",
        "inte": "true",
        "property": "payload",
        "x": 120,
        "y": 440,
        "wires": [
            [
                "94d8b4368dc82812"
            ]
        ]
    },
    {
        "id": "94d8b4368dc82812",
        "type": "function",
        "z": "2ecbb3a5fe8520af",
        "name": "",
        "func": "var number = msg.payload\nmsg.payload = { \"water\": number, \"count\": 42 }\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 300,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "6b2dfee8adb75f88",
        "type": "inject",
        "z": "2ecbb3a5fe8520af",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "1",
        "payloadType": "num",
        "x": 80,
        "y": 580,
        "wires": [
            [
                "160eecd4cca8fa72"
            ]
        ]
    },
    {
        "id": "178ed4d87c132448",
        "type": "function",
        "z": "2ecbb3a5fe8520af",
        "name": "",
        "func": "msg.payload = msg.payload;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 560,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "7389ae81dc8f9346",
        "type": "mqtt in",
        "z": "4b80774a81fc72e3",
        "g": "29cb6290e5ff6565",
        "name": "Estado y LWT",
        "topic": "infind/GRUPO3/conexion",
        "qos": "2",
        "datatype": "auto",
        "broker": "8b67b1bd51c43347",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 110,
        "y": 180,
        "wires": [
            [
                "a807903924b703c6"
            ]
        ]
    },
    {
        "id": "d32126701a054460",
        "type": "debug",
        "z": "4b80774a81fc72e3",
        "g": "29cb6290e5ff6565",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 590,
        "y": 60,
        "wires": []
    },
    {
        "id": "d88cbb9404e397dd",
        "type": "inject",
        "z": "4b80774a81fc72e3",
        "g": "29cb6290e5ff6565",
        "name": "Online",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"online\":true}",
        "payloadType": "str",
        "x": 110,
        "y": 60,
        "wires": [
            [
                "a807903924b703c6"
            ]
        ]
    },
    {
        "id": "2960423e04904fe7",
        "type": "inject",
        "z": "4b80774a81fc72e3",
        "g": "29cb6290e5ff6565",
        "name": "Offline",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{\"online\":false}",
        "payloadType": "str",
        "x": 110,
        "y": 120,
        "wires": [
            [
                "a807903924b703c6"
            ]
        ]
    },
    {
        "id": "0be60a69fcb5b045",
        "type": "mqtt in",
        "z": "4b80774a81fc72e3",
        "g": "f2a63becb357bbaa",
        "name": "Sensores",
        "topic": "infind/GRUPO3/datos",
        "qos": "2",
        "datatype": "auto",
        "broker": "8b67b1bd51c43347",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 100,
        "y": 400,
        "wires": [
            [
                "d138837287c476f0",
                "e8a7079d81e1f4fe"
            ]
        ]
    },
    {
        "id": "a183000632389a04",
        "type": "debug",
        "z": "4b80774a81fc72e3",
        "g": "f2a63becb357bbaa",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 410,
        "y": 280,
        "wires": []
    },
    {
        "id": "be3461b1d304e8d1",
        "type": "inject",
        "z": "4b80774a81fc72e3",
        "g": "f2a63becb357bbaa",
        "name": "Datos",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{  \"Uptime\":12300,  \"Vcc\":4.97,  \"DHT11\":{\"temp\":-2.0,\"hum\":37.0},  \"LED\":100,  \"Wifi\":{\"SSId\":\"infind\",\"IP\":\"192.168.0.100\",\"RSSI\":56}  }",
        "payloadType": "str",
        "x": 130,
        "y": 280,
        "wires": [
            [
                "d138837287c476f0"
            ]
        ]
    },
    {
        "id": "4086e459ed8e2d4e",
        "type": "mqtt in",
        "z": "4b80774a81fc72e3",
        "g": "cedc168255cba3fe",
        "name": "Sensores",
        "topic": "infind/GRUPO3/led/status",
        "qos": "2",
        "datatype": "auto",
        "broker": "8b67b1bd51c43347",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 100,
        "y": 1020,
        "wires": [
            [
                "b55ac03529c46e9a",
                "c32ecdfa41ec6c11"
            ]
        ]
    },
    {
        "id": "5e694971870c0ec9",
        "type": "inject",
        "z": "4b80774a81fc72e3",
        "g": "cedc168255cba3fe",
        "name": "Status",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{ \"led\":75 }",
        "payloadType": "str",
        "x": 110,
        "y": 900,
        "wires": [
            [
                "b55ac03529c46e9a"
            ]
        ],
        "info": "# Status\n\n- Topic: infind/GRUPOX/led/status\n- Acción: Publicar\n- Descripción: El dispositivo confirma la configuración de intensidad del LED [0-100] después de aplicarla\n- Ejemplo: { \"led\":75 } "
    },
    {
        "id": "e925b3185130b633",
        "type": "link in",
        "z": "4b80774a81fc72e3",
        "g": "29cb6290e5ff6565",
        "name": "",
        "links": [
            "a807903924b703c6"
        ],
        "x": 355,
        "y": 60,
        "wires": [
            [
                "d32126701a054460",
                "eb23964865b88d26"
            ]
        ]
    },
    {
        "id": "a807903924b703c6",
        "type": "link out",
        "z": "4b80774a81fc72e3",
        "g": "29cb6290e5ff6565",
        "name": "",
        "links": [
            "e925b3185130b633"
        ],
        "x": 295,
        "y": 60,
        "wires": []
    },
    {
        "id": "d138837287c476f0",
        "type": "json",
        "z": "4b80774a81fc72e3",
        "g": "f2a63becb357bbaa",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 290,
        "y": 380,
        "wires": [
            [
                "a183000632389a04",
                "9e50e9b5ae8aa381",
                "1755599114fe5073",
                "59a85b8799576545",
                "c255e9170d248ceb",
                "3419bcdf2481535d",
                "269d176f4ded5565",
                "11e3b1353c3dbc5e"
            ]
        ]
    },
    {
        "id": "eb23964865b88d26",
        "type": "json",
        "z": "4b80774a81fc72e3",
        "g": "29cb6290e5ff6565",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 430,
        "y": 120,
        "wires": [
            [
                "a71fc5e3fa9a82bb"
            ]
        ]
    },
    {
        "id": "c0ed8dcd2056a1c4",
        "type": "ui_led",
        "z": "4b80774a81fc72e3",
        "g": "29cb6290e5ff6565",
        "order": 1,
        "group": "b8b5fb6b4bfeb434",
        "width": "2",
        "height": "2",
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "false",
                "valueType": "bool"
            },
            {
                "color": "#008000",
                "value": "true",
                "valueType": "bool"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "",
        "x": 630,
        "y": 180,
        "wires": []
    },
    {
        "id": "a71fc5e3fa9a82bb",
        "type": "change",
        "z": "4b80774a81fc72e3",
        "g": "29cb6290e5ff6565",
        "name": "Online",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.online",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 470,
        "y": 180,
        "wires": [
            [
                "c0ed8dcd2056a1c4"
            ]
        ]
    },
    {
        "id": "c9b852c4e8a57466",
        "type": "ui_text",
        "z": "4b80774a81fc72e3",
        "g": "f2a63becb357bbaa",
        "group": "27e360b8dee7f0ae",
        "order": 0,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Uptime (s): ",
        "format": "{{msg.payload.Uptime}}",
        "layout": "row-left",
        "className": "",
        "x": 610,
        "y": 320,
        "wires": []
    },
    {
        "id": "9e50e9b5ae8aa381",
        "type": "function",
        "z": "4b80774a81fc72e3",
        "g": "f2a63becb357bbaa",
        "name": "ms",
        "func": "msg.payload.Uptime = msg.payload.Uptime/1000;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 440,
        "y": 320,
        "wires": [
            [
                "c9b852c4e8a57466"
            ]
        ]
    },
    {
        "id": "1755599114fe5073",
        "type": "ui_gauge",
        "z": "4b80774a81fc72e3",
        "g": "f2a63becb357bbaa",
        "name": "",
        "group": "27e360b8dee7f0ae",
        "order": 2,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Voltios Vcc",
        "label": "V",
        "format": "{{msg.payload.Vcc}}",
        "min": 0,
        "max": "5",
        "colors": [
            "#ff0000",
            "#e6e600",
            "#008080"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 610,
        "y": 360,
        "wires": []
    },
    {
        "id": "59a85b8799576545",
        "type": "ui_gauge",
        "z": "4b80774a81fc72e3",
        "g": "f2a63becb357bbaa",
        "name": "",
        "group": "27e360b8dee7f0ae",
        "order": 2,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Temperatura",
        "label": "ºC",
        "format": "{{msg.payload.DHT11.temp | number:1}}",
        "min": "-5",
        "max": "50",
        "colors": [
            "#0080ff",
            "#00ff00",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 610,
        "y": 400,
        "wires": []
    },
    {
        "id": "5421b6e2864b3aa9",
        "type": "inject",
        "z": "4b80774a81fc72e3",
        "g": "c670b4d7d9719781",
        "name": "Nivel: 75",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "5",
        "topic": "",
        "payload": "{ \"level\":75 }",
        "payloadType": "str",
        "x": 120,
        "y": 660,
        "wires": [
            [
                "e055538e13adb994"
            ]
        ]
    },
    {
        "id": "e055538e13adb994",
        "type": "mqtt out",
        "z": "4b80774a81fc72e3",
        "g": "c670b4d7d9719781",
        "name": "Set Level",
        "topic": "infind/GRUPO3/led/cmd",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "8b67b1bd51c43347",
        "x": 540,
        "y": 720,
        "wires": []
    },
    {
        "id": "44547e793ea61712",
        "type": "inject",
        "z": "4b80774a81fc72e3",
        "g": "c670b4d7d9719781",
        "name": "Nivel:0",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "7.5",
        "topic": "",
        "payload": "{ \"level\":0}",
        "payloadType": "str",
        "x": 110,
        "y": 700,
        "wires": [
            [
                "e055538e13adb994"
            ]
        ]
    },
    {
        "id": "c255e9170d248ceb",
        "type": "ui_gauge",
        "z": "4b80774a81fc72e3",
        "g": "f2a63becb357bbaa",
        "name": "",
        "group": "27e360b8dee7f0ae",
        "order": 2,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "Humedad",
        "label": "%",
        "format": "{{msg.payload.DHT11.hum}}",
        "min": "0",
        "max": "100",
        "colors": [
            "#0080ff",
            "#00ff00",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 600,
        "y": 440,
        "wires": []
    },
    {
        "id": "e8a7079d81e1f4fe",
        "type": "debug",
        "z": "4b80774a81fc72e3",
        "g": "f2a63becb357bbaa",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 300,
        "y": 440,
        "wires": []
    },
    {
        "id": "5f89bdb78be3f862",
        "type": "ui_slider",
        "z": "4b80774a81fc72e3",
        "g": "c670b4d7d9719781",
        "name": "",
        "label": "Nivel LED",
        "tooltip": "",
        "group": "27e360b8dee7f0ae",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": true,
        "outs": "end",
        "topic": "topic",
        "topicType": "msg",
        "min": 0,
        "max": "100",
        "step": 1,
        "className": "",
        "x": 100,
        "y": 800,
        "wires": [
            [
                "8e2b746befc8dfdb"
            ]
        ]
    },
    {
        "id": "8e2b746befc8dfdb",
        "type": "function",
        "z": "4b80774a81fc72e3",
        "g": "c670b4d7d9719781",
        "name": "",
        "func": "msg.payload= \"{ \\\"level\\\":\"+msg.payload+\" }\"\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 300,
        "y": 800,
        "wires": [
            [
                "e055538e13adb994"
            ]
        ]
    },
    {
        "id": "3419bcdf2481535d",
        "type": "ui_text",
        "z": "4b80774a81fc72e3",
        "g": "f2a63becb357bbaa",
        "group": "27e360b8dee7f0ae",
        "order": 0,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "SSId: ",
        "format": "{{msg.payload.Wifi.SSId}}",
        "layout": "row-left",
        "className": "",
        "x": 590,
        "y": 480,
        "wires": []
    },
    {
        "id": "269d176f4ded5565",
        "type": "ui_text",
        "z": "4b80774a81fc72e3",
        "g": "f2a63becb357bbaa",
        "group": "27e360b8dee7f0ae",
        "order": 0,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "IP: ",
        "format": "{{msg.payload.Wifi.IP}}",
        "layout": "row-left",
        "className": "",
        "x": 590,
        "y": 520,
        "wires": []
    },
    {
        "id": "11e3b1353c3dbc5e",
        "type": "ui_text",
        "z": "4b80774a81fc72e3",
        "g": "f2a63becb357bbaa",
        "group": "27e360b8dee7f0ae",
        "order": 0,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "RSSI: ",
        "format": "{{msg.payload.Wifi.RSSI}}",
        "layout": "row-left",
        "className": "",
        "x": 590,
        "y": 560,
        "wires": []
    },
    {
        "id": "b2c7ad6d67afd80d",
        "type": "ui_gauge",
        "z": "4b80774a81fc72e3",
        "g": "cedc168255cba3fe",
        "name": "",
        "group": "27e360b8dee7f0ae",
        "order": 8,
        "width": 0,
        "height": 0,
        "gtype": "gage",
        "title": "gauge",
        "label": "units",
        "format": "{{msg.payload.led}}",
        "min": 0,
        "max": "100",
        "colors": [
            "#005680",
            "#c0c0c0",
            "#80ffff"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 470,
        "y": 980,
        "wires": []
    },
    {
        "id": "b55ac03529c46e9a",
        "type": "json",
        "z": "4b80774a81fc72e3",
        "g": "cedc168255cba3fe",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 290,
        "y": 1000,
        "wires": [
            [
                "b2c7ad6d67afd80d"
            ]
        ]
    },
    {
        "id": "c32ecdfa41ec6c11",
        "type": "debug",
        "z": "4b80774a81fc72e3",
        "g": "cedc168255cba3fe",
        "name": "debug 4",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 440,
        "y": 900,
        "wires": []
    },
    {
        "id": "23d7a622f3958cb0",
        "type": "http response",
        "z": "717fc4f91fb7094e",
        "name": "OTA Response",
        "statusCode": "",
        "headers": {},
        "x": 2772.559814453125,
        "y": 663.1071910858154,
        "wires": []
    },
    {
        "id": "ada2551d5b59f17b",
        "type": "http in",
        "z": "717fc4f91fb7094e",
        "name": "OTA Manager",
        "url": "/esp8266-ota",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 88.05558013916016,
        "y": 648.2856712341309,
        "wires": [
            [
                "41b674b211def85e"
            ]
        ]
    },
    {
        "id": "22ea6eec03c529ca",
        "type": "file",
        "z": "717fc4f91fb7094e",
        "name": "Save md5 Checksum",
        "filename": "",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "true",
        "x": 1539.9998168945312,
        "y": 845.8333740234375,
        "wires": [
            []
        ]
    },
    {
        "id": "235cb485b0c6f984",
        "type": "file in",
        "z": "717fc4f91fb7094e",
        "name": "Read firmware",
        "filename": "",
        "format": "",
        "x": 842.0833740234375,
        "y": 846.6666870117188,
        "wires": [
            [
                "34389816a91f9042"
            ]
        ]
    },
    {
        "id": "de0c81dd4204dfdc",
        "type": "change",
        "z": "717fc4f91fb7094e",
        "name": "Extract filename",
        "rules": [
            {
                "t": "set",
                "p": "filename",
                "pt": "msg",
                "to": "firmware.directory",
                "tot": "flow"
            },
            {
                "t": "change",
                "p": "filename",
                "pt": "msg",
                "from": "$",
                "fromt": "re",
                "to": "req.files.firmware[0].originalname",
                "tot": "msg"
            },
            {
                "t": "delete",
                "p": "req",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "res",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 619.375,
        "y": 847.9166870117188,
        "wires": [
            [
                "235cb485b0c6f984"
            ]
        ]
    },
    {
        "id": "1c02f52ccfc92829",
        "type": "change",
        "z": "717fc4f91fb7094e",
        "name": "",
        "rules": [
            {
                "t": "change",
                "p": "filename",
                "pt": "msg",
                "from": "bin$",
                "fromt": "re",
                "to": "md5",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1225.625,
        "y": 846.25,
        "wires": [
            [
                "22ea6eec03c529ca"
            ]
        ]
    },
    {
        "id": "f38be0827c783a8d",
        "type": "comment",
        "z": "717fc4f91fb7094e",
        "name": "Firmware Upgrade",
        "info": "The system determines which firmware to send based\non the MAC address, version, and MD5 headers in the\nrequest from the ESP8266.\n\nFirstly, it checks if a firmware hash file with \nthe MAC address as the name exists, or else if a \nfirmware file with the version as the name exists.\nIf neither exist then no update is available.\n\nIt then reads the corresponding MD5 hash from the\nhash file and compares to the MD5 hash in the\nrequest.  If they match then the firmware is up\nto date and no update is required.\n\nOtherwise, it sends the contents of the firmware\nbin file and the MD5 hash value.",
        "x": 103.5,
        "y": 46,
        "wires": []
    },
    {
        "id": "4a5bd7ee35c6fc4e",
        "type": "comment",
        "z": "717fc4f91fb7094e",
        "name": "Firmware Management",
        "info": "",
        "x": 110.5,
        "y": 542,
        "wires": []
    },
    {
        "id": "938cb9d05fd9c423",
        "type": "template",
        "z": "717fc4f91fb7094e",
        "name": "Firmware Manager",
        "field": "payload",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "<html>\n    <head>\n        <title>ESP8266 OTA Firmware Manager</title>\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n        <link rel=\"stylesheet\" href=\"http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css\">\n        <script src=\"https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js\"></script>\n        <script src=\"http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js\"></script>\n        <style>\n            .file-btn-grp {\n                display: none;\n            }\n            body {\n                background-color: #f6f6f6;\n            }\n            .text_holder {\n                display: block;\n                max-width: 100%;\n                word-wrap: break-word;\n                line-height: 30px;\n            }\n            #main {\n                margin-top: 50px;\n                background-color: #ffffff;\n                border-radius: 5px;\n                width: 70%;\n                min-width: 500px;\n                border: 1px solid #545454;\n            }\n            .alert {\n                margin-top: 10px;\n                margin-bottom: 5px;\n            }\n            .link {\n                font-style: italic;\n            }\n            .listentry {\n                display: none;\n                list-style-type: none;\n            }\n        </style>\n\n    </head>\n    <body>\n        <div class=\"container\" id=\"main\">\n            <h1><small>ESP8266 OTA Firmware Manager</small></h1>\n            <h2><small>Upload New Firmware</small></h2>\n\n            <form role =\"form\" id=\"main_input_box\" action=\"esp8266-ota\" method=\"POST\" enctype=\"multipart/form-data\" class=\"form-inline\">\n                <input type=\"file\" accept=\".bin\" class=\"hidden\" id=\"fileUpload\" name=\"firmware\" placeholder=\"firmware.bin\">\n                <div class=\"form-group\">\n                <div class=\"input-group\">\n                    <span class=\"input-group-btn\">\n                        <button id=\"browse\" type=\"button\" class=\"btn btn-primary\">Browse...</button>\n                    </span>\n                    <input id=\"filename\" size=100 readonly=\"\" class=\"form-control\" placeholder=\"Firmware.bin\">\n                    <span class=\"input-group-btn\">\n                        <input type=\"submit\" value=\"Upload\" class=\"btn btn-primary add_button\">\n                    </span>\n                </div>\n                </div>\n            </form>\n\n            <h2><small>Current Firmware</small></h2>\n            <ul class=\"list-group\" id=\"list_of_items\">\n            </ul>\n        </div>\n\n        <div id=\"linkModal\" class=\"modal fade\" role=\"dialog\">\n            <div class=\"modal-dialog\">\n        \n                <!-- Modal content-->\n                <div class=\"modal-content\">\n                    <div class=\"modal-header\">\n                        <button type=\"button\" class=\"close\" data-dismiss=\"modal\">&times;</button>\n                        <h4 class=\"modal-title\">Create Symbolic Link</h4>\n                    </div>\n                    <div class=\"modal-body\">\n                        <form class=\"form-horizontal\" id=\"linkForm\" role=\"form\" action=\"#\" method=\"POST\">\n                            <div class=\"form-group\">\n                                <label class=\"control-label  col-sm-2\" for=\"linkName\">Link:</label> \n                                <div class=\"col-sm-10\">\n                                    <input id=\"linkName\" name=\"linkName\" class=\"form-control\"/>\n                                </div>\n                            </div>\n                            <div class=\"form-group\">\n                                <label class=\"control-label  col-sm-2\" for=\"linkFile\">To:</label> \n                                <div class=\"col-sm-10\">\n                                    <input class=\"form-control\" id=\"linkFile\" name=\"linkFile\"/>\n                                </div>\n                            </div>\n                        </form>\n                    </div>\n                    <div class=\"modal-footer\">\n                        <button type=\"submit\" class=\"btn btn-success link-create\">Create</button>\n                        <button type=\"button\" class=\"btn btn-warning\" data-dismiss=\"modal\">Cancel</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n        <script>\n\n            var deleteButton = \"<button id='delete' class='btn btn-warning'>Delete</button>\";\n            var linkButton = \"<button id='link' class='btn btn-success'>Link</button>\";\n            var oneButton = \"<div class='file-btn-grp btn-group pull-right'>\" + deleteButton + \"</div>\";\n            var twoButtons = \"<div class='file-btn-grp btn-group pull-right'>\" + deleteButton + linkButton + \"</div>\";\n            \n            function addListEntry(list, filename, linkname) {\n            \n                var entry;\n                \n                if (linkname === undefined) {\n                    entry = $(\"<li class='listentry list-group-item'><div class='text_holder'><span>\" \n                    + filename + \"</span>\" + twoButtons + \"</div></li>\");\n                } else {\n                    entry = $(\"<li class='listentry list-group-item'><div class='text_holder'><span class='link'>\" \n                    + filename + \"</span> <span class='glyphicon glyphicon-arrow-right'></span> \" \n                    + linkname + oneButton + \"</div></li>\");\n                }\n                \n                entry.mouseover(function(){\n                    $(this).find(\".btn-group\").fadeIn(\"fast\");\n                });\n                entry.mouseleave(function(){\n                    $(this).find(\".btn-group\").fadeOut(\"slow\");\n                });\n                \n                entry.on(\"click\", \"button#delete\", function(){\n                    var listItem = this.parentElement.parentElement.parentElement;\n                    var file = this.parentElement.parentElement.childNodes[0].childNodes[0].data;\n                    $.ajax({\n                        type: 'DELETE',\n                        data: {\"filename\": file},\n                        success: function(result) {\n                            $(listItem).fadeOut(\"slow\", function(){\n                                listItem.remove();\n                            });\n                        },\n                        error: function(result) {\n                            $(listItem).append(\"<div class='alert alert-danger'>\"\n                                + \"<a href='#' class='close' data-dismiss='alert'\"\n                                + \"aria-label='close'>&times;</a>\"\n                                + result.responseText + \"</div>\");\n                        }\n                    });\n                });\n           \n                entry.on(\"click\", \"button#link\", function(){\n                    var file = this.parentElement.parentElement.childNodes[0].childNodes[0].data;\n                    $(\"#linkName\").val(\"\");\n                    $(\"#linkFile\").prop(\"disabled\", true).val(file);\n                    $(\"#linkName\").parent().removeClass(\"has-error\");\n                    $(\"#linkModal\").modal();\n                    $('#linkModal').on('shown.bs.modal', function () {\n                        $('#linkName').focus();\n                    });\n                });\n                \n                if (list.children().length == 0) {\n                    list.append(entry);\n                    entry.fadeIn(\"slow\");\n                    return;\n                }\n\n                if (filename < $(\"li:first span:first\", list).text()) {\n                    $(\"li:first\", list).before(entry);\n                    entry.fadeIn(\"slow\");\n                    return;\n                }\n                if (filename > $(\"li:last span:first\", list).text()) {\n                    $(\"li:last\", list).after(entry);\n                    entry.fadeIn(\"slow\");\n                    return;\n                }\n                \n                var count = 0;\n                var $li = $(\"li\", list);\n                do {\n                    var index = parseInt($li.length / 2);\n                    var $compare = $li.eq(index);\n                    var compare = $(\"span:first\",$compare).text();\n                    if (filename === compare) {\n                        break;\n                    }\n                    else if (filename > compare) {\n                        $li = $li.slice(index, $li.length);\n                    } else {\n                        $li = $li.slice(0, index);\n                    }\n                } while ($li.length > 1);\n\n                if (filename === compare) {\n                    $compare.slideUp(\"fast\").slideDown(\"slow\");\n                    return;\n                } else if (filename < compare) { \n                    entry.insertBefore($compare); \n                } else { \n                    entry.insertAfter($compare); \n                }\n                entry.slideDown(\"slow\");\n            }\n            \n            \n            var files = String(\"{{payload.files}}\").split(',');\n            var links = String(\"{{payload.links}}\").split(',');\n            \n            var list_of_items = $(\"#list_of_items\");\n            \n            files.forEach(function(file,index) {\n                if (links[index] == \"\") {\n                    addListEntry(this, file.slice(0,-4));\n                } else {\n                    addListEntry(this, file.slice(0,-4), links[index].slice(0,-4));\n                }\n            },list_of_items);\n           \n           \n            $(\"#linkModal\").on(\"click\", \"button.link-create\", function(event){\n               event.preventDefault();\n               if ($(\"#linkName\").val() == \"\") {\n                    $('#linkName').focus();\n                    $('#linkName').parent().addClass(\"has-error\");\n                    return false;\n               }\n               $(\"#linkFile\").prop(\"disabled\",false);               \n               $.ajax({\n                    type: 'PUT',\n                    data: $(\"#linkForm\").serialize(),\n                    success: function(result) {\n                        $(\"#linkModal\").modal('hide');\n                        addListEntry(list_of_items, $('#linkName').val(), $('#linkFile').val());\n                    },\n                    error: function(result) {\n                        $(\"#linkFile\").prop(\"disabled\", true);\n                        $('#linkName').focus();\n                        $('#linkName').parent().addClass(\"has-error\");\n                        $(linkForm).append(\"<div id='linkError' class='alert alert-danger'>\"\n                             + \"<a href='#' class='close' data-dismiss='alert'\"\n                             + \"aria-label='close'>&times;</a>\"\n                             + result.responseText + \"</div>\");\n                    }\n                });\n            });\n            \n            $(\"#browse\").on('click', function () {\n                fileUpload.click();\n            });\n            \n            $(\"#fileUpload\").on('change', function () {\n                $(\"#filename\").val($(\"#fileUpload\").val().split('/').pop().split('\\\\').pop());\n            });\n            \n            var frm = $(\"#main_input_box\");\n            \n            frm.submit( function( e ) {\n                e.preventDefault();\n                if ($('#fileUpload').val() == \"\") return null;\n                $.ajax( {\n                    url: frm.attr('action'),\n                    type: frm.attr('method'),\n                    data: new FormData( this ),\n                    processData: false,\n                    contentType: false,\n                    success: function(result) {\n                        addListEntry(list_of_items, $('#fileUpload').val().slice(0,-4).split('\\\\').pop());\n                        $('#fileUpload').val('');\n                        $(':text').val('');\n                    },\n                    error: function(result) {\n                        $(\"#main_input_box\").append(\"<div class='alert alert-danger'>\"\n                             + \"<a href='#' class='close' data-dismiss='alert'\"\n                             + \"aria-label='close'>&times;</a>\"\n                             + result.responseText + \"</div>\");\n                    }\n\n                });\n            });\n        </script>\n    </body>\n</html>",
        "output": "str",
        "x": 1381.3333740234375,
        "y": 645.8135375976562,
        "wires": [
            [
                "23d7a622f3958cb0"
            ]
        ]
    },
    {
        "id": "6aa61cc286a1b24d",
        "type": "http in",
        "z": "717fc4f91fb7094e",
        "name": "OTA Delete",
        "url": "/esp8266-ota",
        "method": "delete",
        "upload": false,
        "swaggerDoc": "",
        "x": 83.125,
        "y": 933.75,
        "wires": [
            [
                "cda40649ac5b6a3a"
            ]
        ]
    },
    {
        "id": "4dc442eb13ce7be4",
        "type": "catch",
        "z": "717fc4f91fb7094e",
        "name": "File Error",
        "scope": [
            "eeec4571523cb77d",
            "1978bb2509f76733",
            "7fe7ceefd9d298b6",
            "07b097d19c935e40",
            "8af3af8485936fad"
        ],
        "x": 1870.6665573120117,
        "y": 805.3333158493042,
        "wires": [
            [
                "4871b3162e87b8a7"
            ]
        ]
    },
    {
        "id": "4871b3162e87b8a7",
        "type": "change",
        "z": "717fc4f91fb7094e",
        "name": "Error",
        "rules": [
            {
                "t": "set",
                "p": "statusCode",
                "pt": "msg",
                "to": "500",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "error.message",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2159,
        "y": 791,
        "wires": [
            [
                "23d7a622f3958cb0"
            ]
        ]
    },
    {
        "id": "fc2d2f5b3e092da2",
        "type": "change",
        "z": "717fc4f91fb7094e",
        "name": "Change to MD5 filename",
        "rules": [
            {
                "t": "change",
                "p": "payload.filename",
                "pt": "msg",
                "from": "bin",
                "fromt": "str",
                "to": "md5",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1879.1666564941406,
        "y": 936.6666269302368,
        "wires": [
            [
                "1978bb2509f76733"
            ]
        ]
    },
    {
        "id": "4d5ad61ce3b93597",
        "type": "http in",
        "z": "717fc4f91fb7094e",
        "name": "OTA Link",
        "url": "/esp8266-ota",
        "method": "put",
        "upload": false,
        "swaggerDoc": "",
        "x": 84,
        "y": 1041.5,
        "wires": [
            [
                "baa980778d990a0e"
            ]
        ]
    },
    {
        "id": "baa980778d990a0e",
        "type": "change",
        "z": "717fc4f91fb7094e",
        "name": "Extract filename",
        "rules": [
            {
                "t": "change",
                "p": "payload.linkName",
                "pt": "msg",
                "from": "$",
                "fromt": "re",
                "to": ".bin",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload.linkFile",
                "pt": "msg",
                "from": "$",
                "fromt": "re",
                "to": ".bin",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1385,
        "y": 1044,
        "wires": [
            [
                "7fe7ceefd9d298b6"
            ]
        ]
    },
    {
        "id": "d418103bb80cb137",
        "type": "change",
        "z": "717fc4f91fb7094e",
        "name": "Change to MD5 Filename",
        "rules": [
            {
                "t": "change",
                "p": "payload.linkName",
                "pt": "msg",
                "from": "bin$",
                "fromt": "re",
                "to": "md5",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload.linkFile",
                "pt": "msg",
                "from": "bin$",
                "fromt": "re",
                "to": "md5",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1908,
        "y": 1045,
        "wires": [
            [
                "07b097d19c935e40"
            ]
        ]
    },
    {
        "id": "cda40649ac5b6a3a",
        "type": "change",
        "z": "717fc4f91fb7094e",
        "name": "Extract filename",
        "rules": [
            {
                "t": "change",
                "p": "payload.filename",
                "pt": "msg",
                "from": "$",
                "fromt": "re",
                "to": ".bin",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1382.5,
        "y": 937.5,
        "wires": [
            [
                "eeec4571523cb77d"
            ]
        ]
    },
    {
        "id": "e62b3e2a74dd4f42",
        "type": "http response",
        "z": "717fc4f91fb7094e",
        "name": "OTA Response",
        "x": 3210.059814453125,
        "y": 366.06256103515625,
        "wires": []
    },
    {
        "id": "1c665e02292be0db",
        "type": "file in",
        "z": "717fc4f91fb7094e",
        "name": "Load Firmware",
        "filename": "filename",
        "filenameType": "msg",
        "format": "",
        "sendError": false,
        "x": 2586.999786376953,
        "y": 399.88400077819824,
        "wires": [
            [
                "e62b3e2a74dd4f42",
                "03353756447b5ae6"
            ]
        ]
    },
    {
        "id": "fb0f8d6b7892196b",
        "type": "change",
        "z": "717fc4f91fb7094e",
        "name": "No Update",
        "rules": [
            {
                "t": "set",
                "p": "statusCode",
                "pt": "msg",
                "to": "304",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2956.107421875,
        "y": 258.52682304382324,
        "wires": [
            [
                "e62b3e2a74dd4f42"
            ]
        ]
    },
    {
        "id": "402c43b354c7aa28",
        "type": "change",
        "z": "717fc4f91fb7094e",
        "name": "Forbidden",
        "rules": [
            {
                "t": "set",
                "p": "statusCode",
                "pt": "msg",
                "to": "403",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Forbidden",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2933.999755859375,
        "y": 135.84826469421387,
        "wires": [
            [
                "e62b3e2a74dd4f42"
            ]
        ]
    },
    {
        "id": "03353756447b5ae6",
        "type": "debug",
        "z": "717fc4f91fb7094e",
        "name": "Update sent",
        "active": true,
        "console": "false",
        "complete": "req.headers.x-esp8266-sta-mac",
        "x": 2932.0000610351562,
        "y": 405.955472946167,
        "wires": []
    },
    {
        "id": "ce7062008a3c28d5",
        "type": "change",
        "z": "717fc4f91fb7094e",
        "name": "Save MD5 Hash",
        "rules": [
            {
                "t": "set",
                "p": "headers.x-MD5",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "change",
                "p": "filename",
                "pt": "msg",
                "from": "md5",
                "fromt": "str",
                "to": "bin",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 2375.785789489746,
        "y": 387.0268669128418,
        "wires": [
            [
                "1c665e02292be0db"
            ]
        ]
    },
    {
        "id": "c10136e864af0d5c",
        "type": "switch",
        "z": "717fc4f91fb7094e",
        "name": "Update type",
        "property": "req.headers.x-esp8266-mode",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "spiffs",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "sketch",
                "vt": "str"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 474.5179748535156,
        "y": 228.52685356140137,
        "wires": [
            [
                "fb0f8d6b7892196b"
            ],
            [
                "ad4fecfcab747c7a"
            ]
        ]
    },
    {
        "id": "7f63e36e9381024c",
        "type": "switch",
        "z": "717fc4f91fb7094e",
        "name": "Compare MD5 hash",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "req.headers.x-esp8266-sketch-md5",
                "vt": "msg"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "outputs": 2,
        "x": 1945.41064453125,
        "y": 342.13403129577637,
        "wires": [
            [
                "fb0f8d6b7892196b",
                "ea49519409256814"
            ],
            [
                "ce7062008a3c28d5",
                "488215c2b03ac958"
            ]
        ]
    },
    {
        "id": "de22ef7e0e51356c",
        "type": "catch",
        "z": "717fc4f91fb7094e",
        "name": "File error",
        "scope": [
            "1c665e02292be0db",
            "9fd9b906f4e88b02"
        ],
        "x": 2628.3572387695312,
        "y": 348.52682304382324,
        "wires": [
            [
                "fb0f8d6b7892196b",
                "f3ac39373bad58e0"
            ]
        ]
    },
    {
        "id": "ad20fa5352c9fe84",
        "type": "switch",
        "z": "717fc4f91fb7094e",
        "name": "Check user agent",
        "property": "req.headers.user-agent",
        "propertyType": "msg",
        "rules": [
            {
                "t": "neq",
                "v": "ESP8266-http-Update",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 290,
        "y": 140,
        "wires": [
            [
                "402c43b354c7aa28"
            ],
            [
                "c10136e864af0d5c"
            ]
        ]
    },
    {
        "id": "ad4fecfcab747c7a",
        "type": "change",
        "z": "717fc4f91fb7094e",
        "name": "Get MAC hash filename",
        "rules": [
            {
                "t": "set",
                "p": "filename",
                "pt": "msg",
                "to": "firmware.directory",
                "tot": "flow"
            },
            {
                "t": "change",
                "p": "filename",
                "pt": "msg",
                "from": "$",
                "fromt": "re",
                "to": "req.headers.x-esp8266-sta-mac",
                "tot": "msg"
            },
            {
                "t": "change",
                "p": "filename",
                "pt": "msg",
                "from": "$",
                "fromt": "re",
                "to": ".md5",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 703.6428451538086,
        "y": 354.9554100036621,
        "wires": [
            [
                "24f24054912dfbe0"
            ]
        ]
    },
    {
        "id": "9fd9b906f4e88b02",
        "type": "file in",
        "z": "717fc4f91fb7094e",
        "name": "Load Hash",
        "filename": "",
        "format": "utf8",
        "sendError": false,
        "x": 1734.410629272461,
        "y": 341.7768840789795,
        "wires": [
            [
                "7f63e36e9381024c"
            ]
        ]
    },
    {
        "id": "f64a5317832eb7e1",
        "type": "change",
        "z": "717fc4f91fb7094e",
        "name": "Get Version hash filename",
        "rules": [
            {
                "t": "set",
                "p": "filename",
                "pt": "msg",
                "to": "firmware.directory",
                "tot": "flow"
            },
            {
                "t": "change",
                "p": "filename",
                "pt": "msg",
                "from": "$",
                "fromt": "re",
                "to": "req.headers.x-esp8266-version",
                "tot": "msg"
            },
            {
                "t": "change",
                "p": "filename",
                "pt": "msg",
                "from": "$",
                "fromt": "re",
                "to": ".md5",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1183.7857666015625,
        "y": 459.5982036590576,
        "wires": [
            [
                "6a612110ac2e16ad",
                "25de8566112ee6b8"
            ]
        ]
    },
    {
        "id": "f3ac39373bad58e0",
        "type": "debug",
        "z": "717fc4f91fb7094e",
        "name": "Firmware file error",
        "active": true,
        "console": "false",
        "complete": "error",
        "x": 2891.2142944335938,
        "y": 347.09826469421387,
        "wires": []
    },
    {
        "id": "61a1d6af98934aa2",
        "type": "http in",
        "z": "717fc4f91fb7094e",
        "name": "OTA Request",
        "url": "/esp8266-ota/update",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 75,
        "y": 134.95541191101074,
        "wires": [
            [
                "ad20fa5352c9fe84",
                "d41ef9a7299bd35d"
            ]
        ]
    },
    {
        "id": "8778e26f976abe2a",
        "type": "switch",
        "z": "717fc4f91fb7094e",
        "name": "",
        "property": "req.headers.x-esp8266-version",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nnull"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "outputs": 2,
        "x": 687.4642333984375,
        "y": 466.74108695983887,
        "wires": [
            [
                "f64a5317832eb7e1"
            ],
            [
                "632383f6c0a033c7"
            ]
        ]
    },
    {
        "id": "632383f6c0a033c7",
        "type": "change",
        "z": "717fc4f91fb7094e",
        "name": "Version in Request",
        "rules": [
            {
                "t": "set",
                "p": "req.headers.x-esp8266-version",
                "pt": "msg",
                "to": "req.params.version",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 896.9285278320312,
        "y": 532.8125286102295,
        "wires": [
            [
                "f64a5317832eb7e1"
            ]
        ]
    },
    {
        "id": "d41ef9a7299bd35d",
        "type": "debug",
        "z": "717fc4f91fb7094e",
        "name": "Update req",
        "active": true,
        "tosidebar": true,
        "console": false,
        "complete": "true",
        "statusVal": "",
        "statusType": "auto",
        "x": 246.2144012451172,
        "y": 235.66967582702637,
        "wires": []
    },
    {
        "id": "ca911da626c61dfd",
        "type": "debug",
        "z": "717fc4f91fb7094e",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "false",
        "x": 1291.773494720459,
        "y": 382.1797161102295,
        "wires": []
    },
    {
        "id": "9167ee0bff518f29",
        "type": "debug",
        "z": "717fc4f91fb7094e",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "false",
        "x": 1290,
        "y": 280,
        "wires": []
    },
    {
        "id": "25de8566112ee6b8",
        "type": "debug",
        "z": "717fc4f91fb7094e",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "filename",
        "x": 1393.0234375,
        "y": 555.0390625,
        "wires": []
    },
    {
        "id": "1785ee6733d585c7",
        "type": "debug",
        "z": "717fc4f91fb7094e",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "filename",
        "x": 1770.0234375,
        "y": 524.0390625,
        "wires": []
    },
    {
        "id": "25e33974b884acaf",
        "type": "debug",
        "z": "717fc4f91fb7094e",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "filename",
        "x": 1789.0234375,
        "y": 407.0390625,
        "wires": []
    },
    {
        "id": "ea49519409256814",
        "type": "debug",
        "z": "717fc4f91fb7094e",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "filename",
        "x": 2148.0234375,
        "y": 279.0390625,
        "wires": []
    },
    {
        "id": "488215c2b03ac958",
        "type": "debug",
        "z": "717fc4f91fb7094e",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "filename",
        "x": 2170.0234375,
        "y": 506.0390625,
        "wires": []
    },
    {
        "id": "8af3af8485936fad",
        "type": "fs-ops-move",
        "z": "717fc4f91fb7094e",
        "name": "Store firmware",
        "sourcePath": "req.files.firmware[0].destination",
        "sourcePathType": "msg",
        "sourceFilename": "req.files.firmware[0].filename",
        "sourceFilenameType": "msg",
        "destPath": "firmware.directory",
        "destPathType": "flow",
        "destFilename": "req.files.firmware[0].originalname",
        "destFilenameType": "msg",
        "link": false,
        "x": 365.89284896850586,
        "y": 818.3332557678223,
        "wires": [
            [
                "de0c81dd4204dfdc",
                "23d7a622f3958cb0"
            ]
        ]
    },
    {
        "id": "7fe7ceefd9d298b6",
        "type": "fs-ops-move",
        "z": "717fc4f91fb7094e",
        "name": "Link firmware",
        "sourcePath": "",
        "sourcePathType": "str",
        "sourceFilename": "payload.linkFile",
        "sourceFilenameType": "msg",
        "destPath": "firmware.directory",
        "destPathType": "flow",
        "destFilename": "payload.linkName",
        "destFilenameType": "msg",
        "link": true,
        "x": 1644.5,
        "y": 1044,
        "wires": [
            [
                "d418103bb80cb137"
            ]
        ]
    },
    {
        "id": "07b097d19c935e40",
        "type": "fs-ops-move",
        "z": "717fc4f91fb7094e",
        "name": "Link MD5",
        "sourcePath": "",
        "sourcePathType": "str",
        "sourceFilename": "payload.linkFile",
        "sourceFilenameType": "msg",
        "destPath": "firmware.directory",
        "destPathType": "flow",
        "destFilename": "payload.linkName",
        "destFilenameType": "msg",
        "link": true,
        "x": 2152.5,
        "y": 1044,
        "wires": [
            [
                "23d7a622f3958cb0"
            ]
        ]
    },
    {
        "id": "eeec4571523cb77d",
        "type": "fs-ops-delete",
        "z": "717fc4f91fb7094e",
        "name": "Delete firmware",
        "path": "firmware.directory",
        "pathType": "flow",
        "filename": "payload.filename",
        "filenameType": "msg",
        "x": 1628.6250457763672,
        "y": 936.5832777023315,
        "wires": [
            [
                "fc2d2f5b3e092da2"
            ]
        ]
    },
    {
        "id": "1978bb2509f76733",
        "type": "fs-ops-delete",
        "z": "717fc4f91fb7094e",
        "name": "Delete MD5 Hash",
        "path": "firmware.directory",
        "pathType": "flow",
        "filename": "payload.filename",
        "filenameType": "msg",
        "x": 2170.833206176758,
        "y": 936.6665878295898,
        "wires": [
            [
                "23d7a622f3958cb0"
            ]
        ]
    },
    {
        "id": "6a612110ac2e16ad",
        "type": "fs-ops-access",
        "z": "717fc4f91fb7094e",
        "name": "Check for MD5 file exists",
        "path": "",
        "pathType": "str",
        "filename": "filename",
        "filenameType": "msg",
        "read": true,
        "write": false,
        "throwerror": false,
        "x": 1497.2857055664062,
        "y": 459.6696147918701,
        "wires": [
            [
                "9fd9b906f4e88b02",
                "25e33974b884acaf"
            ],
            [
                "fb0f8d6b7892196b",
                "1785ee6733d585c7"
            ]
        ]
    },
    {
        "id": "24f24054912dfbe0",
        "type": "fs-ops-access",
        "z": "717fc4f91fb7094e",
        "name": "Check for MD5 file exists",
        "path": "",
        "pathType": "str",
        "filename": "filename",
        "filenameType": "msg",
        "read": true,
        "write": false,
        "throwerror": false,
        "x": 1009.357177734375,
        "y": 349.09826469421387,
        "wires": [
            [
                "9fd9b906f4e88b02",
                "9167ee0bff518f29"
            ],
            [
                "8778e26f976abe2a",
                "ca911da626c61dfd"
            ]
        ]
    },
    {
        "id": "4fd4e3c4900e6aae",
        "type": "fs-ops-link",
        "z": "717fc4f91fb7094e",
        "name": "Get Links",
        "path": "firmware.directory",
        "pathType": "flow",
        "filename": "payload.files",
        "filenameType": "msg",
        "link": "payload.links",
        "linkType": "msg",
        "x": 776.4999923706055,
        "y": 648.3333110809326,
        "wires": [
            [
                "938cb9d05fd9c423"
            ]
        ]
    },
    {
        "id": "41b674b211def85e",
        "type": "fs-ops-dir",
        "z": "717fc4f91fb7094e",
        "name": "Firmware listing",
        "path": "firmware.directory",
        "pathType": "flow",
        "filter": "*.bin",
        "filterType": "str",
        "dir": "payload.files",
        "dirType": "msg",
        "x": 493.0355987548828,
        "y": 647.8015928268433,
        "wires": [
            [
                "4fd4e3c4900e6aae"
            ]
        ]
    },
    {
        "id": "34389816a91f9042",
        "type": "md5",
        "z": "717fc4f91fb7094e",
        "name": "",
        "fieldToHash": "payload",
        "hashField": "payload",
        "hashFieldType": "msg",
        "x": 1031.6668090820312,
        "y": 846.6666259765625,
        "wires": [
            [
                "1c02f52ccfc92829"
            ]
        ]
    },
    {
        "id": "b7c7b22f0d2cc00f",
        "type": "config",
        "z": "717fc4f91fb7094e",
        "name": "Firmware Config",
        "properties": [
            {
                "p": "firmware.directory",
                "pt": "flow",
                "to": "/home/rhyloo/OTA/",
                "tot": "str"
            }
        ],
        "active": true,
        "x": 123.0714111328125,
        "y": 360.1428527832031,
        "wires": []
    },
    {
        "id": "7ab3729edc672c29",
        "type": "httpInMultipart",
        "z": "717fc4f91fb7094e",
        "name": "OTA Upload",
        "url": "/esp8266-ota",
        "method": "post",
        "fields": "[{ \"name\": \"firmware\"}]",
        "swaggerDoc": "",
        "x": 79.7857437133789,
        "y": 812.4286108016968,
        "wires": [
            [
                "8af3af8485936fad"
            ]
        ]
    },
    {
        "id": "41e0a9e4efd2d997",
        "type": "comment",
        "z": "717fc4f91fb7094e",
        "name": "Dirección Gestionar Firmwares",
        "info": "http://192.168.144.66:1880/esp8266-ota",
        "x": 190,
        "y": 1140,
        "wires": []
    },
    {
        "id": "6f86f7f3464dfd85",
        "type": "inject",
        "z": "ecad3a12aab4b8b2",
        "g": "55042353c69140c9",
        "name": "start flow",
        "props": [
            {
                "p": "payload",
                "v": "",
                "vt": "date"
            },
            {
                "p": "topic",
                "v": "",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 60,
        "wires": [
            [
                "773fa43766f0b25b",
                "c6c3e6c67274295f"
            ]
        ]
    },
    {
        "id": "773fa43766f0b25b",
        "type": "http request",
        "z": "ecad3a12aab4b8b2",
        "g": "55042353c69140c9",
        "name": "AEMET http request",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://www.aemet.es/xml/municipios/localidad_29901.xml",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 360,
        "y": 100,
        "wires": [
            [
                "761d860b7905862e"
            ]
        ]
    },
    {
        "id": "761d860b7905862e",
        "type": "xml",
        "z": "ecad3a12aab4b8b2",
        "g": "55042353c69140c9",
        "name": "",
        "property": "payload",
        "attr": "",
        "chr": "",
        "x": 490,
        "y": 180,
        "wires": [
            [
                "c6c3e6c67274295f",
                "3d09827389478a3a",
                "904c91e5c15bf934",
                "ee43d04648a67e78",
                "6a4aa1571e208fa6"
            ]
        ]
    },
    {
        "id": "c6c3e6c67274295f",
        "type": "debug",
        "z": "ecad3a12aab4b8b2",
        "g": "55042353c69140c9",
        "name": "whole xml",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 720,
        "y": 60,
        "wires": []
    },
    {
        "id": "3d09827389478a3a",
        "type": "change",
        "z": "ecad3a12aab4b8b2",
        "g": "55042353c69140c9",
        "name": "max. temp today",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.root.prediccion[0].dia[0].temperatura[0].maxima[0]",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 740,
        "y": 140,
        "wires": [
            [
                "c3031f97cebcc386"
            ]
        ]
    },
    {
        "id": "c3031f97cebcc386",
        "type": "debug",
        "z": "ecad3a12aab4b8b2",
        "g": "55042353c69140c9",
        "name": "max. temp today",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 980,
        "y": 140,
        "wires": []
    },
    {
        "id": "904c91e5c15bf934",
        "type": "change",
        "z": "ecad3a12aab4b8b2",
        "g": "55042353c69140c9",
        "name": "max. temp tomorrow",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.root.prediccion[0].dia[1].temperatura[0].maxima[0]",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 760,
        "y": 220,
        "wires": [
            [
                "afabcaa71761c6fd"
            ]
        ]
    },
    {
        "id": "afabcaa71761c6fd",
        "type": "debug",
        "z": "ecad3a12aab4b8b2",
        "g": "55042353c69140c9",
        "name": "max. temp tomorrow",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 1000,
        "y": 220,
        "wires": []
    },
    {
        "id": "ee43d04648a67e78",
        "type": "change",
        "z": "ecad3a12aab4b8b2",
        "g": "55042353c69140c9",
        "name": "min. temp today",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.root.prediccion[0].dia[0].temperatura[0].minima[0]",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 740,
        "y": 180,
        "wires": [
            [
                "32c7d5c336ac22e8"
            ]
        ]
    },
    {
        "id": "32c7d5c336ac22e8",
        "type": "debug",
        "z": "ecad3a12aab4b8b2",
        "g": "55042353c69140c9",
        "name": "min. temp today",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 980,
        "y": 180,
        "wires": []
    },
    {
        "id": "6a4aa1571e208fa6",
        "type": "change",
        "z": "ecad3a12aab4b8b2",
        "g": "55042353c69140c9",
        "name": "min. temp tomorrow",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.root.prediccion[0].dia[1].temperatura[0].minima[0]",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 760,
        "y": 260,
        "wires": [
            [
                "59518888f1b728e2"
            ]
        ]
    },
    {
        "id": "59518888f1b728e2",
        "type": "debug",
        "z": "ecad3a12aab4b8b2",
        "g": "55042353c69140c9",
        "name": "min. temp tomorrow",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "x": 1000,
        "y": 260,
        "wires": []
    },
    {
        "id": "a33027ed515efe30",
        "type": "debug",
        "z": "ecad3a12aab4b8b2",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 610,
        "y": 700,
        "wires": []
    },
    {
        "id": "e7615a14151c9de4",
        "type": "function",
        "z": "ecad3a12aab4b8b2",
        "name": "mensaje bienvenida",
        "func": "if(msg.payload.content.substring(0,1)!=\"/\")\n{\n msg.payload.content=\"Hola soy el bot de la tarea 9. Puedo responderte a estos comandos:\\n/start\\n/tiempo\";\n return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 380,
        "y": 440,
        "wires": [
            [
                "fe369d2a64bb8f67"
            ]
        ]
    },
    {
        "id": "0203c7ded67181cd",
        "type": "telegram receiver",
        "z": "ecad3a12aab4b8b2",
        "name": "",
        "bot": "1f33bd2091f1c0f0",
        "saveDataDir": "",
        "filterCommands": true,
        "x": 150,
        "y": 400,
        "wires": [
            [
                "e7615a14151c9de4",
                "d47178f12ea122d0"
            ],
            []
        ]
    },
    {
        "id": "fe369d2a64bb8f67",
        "type": "telegram sender",
        "z": "ecad3a12aab4b8b2",
        "name": "",
        "bot": "1f33bd2091f1c0f0",
        "haserroroutput": false,
        "outputs": 1,
        "x": 910,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "bb124cc057c09dea",
        "type": "telegram command",
        "z": "ecad3a12aab4b8b2",
        "name": "",
        "command": "/start",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "1f33bd2091f1c0f0",
        "strict": false,
        "hasresponse": true,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 2,
        "x": 110,
        "y": 460,
        "wires": [
            [
                "e7615a14151c9de4"
            ],
            []
        ]
    },
    {
        "id": "62b4ae188f0c480f",
        "type": "telegram command",
        "z": "ecad3a12aab4b8b2",
        "name": "",
        "command": "/tiempo",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "1f33bd2091f1c0f0",
        "strict": false,
        "hasresponse": true,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 2,
        "x": 90,
        "y": 580,
        "wires": [
            [
                "9799027f5ce0a14e",
                "a33027ed515efe30"
            ],
            []
        ]
    },
    {
        "id": "9799027f5ce0a14e",
        "type": "function",
        "z": "ecad3a12aab4b8b2",
        "name": "function 5",
        "func": "msg.user = msg.payload;\nvar hora_str = new Date();\nvar hora = Number(hora_str.getHours());\nif (hora < 6) {\n    var value = 3;\n}else if ( hora >= 6 && hora < 12){\n    var value = 4;\n}else if (hora >= 12 && hora < 18){\n    var value = 5;\n}else if (hora >= 18 && hora < 24){\n    var value = 6;\n}\nmsg.mensaje = value;\nmsg.limit = 1;\nmsg.sort = { \"date\": -1 };\nmsg.payload = {};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 300,
        "y": 580,
        "wires": [
            [
                "7f2a8a6c912c691c",
                "a33027ed515efe30"
            ]
        ]
    },
    {
        "id": "c9b4d6b01c94b5a6",
        "type": "function",
        "z": "ecad3a12aab4b8b2",
        "name": "function 6",
        "func": "var period = msg.mensaje;\nmsg.elaborado = msg.payload.root.elaborado[0]\nmsg.prob_precipitacion = msg.payload.root.prediccion[0].dia[0].prob_precipitacion[period]._;\nmsg.periodo = msg.payload.root.prediccion[0].dia[0].prob_precipitacion[period].$.periodo;\nmsg.estado_del_cielo = msg.payload.root.prediccion[0].dia[0].estado_cielo[period].$.descripcion;\nmsg.prob_precipitacion_manana = msg.payload.root.prediccion[0].dia[1].prob_precipitacion[0]._;\nmsg.estado_del_cielo_manana = msg.payload.root.prediccion[0].dia[1].estado_cielo[0].$.descripcion;\n\n\nmsg.payload = msg.user;\nmsg.payload.content = \"\";\nmsg.payload.content += \"\\nSegún la AEMET la predicción para las próximas horas (\"+ msg.periodo + \"h)\"\nmsg.payload.content += \" es de \" + msg.estado_del_cielo;\nmsg.payload.content += \" y probabilidad de lluvia de \" + msg.prob_precipitacion + \"%. \"\nmsg.payload.content += \"Mañana se espera \" + msg.estado_del_cielo_manana + \" y probabilidad de lluvia de \" + msg.prob_precipitacion_manana + \"%.\";\nmsg.payload.content += \"\\nPredicción elaborada: \" + msg.elaborado + \".\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 860,
        "y": 580,
        "wires": [
            [
                "a33027ed515efe30",
                "fe369d2a64bb8f67"
            ]
        ]
    },
    {
        "id": "7f2a8a6c912c691c",
        "type": "http request",
        "z": "ecad3a12aab4b8b2",
        "name": "AEMET http request",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://www.aemet.es/xml/municipios/localidad_29901.xml",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 500,
        "y": 580,
        "wires": [
            [
                "df5a08f940ac1f56"
            ]
        ]
    },
    {
        "id": "df5a08f940ac1f56",
        "type": "xml",
        "z": "ecad3a12aab4b8b2",
        "name": "",
        "property": "payload",
        "attr": "",
        "chr": "",
        "x": 690,
        "y": 580,
        "wires": [
            [
                "c9b4d6b01c94b5a6"
            ]
        ]
    },
    {
        "id": "d47178f12ea122d0",
        "type": "debug",
        "z": "ecad3a12aab4b8b2",
        "name": "debug 5",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 460,
        "y": 380,
        "wires": []
    },
    {
        "id": "895551b6df738478",
        "type": "debug",
        "z": "135a65bc89a095d4",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 572.0142135620117,
        "y": 120.00567054748535,
        "wires": []
    },
    {
        "id": "0d23035aab9ee6f4",
        "type": "json",
        "z": "135a65bc89a095d4",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 418.0142135620117,
        "y": 162.00567626953125,
        "wires": [
            [
                "895551b6df738478",
                "038e1af3e037a6ed"
            ]
        ]
    },
    {
        "id": "038e1af3e037a6ed",
        "type": "function",
        "z": "135a65bc89a095d4",
        "name": "añade fecha",
        "func": "msg.payload.date=new Date();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 574.0142059326172,
        "y": 163.0056791305542,
        "wires": [
            [
                "eda663bb076bc420"
            ]
        ]
    },
    {
        "id": "eda663bb076bc420",
        "type": "mongodb out",
        "z": "135a65bc89a095d4",
        "mongodb": "3752afa1.deaf9",
        "name": "",
        "collection": "test_descarga",
        "payonly": true,
        "upsert": false,
        "multi": false,
        "operation": "store",
        "x": 856.0142135620117,
        "y": 162.00567817687988,
        "wires": []
    },
    {
        "id": "cb5560df1ac475ad",
        "type": "inject",
        "z": "135a65bc89a095d4",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 195.78974151611328,
        "y": 275.9715337753296,
        "wires": [
            [
                "3f77c3d0f5f6dfd1"
            ]
        ]
    },
    {
        "id": "3f77c3d0f5f6dfd1",
        "type": "mongodb in",
        "z": "135a65bc89a095d4",
        "mongodb": "3752afa1.deaf9",
        "name": "",
        "collection": "test_descarga",
        "operation": "find",
        "x": 512.7868957519531,
        "y": 275.6988248825073,
        "wires": [
            [
                "09e998d0859cb397"
            ]
        ]
    },
    {
        "id": "09e998d0859cb397",
        "type": "debug",
        "z": "135a65bc89a095d4",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 830,
        "y": 280,
        "wires": []
    },
    {
        "id": "7ae2f8a466f7164a",
        "type": "http response",
        "z": "135a65bc89a095d4",
        "name": "",
        "statusCode": "",
        "headers": {
            "Content-Disposition": "attachment; filename=registros.csv"
        },
        "x": 1145.9997367858887,
        "y": 583.000057220459,
        "wires": []
    },
    {
        "id": "b62c2dfb594fb230",
        "type": "function",
        "z": "135a65bc89a095d4",
        "name": "Unicode y separador",
        "func": "//add Unicode BOM character (byte order mark) to make EXCEL knows this is UTF-8\nif(global.get(\"separador_decimal\")==\"punto\")\n{\n    msg.payload='\\ufeff'+msg.payload;\n\n}\nelse\n{\n    msg.payload='\\ufeff'+(msg.payload).replace(/\\./g,\",\");\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 975.9998626708984,
        "y": 582.9999866485596,
        "wires": [
            [
                "7ae2f8a466f7164a"
            ]
        ]
    },
    {
        "id": "cb93c6e3ee8058b9",
        "type": "function",
        "z": "135a65bc89a095d4",
        "name": "consulta",
        "func": "// fecha por defecto es hoy\nvar ahora = new Date();\n// pillo los globales si los hay, si no la fecha de hoy\nvar desde = new Date(global.get(\"desde\") || ahora);\nvar hasta = new Date(global.get(\"hasta\") || ahora); \n// el día de inicio desde las cero horas\nvar inicio = new Date(desde.getFullYear(),desde.getMonth(),desde.getDate(),0,0,0,0);\n// el día final es hasta final del día\nvar final = new Date(hasta.getFullYear(),hasta.getMonth(),hasta.getDate(),23,59,59,999);\n\nmsg.payload=\n[\n    { \"$match\": { \"date\": { \"$gte\": inicio , \"$lte\": final } } },\n    { \"$project\": {\n        \"_id\": 0,\n        \"date\": 1,\n        \"temperatura\": \"$BME280.Temperatura\",\n        \"humedad\": \"$BME280.Humedad\",\n        \"presion\": \"$BME280.Presion\"\n        }\n    },\n    { \"$sort\": {\"date\": 1} }\n];\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 254.00003814697266,
        "y": 583.0000076293945,
        "wires": [
            [
                "c4e58a3966379fad"
            ]
        ]
    },
    {
        "id": "e54eecf5e696e379",
        "type": "http in",
        "z": "135a65bc89a095d4",
        "name": "",
        "url": "/registros",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 91,
        "y": 582.9999866485596,
        "wires": [
            [
                "cb93c6e3ee8058b9"
            ]
        ]
    },
    {
        "id": "5d9b4f4f41fb331d",
        "type": "ui_template",
        "z": "135a65bc89a095d4",
        "group": "a34ffe7a.04009",
        "name": "",
        "order": 3,
        "width": "0",
        "height": "0",
        "format": "<style>\n.button {\n    text-align: center;\n    font: bold 17px Arial;\n    text-decoration: none;\n    background-color: #339966;\n    color: white;\n    padding: 8px 10px;\n    border: 2px solid #CCCCCC;\n  }\n  \n  .button:hover\n  {\n   background-color: #26734d;\n  }\n\n</style>\n<a href=\"/registros\" class=\"button\">Descarga registros en CSV (EXCEL)</a>\n",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 110.0000228881836,
        "y": 474.9998197555542,
        "wires": [
            []
        ]
    },
    {
        "id": "c4e58a3966379fad",
        "type": "mongodb in",
        "z": "135a65bc89a095d4",
        "mongodb": "3752afa1.deaf9",
        "name": "",
        "collection": "test_descarga",
        "operation": "aggregate",
        "x": 539.0142211914062,
        "y": 583.0056686401367,
        "wires": [
            [
                "918228f2555e158b"
            ]
        ]
    },
    {
        "id": "918228f2555e158b",
        "type": "csv",
        "z": "135a65bc89a095d4",
        "name": "",
        "sep": ";",
        "hdrin": "",
        "hdrout": true,
        "multi": "one",
        "ret": "\\r\\n",
        "temp": "date, temperatura, humedad, presion",
        "skip": 0,
        "x": 795.0000076293945,
        "y": 582.999963760376,
        "wires": [
            [
                "b62c2dfb594fb230"
            ]
        ]
    },
    {
        "id": "0739ed954da62deb",
        "type": "ui_switch",
        "z": "135a65bc89a095d4",
        "name": "separdor decimal",
        "label": "{{msg.topic}}",
        "tooltip": "",
        "group": "a34ffe7a.04009",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "false",
        "topic": "",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 176.00296020507812,
        "y": 1087.9770593643188,
        "wires": [
            [
                "0bccfc717f222643"
            ]
        ]
    },
    {
        "id": "0bd97fcc15616618",
        "type": "inject",
        "z": "135a65bc89a095d4",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "true",
        "payloadType": "bool",
        "x": 157.00002670288086,
        "y": 1010.8889408111572,
        "wires": [
            [
                "0bccfc717f222643"
            ]
        ]
    },
    {
        "id": "0bccfc717f222643",
        "type": "function",
        "z": "135a65bc89a095d4",
        "name": "set global separador_decimal",
        "func": "if(msg.payload===true)\n{\n    global.set(\"separador_decimal\",\"coma\");\n    msg.topic=\"separador decimal = coma\";\n}\nelse\n{\n    global.set(\"separador_decimal\",\"punto\");\n    msg.topic=\"separador decimal = punto\";\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 485.01141357421875,
        "y": 1011.5963134765625,
        "wires": [
            [
                "0739ed954da62deb"
            ]
        ]
    },
    {
        "id": "e655e854d7911f0c",
        "type": "ui_date_picker",
        "z": "135a65bc89a095d4",
        "name": "",
        "label": "Fecha inicio",
        "group": "a34ffe7a.04009",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "topic": "",
        "x": 313.7812728881836,
        "y": 778.7330231666565,
        "wires": [
            [
                "7c092dbb9fca76d3"
            ]
        ]
    },
    {
        "id": "69bd31ca92cdd280",
        "type": "ui_date_picker",
        "z": "135a65bc89a095d4",
        "name": "",
        "label": "Fecha final",
        "group": "a34ffe7a.04009",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": true,
        "topic": "",
        "x": 316.7926254272461,
        "y": 827.7272605895996,
        "wires": [
            [
                "9b7055e475b01199"
            ]
        ]
    },
    {
        "id": "7c092dbb9fca76d3",
        "type": "change",
        "z": "135a65bc89a095d4",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "desde",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 509.78694915771484,
        "y": 777.3949108123779,
        "wires": [
            []
        ]
    },
    {
        "id": "9b7055e475b01199",
        "type": "change",
        "z": "135a65bc89a095d4",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "hasta",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 513.0142288208008,
        "y": 828.2784652709961,
        "wires": [
            []
        ]
    },
    {
        "id": "907905ddfa1bb7a6",
        "type": "inject",
        "z": "135a65bc89a095d4",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 115.7897720336914,
        "y": 803.1534633636475,
        "wires": [
            [
                "e655e854d7911f0c",
                "69bd31ca92cdd280"
            ]
        ]
    },
    {
        "id": "88fe74514cf80148",
        "type": "comment",
        "z": "135a65bc89a095d4",
        "name": "Almacenamiento en base de datos",
        "info": "",
        "x": 227.7897491455078,
        "y": 73.08806610107422,
        "wires": []
    },
    {
        "id": "003bde6b278467c7",
        "type": "comment",
        "z": "135a65bc89a095d4",
        "name": "Controles para seleccionar fechas",
        "info": "",
        "x": 172.7897605895996,
        "y": 706.630747795105,
        "wires": []
    },
    {
        "id": "db39ea9469128e4c",
        "type": "comment",
        "z": "135a65bc89a095d4",
        "name": "Botón en HTML para lanzar descarga de fichero",
        "info": "",
        "x": 219.78977966308594,
        "y": 427.08227348327637,
        "wires": []
    },
    {
        "id": "9a54a3ea5f20dc0e",
        "type": "comment",
        "z": "135a65bc89a095d4",
        "name": "Flujo para descarga de fichero",
        "info": "",
        "x": 162.0142059326172,
        "y": 525.0056400299072,
        "wires": []
    },
    {
        "id": "cf51797b0687219f",
        "type": "comment",
        "z": "135a65bc89a095d4",
        "name": "Selector de separador decimal",
        "info": "",
        "x": 169.01419067382812,
        "y": 950.5510654449463,
        "wires": []
    },
    {
        "id": "1eacd102304df054",
        "type": "mqtt in",
        "z": "135a65bc89a095d4",
        "name": "",
        "topic": "iot/datos/json",
        "qos": "2",
        "datatype": "auto",
        "broker": "2b251178.95ad2e",
        "nl": false,
        "rap": false,
        "inputs": 0,
        "x": 210,
        "y": 160,
        "wires": [
            [
                "0d23035aab9ee6f4"
            ]
        ]
    },
    {
        "id": "206e65e8fb41aa3f",
        "type": "http response",
        "z": "6c70fe453347e1a4",
        "g": "90cdd081dffb79e1",
        "name": "OTA Response",
        "statusCode": "",
        "headers": {},
        "x": 1560,
        "y": 300,
        "wires": []
    },
    {
        "id": "94b746eb21a1b42b",
        "type": "http in",
        "z": "6c70fe453347e1a4",
        "name": "OTA Manager",
        "url": "/upload-into-database",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 90,
        "y": 160,
        "wires": [
            [
                "0fc3a265b5b73b5d"
            ]
        ]
    },
    {
        "id": "9b10ee5e870f2173",
        "type": "file in",
        "z": "6c70fe453347e1a4",
        "name": "Read firmware",
        "filename": "filename",
        "filenameType": "msg",
        "format": "utf8",
        "encoding": "utf8",
        "allProps": false,
        "x": 780,
        "y": 240,
        "wires": [
            [
                "63df6f5dcaaa994b"
            ]
        ]
    },
    {
        "id": "7d58983a40c8d10e",
        "type": "change",
        "z": "6c70fe453347e1a4",
        "name": "Extract filename",
        "rules": [
            {
                "t": "set",
                "p": "filename",
                "pt": "msg",
                "to": "firmware.directory",
                "tot": "flow"
            },
            {
                "t": "change",
                "p": "filename",
                "pt": "msg",
                "from": "$",
                "fromt": "re",
                "to": "req.files.firmware[0].originalname",
                "tot": "msg"
            },
            {
                "t": "delete",
                "p": "req",
                "pt": "msg"
            },
            {
                "t": "delete",
                "p": "res",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 240,
        "wires": [
            [
                "9b10ee5e870f2173"
            ]
        ]
    },
    {
        "id": "7276ccc0b3eb79f1",
        "type": "comment",
        "z": "6c70fe453347e1a4",
        "name": "MongoDB upload",
        "info": "",
        "x": 100,
        "y": 60,
        "wires": []
    },
    {
        "id": "a8ea838c4efd30b4",
        "type": "template",
        "z": "6c70fe453347e1a4",
        "name": "Firmware Manager",
        "field": "payload",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "<html>\n    <head>\n        <title>Database File Manager</title>\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n        <link rel=\"stylesheet\" href=\"http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css\">\n        <script src=\"https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js\"></script>\n        <script src=\"http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js\"></script>\n        <style>\n            .file-btn-grp {\n                display: none;\n            }\n            body {\n                background-color: #f6f6f6;\n            }\n            .text_holder {\n                display: block;\n                max-width: 100%;\n                word-wrap: break-word;\n                line-height: 30px;\n            }\n            #main {\n                margin-top: 50px;\n                background-color: #ffffff;\n                border-radius: 5px;\n                width: 70%;\n                min-width: 500px;\n                border: 1px solid #545454;\n            }\n            .alert {\n                margin-top: 10px;\n                margin-bottom: 5px;\n            }\n            .link {\n                font-style: italic;\n            }\n            .listentry {\n                display: none;\n                list-style-type: none;\n            }\n        </style>\n\n    </head>\n    <body>\n        <div class=\"container\" id=\"main\">\n            <h1><small>Database File Manager</small></h1>\n            <h2><small>Upload New Files</small></h2>\n<form action=\"test\" method=\"POST\">\n    <label for=\"cars\">Choose a collection:</label>\n    <select name=\"cars\" id=\"cars\">\n    <option value=\"test2\">test2</option>\n    <option value=\"test3\">test3</option>\n    <option value=\"test4\">test4</option>\n    <option value=\"test5\">test5</option>\n  </select>\n    <br><br>\n    <input type=\"submit\" value=\"Submit\">\n</form>\n            <form role =\"form\" id=\"main_input_box\" action=\"upload-into-database\" method=\"POST\" enctype=\"multipart/form-data\" class=\"form-inline\">\n                <input type=\"file\" accept=\".json\" class=\"hidden\" id=\"fileUpload\" name=\"firmware\" placeholder=\"firmware.bin\">\n                <div class=\"form-group\">\n                <div class=\"input-group\">\n                    <span class=\"input-group-btn\">\n                        <button id=\"browse\" type=\"button\" class=\"btn btn-primary\">Browse...</button>\n                    </span>\n                    <input id=\"filename\" size=100 readonly=\"\" class=\"form-control\" placeholder=\"File\">\n                    <span class=\"input-group-btn\">\n                        <input type=\"submit\" value=\"Upload\" class=\"btn btn-primary add_button\">\n                    </span>\n                </div>\n                </div>\n            </form>\n\n            <h2><small>Current Files</small></h2>\n            <ul class=\"list-group\" id=\"list_of_items\">\n            </ul>\n        </div>\n\n        <div id=\"linkModal\" class=\"modal fade\" role=\"dialog\">\n            <div class=\"modal-dialog\">\n        \n                <!-- Modal content-->\n                <div class=\"modal-content\">\n                    <div class=\"modal-header\">\n                        <button type=\"button\" class=\"close\" data-dismiss=\"modal\">&times;</button>\n                        <h4 class=\"modal-title\">Create Symbolic Link</h4>\n                    </div>\n                    <div class=\"modal-body\">\n                        <form class=\"form-horizontal\" id=\"linkForm\" role=\"form\" action=\"#\" method=\"POST\">\n                            <div class=\"form-group\">\n                                <label class=\"control-label  col-sm-2\" for=\"linkName\">Link:</label> \n                                <div class=\"col-sm-10\">\n                                    <input id=\"linkName\" name=\"linkName\" class=\"form-control\"/>\n                                </div>\n                            </div>\n                            <div class=\"form-group\">\n                                <label class=\"control-label  col-sm-2\" for=\"linkFile\">To:</label> \n                                <div class=\"col-sm-10\">\n                                    <input class=\"form-control\" id=\"linkFile\" name=\"linkFile\"/>\n                                </div>\n                            </div>\n                        </form>\n                    </div>\n                    <div class=\"modal-footer\">\n                        <button type=\"submit\" class=\"btn btn-success link-create\">Create</button>\n                        <button type=\"button\" class=\"btn btn-warning\" data-dismiss=\"modal\">Cancel</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n        <script>\n\n            var deleteButton = \"<button id='delete' class='btn btn-warning'>Delete</button>\";\n            var linkButton = \"<button id='link' class='btn btn-success'>Link</button>\";\n            var oneButton = \"<div class='file-btn-grp btn-group pull-right'>\" + deleteButton + \"</div>\";\n            var twoButtons = \"<div class='file-btn-grp btn-group pull-right'>\" + deleteButton + linkButton + \"</div>\";\n            \n            function addListEntry(list, filename, linkname) {\n            \n                var entry;\n                \n                if (linkname === undefined) {\n                    entry = $(\"<li class='listentry list-group-item'><div class='text_holder'><span>\" \n                    + filename + \"</span>\" + twoButtons + \"</div></li>\");\n                } else {\n                    entry = $(\"<li class='listentry list-group-item'><div class='text_holder'><span class='link'>\" \n                    + filename + \"</span> <span class='glyphicon glyphicon-arrow-right'></span> \" \n                    + linkname + oneButton + \"</div></li>\");\n                }\n                \n                entry.mouseover(function(){\n                    $(this).find(\".btn-group\").fadeIn(\"fast\");\n                });\n                entry.mouseleave(function(){\n                    $(this).find(\".btn-group\").fadeOut(\"slow\");\n                });\n                \n                entry.on(\"click\", \"button#delete\", function(){\n                    var listItem = this.parentElement.parentElement.parentElement;\n                    var file = this.parentElement.parentElement.childNodes[0].childNodes[0].data;\n                    $.ajax({\n                        type: 'DELETE',\n                        data: {\"filename\": file},\n                        success: function(result) {\n                            $(listItem).fadeOut(\"slow\", function(){\n                                listItem.remove();\n                            });\n                        },\n                        error: function(result) {\n                            $(listItem).append(\"<div class='alert alert-danger'>\"\n                                + \"<a href='#' class='close' data-dismiss='alert'\"\n                                + \"aria-label='close'>&times;</a>\"\n                                + result.responseText + \"</div>\");\n                        }\n                    });\n                });\n           \n                entry.on(\"click\", \"button#link\", function(){\n                    var file = this.parentElement.parentElement.childNodes[0].childNodes[0].data;\n                    $(\"#linkName\").val(\"\");\n                    $(\"#linkFile\").prop(\"disabled\", true).val(file);\n                    $(\"#linkName\").parent().removeClass(\"has-error\");\n                    $(\"#linkModal\").modal();\n                    $('#linkModal').on('shown.bs.modal', function () {\n                        $('#linkName').focus();\n                    });\n                });\n                \n                if (list.children().length == 0) {\n                    list.append(entry);\n                    entry.fadeIn(\"slow\");\n                    return;\n                }\n\n                if (filename < $(\"li:first span:first\", list).text()) {\n                    $(\"li:first\", list).before(entry);\n                    entry.fadeIn(\"slow\");\n                    return;\n                }\n                if (filename > $(\"li:last span:first\", list).text()) {\n                    $(\"li:last\", list).after(entry);\n                    entry.fadeIn(\"slow\");\n                    return;\n                }\n                \n                var count = 0;\n                var $li = $(\"li\", list);\n                do {\n                    var index = parseInt($li.length / 2);\n                    var $compare = $li.eq(index);\n                    var compare = $(\"span:first\",$compare).text();\n                    if (filename === compare) {\n                        break;\n                    }\n                    else if (filename > compare) {\n                        $li = $li.slice(index, $li.length);\n                    } else {\n                        $li = $li.slice(0, index);\n                    }\n                } while ($li.length > 1);\n\n                if (filename === compare) {\n                    $compare.slideUp(\"fast\").slideDown(\"slow\");\n                    return;\n                } else if (filename < compare) { \n                    entry.insertBefore($compare); \n                } else { \n                    entry.insertAfter($compare); \n                }\n                entry.slideDown(\"slow\");\n            }\n            \n            \n            var files = String(\"{{payload.files}}\").split(',');\n            var links = String(\"{{payload.links}}\").split(',');\n            \n            var list_of_items = $(\"#list_of_items\");\n            \n            files.forEach(function(file,index) {\n                if (links[index] == \"\") {\n                    addListEntry(this, file.slice(0,-4));\n                } else {\n                    addListEntry(this, file.slice(0,-4), links[index].slice(0,-4));\n                }\n            },list_of_items);\n           \n           \n            $(\"#linkModal\").on(\"click\", \"button.link-create\", function(event){\n               event.preventDefault();\n               if ($(\"#linkName\").val() == \"\") {\n                    $('#linkName').focus();\n                    $('#linkName').parent().addClass(\"has-error\");\n                    return false;\n               }\n               $(\"#linkFile\").prop(\"disabled\",false);               \n               $.ajax({\n                    type: 'PUT',\n                    data: $(\"#linkForm\").serialize(),\n                    success: function(result) {\n                        $(\"#linkModal\").modal('hide');\n                        addListEntry(list_of_items, $('#linkName').val(), $('#linkFile').val());\n                    },\n                    error: function(result) {\n                        $(\"#linkFile\").prop(\"disabled\", true);\n                        $('#linkName').focus();\n                        $('#linkName').parent().addClass(\"has-error\");\n                        $(linkForm).append(\"<div id='linkError' class='alert alert-danger'>\"\n                             + \"<a href='#' class='close' data-dismiss='alert'\"\n                             + \"aria-label='close'>&times;</a>\"\n                             + result.responseText + \"</div>\");\n                    }\n                });\n            });\n            \n            $(\"#browse\").on('click', function () {\n                fileUpload.click();\n            });\n            \n            $(\"#fileUpload\").on('change', function () {\n                $(\"#filename\").val($(\"#fileUpload\").val().split('/').pop().split('\\\\').pop());\n            });\n            \n            var frm = $(\"#main_input_box\");\n            \n            frm.submit( function( e ) {\n                e.preventDefault();\n                if ($('#fileUpload').val() == \"\") return null;\n                $.ajax( {\n                    url: frm.attr('action'),\n                    type: frm.attr('method'),\n                    data: new FormData( this ),\n                    processData: false,\n                    contentType: false,\n                    success: function(result) {\n                        addListEntry(list_of_items, $('#fileUpload').val().slice(0,-4).split('\\\\').pop());\n                        $('#fileUpload').val('');\n                        $(':text').val('');\n                    },\n                    error: function(result) {\n                        $(\"#main_input_box\").append(\"<div class='alert alert-danger'>\"\n                             + \"<a href='#' class='close' data-dismiss='alert'\"\n                             + \"aria-label='close'>&times;</a>\"\n                             + result.responseText + \"</div>\");\n                    }\n\n                });\n            });\n            //form=document.getElementById(\"my_options\");\n            //function askForChange() {\n            //form.action=\"test\";\n            //form.submit();\n            //}\n        </script>\n    </body>\n</html>",
        "output": "str",
        "x": 670,
        "y": 160,
        "wires": [
            [
                "ad36e52ce949061a"
            ]
        ]
    },
    {
        "id": "41e1eddafaf51164",
        "type": "http in",
        "z": "6c70fe453347e1a4",
        "name": "OTA Delete",
        "url": "/upload-into-database",
        "method": "delete",
        "upload": false,
        "swaggerDoc": "",
        "x": 90,
        "y": 480,
        "wires": [
            [
                "2ba993977f3908a2"
            ]
        ]
    },
    {
        "id": "379aeeb0478ada47",
        "type": "catch",
        "z": "6c70fe453347e1a4",
        "name": "File Error",
        "scope": [
            "f9e6725d2a9cf017",
            "320a810dbdda8cf2",
            "189696b9665f9083",
            "5477aa71963b7fe6",
            "5d1aa53ca40a731a"
        ],
        "x": 80,
        "y": 340,
        "wires": [
            [
                "1fcb942529ae2a6a"
            ]
        ]
    },
    {
        "id": "1fcb942529ae2a6a",
        "type": "change",
        "z": "6c70fe453347e1a4",
        "name": "Error",
        "rules": [
            {
                "t": "set",
                "p": "statusCode",
                "pt": "msg",
                "to": "500",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "error.message",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 230,
        "y": 340,
        "wires": [
            [
                "b8391159ae5e4891"
            ]
        ]
    },
    {
        "id": "28633303190273eb",
        "type": "change",
        "z": "6c70fe453347e1a4",
        "name": "Change to MD5 filename",
        "rules": [
            {
                "t": "change",
                "p": "payload.filename",
                "pt": "msg",
                "from": "bin",
                "fromt": "str",
                "to": "md5",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 850,
        "y": 480,
        "wires": [
            [
                "320a810dbdda8cf2"
            ]
        ]
    },
    {
        "id": "65455c84d4d13502",
        "type": "http in",
        "z": "6c70fe453347e1a4",
        "name": "OTA Link",
        "url": "/upload-into-database",
        "method": "put",
        "upload": false,
        "swaggerDoc": "",
        "x": 80,
        "y": 400,
        "wires": [
            [
                "2cc590b4348263ad"
            ]
        ]
    },
    {
        "id": "2cc590b4348263ad",
        "type": "change",
        "z": "6c70fe453347e1a4",
        "name": "Extract filename",
        "rules": [
            {
                "t": "change",
                "p": "payload.linkName",
                "pt": "msg",
                "from": "$",
                "fromt": "re",
                "to": ".bin",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload.linkFile",
                "pt": "msg",
                "from": "$",
                "fromt": "re",
                "to": ".txt",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 320,
        "y": 400,
        "wires": [
            [
                "189696b9665f9083"
            ]
        ]
    },
    {
        "id": "a05c6ce678ca8605",
        "type": "change",
        "z": "6c70fe453347e1a4",
        "name": "Change to MD5 Filename",
        "rules": [
            {
                "t": "change",
                "p": "payload.linkName",
                "pt": "msg",
                "from": "bin$",
                "fromt": "re",
                "to": "md5",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload.linkFile",
                "pt": "msg",
                "from": "bin$",
                "fromt": "re",
                "to": "md5",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 850,
        "y": 400,
        "wires": [
            [
                "5477aa71963b7fe6"
            ]
        ]
    },
    {
        "id": "2ba993977f3908a2",
        "type": "change",
        "z": "6c70fe453347e1a4",
        "name": "Extract filename",
        "rules": [
            {
                "t": "change",
                "p": "payload.filename",
                "pt": "msg",
                "from": "$",
                "fromt": "re",
                "to": ".txt",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 320,
        "y": 480,
        "wires": [
            [
                "f9e6725d2a9cf017",
                "0bdc1503fa3993e8"
            ]
        ]
    },
    {
        "id": "189696b9665f9083",
        "type": "fs-ops-move",
        "z": "6c70fe453347e1a4",
        "name": "Link firmware",
        "sourcePath": "",
        "sourcePathType": "str",
        "sourceFilename": "payload.linkFile",
        "sourceFilenameType": "msg",
        "destPath": "firmware.directory",
        "destPathType": "flow",
        "destFilename": "payload.linkName",
        "destFilenameType": "msg",
        "link": true,
        "x": 590,
        "y": 400,
        "wires": [
            [
                "a05c6ce678ca8605"
            ]
        ]
    },
    {
        "id": "5477aa71963b7fe6",
        "type": "fs-ops-move",
        "z": "6c70fe453347e1a4",
        "name": "Link MD5",
        "sourcePath": "",
        "sourcePathType": "str",
        "sourceFilename": "payload.linkFile",
        "sourceFilenameType": "msg",
        "destPath": "firmware.directory",
        "destPathType": "flow",
        "destFilename": "payload.linkName",
        "destFilenameType": "msg",
        "link": true,
        "x": 1060,
        "y": 400,
        "wires": [
            [
                "a6f34ee3e3958605"
            ]
        ]
    },
    {
        "id": "f9e6725d2a9cf017",
        "type": "fs-ops-delete",
        "z": "6c70fe453347e1a4",
        "name": "Delete firmware",
        "path": "firmware.directory",
        "pathType": "flow",
        "filename": "payload.filename",
        "filenameType": "msg",
        "x": 600,
        "y": 480,
        "wires": [
            [
                "28633303190273eb"
            ]
        ]
    },
    {
        "id": "320a810dbdda8cf2",
        "type": "fs-ops-delete",
        "z": "6c70fe453347e1a4",
        "name": "Delete MD5 Hash",
        "path": "firmware.directory",
        "pathType": "flow",
        "filename": "payload.filename",
        "filenameType": "msg",
        "x": 1090,
        "y": 480,
        "wires": [
            [
                "796c2e6ed256433e"
            ]
        ]
    },
    {
        "id": "efb1e5fd76bf4178",
        "type": "fs-ops-link",
        "z": "6c70fe453347e1a4",
        "name": "Get Links",
        "path": "firmware.directory",
        "pathType": "flow",
        "filename": "payload.files",
        "filenameType": "msg",
        "link": "payload.links",
        "linkType": "msg",
        "x": 460,
        "y": 160,
        "wires": [
            [
                "a8ea838c4efd30b4"
            ]
        ]
    },
    {
        "id": "0fc3a265b5b73b5d",
        "type": "fs-ops-dir",
        "z": "6c70fe453347e1a4",
        "name": "Firmware listing",
        "path": "firmware.directory",
        "pathType": "flow",
        "filter": "*.json",
        "filterType": "str",
        "dir": "payload.files",
        "dirType": "msg",
        "x": 280,
        "y": 160,
        "wires": [
            [
                "efb1e5fd76bf4178"
            ]
        ]
    },
    {
        "id": "b86b973641a9e142",
        "type": "httpInMultipart",
        "z": "6c70fe453347e1a4",
        "name": "OTA Upload",
        "url": "/upload-into-database",
        "method": "post",
        "fields": "[{ \"name\": \"firmware\"}]",
        "swaggerDoc": "",
        "x": 90,
        "y": 240,
        "wires": [
            [
                "5d1aa53ca40a731a"
            ]
        ]
    },
    {
        "id": "b9c234dd86ec203a",
        "type": "mongodb out",
        "z": "6c70fe453347e1a4",
        "mongodb": "96e271eba0b52a94",
        "name": "Load file into database",
        "collection": "historia",
        "payonly": false,
        "upsert": false,
        "multi": false,
        "operation": "store",
        "x": 1180,
        "y": 240,
        "wires": []
    },
    {
        "id": "5d1aa53ca40a731a",
        "type": "fs-ops-move",
        "z": "6c70fe453347e1a4",
        "name": "Store firmware",
        "sourcePath": "req.files.firmware[0].destination",
        "sourcePathType": "msg",
        "sourceFilename": "req.files.firmware[0].filename",
        "sourceFilenameType": "msg",
        "destPath": "firmware.directory",
        "destPathType": "flow",
        "destFilename": "req.files.firmware[0].originalname",
        "destFilenameType": "msg",
        "link": false,
        "x": 280,
        "y": 240,
        "wires": [
            [
                "491ab73160264549",
                "4b3d54e306a1ba0c",
                "7d58983a40c8d10e"
            ]
        ]
    },
    {
        "id": "91ce1175ed60c27f",
        "type": "inject",
        "z": "6c70fe453347e1a4",
        "g": "58752f0a6e4c85a0",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "{}",
        "payloadType": "json",
        "x": 890,
        "y": 700,
        "wires": [
            [
                "a939ae425921532b"
            ]
        ]
    },
    {
        "id": "a939ae425921532b",
        "type": "mongodb out",
        "z": "6c70fe453347e1a4",
        "g": "58752f0a6e4c85a0",
        "mongodb": "96e271eba0b52a94",
        "name": "",
        "collection": "historia",
        "payonly": false,
        "upsert": false,
        "multi": false,
        "operation": "delete",
        "x": 1130,
        "y": 700,
        "wires": []
    },
    {
        "id": "63df6f5dcaaa994b",
        "type": "function",
        "z": "6c70fe453347e1a4",
        "name": "Format JSON",
        "func": "msg.payload = JSON.parse(msg.payload);\nmsg.filename = flow.get(\"original_name\");;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 980,
        "y": 240,
        "wires": [
            [
                "b9c234dd86ec203a",
                "8c3af52518a780dd"
            ]
        ]
    },
    {
        "id": "ad36e52ce949061a",
        "type": "link out",
        "z": "6c70fe453347e1a4",
        "name": "link out 2",
        "mode": "link",
        "links": [
            "c9ac8a171ec326a1"
        ],
        "x": 835,
        "y": 160,
        "wires": []
    },
    {
        "id": "c9ac8a171ec326a1",
        "type": "link in",
        "z": "6c70fe453347e1a4",
        "g": "90cdd081dffb79e1",
        "name": "link in 17",
        "links": [
            "ad36e52ce949061a",
            "52635bbb0b434c0a"
        ],
        "x": 1365,
        "y": 220,
        "wires": [
            [
                "206e65e8fb41aa3f"
            ]
        ]
    },
    {
        "id": "491ab73160264549",
        "type": "link out",
        "z": "6c70fe453347e1a4",
        "name": "link out 3",
        "mode": "link",
        "links": [
            "cc775bf8b4c3564d"
        ],
        "x": 415,
        "y": 200,
        "wires": []
    },
    {
        "id": "cc775bf8b4c3564d",
        "type": "link in",
        "z": "6c70fe453347e1a4",
        "g": "90cdd081dffb79e1",
        "name": "link in 18",
        "links": [
            "491ab73160264549"
        ],
        "x": 1365,
        "y": 260,
        "wires": [
            [
                "206e65e8fb41aa3f"
            ]
        ]
    },
    {
        "id": "a4c9e592bf9b2023",
        "type": "link in",
        "z": "6c70fe453347e1a4",
        "g": "90cdd081dffb79e1",
        "name": "link in 19",
        "links": [
            "b8391159ae5e4891"
        ],
        "x": 1365,
        "y": 300,
        "wires": [
            [
                "206e65e8fb41aa3f"
            ]
        ]
    },
    {
        "id": "b8391159ae5e4891",
        "type": "link out",
        "z": "6c70fe453347e1a4",
        "name": "link out 4",
        "mode": "link",
        "links": [
            "a4c9e592bf9b2023"
        ],
        "x": 425,
        "y": 340,
        "wires": []
    },
    {
        "id": "796c2e6ed256433e",
        "type": "link out",
        "z": "6c70fe453347e1a4",
        "name": "link out 5",
        "mode": "link",
        "links": [
            "c6af20667ac98ae0"
        ],
        "x": 1225,
        "y": 480,
        "wires": []
    },
    {
        "id": "a6f34ee3e3958605",
        "type": "link out",
        "z": "6c70fe453347e1a4",
        "name": "link out 6",
        "mode": "link",
        "links": [
            "3654503d536f1979"
        ],
        "x": 1225,
        "y": 400,
        "wires": []
    },
    {
        "id": "3654503d536f1979",
        "type": "link in",
        "z": "6c70fe453347e1a4",
        "g": "90cdd081dffb79e1",
        "name": "link in 20",
        "links": [
            "a6f34ee3e3958605"
        ],
        "x": 1365,
        "y": 340,
        "wires": [
            [
                "206e65e8fb41aa3f"
            ]
        ]
    },
    {
        "id": "c6af20667ac98ae0",
        "type": "link in",
        "z": "6c70fe453347e1a4",
        "g": "90cdd081dffb79e1",
        "name": "link in 21",
        "links": [
            "796c2e6ed256433e"
        ],
        "x": 1365,
        "y": 380,
        "wires": [
            [
                "206e65e8fb41aa3f"
            ]
        ]
    },
    {
        "id": "5b5863967965f424",
        "type": "config",
        "z": "6c70fe453347e1a4",
        "name": "Database Config",
        "properties": [
            {
                "p": "firmware.directory",
                "pt": "flow",
                "to": "/home/rhyloo/OTA/",
                "tot": "str"
            },
            {
                "p": "database.name",
                "pt": "flow",
                "to": "test",
                "tot": "str"
            }
        ],
        "active": true,
        "x": 330,
        "y": 60,
        "wires": []
    },
    {
        "id": "ca3c289b30a4e351",
        "type": "http request",
        "z": "6c70fe453347e1a4",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "url": "",
        "x": 970,
        "y": 760,
        "wires": [
            [
                "f431e8a71ff56adb"
            ]
        ]
    },
    {
        "id": "8d67f83ce2f6296a",
        "type": "inject",
        "z": "6c70fe453347e1a4",
        "name": "cars on craigslist",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "topic": "",
        "payload": "http://localhost:1880/upload-into-database",
        "payloadType": "str",
        "x": 640,
        "y": 760,
        "wires": [
            [
                "767b5ece7894ea64"
            ]
        ]
    },
    {
        "id": "767b5ece7894ea64",
        "type": "change",
        "z": "6c70fe453347e1a4",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 810,
        "y": 760,
        "wires": [
            [
                "ca3c289b30a4e351"
            ]
        ]
    },
    {
        "id": "f431e8a71ff56adb",
        "type": "debug",
        "z": "6c70fe453347e1a4",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "false",
        "x": 1130,
        "y": 760,
        "wires": []
    },
    {
        "id": "4b3d54e306a1ba0c",
        "type": "change",
        "z": "6c70fe453347e1a4",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "original_name",
                "pt": "flow",
                "to": "req.files.firmware[0].originalname",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 500,
        "y": 280,
        "wires": [
            [
                "85965ead45153dc8"
            ]
        ]
    },
    {
        "id": "0bdc1503fa3993e8",
        "type": "mongodb out",
        "z": "6c70fe453347e1a4",
        "mongodb": "96e271eba0b52a94",
        "name": "Remove file from database",
        "collection": "historia",
        "payonly": false,
        "upsert": false,
        "multi": false,
        "operation": "delete",
        "x": 600,
        "y": 560,
        "wires": []
    },
    {
        "id": "8c3af52518a780dd",
        "type": "debug",
        "z": "6c70fe453347e1a4",
        "name": "debug 8",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1140,
        "y": 300,
        "wires": []
    },
    {
        "id": "ea462576d6e200f5",
        "type": "mongodb out",
        "z": "6c70fe453347e1a4",
        "mongodb": "96e271eba0b52a94",
        "name": "Remove file from database",
        "collection": "historia",
        "payonly": false,
        "upsert": false,
        "multi": false,
        "operation": "delete",
        "x": 900,
        "y": 320,
        "wires": []
    },
    {
        "id": "85965ead45153dc8",
        "type": "function",
        "z": "6c70fe453347e1a4",
        "name": "Get name",
        "func": "var name = flow.get(\"original_name\");\nmsg.payload = JSON.parse('{\"filename\":\"' + name + '\"}');\nreturn msg;\n'{\"firstName\": \"John\",\"lastName\": \"Doe\",\"location\": \"New York\"}'",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 700,
        "y": 280,
        "wires": [
            [
                "ea462576d6e200f5"
            ]
        ]
    },
    {
        "id": "70a9da55eff88f37",
        "type": "debug",
        "z": "6c70fe453347e1a4",
        "name": "debug 10",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 480,
        "y": 680,
        "wires": []
    },
    {
        "id": "197a27ccdcb18241",
        "type": "function",
        "z": "6c70fe453347e1a4",
        "name": "function 14",
        "func": "msg.req = { \"_readableState\": { \"objectMode\": false, \"highWaterMark\": 16384, \"buffer\": { \"head\": null, \"tail\": null, \"length\": 0 }, \"length\": 0, \"pipes\": [], \"flowing\": null, \"ended\": true, \"endEmitted\": false, \"reading\": false, \"constructed\": true, \"sync\": true, \"needReadable\": false, \"emittedReadable\": false, \"readableListening\": false, \"resumeScheduled\": false, \"errorEmitted\": false, \"emitClose\": true, \"autoDestroy\": true, \"destroyed\": false, \"errored\": null, \"closed\": false, \"closeEmitted\": false, \"defaultEncoding\": \"utf8\", \"awaitDrainWriters\": null, \"multiAwaitDrain\": false, \"readingMore\": true, \"dataEmitted\": false, \"decoder\": null, \"encoding\": null }, \"_events\": {}, \"_eventsCount\": 1, \"socket\": \"[internal]\", \"httpVersionMajor\": 1, \"httpVersionMinor\": 1, \"httpVersion\": \"1.1\", \"complete\": true, \"rawHeaders\": [\"Host\", \"localhost:1880\", \"User-Agent\", \"Mozilla/5.0 (X11; Linux x86_64; rv:106.0) Gecko/20100101 Firefox/106.0\", \"Accept\", \"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\", \"Accept-Language\", \"en-US,en;q=0.5\", \"Accept-Encoding\", \"gzip, deflate, br\", \"Connection\", \"keep-alive\", \"Upgrade-Insecure-Requests\", \"1\", \"Sec-Fetch-Dest\", \"document\", \"Sec-Fetch-Mode\", \"navigate\", \"Sec-Fetch-Site\", \"none\", \"Sec-Fetch-User\", \"?1\", \"If-None-Match\", \"W/\\\"3128-qMtiVcwBVBzxIdUCUeE/ULHRlsg\\\"\"], \"rawTrailers\": [], \"aborted\": false, \"upgrade\": false, \"url\": \"/upload-into-database\", \"method\": \"GET\", \"statusCode\": null, \"statusMessage\": null, \"client\": \"[internal]\", \"_consuming\": false, \"_dumped\": false, \"baseUrl\": \"\", \"originalUrl\": \"/upload-into-database\", \"_parsedUrl\": { \"protocol\": null, \"slashes\": null, \"auth\": null, \"host\": null, \"port\": null, \"hostname\": null, \"hash\": null, \"search\": null, \"query\": null, \"pathname\": \"/upload-into-database\", \"path\": \"/upload-into-database\", \"href\": \"/upload-into-database\", \"_raw\": \"/upload-into-database\" }, \"params\": {}, \"query\": { \"files\": [\"acertijo.txt\", \"test.txt\"], \"links\": [\"\", \"\"] }, \"res\": \"[internal]\", \"body\": {}, \"_parsedOriginalUrl\": { \"protocol\": null, \"slashes\": null, \"auth\": null, \"host\": null, \"port\": null, \"hostname\": null, \"hash\": null, \"search\": null, \"query\": null, \"pathname\": \"/upload-into-database\", \"path\": \"/upload-into-database\", \"href\": \"/upload-into-database\", \"_raw\": \"/upload-into-database\" }, \"route\": { \"path\": \"/upload-into-database\", \"stack\": [{ \"name\": \"cookieParser\", \"keys\": [], \"regexp\": { \"__enc__\": true, \"type\": \"regexp\", \"data\": \"/^\\\\/?$/i\" }, \"method\": \"get\" }, { \"name\": \"httpMiddleware\", \"keys\": [], \"regexp\": { \"__enc__\": true, \"type\": \"regexp\", \"data\": \"/^\\\\/?$/i\" }, \"method\": \"get\" }, { \"name\": \"corsHandler\", \"keys\": [], \"regexp\": { \"__enc__\": true, \"type\": \"regexp\", \"data\": \"/^\\\\/?$/i\" }, \"method\": \"get\" }, { \"name\": \"metricsHandler\", \"keys\": [], \"regexp\": { \"__enc__\": true, \"type\": \"regexp\", \"data\": \"/^\\\\/?$/i\" }, \"method\": \"get\" }, { \"name\": \"<anonymous>\", \"keys\": [], \"regexp\": { \"__enc__\": true, \"type\": \"regexp\", \"data\": \"/^\\\\/?$/i\" }, \"method\": \"get\" }, { \"name\": \"<anonymous>\", \"keys\": [], \"regexp\": { \"__enc__\": true, \"type\": \"regexp\", \"data\": \"/^\\\\/?$/i\" }, \"method\": \"get\" }], \"methods\": { \"get\": true } }, \"cookies\": {}, \"signedCookies\": {} };\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 290,
        "y": 620,
        "wires": [
            [
                "e8d8c470262012c6"
            ]
        ]
    },
    {
        "id": "1d5d3831193573bc",
        "type": "function",
        "z": "6c70fe453347e1a4",
        "name": "function 15",
        "func": "flow.set(\"database.name\", msg.payload.cars); \nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 290,
        "y": 680,
        "wires": [
            [
                "70a9da55eff88f37"
            ]
        ]
    },
    {
        "id": "e8d8c470262012c6",
        "type": "fs-ops-dir",
        "z": "6c70fe453347e1a4",
        "name": "Firmware listing",
        "path": "firmware.directory",
        "pathType": "flow",
        "filter": "*.txt",
        "filterType": "str",
        "dir": "payload.files",
        "dirType": "msg",
        "x": 500,
        "y": 620,
        "wires": [
            [
                "76ade4c32cd92069"
            ]
        ]
    },
    {
        "id": "76ade4c32cd92069",
        "type": "fs-ops-link",
        "z": "6c70fe453347e1a4",
        "name": "Get Links",
        "path": "firmware.directory",
        "pathType": "flow",
        "filename": "payload.files",
        "filenameType": "msg",
        "link": "payload.links",
        "linkType": "msg",
        "x": 720,
        "y": 620,
        "wires": [
            [
                "b2157855f32cbbb4"
            ]
        ]
    },
    {
        "id": "52635bbb0b434c0a",
        "type": "link out",
        "z": "6c70fe453347e1a4",
        "name": "link out 7",
        "mode": "link",
        "links": [
            "c9ac8a171ec326a1"
        ],
        "x": 1095,
        "y": 620,
        "wires": []
    },
    {
        "id": "8412892ffd7d8700",
        "type": "http in",
        "z": "6c70fe453347e1a4",
        "name": "OTA Manager",
        "url": "/test",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 90,
        "y": 620,
        "wires": [
            [
                "197a27ccdcb18241"
            ]
        ]
    },
    {
        "id": "501dd1abbc421a55",
        "type": "http in",
        "z": "6c70fe453347e1a4",
        "name": "",
        "url": "/test",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 80,
        "y": 680,
        "wires": [
            [
                "197a27ccdcb18241",
                "1d5d3831193573bc"
            ]
        ]
    },
    {
        "id": "b2157855f32cbbb4",
        "type": "template",
        "z": "6c70fe453347e1a4",
        "name": "Firmware Manager",
        "field": "payload",
        "fieldType": "msg",
        "format": "html",
        "syntax": "mustache",
        "template": "<html>\n    <head>\n        <title>Database File Manager</title>\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n        <link rel=\"stylesheet\" href=\"http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css\">\n        <script src=\"https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js\"></script>\n        <script src=\"http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js\"></script>\n        <style>\n            .file-btn-grp {\n                display: none;\n            }\n            body {\n                background-color: #f6f6f6;\n            }\n            .text_holder {\n                display: block;\n                max-width: 100%;\n                word-wrap: break-word;\n                line-height: 30px;\n            }\n            #main {\n                margin-top: 50px;\n                background-color: #ffffff;\n                border-radius: 5px;\n                width: 70%;\n                min-width: 500px;\n                border: 1px solid #545454;\n            }\n            .alert {\n                margin-top: 10px;\n                margin-bottom: 5px;\n            }\n            .link {\n                font-style: italic;\n            }\n            .listentry {\n                display: none;\n                list-style-type: none;\n            }\n        </style>\n\n    </head>\n    <body>\n        <div class=\"container\" id=\"main\">\n            <h1><small>Database File Manager</small></h1>\n            <h2><small>Upload New Files</small></h2>\n<form action=\"test\" method=\"POST\">\n    <label for=\"cars\">Choose a collection:</label>\n    <select name=\"cars\" id=\"cars\">\n    <option value=\"test2\">test2</option>\n    <option value=\"test3\">test3</option>\n    <option value=\"test4\">test4</option>\n    <option value=\"test5\">test5</option>\n  </select>\n    <br><br>\n    <input type=\"submit\" value=\"Submit\">\n</form>\n            <form role =\"form\" id=\"main_input_box\" action=\"upload-into-database\" method=\"POST\" enctype=\"multipart/form-data\" class=\"form-inline\">\n                <input type=\"file\" accept=\".txt\" class=\"hidden\" id=\"fileUpload\" name=\"firmware\" placeholder=\"firmware.bin\">\n                <div class=\"form-group\">\n                <div class=\"input-group\">\n                    <span class=\"input-group-btn\">\n                        <button id=\"browse\" type=\"button\" class=\"btn btn-primary\">Browse...</button>\n                    </span>\n                    <input id=\"filename\" size=100 readonly=\"\" class=\"form-control\" placeholder=\"File\">\n                    <span class=\"input-group-btn\">\n                        <input type=\"submit\" value=\"Upload\" class=\"btn btn-primary add_button\">\n                    </span>\n                </div>\n                </div>\n            </form>\n\n            <h2><small>Current Files</small></h2>\n            <ul class=\"list-group\" id=\"list_of_items\">\n            </ul>\n        </div>\n\n        <div id=\"linkModal\" class=\"modal fade\" role=\"dialog\">\n            <div class=\"modal-dialog\">\n        \n                <!-- Modal content-->\n                <div class=\"modal-content\">\n                    <div class=\"modal-header\">\n                        <button type=\"button\" class=\"close\" data-dismiss=\"modal\">&times;</button>\n                        <h4 class=\"modal-title\">Create Symbolic Link</h4>\n                    </div>\n                    <div class=\"modal-body\">\n                        <form class=\"form-horizontal\" id=\"linkForm\" role=\"form\" action=\"#\" method=\"POST\">\n                            <div class=\"form-group\">\n                                <label class=\"control-label  col-sm-2\" for=\"linkName\">Link:</label> \n                                <div class=\"col-sm-10\">\n                                    <input id=\"linkName\" name=\"linkName\" class=\"form-control\"/>\n                                </div>\n                            </div>\n                            <div class=\"form-group\">\n                                <label class=\"control-label  col-sm-2\" for=\"linkFile\">To:</label> \n                                <div class=\"col-sm-10\">\n                                    <input class=\"form-control\" id=\"linkFile\" name=\"linkFile\"/>\n                                </div>\n                            </div>\n                        </form>\n                    </div>\n                    <div class=\"modal-footer\">\n                        <button type=\"submit\" class=\"btn btn-success link-create\">Create</button>\n                        <button type=\"button\" class=\"btn btn-warning\" data-dismiss=\"modal\">Cancel</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n        <script>\n\n            var deleteButton = \"<button id='delete' class='btn btn-warning'>Delete</button>\";\n            var linkButton = \"<button id='link' class='btn btn-success'>Link</button>\";\n            var oneButton = \"<div class='file-btn-grp btn-group pull-right'>\" + deleteButton + \"</div>\";\n            var twoButtons = \"<div class='file-btn-grp btn-group pull-right'>\" + deleteButton + linkButton + \"</div>\";\n            \n            function addListEntry(list, filename, linkname) {\n            \n                var entry;\n                \n                if (linkname === undefined) {\n                    entry = $(\"<li class='listentry list-group-item'><div class='text_holder'><span>\" \n                    + filename + \"</span>\" + twoButtons + \"</div></li>\");\n                } else {\n                    entry = $(\"<li class='listentry list-group-item'><div class='text_holder'><span class='link'>\" \n                    + filename + \"</span> <span class='glyphicon glyphicon-arrow-right'></span> \" \n                    + linkname + oneButton + \"</div></li>\");\n                }\n                \n                entry.mouseover(function(){\n                    $(this).find(\".btn-group\").fadeIn(\"fast\");\n                });\n                entry.mouseleave(function(){\n                    $(this).find(\".btn-group\").fadeOut(\"slow\");\n                });\n                \n                entry.on(\"click\", \"button#delete\", function(){\n                    var listItem = this.parentElement.parentElement.parentElement;\n                    var file = this.parentElement.parentElement.childNodes[0].childNodes[0].data;\n                    $.ajax({\n                        type: 'DELETE',\n                        data: {\"filename\": file},\n                        success: function(result) {\n                            $(listItem).fadeOut(\"slow\", function(){\n                                listItem.remove();\n                            });\n                        },\n                        error: function(result) {\n                            $(listItem).append(\"<div class='alert alert-danger'>\"\n                                + \"<a href='#' class='close' data-dismiss='alert'\"\n                                + \"aria-label='close'>&times;</a>\"\n                                + result.responseText + \"</div>\");\n                        }\n                    });\n                });\n           \n                entry.on(\"click\", \"button#link\", function(){\n                    var file = this.parentElement.parentElement.childNodes[0].childNodes[0].data;\n                    $(\"#linkName\").val(\"\");\n                    $(\"#linkFile\").prop(\"disabled\", true).val(file);\n                    $(\"#linkName\").parent().removeClass(\"has-error\");\n                    $(\"#linkModal\").modal();\n                    $('#linkModal').on('shown.bs.modal', function () {\n                        $('#linkName').focus();\n                    });\n                });\n                \n                if (list.children().length == 0) {\n                    list.append(entry);\n                    entry.fadeIn(\"slow\");\n                    return;\n                }\n\n                if (filename < $(\"li:first span:first\", list).text()) {\n                    $(\"li:first\", list).before(entry);\n                    entry.fadeIn(\"slow\");\n                    return;\n                }\n                if (filename > $(\"li:last span:first\", list).text()) {\n                    $(\"li:last\", list).after(entry);\n                    entry.fadeIn(\"slow\");\n                    return;\n                }\n                \n                var count = 0;\n                var $li = $(\"li\", list);\n                do {\n                    var index = parseInt($li.length / 2);\n                    var $compare = $li.eq(index);\n                    var compare = $(\"span:first\",$compare).text();\n                    if (filename === compare) {\n                        break;\n                    }\n                    else if (filename > compare) {\n                        $li = $li.slice(index, $li.length);\n                    } else {\n                        $li = $li.slice(0, index);\n                    }\n                } while ($li.length > 1);\n\n                if (filename === compare) {\n                    $compare.slideUp(\"fast\").slideDown(\"slow\");\n                    return;\n                } else if (filename < compare) { \n                    entry.insertBefore($compare); \n                } else { \n                    entry.insertAfter($compare); \n                }\n                entry.slideDown(\"slow\");\n            }\n            \n            \n            var files = String(\"{{payload.files}}\").split(',');\n            var links = String(\"{{payload.links}}\").split(',');\n            \n            var list_of_items = $(\"#list_of_items\");\n            \n            files.forEach(function(file,index) {\n                if (links[index] == \"\") {\n                    addListEntry(this, file.slice(0,-4));\n                } else {\n                    addListEntry(this, file.slice(0,-4), links[index].slice(0,-4));\n                }\n            },list_of_items);\n           \n           \n            $(\"#linkModal\").on(\"click\", \"button.link-create\", function(event){\n               event.preventDefault();\n               if ($(\"#linkName\").val() == \"\") {\n                    $('#linkName').focus();\n                    $('#linkName').parent().addClass(\"has-error\");\n                    return false;\n               }\n               $(\"#linkFile\").prop(\"disabled\",false);               \n               $.ajax({\n                    type: 'PUT',\n                    data: $(\"#linkForm\").serialize(),\n                    success: function(result) {\n                        $(\"#linkModal\").modal('hide');\n                        addListEntry(list_of_items, $('#linkName').val(), $('#linkFile').val());\n                    },\n                    error: function(result) {\n                        $(\"#linkFile\").prop(\"disabled\", true);\n                        $('#linkName').focus();\n                        $('#linkName').parent().addClass(\"has-error\");\n                        $(linkForm).append(\"<div id='linkError' class='alert alert-danger'>\"\n                             + \"<a href='#' class='close' data-dismiss='alert'\"\n                             + \"aria-label='close'>&times;</a>\"\n                             + result.responseText + \"</div>\");\n                    }\n                });\n            });\n            \n            $(\"#browse\").on('click', function () {\n                fileUpload.click();\n            });\n            \n            $(\"#fileUpload\").on('change', function () {\n                $(\"#filename\").val($(\"#fileUpload\").val().split('/').pop().split('\\\\').pop());\n            });\n            \n            var frm = $(\"#main_input_box\");\n            \n            frm.submit( function( e ) {\n                e.preventDefault();\n                if ($('#fileUpload').val() == \"\") return null;\n                $.ajax( {\n                    url: frm.attr('action'),\n                    type: frm.attr('method'),\n                    data: new FormData( this ),\n                    processData: false,\n                    contentType: false,\n                    success: function(result) {\n                        addListEntry(list_of_items, $('#fileUpload').val().slice(0,-4).split('\\\\').pop());\n                        $('#fileUpload').val('');\n                        $(':text').val('');\n                    },\n                    error: function(result) {\n                        $(\"#main_input_box\").append(\"<div class='alert alert-danger'>\"\n                             + \"<a href='#' class='close' data-dismiss='alert'\"\n                             + \"aria-label='close'>&times;</a>\"\n                             + result.responseText + \"</div>\");\n                    }\n\n                });\n            });\n            //form=document.getElementById(\"my_options\");\n            //function askForChange() {\n            //form.action=\"test\";\n            //form.submit();\n            //}\n        </script>\n    </body>\n</html>",
        "output": "str",
        "x": 910,
        "y": 620,
        "wires": [
            [
                "52635bbb0b434c0a"
            ]
        ]
    },
    {
        "id": "fc1c912d8da363e8",
        "type": "telegram receiver",
        "z": "b1264f7f33a6cecd",
        "name": "",
        "bot": "d95354d46509e771",
        "saveDataDir": "",
        "filterCommands": true,
        "x": 130,
        "y": 120,
        "wires": [
            [
                "d7630043175884f2",
                "a8ea2b45c311fa3f"
            ],
            []
        ]
    },
    {
        "id": "8c47ef56210aa70a",
        "type": "telegram sender",
        "z": "b1264f7f33a6cecd",
        "g": "3cbc76d168ffea0b",
        "name": "",
        "bot": "d95354d46509e771",
        "haserroroutput": false,
        "outputs": 1,
        "x": 1510,
        "y": 80,
        "wires": [
            [
                "9de6f6d62250a26e"
            ]
        ]
    },
    {
        "id": "7292a048e2c396a6",
        "type": "subflow:7cbc96056c55979a",
        "z": "b1264f7f33a6cecd",
        "g": "c41f0b47cbbfbc65",
        "name": "Cara002",
        "x": 580,
        "y": 480,
        "wires": [
            [
                "0a75a83f2d9a5f7c"
            ],
            [
                "bb9e039b4e617ca2"
            ],
            [
                "989e21d1ec7543f1"
            ],
            [
                "0b2b91ae657441de"
            ]
        ],
        "icon": "font-awesome/fa-asl-interpreting"
    },
    {
        "id": "a2c798da2a93e73d",
        "type": "change",
        "z": "b1264f7f33a6cecd",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "user",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 500,
        "y": 220,
        "wires": [
            [
                "d3ff075e221516c4"
            ]
        ]
    },
    {
        "id": "d3ff075e221516c4",
        "type": "debug",
        "z": "b1264f7f33a6cecd",
        "name": "debug 16",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 680,
        "y": 220,
        "wires": []
    },
    {
        "id": "cd8490d9597a76eb",
        "type": "telegram command",
        "z": "b1264f7f33a6cecd",
        "name": "",
        "command": "/start",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "d95354d46509e771",
        "strict": false,
        "hasresponse": false,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 1,
        "x": 90,
        "y": 220,
        "wires": [
            [
                "5d91c59f613f6faa"
            ]
        ]
    },
    {
        "id": "10f245919ee40388",
        "type": "link out",
        "z": "b1264f7f33a6cecd",
        "name": "link out 8",
        "mode": "link",
        "links": [
            "880fa11cf1585bf1",
            "60e86eddac32f9da"
        ],
        "x": 435,
        "y": 320,
        "wires": []
    },
    {
        "id": "ec0a9d7e19a77efd",
        "type": "complete",
        "z": "b1264f7f33a6cecd",
        "name": "",
        "scope": [
            "d3ff075e221516c4"
        ],
        "uncaught": false,
        "x": 110,
        "y": 340,
        "wires": [
            [
                "9a0058b62a2879da"
            ]
        ]
    },
    {
        "id": "60e86eddac32f9da",
        "type": "link in",
        "z": "b1264f7f33a6cecd",
        "g": "3cbc76d168ffea0b",
        "name": "link in 23",
        "links": [
            "e34ad49609205470",
            "10f245919ee40388",
            "f8d2fc3e0e98c026",
            "25afc71cf7e8a452",
            "0a75a83f2d9a5f7c",
            "8577a7f24cae5079",
            "c639bb0d1b3c78f4"
        ],
        "x": 1065,
        "y": 80,
        "wires": [
            [
                "8c47ef56210aa70a"
            ]
        ]
    },
    {
        "id": "6d12a581e7591ba7",
        "type": "function",
        "z": "b1264f7f33a6cecd",
        "g": "3cbc76d168ffea0b",
        "name": "",
        "func": "var time = global.get(\"time\");\ntime = time - 1;\nglobal.set(\"time\", time);\n\nvar sec_num = time;\nvar hours = Math.floor(sec_num / 3600);\nvar minutes = Math.floor((sec_num - (hours * 3600)) / 60);\nvar seconds = sec_num - (hours * 3600) - (minutes * 60);\n\nif (hours < 10) { hours = \"0\" + hours; }\nif (minutes < 10) { minutes = \"0\" + minutes; }\nif (seconds < 10) { seconds = \"0\" + seconds; }\n\nmsg.payload = hours + ':' + minutes + ':' + seconds;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1640,
        "y": 300,
        "wires": [
            [
                "35b148a34bb29e41"
            ]
        ]
    },
    {
        "id": "f7333c77b79bbd38",
        "type": "config",
        "z": "b1264f7f33a6cecd",
        "name": "",
        "properties": [
            {
                "p": "time",
                "pt": "global",
                "to": "3600",
                "tot": "num"
            },
            {
                "p": "Game",
                "pt": "global",
                "to": "0",
                "tot": "str"
            },
            {
                "p": "save_random",
                "pt": "global",
                "to": "0",
                "tot": "num"
            }
        ],
        "active": true,
        "x": 310,
        "y": 280,
        "wires": []
    },
    {
        "id": "1ed86f99e4e7d4dc",
        "type": "function",
        "z": "b1264f7f33a6cecd",
        "g": "3cbc76d168ffea0b",
        "name": "Send an inline message",
        "func": "var texto = msg.payload;\nmsg.payload = global.get(\"user\");\nmsg.payload.content = texto;\nmsg.payload.type = \"message\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1230,
        "y": 140,
        "wires": [
            [
                "8c47ef56210aa70a"
            ]
        ]
    },
    {
        "id": "0a75a83f2d9a5f7c",
        "type": "link out",
        "z": "b1264f7f33a6cecd",
        "g": "c41f0b47cbbfbc65",
        "name": "link out 10",
        "mode": "link",
        "links": [
            "60e86eddac32f9da"
        ],
        "x": 755,
        "y": 440,
        "wires": []
    },
    {
        "id": "79b389605d6304db",
        "type": "link in",
        "z": "b1264f7f33a6cecd",
        "g": "3cbc76d168ffea0b",
        "name": "link in 24",
        "links": [
            "5e29b723009e3677",
            "dc20f200c13eb39a",
            "b2227557ab57b7ef",
            "60eddba48375afe2",
            "8b2ac556555a12c8"
        ],
        "x": 1065,
        "y": 140,
        "wires": [
            [
                "1ed86f99e4e7d4dc"
            ]
        ]
    },
    {
        "id": "35b148a34bb29e41",
        "type": "ui_text",
        "z": "b1264f7f33a6cecd",
        "g": "3cbc76d168ffea0b",
        "group": "f870df7d6c3cc2e9",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Game time - User",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1850,
        "y": 300,
        "wires": []
    },
    {
        "id": "5482ee35c7b5f19c",
        "type": "complete",
        "z": "b1264f7f33a6cecd",
        "name": "",
        "scope": [
            "d3ff075e221516c4"
        ],
        "uncaught": false,
        "x": 110,
        "y": 280,
        "wires": [
            [
                "f7333c77b79bbd38"
            ]
        ]
    },
    {
        "id": "5205cf7ed44ed20c",
        "type": "debug",
        "z": "b1264f7f33a6cecd",
        "name": "debug 6",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 680,
        "y": 140,
        "wires": []
    },
    {
        "id": "d7630043175884f2",
        "type": "change",
        "z": "b1264f7f33a6cecd",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "user",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 340,
        "y": 140,
        "wires": [
            [
                "5205cf7ed44ed20c"
            ]
        ]
    },
    {
        "id": "9de6f6d62250a26e",
        "type": "debug",
        "z": "b1264f7f33a6cecd",
        "g": "3cbc76d168ffea0b",
        "name": "debug 21",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1680,
        "y": 80,
        "wires": []
    },
    {
        "id": "a8ea2b45c311fa3f",
        "type": "function",
        "z": "b1264f7f33a6cecd",
        "name": "Delete messages from user",
        "func": "msg.payload = global.get(\"user\");\nvar chat_id = msg.payload.chatId;\nvar message_id = msg.payload.messageId;\nmsg.payload.type = \"deleteMessage\";\nmsg.payload.content = message_id;\n\nreturn msg;\n\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 380,
        "y": 80,
        "wires": [
            [
                "25afc71cf7e8a452"
            ]
        ]
    },
    {
        "id": "25afc71cf7e8a452",
        "type": "link out",
        "z": "b1264f7f33a6cecd",
        "name": "link out 13",
        "mode": "link",
        "links": [
            "60e86eddac32f9da"
        ],
        "x": 605,
        "y": 80,
        "wires": []
    },
    {
        "id": "e41230128d1a231b",
        "type": "ui_led",
        "z": "b1264f7f33a6cecd",
        "g": "3cbc76d168ffea0b",
        "order": 3,
        "group": "f870df7d6c3cc2e9",
        "width": 0,
        "height": 0,
        "label": "Cara002",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff7800",
                "value": "Setting Up",
                "valueType": "str"
            },
            {
                "color": "#ffff00",
                "value": "Waiting to start game",
                "valueType": "str"
            },
            {
                "color": "#dc8add",
                "value": "Starting",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "Playing",
                "valueType": "str"
            },
            {
                "color": "#cc0000",
                "value": "You lose",
                "valueType": "str"
            },
            {
                "color": "#1a5fb4",
                "value": "You won",
                "valueType": "str"
            },
            {
                "color": "#865e3c",
                "value": "Timeout! You lost",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "Cara002",
        "x": 1880,
        "y": 500,
        "wires": []
    },
    {
        "id": "8ca3bdc94c59e1e0",
        "type": "delay",
        "z": "b1264f7f33a6cecd",
        "g": "c41f0b47cbbfbc65",
        "name": "",
        "pauseType": "delay",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 220,
        "y": 480,
        "wires": [
            [
                "7292a048e2c396a6"
            ]
        ]
    },
    {
        "id": "bb9e039b4e617ca2",
        "type": "link out",
        "z": "b1264f7f33a6cecd",
        "g": "c41f0b47cbbfbc65",
        "name": "link out 17",
        "mode": "link",
        "links": [
            "c442e1e4d8c60952",
            "06fc84f46a789dc6"
        ],
        "x": 755,
        "y": 480,
        "wires": []
    },
    {
        "id": "989e21d1ec7543f1",
        "type": "link out",
        "z": "b1264f7f33a6cecd",
        "g": "c41f0b47cbbfbc65",
        "name": "link out 18",
        "mode": "link",
        "links": [],
        "x": 755,
        "y": 520,
        "wires": []
    },
    {
        "id": "06fc84f46a789dc6",
        "type": "link in",
        "z": "b1264f7f33a6cecd",
        "g": "3cbc76d168ffea0b",
        "name": "link in 26",
        "links": [
            "5e29b723009e3677",
            "dc20f200c13eb39a",
            "b2227557ab57b7ef",
            "bb9e039b4e617ca2",
            "f6583d92a29357b9"
        ],
        "x": 1065,
        "y": 500,
        "wires": [
            [
                "e41230128d1a231b"
            ]
        ]
    },
    {
        "id": "60e1bcfa7d0988f8",
        "type": "link in",
        "z": "b1264f7f33a6cecd",
        "g": "3cbc76d168ffea0b",
        "name": "link in 27",
        "links": [
            "5e29b723009e3677",
            "dc20f200c13eb39a",
            "b2227557ab57b7ef",
            "12cc4231e9594b77",
            "e8e5d289cdf980f6",
            "2e681e5c5cdf07be",
            "00d7dcb2c10d87f1"
        ],
        "x": 1065,
        "y": 300,
        "wires": [
            []
        ]
    },
    {
        "id": "60eddba48375afe2",
        "type": "link out",
        "z": "b1264f7f33a6cecd",
        "g": "c58cdcaa25741f38",
        "name": "link out 19",
        "mode": "link",
        "links": [
            "79b389605d6304db"
        ],
        "x": 755,
        "y": 660,
        "wires": []
    },
    {
        "id": "3a29e59fba2a5164",
        "type": "delay",
        "z": "b1264f7f33a6cecd",
        "g": "c58cdcaa25741f38",
        "name": "",
        "pauseType": "delay",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 420,
        "y": 700,
        "wires": [
            [
                "98c631e8246cc765"
            ]
        ]
    },
    {
        "id": "98c631e8246cc765",
        "type": "subflow:72ea5fcb0b022fe1",
        "z": "b1264f7f33a6cecd",
        "g": "c58cdcaa25741f38",
        "name": "",
        "x": 590,
        "y": 700,
        "wires": [
            [
                "60eddba48375afe2"
            ],
            [
                "06976b1a983dd765"
            ],
            [
                "2e681e5c5cdf07be"
            ]
        ]
    },
    {
        "id": "157499ce0bfc42b7",
        "type": "function",
        "z": "b1264f7f33a6cecd",
        "g": "c58cdcaa25741f38",
        "name": "terminado?",
        "func": "if (msg.payload == 2){\n    return msg;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 230,
        "y": 700,
        "wires": [
            [
                "3a29e59fba2a5164"
            ]
        ]
    },
    {
        "id": "c442e1e4d8c60952",
        "type": "link in",
        "z": "b1264f7f33a6cecd",
        "g": "c58cdcaa25741f38",
        "name": "link in 28",
        "links": [
            "bb9e039b4e617ca2"
        ],
        "x": 55,
        "y": 700,
        "wires": [
            [
                "157499ce0bfc42b7"
            ]
        ]
    },
    {
        "id": "dd3fc4e68e99cc7f",
        "type": "link in",
        "z": "b1264f7f33a6cecd",
        "g": "3cbc76d168ffea0b",
        "name": "link in 29",
        "links": [
            "5e29b723009e3677",
            "dc20f200c13eb39a",
            "b2227557ab57b7ef",
            "f6583d92a29357b9",
            "06976b1a983dd765"
        ],
        "x": 1065,
        "y": 540,
        "wires": [
            [
                "07b6818be845ed13"
            ]
        ]
    },
    {
        "id": "874896e5c790fac7",
        "type": "exec",
        "z": "b1264f7f33a6cecd",
        "command": "hostname -I",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 650,
        "y": 1320,
        "wires": [
            [
                "e5a21d0bd624b577"
            ],
            [
                "e5a21d0bd624b577"
            ],
            [
                "e5a21d0bd624b577"
            ]
        ]
    },
    {
        "id": "02eff4f682eafba9",
        "type": "inject",
        "z": "b1264f7f33a6cecd",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 280,
        "y": 1300,
        "wires": [
            [
                "8104bd8c54f5c23b"
            ]
        ]
    },
    {
        "id": "e5a21d0bd624b577",
        "type": "debug",
        "z": "b1264f7f33a6cecd",
        "name": "debug 28",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 840,
        "y": 1320,
        "wires": []
    },
    {
        "id": "8b2ac556555a12c8",
        "type": "link out",
        "z": "b1264f7f33a6cecd",
        "g": "e58badeac6a79a19",
        "name": "link out 20",
        "mode": "link",
        "links": [
            "79b389605d6304db"
        ],
        "x": 755,
        "y": 1020,
        "wires": []
    },
    {
        "id": "ae1892d2b2a412d2",
        "type": "delay",
        "z": "b1264f7f33a6cecd",
        "g": "e58badeac6a79a19",
        "name": "",
        "pauseType": "delay",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 420,
        "y": 1060,
        "wires": [
            [
                "18e527ef879eb9f5"
            ]
        ]
    },
    {
        "id": "e8a92e7b28f7b9f0",
        "type": "function",
        "z": "b1264f7f33a6cecd",
        "g": "e58badeac6a79a19",
        "name": "terminado?",
        "func": "if (msg.payload == 2){\n    return msg;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 230,
        "y": 1060,
        "wires": [
            [
                "ae1892d2b2a412d2"
            ]
        ]
    },
    {
        "id": "f2eb9e8f54ec2846",
        "type": "link in",
        "z": "b1264f7f33a6cecd",
        "g": "e58badeac6a79a19",
        "name": "link in 30",
        "links": [
            "06976b1a983dd765"
        ],
        "x": 55,
        "y": 1060,
        "wires": [
            [
                "e8a92e7b28f7b9f0"
            ]
        ]
    },
    {
        "id": "18e527ef879eb9f5",
        "type": "subflow:90d9a362f6d9804b",
        "z": "b1264f7f33a6cecd",
        "g": "e58badeac6a79a19",
        "name": "",
        "x": 600,
        "y": 1060,
        "wires": [
            [
                "8b2ac556555a12c8"
            ],
            [
                "f2dce74e263d3d9c"
            ],
            [
                "e8e5d289cdf980f6"
            ]
        ]
    },
    {
        "id": "f2dce74e263d3d9c",
        "type": "link out",
        "z": "b1264f7f33a6cecd",
        "g": "e58badeac6a79a19",
        "name": "link out 25",
        "mode": "link",
        "links": [
            "4f169ba3320645ff"
        ],
        "x": 755,
        "y": 1060,
        "wires": []
    },
    {
        "id": "e8e5d289cdf980f6",
        "type": "link out",
        "z": "b1264f7f33a6cecd",
        "g": "e58badeac6a79a19",
        "name": "link out 26",
        "mode": "link",
        "links": [
            "60e1bcfa7d0988f8"
        ],
        "x": 755,
        "y": 1100,
        "wires": []
    },
    {
        "id": "4f169ba3320645ff",
        "type": "link in",
        "z": "b1264f7f33a6cecd",
        "g": "3cbc76d168ffea0b",
        "name": "link in 32",
        "links": [
            "5e29b723009e3677",
            "dc20f200c13eb39a",
            "b2227557ab57b7ef",
            "f6583d92a29357b9",
            "f2dce74e263d3d9c"
        ],
        "x": 1065,
        "y": 620,
        "wires": [
            [
                "8d0f4c9c38dfba89"
            ]
        ]
    },
    {
        "id": "06976b1a983dd765",
        "type": "link out",
        "z": "b1264f7f33a6cecd",
        "g": "c58cdcaa25741f38",
        "name": "link out 27",
        "mode": "link",
        "links": [
            "dd3fc4e68e99cc7f",
            "b81cc36611338a99",
            "f2eb9e8f54ec2846"
        ],
        "x": 755,
        "y": 700,
        "wires": []
    },
    {
        "id": "2e681e5c5cdf07be",
        "type": "link out",
        "z": "b1264f7f33a6cecd",
        "g": "c58cdcaa25741f38",
        "name": "link out 28",
        "mode": "link",
        "links": [
            "60e1bcfa7d0988f8"
        ],
        "x": 755,
        "y": 740,
        "wires": []
    },
    {
        "id": "9a0058b62a2879da",
        "type": "subflow:7e2a7678166f609f",
        "z": "b1264f7f33a6cecd",
        "name": "",
        "x": 310,
        "y": 340,
        "wires": [
            [
                "10f245919ee40388"
            ],
            [
                "6a858232c5913be8"
            ]
        ]
    },
    {
        "id": "6a858232c5913be8",
        "type": "link out",
        "z": "b1264f7f33a6cecd",
        "name": "link out 29",
        "mode": "link",
        "links": [
            "880fa11cf1585bf1",
            "7c83d266f3d716e4"
        ],
        "x": 435,
        "y": 360,
        "wires": []
    },
    {
        "id": "7c83d266f3d716e4",
        "type": "link in",
        "z": "b1264f7f33a6cecd",
        "g": "c41f0b47cbbfbc65",
        "name": "link in 33",
        "links": [
            "6a858232c5913be8"
        ],
        "x": 55,
        "y": 480,
        "wires": [
            [
                "8ca3bdc94c59e1e0"
            ]
        ]
    },
    {
        "id": "5d91c59f613f6faa",
        "type": "function",
        "z": "b1264f7f33a6cecd",
        "name": "Set Parse Mode",
        "func": "msg.payload.options = { parse_mode: \"Markdown\" };\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 260,
        "y": 220,
        "wires": [
            [
                "a2c798da2a93e73d"
            ]
        ]
    },
    {
        "id": "8104bd8c54f5c23b",
        "type": "subflow:178fa897d7510777",
        "z": "b1264f7f33a6cecd",
        "g": "998f9c86d7c6ed11",
        "name": "",
        "x": 600,
        "y": 880,
        "wires": [
            [
                "8577a7f24cae5079"
            ],
            [
                "e1313cf636f86331"
            ],
            [
                "00d7dcb2c10d87f1"
            ]
        ]
    },
    {
        "id": "8577a7f24cae5079",
        "type": "link out",
        "z": "b1264f7f33a6cecd",
        "g": "998f9c86d7c6ed11",
        "name": "link out 53",
        "mode": "link",
        "links": [
            "60e86eddac32f9da"
        ],
        "x": 755,
        "y": 840,
        "wires": []
    },
    {
        "id": "a9f3f752ca8131d6",
        "type": "function",
        "z": "b1264f7f33a6cecd",
        "g": "998f9c86d7c6ed11",
        "name": "terminado?",
        "func": "if (msg.payload == 2){\n    return msg;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 230,
        "y": 880,
        "wires": [
            [
                "2eae17aa5a73d683"
            ]
        ]
    },
    {
        "id": "2eae17aa5a73d683",
        "type": "delay",
        "z": "b1264f7f33a6cecd",
        "g": "998f9c86d7c6ed11",
        "name": "",
        "pauseType": "delay",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 420,
        "y": 880,
        "wires": [
            [
                "8104bd8c54f5c23b"
            ]
        ]
    },
    {
        "id": "b81cc36611338a99",
        "type": "link in",
        "z": "b1264f7f33a6cecd",
        "g": "998f9c86d7c6ed11",
        "name": "link in 36",
        "links": [
            "06976b1a983dd765"
        ],
        "x": 55,
        "y": 880,
        "wires": [
            [
                "a9f3f752ca8131d6"
            ]
        ]
    },
    {
        "id": "e1313cf636f86331",
        "type": "link out",
        "z": "b1264f7f33a6cecd",
        "g": "998f9c86d7c6ed11",
        "name": "link out 54",
        "mode": "link",
        "links": [
            "5882ed5137ba31d7"
        ],
        "x": 755,
        "y": 880,
        "wires": []
    },
    {
        "id": "00d7dcb2c10d87f1",
        "type": "link out",
        "z": "b1264f7f33a6cecd",
        "g": "998f9c86d7c6ed11",
        "name": "link out 55",
        "mode": "link",
        "links": [
            "60e1bcfa7d0988f8"
        ],
        "x": 755,
        "y": 920,
        "wires": []
    },
    {
        "id": "5882ed5137ba31d7",
        "type": "link in",
        "z": "b1264f7f33a6cecd",
        "g": "3cbc76d168ffea0b",
        "name": "link in 37",
        "links": [
            "5e29b723009e3677",
            "dc20f200c13eb39a",
            "b2227557ab57b7ef",
            "f6583d92a29357b9",
            "e1313cf636f86331"
        ],
        "x": 1065,
        "y": 580,
        "wires": [
            [
                "63f0786d37170552"
            ]
        ]
    },
    {
        "id": "29ab9449cc0efcfd",
        "type": "function",
        "z": "b1264f7f33a6cecd",
        "g": "649bfa4f764191c5",
        "name": "Get a range of messages",
        "func": "const min = 0;\nconst max = 6;\nmsg.payload = [\n  { $match: { \"filename\": \"historia.json\" } },\n  { $unwind: \"$payload\" },\n  {\n    $match: {\n      \"payload.numero\": { $gte: min, $lte: max }\n    }\n  },\n  {$sort: {\n    numero: 1 // 1 for ascending, -1 for descending\n  }},\n  { $replaceRoot: { newRoot: \"$payload\" } }\n];\nreturn msg;\n\n//msg.payload = [\n//  { $match: { \"filename\": \"historia.json\" } },\n//  { $unwind: \"$payload\" },\n//  { $match: { $and: [{ \"payload.numero\": { $gt: 0 } }, { \"payload.numero\": { $lt: 2 } }] } },\n//  { $replaceRoot: { newRoot: \"$payload\" } }\n//];",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1270,
        "y": 740,
        "wires": [
            [
                "a8033b20a9e59d7b"
            ]
        ]
    },
    {
        "id": "62d9a2496e44fec1",
        "type": "inject",
        "z": "b1264f7f33a6cecd",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 380,
        "y": 400,
        "wires": [
            [
                "7292a048e2c396a6"
            ]
        ]
    },
    {
        "id": "a8033b20a9e59d7b",
        "type": "mongodb in",
        "z": "b1264f7f33a6cecd",
        "g": "649bfa4f764191c5",
        "mongodb": "96e271eba0b52a94",
        "name": "",
        "collection": "historia",
        "operation": "aggregate",
        "x": 1210,
        "y": 820,
        "wires": [
            [
                "99cb5ceb8f132a55"
            ]
        ]
    },
    {
        "id": "99cb5ceb8f132a55",
        "type": "function",
        "z": "b1264f7f33a6cecd",
        "g": "649bfa4f764191c5",
        "name": "Get a range of messages",
        "func": "var contenido = msg.payload;\nvar lenght = msg.payload.length\nfor (let i = 0; i < lenght; i++) {\n  // Add a delay of 1000 milliseconds (1 second) before continuing to the next iteration\n  await new Promise(resolve => setTimeout(resolve, 5000));\n  msg.payload = contenido[i].content;\n  node.send(msg);\n}\n//return msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1470,
        "y": 820,
        "wires": [
            [
                "4987ca13a0b90d2b"
            ]
        ]
    },
    {
        "id": "4987ca13a0b90d2b",
        "type": "delay",
        "z": "b1264f7f33a6cecd",
        "g": "649bfa4f764191c5",
        "name": "",
        "pauseType": "random",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "5",
        "randomLast": "10",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1680,
        "y": 820,
        "wires": [
            [
                "1ed86f99e4e7d4dc"
            ]
        ]
    },
    {
        "id": "07b6818be845ed13",
        "type": "ui_led",
        "z": "b1264f7f33a6cecd",
        "g": "3cbc76d168ffea0b",
        "order": 3,
        "group": "f870df7d6c3cc2e9",
        "width": 0,
        "height": 0,
        "label": "Cara003",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff7800",
                "value": "Setting Up",
                "valueType": "str"
            },
            {
                "color": "#ffff00",
                "value": "Waiting to start game",
                "valueType": "str"
            },
            {
                "color": "#dc8add",
                "value": "Starting",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "Playing",
                "valueType": "str"
            },
            {
                "color": "#cc0000",
                "value": "You lose",
                "valueType": "str"
            },
            {
                "color": "#1a5fb4",
                "value": "You won",
                "valueType": "str"
            },
            {
                "color": "#865e3c",
                "value": "Timeout! You lost",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "Cara003",
        "x": 1880,
        "y": 540,
        "wires": []
    },
    {
        "id": "63f0786d37170552",
        "type": "ui_led",
        "z": "b1264f7f33a6cecd",
        "g": "3cbc76d168ffea0b",
        "order": 3,
        "group": "f870df7d6c3cc2e9",
        "width": 0,
        "height": 0,
        "label": "Cara004",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff7800",
                "value": "Setting Up",
                "valueType": "str"
            },
            {
                "color": "#ffff00",
                "value": "Waiting to start game",
                "valueType": "str"
            },
            {
                "color": "#dc8add",
                "value": "Starting",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "Playing",
                "valueType": "str"
            },
            {
                "color": "#cc0000",
                "value": "You lose",
                "valueType": "str"
            },
            {
                "color": "#1a5fb4",
                "value": "You won",
                "valueType": "str"
            },
            {
                "color": "#865e3c",
                "value": "Timeout! You lost",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "Cara004",
        "x": 1880,
        "y": 580,
        "wires": []
    },
    {
        "id": "8d0f4c9c38dfba89",
        "type": "ui_led",
        "z": "b1264f7f33a6cecd",
        "g": "3cbc76d168ffea0b",
        "order": 3,
        "group": "f870df7d6c3cc2e9",
        "width": 0,
        "height": 0,
        "label": "Cara005",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff7800",
                "value": "Setting Up",
                "valueType": "str"
            },
            {
                "color": "#ffff00",
                "value": "Waiting to start game",
                "valueType": "str"
            },
            {
                "color": "#dc8add",
                "value": "Starting",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "Playing",
                "valueType": "str"
            },
            {
                "color": "#cc0000",
                "value": "You lose",
                "valueType": "str"
            },
            {
                "color": "#1a5fb4",
                "value": "You won",
                "valueType": "str"
            },
            {
                "color": "#865e3c",
                "value": "Timeout! You lost",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": true,
        "name": "Cara005",
        "x": 1880,
        "y": 620,
        "wires": []
    },
    {
        "id": "62573d0f1753256b",
        "type": "ui_text",
        "z": "b1264f7f33a6cecd",
        "g": "3cbc76d168ffea0b",
        "order": 0,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "text",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1890,
        "y": 360,
        "wires": []
    },
    {
        "id": "0b2b91ae657441de",
        "type": "link out",
        "z": "b1264f7f33a6cecd",
        "g": "c41f0b47cbbfbc65",
        "name": "link out 56",
        "mode": "link",
        "links": [],
        "x": 755,
        "y": 560,
        "wires": []
    },
    {
        "id": "7b296dd275441bdc",
        "type": "link in",
        "z": "b1264f7f33a6cecd",
        "g": "3cbc76d168ffea0b",
        "name": "link in 38",
        "links": [],
        "x": 1065,
        "y": 380,
        "wires": [
            [
                "62573d0f1753256b"
            ]
        ]
    },
    {
        "id": "07adb488628c740e",
        "type": "debug",
        "z": "d894e2caf9be4a6e",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 547.0141983032227,
        "y": 126.00568771362305,
        "wires": []
    },
    {
        "id": "aa0a1c446cfb6f2b",
        "type": "json",
        "z": "d894e2caf9be4a6e",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 393.01419830322266,
        "y": 168.00569343566895,
        "wires": [
            [
                "07adb488628c740e",
                "8053bb5d9bfa744f"
            ]
        ]
    },
    {
        "id": "8053bb5d9bfa744f",
        "type": "function",
        "z": "d894e2caf9be4a6e",
        "name": "añade fecha",
        "func": "msg.payload.date=new Date();\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 549.0141906738281,
        "y": 169.0056962966919,
        "wires": [
            [
                "2a1ecd121dfb5544"
            ]
        ]
    },
    {
        "id": "2a1ecd121dfb5544",
        "type": "mongodb out",
        "z": "d894e2caf9be4a6e",
        "mongodb": "3752afa1.deaf9",
        "name": "",
        "collection": "test_agrega",
        "payonly": true,
        "upsert": false,
        "multi": false,
        "operation": "store",
        "x": 828.0142021179199,
        "y": 168.00568771362305,
        "wires": []
    },
    {
        "id": "34660148c8960938",
        "type": "inject",
        "z": "d894e2caf9be4a6e",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 172.7897186279297,
        "y": 261.9715576171875,
        "wires": [
            [
                "87c01054772fdf1e"
            ]
        ]
    },
    {
        "id": "87c01054772fdf1e",
        "type": "mongodb in",
        "z": "d894e2caf9be4a6e",
        "mongodb": "3752afa1.deaf9",
        "name": "",
        "collection": "test_agrega",
        "operation": "find",
        "x": 479.78687286376953,
        "y": 261.69884872436523,
        "wires": [
            [
                "39b54db0418f2447"
            ]
        ]
    },
    {
        "id": "39b54db0418f2447",
        "type": "debug",
        "z": "d894e2caf9be4a6e",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 888.7897109985352,
        "y": 263.81244564056396,
        "wires": []
    },
    {
        "id": "bbf5c8f9dfd14cee",
        "type": "comment",
        "z": "d894e2caf9be4a6e",
        "name": "Almacenamiento en base de datos",
        "info": "",
        "x": 202.78973388671875,
        "y": 79.08808326721191,
        "wires": []
    },
    {
        "id": "1b276b78dff47619",
        "type": "function",
        "z": "d894e2caf9be4a6e",
        "name": "agrega por días",
        "func": "// fecha por defecto es hoy\nvar ahora = new Date();\n// pillo los globales si los hay, si no la fecha de hoy\nvar desde = new Date(global.get(\"desde\") || ahora);\nvar hasta = new Date(global.get(\"hasta\") || ahora); \n// el día de inicio desde las cero horas\nvar inicio = new Date(desde.getFullYear(),desde.getMonth(),desde.getDate(),1,0,0,0);\n// el día final es hasta final del día\nvar final = new Date(hasta.getFullYear(),hasta.getMonth(),hasta.getDate(),24,59,59,99);\n\nmsg.payload=\n[\n    { \"$match\": { \"date\": { \"$gte\": inicio , \"$lte\": final } } },\n    { \"$project\": {\n        \"date\": 1,\n        \"temperatura\": \"$BME280.Temperatura\"\n        }\n    },\n    { \"$group\": {\n        \"_id\": { \n        \"$dateFromParts\" : {\n            \"year\": { \"$year\": \"$date\" }, \n            \"month\": { \"$month\": \"$date\" },\n            \"day\": { \"$dayOfMonth\": \"$date\" }\n        }},\n\n        \"Tmedia\":{\"$avg\":\"$temperatura\"},\n        \"Tmax\":  {\"$max\":\"$temperatura\"},\n        \"Tmin\":  {\"$min\":\"$temperatura\"},\n        \"datos\": {\"$sum\":1},\n    }},\n    { \"$sort\": {\"_id\": 1} }\n];\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 269.314266204834,
        "y": 718.0055141448975,
        "wires": [
            [
                "7fb34088ba379708"
            ]
        ]
    },
    {
        "id": "7fb34088ba379708",
        "type": "mongodb in",
        "z": "d894e2caf9be4a6e",
        "mongodb": "3752afa1.deaf9",
        "name": "",
        "collection": "test_agrega",
        "operation": "aggregate",
        "x": 543.3284492492676,
        "y": 718.0113296508789,
        "wires": [
            [
                "2f72bd130af5eb0c",
                "34d957a3a90e1ac4"
            ]
        ]
    },
    {
        "id": "2f72bd130af5eb0c",
        "type": "function",
        "z": "d894e2caf9be4a6e",
        "name": "genera datos gráfica",
        "func": "var arrayavg=[];\nvar arraymax=[];\nvar arraymin=[];\n\n// los arrays usados en la represenstación gráfica deben contener objetos JSON con dos campos: {x , y}\n// en x debemos poner la hora en formato \"timestamp\". Si tenemos un objeto fecha se puede convertir usando el método getTime()\n// en y debemos poner el valor de la variable\n// mas info en: https://github.com/node-red/node-red-dashboard/blob/master/Charts.md\n\nif(Array.isArray(msg.payload) && msg.payload.length>0)\n{\n    for (var i = 0; i < msg.payload.length; i++) { // añade datos a los array\n        arrayavg.push({x : msg.payload[i]._id.getTime() , y : msg.payload[i].Tmedia});\n        arraymax.push({x : msg.payload[i]._id.getTime() , y : msg.payload[i].Tmax});\n        arraymin.push({x : msg.payload[i]._id.getTime() , y : msg.payload[i].Tmin});\n    }\n}\n    \nmsg.payload = [{\n        \"series\":[\"T.media\",\"T.max\",\"T.min\"],\n        \"data\":[arrayavg, arraymax, arraymin],\n        \"labels\":[\"\"]\n        }];\n\nreturn msg;  ",
        "outputs": "1",
        "noerr": 0,
        "x": 859.0142402648926,
        "y": 777.0056324005127,
        "wires": [
            [
                "ec97c24f49aa4eed"
            ]
        ]
    },
    {
        "id": "ec97c24f49aa4eed",
        "type": "ui_chart",
        "z": "d894e2caf9be4a6e",
        "name": "",
        "group": "970b2d92940cc035",
        "order": 8,
        "width": 0,
        "height": 0,
        "label": "Temperaturas diarias",
        "chartType": "line",
        "legend": "true",
        "xformat": "D/M",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "colors": [
            "#008000",
            "#ff0000",
            "#0080ff",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "outputs": 2,
        "x": 1088.014072418213,
        "y": 777.0055847167969,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "fe26463c0508f97b",
        "type": "change",
        "z": "d894e2caf9be4a6e",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "desde",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 394.0057258605957,
        "y": 438.5766592025757,
        "wires": [
            [
                "e6f121b418e08458"
            ]
        ]
    },
    {
        "id": "ad96f2ccd0d3dcd6",
        "type": "change",
        "z": "d894e2caf9be4a6e",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "hasta",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 397.232967376709,
        "y": 490.4602007865906,
        "wires": [
            [
                "e6f121b418e08458"
            ]
        ]
    },
    {
        "id": "e6f121b418e08458",
        "type": "link out",
        "z": "d894e2caf9be4a6e",
        "name": "",
        "links": [],
        "x": 596.7698726654053,
        "y": 470.70737075805664,
        "wires": []
    },
    {
        "id": "b19f3a0b45f31bed",
        "type": "link in",
        "z": "d894e2caf9be4a6e",
        "name": "",
        "links": [],
        "x": 115.78126525878906,
        "y": 678.8350811004639,
        "wires": [
            [
                "1b276b78dff47619",
                "4b345b6827e81b7c"
            ]
        ]
    },
    {
        "id": "4b345b6827e81b7c",
        "type": "function",
        "z": "d894e2caf9be4a6e",
        "name": "agreaga todo",
        "func": "// fecha por defecto es hoy\nvar ahora = new Date();\n// pillo los globales si los hay, si no la fecha de hoy\nvar desde = new Date(global.get(\"desde\") || ahora);\nvar hasta = new Date(global.get(\"hasta\") || ahora); \n// el día de inicio desde las cero horas\nvar inicio = new Date(desde.getFullYear(),desde.getMonth(),desde.getDate(),1,0,0,0);\n// el día final es hasta final del día\nvar final = new Date(hasta.getFullYear(),hasta.getMonth(),hasta.getDate(),24,59,59,99);\n\nmsg.payload=\n[\n    { \"$match\": { \"date\": { \"$gte\": inicio , \"$lte\": final } } },\n    { \"$project\": {\n        \"temperatura\": \"$BME280.Temperatura\"\n        }\n    },\n    { \"$group\": {\n        \"_id\": 0,\n        \"Tmedia\":{\"$avg\":\"$temperatura\"},\n        \"Tmax\":  {\"$max\":\"$temperatura\"},\n        \"Tmin\":  {\"$min\":\"$temperatura\"},\n        \"datos\": {\"$sum\":1}\n    }}\n];\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 264.01423263549805,
        "y": 636.9146575927734,
        "wires": [
            [
                "597cc25907ac09ea"
            ]
        ]
    },
    {
        "id": "597cc25907ac09ea",
        "type": "mongodb in",
        "z": "d894e2caf9be4a6e",
        "mongodb": "3752afa1.deaf9",
        "name": "",
        "collection": "test_agrega",
        "operation": "aggregate",
        "x": 543.0284309387207,
        "y": 635.9202737808228,
        "wires": [
            [
                "96da22c131dd7b7d",
                "c794a81b732b01b6",
                "41821dbaebe31c4e",
                "fe70b7aed4483638",
                "6b220728bc4b2579"
            ]
        ]
    },
    {
        "id": "96da22c131dd7b7d",
        "type": "ui_text",
        "z": "d894e2caf9be4a6e",
        "group": "970b2d92940cc035",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Média en el período",
        "format": "{{msg.payload[0].Tmedia | number:1 }}ºC",
        "layout": "row-left",
        "x": 1042.792636871338,
        "y": 557.3292970657349,
        "wires": []
    },
    {
        "id": "c794a81b732b01b6",
        "type": "ui_text",
        "z": "d894e2caf9be4a6e",
        "group": "970b2d92940cc035",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Máxima en el período",
        "format": "{{msg.payload[0].Tmax | number:1 }}ºC",
        "layout": "row-left",
        "x": 1037.0142250061035,
        "y": 596.7327833175659,
        "wires": []
    },
    {
        "id": "41821dbaebe31c4e",
        "type": "ui_text",
        "z": "d894e2caf9be4a6e",
        "group": "970b2d92940cc035",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Mínima en el período",
        "format": "{{msg.payload[0].Tmin | number:1 }}ºC",
        "layout": "row-left",
        "x": 1036.0142250061035,
        "y": 634.7327489852905,
        "wires": []
    },
    {
        "id": "a36253d32c4d2751",
        "type": "comment",
        "z": "d894e2caf9be4a6e",
        "name": "Controles para seleccionar fechas",
        "info": "",
        "x": 198.00001525878906,
        "y": 373.82383251190186,
        "wires": []
    },
    {
        "id": "5d82db756b797ad1",
        "type": "comment",
        "z": "d894e2caf9be4a6e",
        "name": "Consultas agregadas",
        "info": "",
        "x": 173.7897720336914,
        "y": 579.3663816452026,
        "wires": []
    },
    {
        "id": "34d957a3a90e1ac4",
        "type": "debug",
        "z": "d894e2caf9be4a6e",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 846.789737701416,
        "y": 737.8124227523804,
        "wires": []
    },
    {
        "id": "fe70b7aed4483638",
        "type": "debug",
        "z": "d894e2caf9be4a6e",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 812.0142364501953,
        "y": 545.0055742263794,
        "wires": []
    },
    {
        "id": "6b220728bc4b2579",
        "type": "ui_text",
        "z": "d894e2caf9be4a6e",
        "group": "970b2d92940cc035",
        "order": 6,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Número de datos",
        "format": "{{msg.payload[0].datos }} muestras",
        "layout": "row-left",
        "x": 1032.0142402648926,
        "y": 682.0055913925171,
        "wires": []
    },
    {
        "id": "d27ee6eb14be70d1",
        "type": "ui_date_picker",
        "z": "d894e2caf9be4a6e",
        "name": "",
        "label": "Fecha de inicio",
        "group": "970b2d92940cc035",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": true,
        "topic": "",
        "x": 185.76986694335938,
        "y": 434.73571586608887,
        "wires": [
            [
                "fe26463c0508f97b"
            ]
        ]
    },
    {
        "id": "48c0cc40805bc146",
        "type": "ui_date_picker",
        "z": "d894e2caf9be4a6e",
        "name": "",
        "label": "Fecha de final",
        "group": "970b2d92940cc035",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": true,
        "topic": "",
        "x": 162.7783966064453,
        "y": 488.7414951324463,
        "wires": [
            [
                "ad96f2ccd0d3dcd6"
            ]
        ]
    },
    {
        "id": "7ced1ae9e7c990f3",
        "type": "mqtt in",
        "z": "d894e2caf9be4a6e",
        "name": "",
        "topic": "iot/datos/json",
        "qos": "2",
        "datatype": "auto",
        "broker": "2b251178.95ad2e",
        "nl": false,
        "rap": false,
        "inputs": 0,
        "x": 150,
        "y": 171.1111159324646,
        "wires": [
            [
                "aa0a1c446cfb6f2b"
            ]
        ]
    },
    {
        "id": "91a68b97b3deebe0",
        "type": "ui_text_input",
        "z": "e5bf25aa0df07243",
        "name": "",
        "label": "",
        "tooltip": "",
        "group": "ef4e3347ed457b9c",
        "order": 0,
        "width": 0,
        "height": 0,
        "passthru": true,
        "mode": "text",
        "delay": "0",
        "topic": "topic",
        "sendOnBlur": true,
        "className": "",
        "topicType": "msg",
        "x": 80,
        "y": 180,
        "wires": [
            [
                "e99caad263207692"
            ]
        ]
    },
    {
        "id": "72d1351fa90f7c1a",
        "type": "mongodb in",
        "z": "e5bf25aa0df07243",
        "mongodb": "f605fa69.8f5008",
        "name": "Colección: datousuario",
        "collection": "datosusuario",
        "operation": "find",
        "x": 500,
        "y": 180,
        "wires": [
            [
                "734a9b07feeef7eb"
            ]
        ]
    },
    {
        "id": "37deb857424f416d",
        "type": "debug",
        "z": "e5bf25aa0df07243",
        "name": "debug 13",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1000,
        "y": 220,
        "wires": []
    },
    {
        "id": "e99caad263207692",
        "type": "function",
        "z": "e5bf25aa0df07243",
        "name": "Finder",
        "func": "var user = msg.payload;\nflow.set(\"user\", user);\nmsg.payload = {\"usuario\":user};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 270,
        "y": 180,
        "wires": [
            [
                "72d1351fa90f7c1a"
            ]
        ]
    },
    {
        "id": "1108aac688511925",
        "type": "mongodb in",
        "z": "e5bf25aa0df07243",
        "mongodb": "f605fa69.8f5008",
        "name": "Colección: hashusuario",
        "collection": "hashusuario",
        "operation": "find",
        "x": 510,
        "y": 260,
        "wires": [
            [
                "f0efedcb0b4e9a78"
            ]
        ]
    },
    {
        "id": "734a9b07feeef7eb",
        "type": "function",
        "z": "e5bf25aa0df07243",
        "name": "Set pass as flow var",
        "func": "flow.set(\"password\", msg.payload[0].password);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 800,
        "y": 180,
        "wires": [
            [
                "37deb857424f416d"
            ]
        ]
    },
    {
        "id": "f0efedcb0b4e9a78",
        "type": "function",
        "z": "e5bf25aa0df07243",
        "name": "Set hash as flow var",
        "func": "flow.set(\"hash\", msg.payload[0].hash);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 800,
        "y": 260,
        "wires": [
            [
                "37deb857424f416d"
            ]
        ]
    },
    {
        "id": "4ad7a20ef57b3833",
        "type": "mqtt out",
        "z": "e5bf25aa0df07243",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "64cdcf7a3b4cd223",
        "x": 850,
        "y": 320,
        "wires": []
    },
    {
        "id": "4086305bf76bcaf6",
        "type": "function",
        "z": "e5bf25aa0df07243",
        "name": "Generate JSON",
        "func": "var user = flow.get(\"user\");\nvar password = flow.get(\"password\");\nvar hash = flow.get(\"hash\");\nmsg.topic = \"examen/nodered/\";\nmsg.topic = msg.topic + password;\nmsg.payload = { \"usuario\": user, \"password\": password, \"hash\": hash };\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 300,
        "y": 320,
        "wires": [
            [
                "8aadd19bd2a61942"
            ]
        ]
    },
    {
        "id": "8aadd19bd2a61942",
        "type": "json",
        "z": "e5bf25aa0df07243",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 550,
        "y": 320,
        "wires": [
            [
                "4ad7a20ef57b3833"
            ]
        ]
    },
    {
        "id": "de38e936a07a26d1",
        "type": "mqtt in",
        "z": "e5bf25aa0df07243",
        "g": "b247db83b1efe9cb",
        "name": "",
        "topic": "respuesta/usuario/7742805",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "64cdcf7a3b4cd223",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 150,
        "y": 440,
        "wires": [
            [
                "6cf20a8e5e9451f2"
            ]
        ]
    },
    {
        "id": "6cf20a8e5e9451f2",
        "type": "debug",
        "z": "e5bf25aa0df07243",
        "g": "b247db83b1efe9cb",
        "name": "debug 14",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 420,
        "y": 440,
        "wires": []
    },
    {
        "id": "803baba75ce2fb4f",
        "type": "function",
        "z": "e5bf25aa0df07243",
        "name": "Finder",
        "func": "var user = flow.get(\"user\");\nmsg.payload = {\"usuario\":user};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 270,
        "y": 260,
        "wires": [
            [
                "1108aac688511925"
            ]
        ]
    },
    {
        "id": "549f8fd5ec7043b1",
        "type": "complete",
        "z": "e5bf25aa0df07243",
        "name": "",
        "scope": [
            "734a9b07feeef7eb"
        ],
        "uncaught": false,
        "x": 90,
        "y": 260,
        "wires": [
            [
                "803baba75ce2fb4f"
            ]
        ]
    },
    {
        "id": "2675d0d37c03891a",
        "type": "complete",
        "z": "e5bf25aa0df07243",
        "name": "",
        "scope": [
            "f0efedcb0b4e9a78"
        ],
        "uncaught": false,
        "x": 90,
        "y": 320,
        "wires": [
            [
                "4086305bf76bcaf6"
            ]
        ]
    },
    {
        "id": "9a4e0a7e9d31db84",
        "type": "mqtt in",
        "z": "e5bf25aa0df07243",
        "name": "",
        "topic": "examen/datos/NODO14319362",
        "qos": "2",
        "datatype": "auto-detect",
        "broker": "64cdcf7a3b4cd223",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 170,
        "y": 540,
        "wires": [
            [
                "2eebacb42e3db9c1"
            ]
        ]
    },
    {
        "id": "2eebacb42e3db9c1",
        "type": "debug",
        "z": "e5bf25aa0df07243",
        "name": "debug 15",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 440,
        "y": 540,
        "wires": []
    },
    {
        "id": "cdbfcc3d3f384725",
        "type": "telegram command",
        "z": "bf067899c58fd436",
        "name": "",
        "command": "/tiempo",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "1f33bd2091f1c0f0",
        "strict": false,
        "hasresponse": false,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 1,
        "x": 130,
        "y": 980,
        "wires": [
            [
                "131570a404fb2ef4"
            ]
        ]
    },
    {
        "id": "131570a404fb2ef4",
        "type": "function",
        "z": "bf067899c58fd436",
        "name": "function 7",
        "func": "msg.user = msg.payload;\nvar hora_str = new Date();\nvar hora = Number(hora_str.getHours());\nif (hora < 6) {\n    var value = 3;\n}else if ( hora >= 6 && hora < 12){\n    var value = 4;\n}else if (hora >= 12 && hora < 18){\n    var value = 5;\n}else if (hora >= 18 && hora < 24){\n    var value = 6;\n}\nmsg.mensaje = value;\nmsg.limit = 1;\nmsg.sort = { \"date\": -1 };\nmsg.payload = {};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 300,
        "y": 980,
        "wires": [
            [
                "d034f65f0e3e95d5"
            ]
        ]
    },
    {
        "id": "372d395d37f4399f",
        "type": "function",
        "z": "bf067899c58fd436",
        "name": "function 8",
        "func": "var period = msg.mensaje;\nmsg.elaborado = msg.payload.root.elaborado[0]\nmsg.prob_precipitacion = msg.payload.root.prediccion[0].dia[0].prob_precipitacion[period]._;\nmsg.periodo = msg.payload.root.prediccion[0].dia[0].prob_precipitacion[period].$.periodo;\nmsg.estado_del_cielo = msg.payload.root.prediccion[0].dia[0].estado_cielo[period].$.descripcion;\nmsg.prob_precipitacion_manana = msg.payload.root.prediccion[0].dia[1].prob_precipitacion[0]._;\nmsg.estado_del_cielo_manana = msg.payload.root.prediccion[0].dia[1].estado_cielo[0].$.descripcion;\n\n\nmsg.payload = msg.user;\nmsg.payload.content = \"\";\nmsg.payload.content += \"\\nSegún la AEMET la predicción para las próximas horas (\"+ msg.periodo + \"h)\"\nmsg.payload.content += \" es de \" + msg.estado_del_cielo;\nmsg.payload.content += \" y probabilidad de lluvia de \" + msg.prob_precipitacion + \"%. \"\nmsg.payload.content += \"Mañana se espera \" + msg.estado_del_cielo_manana + \" y probabilidad de lluvia de \" + msg.prob_precipitacion_manana + \"%.\";\nmsg.payload.content += \"\\nPredicción elaborada: \" + msg.elaborado + \".\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 920,
        "y": 980,
        "wires": [
            []
        ]
    },
    {
        "id": "d034f65f0e3e95d5",
        "type": "http request",
        "z": "bf067899c58fd436",
        "name": "AEMET http request",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://www.aemet.es/xml/municipios/localidad_29901.xml",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 540,
        "y": 980,
        "wires": [
            [
                "c85d881e10b6329d"
            ]
        ]
    },
    {
        "id": "c85d881e10b6329d",
        "type": "xml",
        "z": "bf067899c58fd436",
        "name": "",
        "property": "payload",
        "attr": "",
        "chr": "",
        "x": 750,
        "y": 980,
        "wires": [
            [
                "372d395d37f4399f"
            ]
        ]
    },
    {
        "id": "04dcfe82fc5cd443",
        "type": "debug",
        "z": "bf067899c58fd436",
        "name": "debug 11",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1320,
        "y": 780,
        "wires": []
    },
    {
        "id": "34c0f7c601487783",
        "type": "inject",
        "z": "bf067899c58fd436",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "II3/ESP004/cmd/cara004",
        "payload": "0",
        "payloadType": "num",
        "x": 230,
        "y": 620,
        "wires": [
            [
                "4515b66903b1875a"
            ]
        ]
    },
    {
        "id": "f10b56669cea886e",
        "type": "mqtt out",
        "z": "bf067899c58fd436",
        "name": "",
        "topic": "II3/ESP004/cmd/cara004",
        "qos": "",
        "retain": "",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "2b251178.95ad2e",
        "x": 750,
        "y": 680,
        "wires": []
    },
    {
        "id": "6ada68e57791b1ac",
        "type": "inject",
        "z": "bf067899c58fd436",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "II3/ESP004/cmd/cara004",
        "payload": "1",
        "payloadType": "num",
        "x": 230,
        "y": 680,
        "wires": [
            [
                "4515b66903b1875a"
            ]
        ]
    },
    {
        "id": "4515b66903b1875a",
        "type": "function",
        "z": "bf067899c58fd436",
        "name": "function 17",
        "func": "msg.payload = {\n    \"commands\": {\n        \"1\": { \"action\": \"activar_led\", \"value\": \"1\" },\n        \"2\": { \"action\": \"enable_game\", \"value\": \"1\" },\n        \"3\": { \"action\": \"get_sequence\", \"value\": \"010204\" }\n    }\n};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 470,
        "y": 640,
        "wires": [
            [
                "f10b56669cea886e",
                "bd5edbebc3d61ab2"
            ]
        ]
    },
    {
        "id": "bd5edbebc3d61ab2",
        "type": "debug",
        "z": "bf067899c58fd436",
        "name": "debug 12",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 640.0833129882812,
        "y": 731.0833435058594,
        "wires": []
    },
    {
        "id": "2f1566848f44cdae",
        "type": "telegram reply",
        "z": "bf067899c58fd436",
        "name": "",
        "bot": "d95354d46509e771",
        "x": 900,
        "y": 160,
        "wires": [
            [
                "4489c81ed21b2417"
            ]
        ]
    },
    {
        "id": "6214e9d776bde3e1",
        "type": "telegram event",
        "z": "bf067899c58fd436",
        "name": "",
        "bot": "d95354d46509e771",
        "event": "callback_query",
        "autoanswer": true,
        "x": 200,
        "y": 260,
        "wires": [
            [
                "293ba2df2496b95a"
            ]
        ]
    },
    {
        "id": "9e2fa180ba29302a",
        "type": "telegram control",
        "z": "bf067899c58fd436",
        "name": "",
        "bot": "d95354d46509e771",
        "outputs": 1,
        "checkconnection": false,
        "hostname": "",
        "interval": 10,
        "timeout": 1,
        "x": 220,
        "y": 80,
        "wires": [
            [
                "9491d7a014559425"
            ]
        ]
    },
    {
        "id": "9491d7a014559425",
        "type": "debug",
        "z": "bf067899c58fd436",
        "name": "debug 22",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 460,
        "y": 80,
        "wires": []
    },
    {
        "id": "39cc42426b018744",
        "type": "function",
        "z": "bf067899c58fd436",
        "name": "function 18",
        "func": "var texto = msg.payload;\nmsg.payload = global.get(\"user\");\nmsg.payload.content = \"te gusta el pan ?\";\nmsg.payload.type = \"message\";\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 470,
        "y": 160,
        "wires": [
            [
                "baf5edb767f52d1d"
            ]
        ]
    },
    {
        "id": "c3363cce1c8ce10d",
        "type": "change",
        "z": "bf067899c58fd436",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "user",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 280,
        "y": 160,
        "wires": [
            [
                "39cc42426b018744"
            ]
        ]
    },
    {
        "id": "baf5edb767f52d1d",
        "type": "telegram sender",
        "z": "bf067899c58fd436",
        "name": "",
        "bot": "d95354d46509e771",
        "haserroroutput": false,
        "outputs": 1,
        "x": 670,
        "y": 160,
        "wires": [
            [
                "2f1566848f44cdae"
            ]
        ]
    },
    {
        "id": "4489c81ed21b2417",
        "type": "debug",
        "z": "bf067899c58fd436",
        "name": "debug 23",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1080,
        "y": 160,
        "wires": []
    },
    {
        "id": "df4e1a7098f08e09",
        "type": "state-machine",
        "z": "bf067899c58fd436",
        "name": "",
        "triggerProperty": "topic",
        "triggerPropertyType": "msg",
        "stateProperty": "topic",
        "statePropertyType": "msg",
        "outputStateChangeOnly": false,
        "throwException": false,
        "states": [
            "start",
            "game1",
            "game2"
        ],
        "transitions": [
            {
                "name": "game 1",
                "from": "start",
                "to": "start"
            }
        ],
        "x": 380,
        "y": 1120,
        "wires": [
            [
                "343804ff1e0b5fee"
            ]
        ]
    },
    {
        "id": "b8137dcf263b6ca4",
        "type": "inject",
        "z": "bf067899c58fd436",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 180,
        "y": 1120,
        "wires": [
            [
                "df4e1a7098f08e09"
            ]
        ]
    },
    {
        "id": "343804ff1e0b5fee",
        "type": "debug",
        "z": "bf067899c58fd436",
        "name": "debug 24",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 580,
        "y": 1120,
        "wires": []
    },
    {
        "id": "3524b095adb0a45f",
        "type": "finite-state-machine",
        "z": "bf067899c58fd436",
        "name": "",
        "fsmDefinition": "{\"state\":{\"status\":\"IDLE\",\"data\":{\"x\":5}},\"transitions\":{\"IDLE\":{\"run\":\"RUNNING\"},\"RUNNING\":{\"stop\":\"IDLE\"}}}",
        "sendInitialState": true,
        "sendStateWithoutChange": true,
        "showTransitionErrors": true,
        "x": 390,
        "y": 1160,
        "wires": [
            [
                "5d05e2225455d8c2"
            ]
        ]
    },
    {
        "id": "5d05e2225455d8c2",
        "type": "debug",
        "z": "bf067899c58fd436",
        "name": "debug 25",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 620,
        "y": 1160,
        "wires": []
    },
    {
        "id": "e450c4ac36b135e5",
        "type": "inject",
        "z": "bf067899c58fd436",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "run",
        "payload": "run",
        "payloadType": "str",
        "x": 170,
        "y": 1160,
        "wires": [
            [
                "3524b095adb0a45f"
            ]
        ]
    },
    {
        "id": "293ba2df2496b95a",
        "type": "function",
        "z": "bf067899c58fd436",
        "name": "function 19",
        "func": "var show_alert = false; // you can set this to true to open a dialog with the answer in the client.\n\n// msg.payload.content contains the callback data from the keyboard.\n// You may change this value here.\nmsg.payload.options = show_alert;\n\nreturn [msg];",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 430,
        "y": 260,
        "wires": [
            [
                "78e7aab9c7ec1373"
            ]
        ]
    },
    {
        "id": "78e7aab9c7ec1373",
        "type": "telegram sender",
        "z": "bf067899c58fd436",
        "name": "",
        "bot": "d95354d46509e771",
        "haserroroutput": false,
        "outputs": 1,
        "x": 710,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "9b2ea54fa78e86bd",
        "type": "function",
        "z": "bf067899c58fd436",
        "name": "function 20",
        "func": "var opts = {\n    reply_to_message_id: msg.payload.messageId,\n    reply_markup: JSON.stringify({\n        \"inline_keyboard\": [[\n            {\n                \"text\": \"Yes\",\n                \"callback_data\": \"FOO YES\"\n            },\n            {\n                \"text\": \"No\",\n                \"callback_data\": \"FOO NO\"\n            }]\n        ]\n    })\n};\n\nmsg.payload.content = 'Are you sure?';\nmsg.payload.options = opts;\n\nreturn [msg];",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 430,
        "y": 340,
        "wires": [
            [
                "d8b284664cfbb709"
            ]
        ]
    },
    {
        "id": "d8b284664cfbb709",
        "type": "telegram sender",
        "z": "bf067899c58fd436",
        "name": "",
        "bot": "d95354d46509e771",
        "haserroroutput": false,
        "outputs": 1,
        "x": 710,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "572ffaa24f1114dd",
        "type": "telegram command",
        "z": "bf067899c58fd436",
        "name": "",
        "command": "/menu",
        "description": "",
        "registercommand": false,
        "language": "",
        "scope": "default",
        "bot": "d95354d46509e771",
        "strict": false,
        "hasresponse": false,
        "useregex": false,
        "removeregexcommand": false,
        "outputs": 1,
        "x": 170,
        "y": 340,
        "wires": [
            [
                "9b2ea54fa78e86bd"
            ]
        ]
    },
    {
        "id": "e99f6c6b8cc9d3fd",
        "type": "file in",
        "z": "bf067899c58fd436",
        "name": "",
        "filename": "/home/rhyloo/nol/pics/foo.jpeg",
        "filenameType": "str",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "allProps": false,
        "x": 430,
        "y": 800,
        "wires": [
            [
                "a71b59a1c464a5f9"
            ]
        ]
    },
    {
        "id": "a71b59a1c464a5f9",
        "type": "mongodb out",
        "z": "bf067899c58fd436",
        "mongodb": "6046a47177835823",
        "name": "",
        "collection": "test",
        "payonly": false,
        "upsert": false,
        "multi": false,
        "operation": "store",
        "x": 730,
        "y": 800,
        "wires": []
    },
    {
        "id": "2e17caddfac54aed",
        "type": "inject",
        "z": "bf067899c58fd436",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 800,
        "wires": [
            [
                "e99f6c6b8cc9d3fd"
            ]
        ]
    },
    {
        "id": "b80f6dcc2542d37d",
        "type": "function",
        "z": "bf067899c58fd436",
        "name": "Recupera un acertijo aleatorio de la base de datos",
        "func": "msg.payload = {\"filename\":\"/home/rhyloo/nol/pics/foo.jpeg\"};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 490,
        "y": 860,
        "wires": [
            [
                "ea4d09276eae1c1d"
            ]
        ]
    },
    {
        "id": "ea4d09276eae1c1d",
        "type": "mongodb in",
        "z": "bf067899c58fd436",
        "mongodb": "6046a47177835823",
        "name": "",
        "collection": "test",
        "operation": "find",
        "x": 830,
        "y": 860,
        "wires": [
            [
                "a6171cc039c926da"
            ]
        ]
    },
    {
        "id": "9ded2e9870324257",
        "type": "inject",
        "z": "bf067899c58fd436",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 160,
        "y": 860,
        "wires": [
            [
                "b80f6dcc2542d37d"
            ]
        ]
    },
    {
        "id": "e5d28d34b96e8e7b",
        "type": "function",
        "z": "bf067899c58fd436",
        "name": "function 22",
        "func": "flow.set(\"photo\", msg.payload[0].payload);\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1250,
        "y": 860,
        "wires": [
            [
                "04dcfe82fc5cd443"
            ]
        ]
    },
    {
        "id": "452202df97badbee",
        "type": "buffer-maker",
        "z": "bf067899c58fd436",
        "name": "",
        "specification": "",
        "specificationType": "ui",
        "items": [
            {
                "name": "item1",
                "type": "int16be",
                "data": "payload",
                "dataType": "msg"
            }
        ],
        "swap1": "",
        "swap2": "",
        "swap3": "",
        "swap1Type": "swap",
        "swap2Type": "swap",
        "swap3Type": "swap",
        "msgProperty": "payload",
        "msgPropertyType": "str",
        "x": 890,
        "y": 580,
        "wires": [
            []
        ]
    },
    {
        "id": "a6171cc039c926da",
        "type": "buffer-parser",
        "z": "bf067899c58fd436",
        "name": "",
        "data": "payload",
        "dataType": "msg",
        "specification": "spec",
        "specificationType": "ui",
        "items": [
            {
                "type": "buffer",
                "name": "item1",
                "offset": 0,
                "length": 1,
                "offsetbit": 0,
                "scale": "1",
                "mask": ""
            }
        ],
        "swap1": "",
        "swap2": "",
        "swap3": "",
        "swap1Type": "swap",
        "swap2Type": "swap",
        "swap3Type": "swap",
        "msgProperty": "payload",
        "msgPropertyType": "str",
        "resultType": "object",
        "resultTypeType": "return",
        "multipleResult": true,
        "fanOutMultipleResult": false,
        "setTopic": true,
        "outputs": 1,
        "x": 1030,
        "y": 860,
        "wires": [
            [
                "e5d28d34b96e8e7b",
                "04dcfe82fc5cd443"
            ]
        ]
    },
    {
        "id": "bf0d95412d1de016",
        "type": "mongodb in",
        "z": "bf067899c58fd436",
        "mongodb": "96e271eba0b52a94",
        "name": "",
        "collection": "recursos_de_las_pruebas",
        "operation": "find",
        "x": 590,
        "y": 1280,
        "wires": [
            [
                "80d947e82fd01930"
            ]
        ]
    },
    {
        "id": "c8e615bbe89b4f16",
        "type": "mongodb out",
        "z": "bf067899c58fd436",
        "mongodb": "96e271eba0b52a94",
        "name": "",
        "collection": "recursos_de_las_pruebas",
        "payonly": false,
        "upsert": false,
        "multi": false,
        "operation": "store",
        "x": 610,
        "y": 1360,
        "wires": []
    },
    {
        "id": "9b7056b6612049c0",
        "type": "inject",
        "z": "bf067899c58fd436",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 300,
        "y": 1280,
        "wires": [
            [
                "bf0d95412d1de016"
            ]
        ]
    },
    {
        "id": "80d947e82fd01930",
        "type": "debug",
        "z": "bf067899c58fd436",
        "name": "debug 30",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 980,
        "y": 1280,
        "wires": []
    },
    {
        "id": "f9c43e7b.e1716",
        "type": "file in",
        "z": "d13323c9cef06b5d",
        "name": "Read audio file",
        "filename": "filename",
        "filenameType": "msg",
        "format": "utf8",
        "chunk": false,
        "sendError": false,
        "x": 600,
        "y": 140,
        "wires": [
            [
                "36e6c708.f3d3a"
            ]
        ]
    },
    {
        "id": "36e6c708.f3d3a",
        "type": "mongodb out",
        "z": "d13323c9cef06b5d",
        "mongodb": "96e271eba0b52a94",
        "name": "Save audio file to MongoDB",
        "collection": "audio_test",
        "payonly": true,
        "upsert": false,
        "multi": false,
        "operation": "store",
        "x": 860,
        "y": 140,
        "wires": []
    },
    {
        "id": "22c58b82.6dcd64",
        "type": "mongodb in",
        "z": "d13323c9cef06b5d",
        "mongodb": "96e271eba0b52a94",
        "name": "Retrieve audio file from MongoDB",
        "collection": "audio_test",
        "operation": "find",
        "x": 600,
        "y": 340,
        "wires": [
            [
                "983b1f9fd1205006",
                "242723e243bb1259",
                "f46ba2e19f335c54"
            ]
        ]
    },
    {
        "id": "4304a9d7a43c2519",
        "type": "inject",
        "z": "d13323c9cef06b5d",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            },
            {
                "p": "filename",
                "v": "/home/rhyloo/nol/pics/mensaje1.wav",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 320,
        "y": 140,
        "wires": [
            [
                "f9c43e7b.e1716"
            ]
        ]
    },
    {
        "id": "cddeeafbc72621f1",
        "type": "inject",
        "z": "d13323c9cef06b5d",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "()",
        "payloadType": "str",
        "x": 290,
        "y": 340,
        "wires": [
            [
                "22c58b82.6dcd64"
            ]
        ]
    },
    {
        "id": "8b076147b61f80f3",
        "type": "function",
        "z": "d13323c9cef06b5d",
        "name": "voide - msg 1",
        "func": "var audio = msg.payload[0];\nmsg.payload = global.get(\"user\");\nmsg.payload.content = audio;\nmsg.payload.type = 'voice';\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1160,
        "y": 340,
        "wires": [
            [
                "620dbc930d372bc6"
            ]
        ]
    },
    {
        "id": "620dbc930d372bc6",
        "type": "telegram sender",
        "z": "d13323c9cef06b5d",
        "name": "",
        "bot": "d95354d46509e771",
        "haserroroutput": false,
        "outputs": 1,
        "x": 1390,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "983b1f9fd1205006",
        "type": "debug",
        "z": "d13323c9cef06b5d",
        "name": "debug 44",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 900,
        "y": 440,
        "wires": []
    },
    {
        "id": "242723e243bb1259",
        "type": "function",
        "z": "d13323c9cef06b5d",
        "name": "function 25",
        "func": "msg.payload = Buffer.from(msg.payload); \nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 910,
        "y": 340,
        "wires": [
            [
                "8b076147b61f80f3",
                "9ce7382270600c46"
            ]
        ]
    },
    {
        "id": "9ce7382270600c46",
        "type": "debug",
        "z": "d13323c9cef06b5d",
        "name": "debug 47",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1140,
        "y": 420,
        "wires": []
    },
    {
        "id": "f46ba2e19f335c54",
        "type": "file",
        "z": "d13323c9cef06b5d",
        "name": "",
        "filename": "~/nol/pics/test.wav",
        "filenameType": "str",
        "appendNewline": true,
        "createDir": true,
        "overwriteFile": "false",
        "encoding": "setbymsg",
        "x": 970,
        "y": 240,
        "wires": [
            []
        ]
    }
]